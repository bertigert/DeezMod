"use strict";(self.webpackJsonpDeezer=self.webpackJsonpDeezer||[]).push([[5986],{"5s/P":(e,t,r)=>{r.r(t),r.d(t,{default:()=>_e});var s,i=r("q1tI"),n=r("X6oL"),a=r("TRpf"),o=r("Wp0Y"),l=r("WmA5"),c=r("hz5U"),d=r("YG/N"),p=r("aHAS"),m=r("e2eG");const h=(0,n.Ay)({pagename:"onboarding",pagecategory:"onboarding-artists",virtualpageurl:"/onboarding-completed",event:"virtualpageview"},{dispatchOnMount:!0})((({closeScreen:e,callbackLink:t})=>{const r=(0,a.wA)();return i.useEffect((()=>{r((0,p.Sk)((()=>{m.A.init(),l.A.replace(t),e()})))}),[]),i.createElement("div",{className:"onboarding-screen-finish"},i.createElement(d.A.Header,{className:"onboarding-screen-finish-header"},(0,o.AP)("Splendide !")),i.createElement("div",{key:"onboarding-screen-finish-animation",className:"onboarding-screen-finish-animation"},s||(s=i.createElement("div",{className:"onboarding-screen-finish-loader"})),i.createElement("img",{className:"onboarding-screen-finish-loader-picture",width:"204",src:c.A.getImageSrc("misc","4d557016ec84834d42fbea9c97d3b4eb",204,204,"none")})))}));var u=r("+9dH"),f=(r("/eM8"),r("RGaU")),g=r("HmE0"),E=r("eOc8"),A=r("CdHq"),v=r("ZDlI"),S=r("y7xR"),y=r("pVdW"),x=r("TDRX"),b=r("nrKQ");const _=(e,t)=>e.map((e=>({id:e.ART_ID,name:e.ART_NAME,image:e.ART_PICTURE||{format:"jpg",type:"artist",md5:"d41d8cd98f00b204e9800998ecf8427e"},isSelected:!1,reference:t}))),w=e=>e.id,k=(e,t,r)=>{b.A.call({method:"onboarding.getTopArtists",data:{CONTEXT:e},success:e=>{t(_(e))},error:r})};var C=r("5G9X"),L=r("LjZa"),T=r("34sk"),I=r("xobL"),O=r("kSUS"),B=r("3o0m"),F=r("Z9kq"),R=r("ntT5"),P=r("rXlm"),G=r("MG7B");const M=({artist:e,onClick:t})=>i.createElement("div",{className:"onboarding-screen-search-item",onClick:t},i.createElement("img",{className:"onboarding-screen-search-item-picture",src:c.A.getImageSrc("artist",e.image.md5,55,55)}),i.createElement("div",{className:"onboarding-screen-search-item-name ellipsis"},e.name));var N,D=r("4liH"),U=r("7E8A");class z extends i.Component{constructor(...e){super(...e),this.state={isOpened:!1,searchResult:[],query:"",searchResultLoaded:!1},this.textInput=i.createRef(),this.popoverElement=i.createRef(),this.focusInput=()=>{this.textInput.current&&this.textInput.current.focus()},this.searchArtist=(0,O.A)((()=>{var e,t,r,s;this.state.query&&(e=this.state.query,t=this.props.context,r=this.setSearchResult,s=L.A,b.A.call({method:"onboarding.searchArtist",data:{QUERY:e,CONTEXT:t},success:e=>{r(_(e.data))},error:s}))}),500),this.setSearchResult=e=>{this.setState({searchResult:e,searchResultLoaded:!0,isOpened:!0})},this.clickOutsideSearch=e=>{const t=e.target;null===this.textInput.current||this.textInput.current.contains(t)||t.className.includes("onboarding-screen-search-item")||this.closePopper()},this.closePopper=()=>{this.props.onPopoverOpened(!1),this.setState({isOpened:!1})},this.onArtistSelection=e=>{(0,R.Fw)(this.state.query,"",U.CONTEXT_PAGE_SEARCH_ONBOARDING,D.SA,{...e,type:C.Ay.Artist}),this.closePopper(),this.props.onArtistSelection(e),this.setState({query:"",searchResult:[],isOpened:!1,searchResultLoaded:!1})},this.onInputChange=e=>{const t=Boolean(e.target.value);this.setState({isOpened:t,query:e.target.value,searchResultLoaded:!1}),this.props.onPopoverOpened(t),t||this.closePopper(),this.searchArtist()},this.onWrapperClick=()=>{this.focusInput(),this.props.onPopoverOpened(this.state.searchResultLoaded),this.setState({isOpened:this.state.searchResultLoaded})},this.onCancelClick=()=>{this.props.onPopoverOpened(!1),this.setState({query:"",searchResult:[],isOpened:!1,searchResultLoaded:!1})}}componentDidMount(){document.addEventListener("click",this.clickOutsideSearch,!0)}get resultList(){if(!this.state.searchResultLoaded)return N||(N=i.createElement(f.k,null));if(!this.state.searchResult.length){const e=(0,o.AP)("Aucun résultat pour «<strong>%s</strong>»",{sprintf:[" "+(0,G.A)(this.state.query)+" "]});return i.createElement("div",{className:"onboarding-screen-search-no-results",dangerouslySetInnerHTML:{__html:e}})}return i.createElement(P.A,{className:"onboarding-screen-search-list"},this.state.searchResult.map((e=>i.createElement(M,{key:e.id,artist:e,onClick:this.onArtistSelection.bind(this,e)}))))}render(){return i.createElement(A.s,{w:"100%"},i.createElement(F.D,{ref:this.textInput,id:"onBoardingSearchAnchor",className:"onboarding-screen-search-input",type:"text",autoComplete:"off",placeholder:(0,o.AP)("Rechercher"),onChange:this.onInputChange,value:this.state.query,onClick:this.onWrapperClick}),this.state.isOpened&&i.createElement(B.A,{anchorNode:this.textInput.current,className:"onboarding-screen-search-popper"},this.resultList))}}var X=r("juqV"),W=r("siwx"),j=r("VQs7"),Z=r("AlG7");const V=242;class q extends i.Component{constructor(...e){super(...e),this.self=i.createRef(),this.onClick=()=>{this.props.onClick(this.props.id,this.self.current)}}get imageUrl(){const{image:{type:e,md5:t}}=this.props;return c.A.getImageSrc(e,t,V,V)}render(){const e=(0,X.A)("onboarding-screen-artist-item",{"onboarding-screen-artist-item--selected":this.props.isSelected});return i.createElement("div",{ref:this.self,className:e,onClick:this.onClick},i.createElement(j.P.div,{layout:!0,transition:{duration:.2}},i.createElement(j.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.2,delay:.1}},i.createElement("div",{className:"onboarding-screen-artist-item-image-wrapper"},i.createElement(W._,{className:"onboarding-screen-artist-item-image",loading:"lazy",src:this.imageUrl,htmlWidth:V,htmlHeight:V}),i.createElement(Z.C,{sx:{color:"#FEFEFE",position:"absolute",top:"calc(50% - 25px)",left:"calc(50% - 18px)",boxSize:8,opacity:this.props.isSelected?1:0,transition:"opacity 0.5s ease"}})),i.createElement("div",{className:"onboarding-screen-artist-item-name ellipsis"},this.props.name))))}}const H=q;var K,J=r("PBDT");const Y=e=>{const[t,r]=(0,i.useState)(!1);if((0,i.useEffect)((()=>{const e=setTimeout((()=>{r(!0)}),250);return()=>clearTimeout(e)}),[]),!t)return K||(K=i.createElement(J.o,null,i.createElement(f.k,null)));const s=e.artists.map((t=>i.createElement(H,(0,u.A)({key:t.id,onClick:e.toggleArtistSelection},t))));return i.createElement(x.a,{className:"onboarding-screen-grid-wrapper",w:"100%"},i.createElement(P.A,{className:"onboarding-screen-grid-scroller"},i.createElement(x.a,{className:"onboarding-screen-grid"},s)))},Q=({onSelected:e,context:t})=>{const[r,s]=(0,i.useState)([]),[n,a]=(0,i.useState)();return(0,i.useEffect)((()=>{((e,t,r)=>{b.A.call({method:"onboarding.getTopGenres",data:{CONTEXT:e},success:e=>{(e=>{s(e.map((e=>({...e,isSelected:!1}))))})(e.map((e=>({id:e.GENRE_ID,name:e.GENRE_NAME}))))},error:r})})(t,0,L.A)}),[]),i.createElement(E.B,{direction:"row",spacing:3,align:"center",w:"fit-content",py:"4px"},r.map((t=>{const r=t.id===(null==n?void 0:n.id);return i.createElement(g.$n,{key:t.id,variant:r?"contain":"outline",onClick:()=>(t=>{const r=n&&n.id===t.id?void 0:t;a(r),e(r)})(t),size:"sm",fontWeight:"normal"},t.name)})))};var $,ee,te=r("I36q"),re=r("A2sV"),se=r("g1Fm"),ie={name:"y0dhib",styles:"&::-webkit-scrollbar{display:none;}scrollbar-width:none"};let ne=(0,n.Ay)({pagename:"onboarding",pagecategory:"onboarding-artists",virtualpageurl:"/onboarding-artists",event:"virtualpageview"},{dispatchOnMount:!0})($=class extends i.Component{constructor(...e){super(...e),this.state={artistList:[],artistListLoaded:!1,finalizing:!1,searchDisplay:!0,popoverOpened:!1},this.currentGetRelatedCall=void 0,this.selectedArtists={},this.mainListSnapShot=[],this.selectedGenre=void 0,this.addArtistAtTopOfList=e=>{const t=this.state.artistList.filter((t=>e.id!==t.id));this.setState({artistList:this.rebuildArtistList([e,...t])})},this.addRelatedArtistsToList=(e,t)=>{const r=[...this.state.artistList],s=r.findIndex((t=>e.id===t.id))+1;r.splice(s,0,...t),this.setState({artistList:this.rebuildArtistList(r)})},this.toggleArtist=(e,t)=>{if(this.selectedArtists[e])delete this.selectedArtists[e];else{if(!this._maxArtistSelectionSafeGuard())return;this.selectedArtists[e]=!0}const r=this.rebuildArtistList(this.state.artistList);this.setState({artistList:r});const s=r.find((t=>t.id===e&&t.isSelected));s&&this.getRelatedArtistsAndAddTolist({...s,reference:t})},this.onGenreSelected=e=>{this.setState({artistListLoaded:!1},(()=>{if(e)void 0===this.selectedGenre&&(this.mainListSnapShot=this.state.artistList),this.selectedGenre=e,t=e.id,r=this.props.context,s=e=>this.setState({artistList:this.rebuildArtistList(e),artistListLoaded:!0}),i=L.A,b.A.call({method:"onboarding.getTopArtistsByGenre",data:{GENRE_ID:t,CONTEXT:r},success:e=>{s(_(e))},error:i});else{if(this.selectedGenre=void 0,this.mainListSnapShot)return void this.setState({artistList:this.rebuildArtistList(this.mainListSnapShot),artistListLoaded:!0});k(this.props.context,(e=>this.setState({artistList:this.rebuildArtistList(e),artistListLoaded:!0})),L.A)}var t,r,s,i}))},this.getRelatedArtistsAndAddTolist=e=>{var t,r,s,i,n,a;this.currentGetRelatedCall=(t=e,r=this.state.artistList,s=this.props.context,i=this.addRelatedArtistsToList,n=L.A,(a=this.currentGetRelatedCall)&&b.A.cancel(a),b.A.call({method:"onboarding.getRelatedArtists",data:{ART_ID:t.id,CONTEXT:s,EXCLUDED_ARTISTS:r.map(w)},success:e=>{i(t,_(e,t.reference))},error:n}))},this.onCompleted=()=>{var e;this.setState({finalizing:!0});const{context:t,isOnlyAddArtist:r}=this.props;if(null===(e=this.props.tracking)||void 0===e||e.trackEvent({eventname:"click",eventcategory:"onboarding-artists",eventaction:"validate"}),t===te.d.Improve){const e=(0,I.mI)({SERVER_TIMESTAMP:this.props.serverTimestamp,clientTimestampDelta:this.props.clientTimestampDelta});this.props.addMultipleFavoritesAction(this.selectedArtistList,C.Ay.Artist,e,{},!1).then((()=>{this.props.addArtistsFavorites(this.selectedArtistList)})).then(this.props.finishStep)}r||this.props.validateOnboardingArtistsPickerStep(this.selectedArtistList).then(this.props.finishStep)},this.onSearchSelected=e=>{this._maxArtistSelectionSafeGuard()&&(this.selectedArtists[e.id]=!0,this.mainListSnapShot=[e,...this.mainListSnapShot.filter((t=>t.id!==e.id))],this.addArtistAtTopOfList({...e,isSelected:!0}),this.getRelatedArtistsAndAddTolist(e))},this.onPopoverOpened=e=>{this.setState({popoverOpened:e})}}componentDidMount(){k(this.props.context,(e=>this.setState({artistList:e,artistListLoaded:!0})),L.A)}get selectedArtistList(){return Object.keys(this.selectedArtists)}get artistGrid(){return this.state.artistListLoaded?i.createElement(Y,{artists:this.state.artistList,toggleArtistSelection:this.toggleArtist}):ee||(ee=i.createElement("div",{className:"onboarding-screen-artists-loader"},i.createElement(f.k,null)))}get isSelectionCompleted(){return this.selectedArtistList.length>=this.props.minArtistsToSelect}get nextButton(){let e,t=!0;const r=this.selectedArtistList.length;return 0===this.props.minArtistsToSelect?(e=(0,se.A)((0,o.AP)("TERMINER"),!0),t=!1):r?r<this.props.minArtistsToSelect?e=(0,o.WI)("artistselectionoptimization_action_chooseXmoreartistsUPP_web","artistselectionoptimization_action_chooseXmoreartistsUPP_web",{sprintf:[this.props.minArtistsToSelect-r],count:this.props.minArtistsToSelect-r}):(e=(0,o.WI)("artistselectionoptimization_action_continuewithXartistsUPP_web","artistselectionoptimization_action_continuewithXartistsUPP_web",{sprintf:[r],count:r}),t=!1):e=(0,o.WI)("artistselectionoptimization_action_chooseatleastXartistsUPP_web","artistselectionoptimization_action_chooseatleastXartistsUPP_web",{sprintf:[this.props.minArtistsToSelect],count:this.props.minArtistsToSelect}),i.createElement(g.$n,{isDisabled:t,onClick:this.onCompleted},e)}showMaxAlert(){alert((0,o.AP)("errormessage_title_maximumreached_web")+"\n"+(0,o.AP)("errormessage_text_maxnberartistreachedforthisstage_web")+"\n"+(0,o.AP)("errormessage_text_dontworrycanaddmorelater_web"))}rebuildArtistList(e){return e.map((e=>({...e,isSelected:Boolean(this.selectedArtists[e.id])})))}_maxArtistSelectionSafeGuard(){return!(this.selectedArtistList.length>=this.props.maxArtistsToSelect&&(this.showMaxAlert(),1))}render(){const e=te.d.Welcome;return i.createElement(i.Fragment,null,this.props.showCloseButton?i.createElement(d.A.Close,{customClose:this.props.closeScreen}):null,i.createElement(E.B,{direction:"column",spacing:"6",h:"100vh",w:"100vw",position:"absolute",top:"0",left:"0",px:"4",py:"6"},i.createElement(A.s,{w:"100%",alignItems:"center",justifyContent:"center"},i.createElement(v.m,{maxW:"800px"},i.createElement(E.B,{direction:"column",spacing:"4",textAlign:"center"},i.createElement(S.D,{as:"h1",fontSize:"30px",className:"onboarding-screen-artists-header"},e?(0,o.AP)("Bienvenue"):(0,se.A)((0,o.AP)("artistselectionoptimization_action_chooseartistUPP_web"))),i.createElement(y.E,{fontSize:"14px"},e?(0,o.AP)("artistselectionoptimization_text_chooseartistsformorepersonalizedreco_web"):(0,o.AP)("onboardingartistpicker_text_improverecoselectfavartists_web")),i.createElement(z,{onArtistSelection:this.onSearchSelected,onPopoverOpened:this.onPopoverOpened,context:this.props.context})))),i.createElement(A.s,{w:"100%",alignItems:"center",justifyContent:{base:"flex-start",md:"center"},overflow:"auto",css:ie},this.props.showGenreFilter&&i.createElement(Q,{onSelected:this.onGenreSelected.bind(this),context:this.props.context})),i.createElement(x.a,{w:"100%",id:"artist-grid",flex:"1"},i.createElement(v.m,{maxW:"1400px",display:"flex",alignItems:"center",justifyContent:"center",h:"100%"},this.artistGrid)),i.createElement(A.s,{w:"100%",alignItems:"center",justifyContent:"center"},i.createElement(v.m,{maxW:"800px",display:"flex",alignItems:"center",justifyContent:"center",mb:"6",className:"onboarding-block-footer"},this.nextButton))))}})||$;const ae=(0,a.Ng)((({user:e})=>({clientTimestampDelta:(0,I.gE)(e),serverTimestamp:(0,I.mS)(e)})),{addMultipleFavoritesAction:T.jo})(ne),oe=({...e})=>{var t;const r=e.context===te.d.Improve?re.Dvu.IMPROVE:re.Dvu.WELCOME,[s]=(0,re.O7r)(),[n]=(0,re.BXP)(),{data:a,error:o,loading:l}=(0,re.V9d)({variables:{context:r}});if(o)throw o;if(l||!a)return null;const c=null===(t=a.onboardingSteps)||void 0===t?void 0:t.artistsPicker;return i.createElement(ae,(0,u.A)({},e,{validateOnboardingArtistsPickerStep:e=>s({variables:{artistIds:e,context:r}}).then((()=>{})),addArtistsFavorites:e=>Promise.all(e.map((e=>n({variables:{artistId:e}})))).then((()=>{})),maxArtistsToSelect:(null==c?void 0:c.maximumArtistsToPick)||500,minArtistsToSelect:(null==c?void 0:c.minimumArtistsToPick)||0,showGenreFilter:!e.isOnlyAddArtist}))};var le,ce,de,pe,me,he,ue,fe,ge,Ee=r("9odk"),Ae=r("i6DM"),ve=r("fkXJ"),Se=r("FVVF");const ye=e=>i.createElement("svg",(0,u.A)({width:790,height:390,fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),le||(le=i.createElement("g",{opacity:.3,filter:"url(#a)"},i.createElement("ellipse",{cx:212.021,cy:194.922,rx:111.021,ry:93.359,fill:"#C2FFD9"}))),ce||(ce=i.createElement("g",{opacity:.45,filter:"url(#b)"},i.createElement("ellipse",{cx:566.877,cy:194.922,rx:122.123,ry:93.359,fill:"url(#c)"}))),de||(de=i.createElement("g",{opacity:.5,filter:"url(#d)"},i.createElement("ellipse",{cx:513.796,cy:138.999,rx:36.334,ry:37.435,fill:"url(#e)"}))),pe||(pe=i.createElement("g",{filter:"url(#f)"},i.createElement("path",{d:"M260.474 200.043h87.456c6.207 0 1.552-11.034 10.862-11.034 9.309 0 3.103 28.372 13.964 28.372 10.862 0 7.758-40.982 17.068-40.982 9.31 0 3.103 23.644 10.861 23.644h79.843",stroke:"url(#g)",strokeWidth:8.074}))),me||(me=i.createElement("g",{filter:"url(#h)"},i.createElement("path",{d:"M299.456 197.3c0 51.437-41.698 93.135-93.135 93.135-51.437 0-93.134-41.698-93.134-93.135 0-51.437 41.697-93.134 93.134-93.134s93.135 41.697 93.135 93.134Z",fill:"url(#i)"}))),he||(he=i.createElement("g",{filter:"url(#j)",fill:"#fff"},i.createElement("rect",{x:212.782,y:169.287,width:17.058,height:67.646,rx:4.479,transform:"rotate(-18 212.782 169.287)"}),i.createElement("rect",{x:194.158,y:162.291,width:17.058,height:71.337,rx:4.723}),i.createElement("rect",{x:171.983,y:162.291,width:17.058,height:71.337,rx:4.723}))),ue||(ue=i.createElement("g",{filter:"url(#k)"},i.createElement("path",{d:"M662.689 197.3c0 51.437-41.698 93.135-93.134 93.135-51.437 0-93.135-41.698-93.135-93.135 0-51.437 41.698-93.134 93.135-93.134 51.436 0 93.134 41.697 93.134 93.134Z",fill:"url(#l)"}))),fe||(fe=i.createElement("g",{filter:"url(#m)"},i.createElement("path",{d:"M606.874 172.275h-15.786v8.622h15.786v-8.622Zm-42.097 12.933H548.99v8.622h15.787v-8.622Zm-15.787 12.933h15.787v8.622H548.99v-8.622Zm-5.262 12.932h-15.787v8.622h15.787v-8.622Zm21.049 0H548.99v8.622h15.787v-8.622Zm5.262 0h15.787v8.622h-15.787v-8.622Zm15.787-12.932h-15.787v8.622h15.787v-8.622Zm5.262 12.932h15.786v8.622h-15.786v-8.622Zm15.786-12.932h-15.786v8.622h15.786v-8.622Zm-15.786-12.933h15.786v8.622h-15.786v-8.622Z",fill:"#fff"}))),ge||(ge=i.createElement("defs",null,i.createElement("filter",{id:"a",x:.072,y:.635,width:423.898,height:388.573,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},i.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),i.createElement("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),i.createElement("feGaussianBlur",{stdDeviation:50.464,result:"effect1_foregroundBlur_2999_170083"})),i.createElement("filter",{id:"b",x:343.826,y:.635,width:446.102,height:388.573,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},i.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),i.createElement("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),i.createElement("feGaussianBlur",{stdDeviation:50.464,result:"effect1_foregroundBlur_2999_170083"})),i.createElement("filter",{id:"d",x:416.905,y:41.007,width:193.782,height:195.984,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},i.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),i.createElement("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),i.createElement("feGaussianBlur",{stdDeviation:30.278,result:"effect1_foregroundBlur_2999_170083"})),i.createElement("filter",{id:"f",x:210.01,y:142.084,width:320.983,height:149.984,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},i.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),i.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),i.createElement("feOffset",{dy:20.186}),i.createElement("feGaussianBlur",{stdDeviation:25.232}),i.createElement("feComposite",{in2:"hardAlpha",operator:"out"}),i.createElement("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0"}),i.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2999_170083"}),i.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2999_170083",result:"shape"})),i.createElement("filter",{id:"h",x:93.001,y:96.091,width:226.641,height:226.641,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},i.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),i.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),i.createElement("feOffset",{dy:12.111}),i.createElement("feGaussianBlur",{stdDeviation:10.093}),i.createElement("feComposite",{in2:"hardAlpha",operator:"out"}),i.createElement("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.15 0"}),i.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2999_170083"}),i.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2999_170083",result:"shape"})),i.createElement("filter",{id:"j",x:145.919,y:150.562,width:128.889,height:123.464,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},i.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),i.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),i.createElement("feOffset",{dy:14.335}),i.createElement("feGaussianBlur",{stdDeviation:13.032}),i.createElement("feComposite",{in2:"hardAlpha",operator:"out"}),i.createElement("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.5 0"}),i.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2999_170083"}),i.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2999_170083",result:"shape"})),i.createElement("filter",{id:"k",x:455.225,y:98.11,width:228.659,height:228.659,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},i.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),i.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),i.createElement("feOffset",{dy:15.139}),i.createElement("feGaussianBlur",{stdDeviation:10.598}),i.createElement("feComposite",{in2:"hardAlpha",operator:"out"}),i.createElement("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.15 0"}),i.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2999_170083"}),i.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2999_170083",result:"shape"})),i.createElement("filter",{id:"m",x:507.756,y:163.192,width:119.305,height:87.791,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},i.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),i.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),i.createElement("feOffset",{dy:11.102}),i.createElement("feGaussianBlur",{stdDeviation:10.093}),i.createElement("feComposite",{in2:"hardAlpha",operator:"out"}),i.createElement("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.5 0"}),i.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2999_170083"}),i.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2999_170083",result:"shape"})),i.createElement("linearGradient",{id:"c",x1:557.319,y1:116.988,x2:575.878,y2:249.478,gradientUnits:"userSpaceOnUse"},i.createElement("stop",{stopColor:"#FFF500"}),i.createElement("stop",{offset:.912,stopColor:"#FD1987"})),i.createElement("linearGradient",{id:"e",x1:510.952,y1:107.748,x2:520.826,y2:160.053,gradientUnits:"userSpaceOnUse"},i.createElement("stop",{stopColor:"#FFFEEC"}),i.createElement("stop",{offset:.912,stopColor:"#FFF9FC"})),i.createElement("linearGradient",{id:"g",x1:222.744,y1:197.561,x2:546.935,y2:197.561,gradientUnits:"userSpaceOnUse"},i.createElement("stop",{stopColor:"#9CDA64"}),i.createElement("stop",{offset:.432,stopColor:"#47B477"}),i.createElement("stop",{offset:.894,stopColor:"#FA0A44"})),i.createElement("linearGradient",{id:"i",x1:113.187,y1:243.868,x2:299.456,y2:104.166,gradientUnits:"userSpaceOnUse"},i.createElement("stop",{stopColor:"#208C79"}),i.createElement("stop",{offset:1,stopColor:"#C3F25D"})),i.createElement("linearGradient",{id:"l",x1:504.626,y1:133.703,x2:637.144,y2:275.8,gradientUnits:"userSpaceOnUse"},i.createElement("stop",{stopColor:"#FF9A0F"}),i.createElement("stop",{offset:.27,stopColor:"#FF0A3C"}),i.createElement("stop",{offset:.518,stopColor:"#990BDC"}),i.createElement("stop",{offset:.885,stopColor:"#18A894"})))));var xe;const be=(0,n.Ay)({pagename:"onboarding-tmm",pagecategory:"onboarding-artists",virtualpageurl:"/onboarding-tmm",event:"virtualpageview"},{dispatchOnMount:!0})((({context:e,finishStep:t,tracking:r})=>{var s;const{data:n,loading:l,error:c}=(0,re.vjx)(),[p]=(0,re.weQ)(),[h,u]=(0,a.d4)((e=>[(0,I.F6)(e.user),(0,I.Mn)(e.user)]));if(c)throw c;if(l||!n||!n.onboardingSteps)return null;const f=e===te.d.Welcome?re.Dvu.WELCOME:re.Dvu.IMPROVE;return i.createElement(A.s,{bgColor:"gray.100",flexDir:"column",position:"absolute",height:"100vh",width:"100%",top:0,left:0},i.createElement(d.A.Header,null,i.createElement(S.D,{as:"span"},n.onboardingSteps.importLibrary.title),i.createElement(y.E,{fontSize:"md",fontWeight:400},(0,o.AP)("libraryimporteronboarding_text_transfermusiclibraryforfree_web")),i.createElement(y.E,{fontSize:"md",fontWeight:400},(0,o.AP)("libraryimporteronboarding_text_fastsafethankstoXpartner_web",{sprintf:[n.onboardingSteps.importLibrary.importer]}))),i.createElement(x.a,{flexGrow:1},i.createElement(Se.T,{alignItems:"center"},xe||(xe=i.createElement(ye,{height:"40vh"})),i.createElement(y.E,{fontSize:"md",color:"gray.500"},(0,o.AP)("libraryimporteronboarding_text_supportsXstreamserviceslist_web",{sprintf:n.onboardingSteps.importLibrary.supportedServices})))),i.createElement(A.s,{gap:"2em",justifyContent:"center",padding:"6",bgColor:"white"},i.createElement(g.$n,{onClick:e=>{e.preventDefault(),null==r||r.trackEvent({eventname:"click",eventaction:"transfer-now",eventcategory:"onboarding-tmm"}),(async()=>{try{const e=await(0,Ae.r)(h,u,true);await p({variables:{context:f,hasSkipped:!1}}),open(e)}catch{(0,ve.A)({body:(0,o.AP)("Une erreur est survenue, merci de réessayer plus tard.")})}})()}},(0,o.AP)("libraryimporter_action_transfernow_web")),i.createElement(g.$n,{variant:"ghost",onClick:()=>{null==r||r.trackEvent({eventname:"click",eventaction:"skip",eventcategory:"onboarding-tmm"}),p({variables:{context:f,hasSkipped:!0}}).then(t)}},null===(s=n.onboardingSteps)||void 0===s?void 0:s.importLibrary.skipCTA)))})),_e=({closeScreen:e,showCloseButton:t=!1,context:r=te.d.Welcome,isOnlyAddArtist:s=!1,callbackLink:n="/"})=>{const a=(0,Ee.AP)(),o=(0,Ee.kA)(),[l,c]=i.useState(!1);if(!a||o.loading)return null;let d=s||r===te.d.Improve?"artistsPicker":a.currentStep;l&&(d="finish");let p=null;switch(d){case"artistsPicker":p=i.createElement(oe,{context:r,finishStep:()=>{o.refetch(),c(!0)},isOnlyAddArtist:s,showCloseButton:t,closeScreen:e});break;case"importLibrary":p=i.createElement(be,{context:r,finishStep:o.refetch});break;default:p=i.createElement(h,{closeScreen:e,callbackLink:n})}return i.createElement(i.Fragment,null,p)}},MG7B:(e,t,r)=>{function s(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}r.d(t,{A:()=>s})},PBDT:(e,t,r)=>{r.d(t,{o:()=>a});var s=r("nKUr"),i=r("IRKz"),n=r("xi32");const a=(0,i.B)("div",{baseStyle:{display:"flex",alignItems:"center",justifyContent:"center"}});a.displayName="Center";const o={horizontal:{insetStart:"50%",transform:"translateX(-50%)"},vertical:{top:"50%",transform:"translateY(-50%)"},both:{insetStart:"50%",top:"50%",transform:"translate(-50%, -50%)"}};(0,n.R)((function(e,t){const{axis:r="both",...n}=e;return(0,s.jsx)(i.B.div,{ref:t,__css:o[r],...n,position:"absolute"})}))},"YG/N":(e,t,r)=>{r.d(t,{A:()=>f});var s=r("WKgy"),i=r("q1tI"),n=r("juqV");var o=r("TRpf"),l=r("DVo4"),c=r("nxAS");const d=(0,o.Ng)(null,{closeScreen:c.Fn})((({customClose:e,closeScreen:t})=>{const r=e||t;return i.createElement(l.J,{position:"absolute",top:"8px",insetInlineEnd:"8px",size:"lg",onClick:r,zIndex:2})}));var m=r("+9dH"),h=r("TDRX");s.A.addReducers({modal:c.Ay});const f={Body:({className:e,children:t})=>{const r=(0,n.A)("full-screen-body",e);return i.createElement("div",{className:r},t)},Close:d,Footer:({className:e,children:t})=>{const r=(0,n.A)("full-screen-footer",e);return i.createElement("div",{className:r},t)},Header:({className:e,children:t,...r})=>{const s=(0,n.A)("full-screen-header",e);return i.createElement(h.a,(0,m.A)({as:"h1",className:s},r),t)}}},ZDlI:(e,t,r)=>{r.d(t,{m:()=>c});var s=r("nKUr"),i=r("p1Zg"),n=r("8EFB"),a=r("xi32"),o=r("JFGw"),l=r("IRKz");const c=(0,a.R)((function(e,t){const{className:r,centerContent:a,...c}=(0,i.M)(e),d=(0,o.V)("Container",e);return(0,s.jsx)(l.B.div,{ref:t,className:(0,n.cx)("chakra-container",r),...c,__css:{...d,...a&&{display:"flex",flexDirection:"column",alignItems:"center"}}})}));c.displayName="Container"},ZOeD:(e,t,r)=>{r.d(t,{V:()=>o}),r("/eM8");var s,i=r("Vd8Q");r("EV0h"),r("gS5K");const n={Spotify:"https://open.spotify.com/track/",Apple:`https://music.apple.com/${null!==(s=function(){if("undefined"==typeof window)return null;const e=window.location.href;return new URL(e).pathname.split("/")[1]||null}())&&void 0!==s?s:"en"}/song/`,YouTubeMusic:"https://music.youtube.com/watch?v="},a=`//${i.default.get("host_website_ssl")}/profile/me`;class o{constructor(){this.token=""}async v1(e){const t={...e};this.token&&(t.deezer_access_token=this.token);const r=await fetch("https://www.tunemymusic.com/api/AuthenticateUser.php",{method:"POST",cache:"default",body:JSON.stringify(t)}).catch((e=>{throw e}));if(!r.ok||200!==r.status)throw new Error("TMM: response error");return r.json()}async v2(e,t){const r=await fetch("https://api.tunemymusic.com/v2/api"+e,{headers:{"Content-Type":"application/json"},method:"POST",cache:"default",body:JSON.stringify({...t})});if(!r.ok||200!==r.status)throw new Error("TMM: response error");return r.json()}setToken(e){this.token=e}async getLibraryTransferUrl(e,t,r){return this.v1({deezer_user_id:e,deezer_user_name:t,deezer_redirect_url:r?"deezer://reload":a})}async findTrack(e){var t;const r={...e,region:"Apple"===e.platform?null===(t=e.region)||void 0===t?void 0:t.toUpperCase():void 0},s=await this.v2("/FindTrack",r);return"not found"===s.result?Promise.reject(new Error("Track not found")):{...s,url:(i=e.platform,a=s.trackId,n[i]+a)};var i,a}}},i6DM:(e,t,r)=>{r.d(t,{K:()=>l,r:()=>o}),r("/eM8"),r("EV0h"),r("gS5K");var s=r("nrKQ"),i=r("Wp0Y"),n=r("fkXJ");const a=new(r("ZOeD").V),o=async(e,t,r=!1)=>{const i=await s.A.callAsync({method:"libraryimport.getTMMAccessToken",data:{}}).catch((e=>{throw e}));a.setToken(i);const n=await a.getLibraryTransferUrl(e,t,r);try{const e=new URL(n.migration_url);return e.searchParams.append("mode","deezer"),e.href}catch(e){throw new Error("TMM: migration url not valid")}},l=()=>{(0,n.A)({body:(0,i.AP)("libraryimporterdismiss_text_transferstillavailableinsettings_web")}),s.A.callAsync({method:"libraryimport.flagTMMAsDismissed"}).catch((e=>{throw e}))}}}]);