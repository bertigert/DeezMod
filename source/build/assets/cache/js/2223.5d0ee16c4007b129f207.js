"use strict";(self.webpackJsonpDeezer=self.webpackJsonpDeezer||[]).push([[2223],{K5vB:(e,t,i)=>{i.d(t,{AG:()=>r,t$:()=>n});var o=i("chf7");const[r,s,n]=(0,o.q6)({name:"UploadContext"})},QOhT:(e,t,i)=>{i.d(t,{A:()=>me});var o={};i.r(o),i.d(o,{album:()=>I,artist:()=>N,channel:()=>T,episode:()=>P,flow:()=>L,livestream:()=>D,playlist:()=>R,radio:()=>O,show:()=>M,smarttracklist:()=>U,track:()=>$,user:()=>H});var r=i("+9dH"),s=i("17x9"),n=i.n(s),a=i("q1tI"),l=i("TRpf"),c=i("juqV"),d=i("lXQd"),p=i("H/eQ"),u=i("u7vQ"),h=i("e2eG"),f=i("vXsw"),_=i("Wp0Y"),m=i("fJgm"),g=i("hz5U"),y=i("5G9X"),v=i("tZCQ"),x=i("iooo"),A=i("SrwL"),b=i("OPhi"),C=i("CyAC"),k=i("FMs+"),E=i("Qlza"),S=i("LOQS"),w=i("jERP"),F=i("2EvD");const I=JSON.parse('{"default":{"center":false,"play":"force","preview":"on","favorite":"on","contextMenu":"on","dislike":"off"},"album_page":{"preview":"off","favorite":"off","contextMenu":"off"},"topbar_popper_album":{"play":"on"},"dynamic_page":{"play":"on"}}'),N=JSON.parse('{"default":{"center":false,"play":"on","preview":"on","favorite":"on","contextMenu":"off","dislike":"off"},"search_top_artist":{"play":"off","preview":"off","favorite":"off"},"topbar_popper_artist":{"play":"off"},"artist_discography_related_artist":{"play":"off","preview":"off","favorite":"off"},"mixes_page":{"play":"force","favorite":"off"}}'),T=JSON.parse('{"default":{"center":false,"play":"off","preview":"off","favorite":"off","contextMenu":"off","dislike":"off"}}'),P=JSON.parse('{"default":{"center":false,"contextMenu":"on","dislike":"off","favorite":"on","play":"force","preview":"off"},"dynamic_page":{"center":true,"contextMenu":"off","favorite":"off","play":"on"},"episode_page":{"contextMenu":"off","favorite":"off"},"resume":{"center":true,"contextMenu":"off","favorite":"off","isNotAnimatedFromTrackListIndex":true,"play":"on"},"latest":{"center":true,"contextMenu":"off","favorite":"off","play":"on"},"topbar_popper_episode":{"play":"on"}}'),L=JSON.parse('{"default":{"center":true,"play":"force","preview":"off","favorite":"off","contextMenu":"off","dislike":"off"},"profile_recently_played":{"center":false}}'),D=JSON.parse('{"default":{"center":false,"play":"force","preview":"off","favorite":"off","contextMenu":"off","dislike":"off"},"dynamic_page":{"play":"on"}}'),R=JSON.parse('{"default":{"center":false,"play":"force","preview":"on","favorite":"on","contextMenu":"on","dislike":"off"},"playlist_page":{"preview":"off","favorite":"off","contextMenu":"off"},"artist_discography_related_playlist":{"play":"on","preview":"off","favorite":"off","contextMenu":"off"},"topbar_popper_playlist":{"play":"on"},"dynamic_page":{"play":"on"}}'),O=JSON.parse('{"default":{"center":false,"play":"force","preview":"off","favorite":"on","contextMenu":"on","dislike":"off"},"topbar_popper_radio":{"play":"on"},"mixes_page":{"favorite":"off","contextMenu":"off"},"dynamic_page":{"play":"on"}}'),M=JSON.parse('{"default":{"center":false,"play":"force","preview":"off","favorite":"on","contextMenu":"on","dislike":"off"},"show_page":{"favorite":"off","contextMenu":"off"},"episodes_page":{"play":"off","favorite":"off","contextMenu":"off"},"topbar_popper_show":{"play":"on"},"dynamic_page":{"play":"on"}}'),U=JSON.parse('{"default":{"center":true,"play":"force","preview":"off","favorite":"off","contextMenu":"off","dislike":"off"},"smart_tracklist_page":{"center":false},"dynamic_page":{"play":"on"}}'),$=JSON.parse('{"default":{"center":false,"play":"on","preview":"on","favorite":"off","contextMenu":"off","dislike":"off"},"track_page":{"play":"force","favorite":"off","contextMenu":"off"},"profile_home":{"play":"force"},"topbar_popper_track":{"play":"on"}}'),H=JSON.parse('{"default":{"center":false,"play":"off","preview":"off","favorite":"off","contextMenu":"off","dislike":"off"}}');var B,J,j=i("F3Nm"),z=i("X6oL"),G=i("6VLJ"),W=i("Hews"),Q=i("HmE0");const V=(0,z.Ay)()(((J=class extends a.Component{constructor(...e){super(...e),this._onMouseClick=e=>{this.props.onFavoriteToggle(e),this._triggerTracking()}}render(){const{isFavorite:e,presets:t}=this.props,i={className:(0,c.A)("action-item-tempo-btn",{"action-force":t.favorite===G.B.force}),type:"button",onClick:this._onMouseClick},o={isActive:e};return a.createElement(Q.K0,(0,r.A)({"aria-label":e?(0,_.AP)("Retirer des Coups de cœur"):(0,_.AP)("Ajouter aux Coups de cœur"),icon:a.createElement(W.A,o),colorScheme:"white",variant:v.A.isAllowed("revamp2023")?"onDark":"solid"},i))}_triggerTracking(){const{id:e,type:t,isFavorite:i}=this.props,o=this.props.tracking.getTrackingData(),r=o.pagecategory||o.pagename;r&&!i&&this.props.tracking.trackEvent({eventaction:`click-favorite-${r}_${t}`,event:"click",eventcategory:r,eventlabel:`favorite-${r}_${t}`,item:{id:e,type:t,rank:o.index||0}})}}).defaultProps={presets:G.I},B=J))||B;var ne,ae,le,Y=i("AlG7"),q=i("P/T7"),X=i("MMCw"),K=i("kqs6"),Z=i("5Loq"),ee=i("TDRX"),te=i("y7xR"),ie=i("CdHq"),oe=i("siwx"),re=i("pVdW"),se=i("LpaV"),ce=i("s026"),de=i("xobL"),pe=i("vF4p"),ue=i("h8EF"),he=i("HQpa");let fe=0;class _e extends a.Component{constructor(e){super(e),this._onPlayerTypeChange=this._onPlayerTypeChange.bind(this),this._onThumbnailClick=this._onThumbnailClick.bind(this),this._onFavoriteToggle=this._onFavoriteToggle.bind(this),this._onLoadPicture=this._onLoadPicture.bind(this),this._onLoadExplicit=this._onLoadExplicit.bind(this),this._switchActiveImg=this._switchActiveImg.bind(this),this._shouldNavigateOnClick=this._shouldNavigateOnClick.bind(this),this._getExplicitCoverColor=this._getExplicitCoverColor.bind(this),this._intervalAnimation=null,this._contextMenuId=(0,A.uC)();const t=e.id||g.A.getID(e.type,e.data);let i=t,o=e.type;this._isFlowType(this.props.type)&&Object.keys(e.data).length&&"song"===e.data.__TYPE__&&(i=Number(e.data.SNG_ID),o=y.Ay.Track),this.state={id:t,optionsType:o,optionsId:i,imgSrc:this._getImgSrc(e),picturesLoadedCount:0,isRadio:u.Ay.isRadio(),isPrivatePlaylist:"playlist"===e.type&&Number(e.data.PARENT_USER_ID)!==e.userID&&(1===Number(e.data.STATUS)||3===Number(e.data.STATUS)),indexActivePicture:0,explicitCoverColor:null,isVertical:e.isVertical}}componentDidMount(){p.A.subscribe(p.A.player.changePlayerType,this._onPlayerTypeChange)}UNSAFE_componentWillReceiveProps(e){const t=e.id||g.A.getID(e.type,e.data);let i=t,o=e.type;this._isFlowType(this.props.type)&&Object.keys(this.props.data).length&&"song"===this.props.data.__TYPE__&&(i=Number(e.data.SNG_ID),o=y.Ay.Track);const r=this._getImgSrc(e);this.setState({id:t,imgSrc:r,optionsType:o,optionsId:i,isPrivatePlaylist:"playlist"===e.type&&Number(e.data.PARENT_USER_ID)!==e.userID&&(1===Number(e.data.STATUS)||3===Number(e.data.STATUS))})}shouldComponentUpdate(e,t,i){return this.state.id!==t.id||this.props.isFavorite!==e.isFavorite||this.state.isRadio!==t.isRadio||this.state.imgSrc!==t.imgSrc||this.state.picturesLoadedCount!==t.picturesLoadedCount||this.props.imgSrc!==e.imgSrc||this.context.isDisabled!==i.isDisabled||this.props.trackListIndex!==e.trackListIndex||this.state.indexActivePicture!==t.indexActivePicture||this.state.explicitCoverColor!==t.explicitCoverColor||this.props.shouldCensorCover!==e.shouldCensorCover||this.props.popperId!==e.popperId&&(this.props.popperId===this._contextMenuId||e.popperId===this._contextMenuId)}componentDidUpdate(){this._checkAllPicturesAreLoaded()&&this._startAnimation()}componentWillUnmount(){this._clearAnimation(),clearTimeout(this._navTimeoutRef),p.A.unsubscribe(p.A.player.changePlayerType,this._onPlayerTypeChange)}render(){const{bordered:e,borderRadius:t,data:i,rounded:o,halfRounded:r,type:s,title:n,uploadCover:l,className:d,shouldCensorCover:p,popperId:u}=this.props,h=(0,c.A)("thumbnail",d,{"thumbnail-bordered":e,"thumbnail-rounded":o,"thumbnail-half-rounded":r,"thumbnail-mix":["radio","generic"].indexOf(s)>=0,"thumbnail-rectangle":!this.state.isVertical&&s===y.Ay.VideoLink||s===y.Ay.Channel,"thumbnail-vertical":this.state.isVertical&&s===y.Ay.VideoLink,"thumbnail-animated":this._isAnimated(),"thumbnail-explicit":p,"has-contextmenu":(0,A.pz)(u,this._contextMenuId)}),f=(null==i?void 0:i.__TYPE__)===y.Ay.ArtistLineUp,_=this._getActions();let m;return n&&(m="ariaThumbnailTitle"+fe++),a.createElement(ee.a,{as:"figure",borderRadius:o?"rounded":t,className:h},this._renderThumbnail(_.length,m),n?this._renderTitle(m):null,this.state.isPrivatePlaylist||f?null:this._renderActions(_),l!==G.B.off?this._renderFileUpload():null)}_renderThumbnail(e,t){const{type:i,coverLink:o,uploadCover:s,shouldCensorCover:n}=this.props,{explicitCoverColor:l}=this.state;let d={className:(0,c.A)("picture",{"picture-link":o&&!this.context.isDisabled&&this._shouldNavigateOnClick()||i===y.Ay.Flow,"picture-img":this._isAnimated(),"overlay-hidden":!e&&i!==y.Ay.Generic&&s===G.B.off,"no-background":this._checkAllPicturesAreLoaded()&&!n})};return t&&(d["aria-labelledby"]=t),n&&(d.style={backgroundImage:`url(${g.A.getExplicitSrc(this.props.width,this.props.height)})`,backgroundColor:`${l}`,backgroundBlendMode:"multiply",backgroundSize:"100%"}),a.createElement("div",(0,r.A)({},d,{onClick:this._onThumbnailClick}),this._renderPictures(t))}_renderPictures(e){const{imgHeight:t,height:i,imgWidth:o,width:r,alt:s,type:n,data:l,redirectUrl:d,isDarkMode:p}=this.props,{indexActivePicture:u}=this.state;if(n===y.Ay.Flow)return ne||(ne=a.createElement(ee.a,{className:"picture-img",background:"radial-gradient(386% 121.12% at 124.67% 100%, #FF503D 0%, #D82C6A 50%, #8625D4 100%)",height:"100%",width:"100%",position:"relative"},a.createElement(ee.a,{position:"absolute",top:"spacing.m",left:"spacing.m"},a.createElement(te.D,{variant:"heading.l",color:"text.accent.onDark.default"},"FLOW"))));const h=d&&d.includes("loved")||l.PLAYLIST_PICTURE===g.A.PLACEHOLDER_LOVED_TRACKS_MD5,f=d&&d.includes("resume"),_=d&&d.includes("latest");return n===y.Ay.Generic&&(_||f)||h?a.createElement(ee.a,{className:"picture-img",height:"100%",width:"100%"},a.createElement(ie.s,{backgroundColor:p?"#FF8564":"#FFD0C3",justifyContent:"center",alignItems:"center",height:"100%",width:"100%"},h?a.createElement(Y.C,{size:"medium",boxSize:"50%",color:p?"#B5492B":"#E85E38"}):f?a.createElement(q.x,{size:"medium",boxSize:"50%",color:p?"#B5492B":"#E85E38"}):a.createElement(X.X,{size:"medium",boxSize:"50%",color:p?"#B5492B":"#E85E38"}))):this.state.imgSrc.map(((a,d)=>{const p={alt:e?"":s,className:(0,c.A)("picture-img",{active:this._isAnimated()&&d===u}),crossOrigin:"anonymous",height:t||i,key:`${g.A.getID(n,l)}_${d}`,onLoad:this._onLoadPicture,src:a,width:o||r};return this._renderPicture(p)}))}_renderPicture(e){const{isHighlight:t}=this.props;return t?this._renderHighlight():this.state.isVertical?a.createElement(a.Fragment,null,a.createElement(oe._,(0,r.A)({},e,{height:`${e.height}px`,width:`${e.width}px`,loading:"lazy",objectFit:"cover"})),this._renderDuration()):a.createElement(oe._,(0,r.A)({},e,{height:`${e.height}px`,width:`${e.width}px`,loading:"lazy",objectFit:"cover"}))}_renderDuration(){const{data:{duration:e=0,theme:t="dark"}={}}=this.props;return!e||e<=0?null:a.createElement(re.E,{fontWeight:"bold",fontSize:"sm",className:"thumbnail-duration",color:"dark"===t?"white":"black"},(0,ce.A)(e,{displayHours:!0,padHours:!0,hideFalsyHour:!0}))}_renderHighlight(){const e={backgroundImage:`url("${this.state.imgSrc}")`};return a.createElement("div",{className:"picture-highlight",style:e})}_renderActions(e){if(!e.length)return null;const t=(0,c.A)("action",{"action-center":this._getPresets().center});return a.createElement("ul",{className:t},e)}_renderTitle(e){const{title:t,type:i}=this.props;return t?i===y.Ay.Smarttracklist?a.createElement(te.D,{id:e,variant:"display.2xs",color:"text.accent.onLight.default",display:"flex",justifyContent:"flex-start",position:"absolute",left:"spacing.l",right:"spacing.l",top:"spacing.l",noOfLines:2,pointerEvents:"none"},i===y.Ay.Radio?(0,_.AP)("Mix"):t):a.createElement("div",{className:"title"},i===y.Ay.Radio?a.createElement("p",{className:"title-label"},(0,_.AP)("Mix")):null,a.createElement("p",{className:"title-text",id:e},t)):null}_renderFileUpload(){const{uploadCover:e,uploadType:t,type:i,forceImmediateUpload:o}=this.props;if(e===G.B.off)return null;const r=(0,c.A)({"action-item-btn action-upload":!0,"action-force":"force"===e});return a.createElement(w.A,{element_id:this.state.id,type:t,directory:i,forceImmediateUpload:o},a.createElement("span",{className:r},ae||(ae=a.createElement(K.x,{boxSize:"20px"}))))}_onFavoriteToggle(e){e.stopPropagation(),e.preventDefault();const{optionsType:t,optionsId:i}=this.state,o=this.props.isFavorite?"remove":"add";m.A[o]({type:h.A.getUserDataType(t),id:i,context:this._getContext()})}_onPlayerTypeChange(){this.setState({isRadio:u.Ay.isRadio()})}_onThumbnailClick(){const{coverLink:e,externalLink:t,onClick:i,pageContext:o,type:r}=this.props,{id:s}=this.state;if(o.includes("profile_")&&!["profile_following","profile_followers"].includes(o)&&r!==he.S.LIVESTREAM&&(r===y.Ay.Flow?(0,ue.h4)({action:ue.dJ.PLAY_CLICKED,payload:{path:"profile_recently_played"===o?"home":o.replace("profile_",""),item_id:s.toString(),item_type:r}}):S.A.log({type:"cdp",eventName:"item_clicked",customAttributes:{screen_view_name:"profile_recently_played"===o?pe.Xw.home:pe.Xw[o.replace("profile_","")],item_id:s.toString(),item_type:"show"===r?he.S.SHOW:r}})),i(),!e||this.context.isDisabled)return;const n=this._getUrlWithLang();n&&this._shouldNavigateOnClick()&&(this._navTimeoutRef=setTimeout((()=>{f.g.navigate(n,{externalLink:t})}),0))}_onLoadPicture(e){this.setState((e=>({picturesLoadedCount:e.picturesLoadedCount+1}))),this._onLoadExplicit(e)}_onLoadExplicit(e){const{shouldCensorCover:t}=this.props;t&&this.setState({explicitCoverColor:this._getExplicitCoverColor(e.target)})}_checkAllPicturesAreLoaded(){return this.state.picturesLoadedCount>=this.state.imgSrc.length}_getContextMenuContent(e){const{optionsId:t,optionsType:i}=this.state,o="song"===i?"track":i;let r=this.props.data;"track"===o&&(r={SONG:this.props.data});const s=(0,c.A)("action-item-tempo-btn",{"action-force":e.contextMenu===G.B.force}),n={anchor:a.createElement(Q.K0,{icon:le||(le=a.createElement(Z.j,null)),className:s,type:"button",colorScheme:"white",variant:"onDark"}),context:this._getContext(),data:r,id:t,placement:"top",type:o};return a.createElement(se.K.Provider,{value:this._contextMenuId},a.createElement(F.A,n))}_getContext(){const{context:e}=this.props,{optionsId:t}=this.state;return"string"==typeof e?{ID:t,TYPE:e}:e}_getActions(){const{isPrivatePlaylist:e,id:t}=this.state,{data:i,type:o,userID:r,trackList:s,trackListIndex:n,width:l,pageContext:c,isFavorite:d}=this.props,p=this._getPresets();if(this.context.isDisabled)return[];const h=o===y.Ay.Artist||o===y.Ay.Radio||o===y.Ay.User||o===y.Ay.Flow||o===y.Ay.Livestream,f=o===y.Ay.Playlist&&Number(i.PARENT_USER_ID)===r||o===y.Ay.Radio||o===y.Ay.Show&&!v.A.isAllowed("talk"),_=i.layout_parameters&&!(0,E.pJ)(i.layout_parameters)||g.A.isFullWindowedAlbum(o,i)||0===i.NB_SONG,m=[];if(!e&&!_&&p.play!==G.B.off){const e={context:this._getContext(),radio:h,id:t,presets:p,size:l<=64?"small":"medium",trackList:s,trackListIndex:n,type:o,pageContext:c,moduleId:i.module_id,index:i.index};m.push(a.createElement("li",{className:"action-item",key:"play"},a.createElement(j.A,e)))}if(l<=64)return m;p.favorite===G.B.off||f||m.push(a.createElement("li",{className:"action-item",key:"favorite"},a.createElement(V,{id:t,type:o,presets:p,isFavorite:d,onFavoriteToggle:this._onFavoriteToggle})));const x=(0===i.NB_SONG||u.Ay.isRadio())&&"playlist"===o&&Number(i.PARENT_USER_ID)===r&&(1===Number(i.STATUS)||3===Number(i.STATUS));return p.contextMenu===G.B.off||x||m.push(a.createElement("li",{className:"action-item",key:"contextmenu"},this._getContextMenuContent(p))),m}_shouldNavigateOnClick(){const e=this._getUrlWithLang();return!(!e||f.g.getCurrentPath()===e)}_getPresets(){const{pageContext:e,type:t}=this.props;return""===e?G.I:o[t]?{...o[t].default,...o[t][e]}:G.I}_getUrlWithLang(){const{redirectUrl:e,type:t}=this.props,{id:i}=this.state,o=e||g.A.getClickURL(t,i);return o?(0,x.jd)(o):null}_getImgSrc(e){return e.imgSrc?"string"==typeof e.imgSrc?[e.imgSrc]:e.imgSrc:[g.A.getImageSrcForData(e.type,e.data,e.imgWidth||e.width,e.imgHeight||e.height,e.multiCover)]}_getExplicitCoverColor(e){try{const{color:t,visiblePixelsPercentage:i}=(0,k.xH)(e);if(i>10)return(0,k.s3)(t)}catch(e){}return"rgba(0,0,0,0)"}_switchActiveImg(){this.setState((e=>({indexActivePicture:(e.indexActivePicture+1)%e.imgSrc.length})))}_isFlowType(e){return e===y.Ay.User||e===y.Ay.Flow}_isAnimated(){return this.state.imgSrc.length>1}_clearAnimation(){var e;this._animationHandler&&((e=this._animationHandler).id&&cancelAnimationFrame(e.id),this._animationHandler=null)}_startAnimation(){this._isAnimated()&&!this._animationHandler&&(this._animationHandler=((e,t)=>{const i={};let o=performance.now();const r=s=>{s-o>=4e3&&(e(),o=s),i.id=requestAnimationFrame(r)};return i.id=requestAnimationFrame(r),i})(this._switchActiveImg))}}_e.contextTypes={panel_name:n().string,isDisabled:n().bool},_e.defaultProps={id:void 0,title:void 0,imgHeight:void 0,imgWidth:void 0,imgSrc:void 0,redirectUrl:void 0,trackListIndex:void 0,bordered:!1,borderRadius:"xs",rounded:!1,halfRounded:!1,uploadType:"picture",uploadCover:G.B.off,height:250,width:250,data:{},forceImmediateUpload:!1,multiCover:!1,isHighlight:!1,coverLink:!0,onClick:()=>{},externalLink:!1,context:"",pageContext:"",trackList:[],alt:""};const me=(0,l.Ng)((({user:e,feedbacks:t,popper:i},o)=>{const r="track"===o.type?y.Ay.Song:o.type,s=(0,d.A)(o,"context.ID")||(0,d.A)(o,`data.${y.vn[r]}`);return{shouldCensorCover:(0,C.vp)(e,(0,d.A)(o,"data")||{}),userID:e.id,popperId:i.popperId,isFavorite:(0,b.BA)(t,s,r),isDarkMode:(0,de.NF)(e)}}))(_e)},QSbk:(e,t,i)=>{i.d(t,{M4:()=>d,gf:()=>c,ri:()=>p}),i("/eM8");var o=i("Vd8Q"),r=i("YEdj"),s=i("zuHY");const n=(0,s.VF)((0,s.ny)(s.MG));let a=null;const l=()=>{if(a)return a;const e=o.default.get("host_authent");return a=new n({tokenOutputType:s.NP.PAYLOAD,refreshTokenOutputType:s.NP.COOKIE,host:e,customFetch:(e,t)=>{const i=new Headers({Accept:"application/json"});return i.append("Origin",`https://${o.default.get("host_website_ssl")}`),(0,r.A6)(e,{...t,headers:i,credentials:"include"})},requestDelay:15}),a},c=async e=>{let t;try{t=await l().getToken()}catch(i){t=e?await l().loginWithArl().catch((async()=>await l().getToken())):await l().loginAsAnonymous()}if(null===t)throw new Error("Could not log user to new Auth");return t},d=()=>{l().invalidateCurrentToken()},p=async()=>{l().logout()}},Qlza:(e,t,i)=>{i.d(t,{$3:()=>n,$E:()=>c,B4:()=>f,GZ:()=>p,IZ:()=>_,J0:()=>l,N8:()=>h,NY:()=>s,d_:()=>a,pJ:()=>d});var o=i("Wp0Y"),r=i("g1Fm");function s(e){let t=e.layout_parameters||{},i=t.override||{};const o=["title","subtitle","theme","pictures","tag","alignment","title_color","subtitle_color"];for(let t of o)void 0!==e[t]&&(i[t]=e[t]);return Object.keys(i).length&&(t.override=i),Object.keys(t).length?t:void 0}function n(e,t=void 0){return t?e&&e.override&&e.override[t]||void 0:e&&e.override||void 0}function a(e){return e&&e.is_promoted||!1}const l={TYPE:{PLAY:"play",WATCH:"watch",BROWSE:"browse"},LABEL:{BROWSE:(0,r.A)((0,o.AP)("DÉCOUVRIR"),!0),PAUSE:(0,r.A)((0,o.AP)("PAUSE"),!0)}};function c(e){return e&&e.cta&&e.cta.type||null}function d(e){return c(e)===l.TYPE.PLAY}const p={SLIDE:"slide",MINI_BANNER:"mini-banner",LONG_CARD:"long-card"};function u(e){return e&&e.item_layout||null}function h(e){return u(e)===p.SLIDE}function f(e){return u(e)===p.MINI_BANNER}function _(e){return u(e)===p.LONG_CARD}},jERP:(e,t,i)=>{i.d(t,{A:()=>p}),i("/eM8");var o=i("q1tI"),r=i("TRpf"),s=i("Vd8Q"),n=i("IZLt"),a=i("QSbk"),l=i("K5vB");const c=["playlist","user"];class d extends o.Component{constructor(e){super(e),this._selectedIndexFile=0,this._selectedFiles=null,this._fileInput=o.createRef(),this._uploadFile=this._uploadFile.bind(this),this._uploadGraphQlFile=this._uploadGraphQlFile.bind(this),this._onChangeFile=this._onChangeFile.bind(this),this._onSelectFileClick=this._onSelectFileClick.bind(this),this._onNextFile=this._onNextFile.bind(this)}componentWillUnmount(){this._xhr&&this._xhr.abort()}render(){const{accept:e,children:t,multiFile:i}=this.props;return window.FileReader?o.createElement(o.Fragment,null,o.createElement("input",{type:"file",className:"hide",multiple:i,ref:this._fileInput,accept:e,onChange:this._onChangeFile,"data-testid":"upload-file"}),o.createElement("div",{onClick:this._onSelectFileClick,onKeyDown:this._onSelectFileClick},t)):null}_onSelectFileClick(e){void 0!==e.keyCode&&13!==e.keyCode||this._fileInput.current.click()}_onChangeFile(e){if(this._selectedFiles=e.target.files,0===this._selectedFiles.length)return;const{accept:t,element_id:i,directory:o,type:r}=this.props,s=this._selectedFiles.item(this._selectedIndexFile).type;if(""===s||-1===t.indexOf(s))return;if(i>0&&-1===c.indexOf(o)||"audio"===r||this.props.forceImmediateUpload)return void this._uploadFile(i);const n=new FileReader;n.onload=e=>{this.context.onDisplay(e.target.result,this.context.isGraphQlUpload?this._uploadGraphQlFile:this._uploadFile)},n.readAsDataURL(this._selectedFiles.item(this._selectedIndexFile))}_onNextFile(){if(this._selectedIndexFile++,this._selectedFiles.length===this._selectedIndexFile)return this._fileInput.current&&(this._fileInput.current.value=""),void(this._selectedIndexFile=0);this._onChangeFile({target:{files:this._selectedFiles,value:""}})}_uploadFile(e){if(null===this._selectedFiles)return!1;const t=this._selectedFiles.item(this._selectedIndexFile);if(null===t)return!1;const i=t.name.replace(/&/g,""),{directory:o,type:r,userSessionID:a,userSettingRefererUpload:l}=this.props;let c=`https://${s.default.get("host_upload")}/?sid=${a}&id=${e}&resize=1&directory=${o}&type=${r}&referer=${l}&file=${i}`;const d=new FormData;return d.append("file",t,i),this._xhr=new XMLHttpRequest,this._xhr.addEventListener("load",(e=>{if(200===e.target.status){const s=JSON.parse(e.target.response);if(Object.keys(s.error).length>0){var t,i,r;if("user"===o)new n.A({error:null!==(t=null==s||null===(i=s.error)||void 0===i?void 0:i.message)&&void 0!==t?t:null==s||null===(r=s.error)||void 0===r?void 0:r.name,journey_type:"update-picture",gateway_method:"user_upload",server_payload:s}).send();this.context.onError(s.error)}else this.context.onSuccess(s.results);this._onNextFile()}}),!1),this._xhr.addEventListener("error",(e=>{this.context.onError(e),this._onNextFile()}),!1),this._xhr.open("POST",c,!0),this._xhr.send(d)}async _uploadGraphQlFile(){if(null===this._selectedFiles)return!1;const e=this._selectedFiles.item(this._selectedIndexFile);if(null===e)return!1;const t=e.name.replace(/&/g,""),{directory:i,type:o}=this.props,r=`https://${s.default.get("host_upload")}/v2/${i}/${o}`,l=new FormData;l.append("file",e,t),this._xhr=new XMLHttpRequest,this._xhr.addEventListener("load",(e=>{if(200===e.target.status){const s=JSON.parse(e.target.response);if(Object.keys(s.error).length>0){var t,o,r;if("user"===i)new n.A({error:null!==(t=null==s||null===(o=s.error)||void 0===o?void 0:o.message)&&void 0!==t?t:null==s||null===(r=s.error)||void 0===r?void 0:r.name,journey_type:"update-picture",gateway_method:"user_upload",server_payload:s}).send();this.context.onError(s.error)}else this.context.onSuccess(s.results);this._onNextFile()}}),!1),this._xhr.addEventListener("error",(e=>{this.context.onError(e),this._onNextFile()}),!1),this._xhr.open("POST",r,!0);const c=await(0,a.gf)(!0);return this._xhr.setRequestHeader("Authorization","Bearer "+c),this._xhr.send(l)}}d.defaultProps={element_id:0,children:"",accept:"image/jpeg,image/png",type:"picture",directory:"playlist",multiFile:!1,action:"updatePicture",forceImmediateUpload:!1},d.contextType=l.t$;const p=(0,r.Ng)((({user:e})=>({userSessionID:e.SESSION_ID,userSettingRefererUpload:e.SETTING_REFERER_UPLOAD})))(d)},vF4p:(e,t,i)=>{i.d(t,{E6:()=>o,Xw:()=>s,pw:()=>r});let o=function(e){return e.home="home",e.loved="loved",e.playlists="playlists",e.albums="albums",e.artists="artists",e.shows="shows",e.podcasts="podcasts",e.history="history",e.radios="radios",e.personal_song="personal_song",e.downloads="downloads",e.following="following",e.followers="followers",e}({});const r=[o.loved,o.history,o.personal_song];let s=function(e){return e.downloads="favorite_downloaded_music",e.history="favorite_playlists_listening_history",e.home="favorite_tab",e.loved="favorite_tracks",e.playlists="favorite_playlists",e.albums="favorite_albums",e.artists="favorite_artists",e.shows="favorite_podcasts",e.resume="favorite_podcasts_ongoing",e.latest="favorite_podcasts_latest_episodes",e}({})}}]);