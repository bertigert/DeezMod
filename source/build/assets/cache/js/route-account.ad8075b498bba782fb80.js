"use strict";(self.webpackJsonpDeezer=self.webpackJsonpDeezer||[]).push([[7960],{"1EyH":(e,t,n)=>{n.d(t,{BB:()=>r,Sx:()=>a,UC:()=>s});const a=e=>/[\u2000-\u2BFF]/.test(e),r=e=>/[\u{10000}-\u{10FFFF}]/u.test(e),s=e=>!!e.match(/^[_0-9a-z-+]+[_.0-9a-z-+]*@([0-9a-z-]+\.)+[a-z]{2,13}$/i)},"86Vu":(e,t,n)=>{n.r(t),n.d(t,{default:()=>Gt});var a,r,s=n("q1tI"),i=n("nrKQ"),o=n("X6oL"),l=n("TRpf"),c=n("Ty5D"),d=n("Wp0Y"),u=n("Vd8Q"),p=n("xobL"),m=n("FSqQ"),h=n("MTsA"),g=n("y8BT"),_=(n("/eM8"),n("IRKz")),b=n("eOc8"),E=n("6jI4"),A=n("TDRX"),v=n("pVdW"),f=n("y7xR"),y=n("HmE0"),w=n("80JK"),S=n("8WIx"),P=n("XkdG"),C=n("NgX8"),k=n("SYyZ"),x=n("GHTP"),D=n("YIja"),T=n("mbHV");const N=({title:e,children:t,...n})=>s.createElement(A.a,n,s.createElement(f.D,{as:"h2",variant:"heading.l"},e),a||(a=s.createElement(E.c,{mt:"spacing.m",mb:"spacing.l"})),t),I=({title:e,children:t,...n})=>s.createElement(A.a,n,s.createElement(f.D,{as:"h3",variant:"heading.m"},e),r||(r=s.createElement(E.c,{mt:"spacing.m",mb:"spacing.l"})),t);I.defaultProps={maxW:"container.sm",mx:"auto",w:"100%"};var L=n("TqF5");const R=({requestStatus:e,email:t,onUpdateStatus:n})=>{const a=(0,l.wA)(),r=e=>e?e.available&&null!=e&&e.requested?(0,d.AP)("requestmydatamessage_text_alreadyrequestedwaitXdays_web",{sprintf:[30],count:30}):null!=e&&e.requested&&!e.available?(0,d.AP)("requestmydatamessage_text_alreadysentandbeingprocessed_web"):void 0:"";return s.createElement(C.m,{label:r(e),"aria-label":r(e)},s.createElement(y.$n,{variant:"outline",onClick:()=>a((0,L.qf)({name:"REQUEST_MY_DATA",props:{email:t,cb:n}})),isDisabled:Boolean(e&&e.requested)},(0,d.AP)("settingspage_title_mypersonaldata_web")))};var M=n("H/eQ"),O=n("tZCQ"),U=n("pxP/"),F=n("Vsul"),q=n("Jpjb"),z=n("exUT"),B=n("WLHJ"),V=n("p1TQ"),j=n("PbG0");const G=e=>({method:B.K.APPLE,...e});var K=n("WrS5"),W=n("WKgy"),$=n("rVxF"),H=n("IZLt");const X=(0,V.e7)("apple"),J=()=>{if(!X.apple)throw new Error("LegacyAuth - Apple not found, have you called init with apple as a param?");return X.apple},Y=async()=>{try{const e=await J().unlinkAccount();(0,V.s5)(e)}catch(t){var e;(0,V.kL)(t,G({intent:j.d6.Link})),"user_using_apple_email"===t.response.error.DATA_ERROR&&(W.A.dispatch((0,L.Oo)()),W.A.dispatch((0,L.qf)({name:K.b.THIRD_PARTY_CONFIRM_APPLE_UNLINK,size:"small",props:{email:t.response.payload.email,method:B.K.APPLE,confirmCallback:Y}})));const n=t;new H.A({error:null!==(e=n.message)&&void 0!==e?e:n.name,journey_type:"unlink-apple",gateway_method:"apple.unlinkAccount",server_payload:n}).send()}};var ee=n("fkXJ"),te=n("aHAS"),ne=n("QOhT"),ae=n("K5vB"),re=n("ZUSG"),se=n("2Av+"),ie=n("Ae9q"),oe=n("JlHZ"),le=n("Xf48"),ce=n("PBDT"),de=n("ZDlI");const ue=({children:e})=>s.createElement(ce.o,{w:"100%",h:"100%",p:"spacing.xl"},s.createElement(de.m,{background:"background.neutral.secondary.default",borderRadius:"lg",maxW:"container.lg",padding:"spacing.xl",border:"1px solid",borderColor:"border.neutral.primary.default"},e)),pe=({range:e,start:t=1,type:n,onChange:a,value:r})=>s.createElement(T.l,{id:`birthday-${n}`,w:"100%",onChange:a,value:r},Array.from(Array(e).keys()).map(e=>(e+=t,s.createElement("option",{key:`${n}-${e}`,value:e},e)))),me=(e,t)=>new Date(e,t,0).getDate(),he=({initialDate:e,onChange:t})=>{var n,a,r;const[i,o,l]=e?e.split("-"):[],[c,u]=(0,s.useState)(null!==(n=parseInt(l,10))&&void 0!==n?n:1),[p,m]=(0,s.useState)(null!==(a=parseInt(o,10))&&void 0!==a?a:1),[h,g]=(0,s.useState)(null!==(r=parseInt(i,10))&&void 0!==r?r:1900),_=e=>n=>{const a={day:c,month:p,year:h};a[e]=parseInt(n.target.value,10);const r=me(a.year,a.month);a.day>r&&(a.day=r),u(a.day),m(a.month),g(a.year);const s=`${a.year}-${a.month}-${a.day}`;t(s)};return s.createElement(b.B,{direction:"row",alignItems:"center",w:"100%"},s.createElement(w.MJ,null,s.createElement(S.l,{htmlFor:"birthday-day"},(0,d.AP)("Date de naissance")),s.createElement(b.B,{direction:"row",alignItems:"center",w:"100%"},s.createElement(pe,{type:"day",range:me(h,p),onChange:_("day"),value:c}),s.createElement(pe,{type:"month",range:12,onChange:_("month"),value:p}),s.createElement(pe,{type:"year",start:1900,range:(new Date).getFullYear()-1900,onChange:_("year"),value:h}))))};var ge,_e,be,Ee,Ae,ve,fe,ye,we,Se=n("hz5U"),Pe=n("QKMO"),Ce=n("1EyH"),ke=n("3nMj"),xe=n("G04z");const De=(0,_.B)(b.B);De.defaultProps={alignItems:"center",direction:"column",mx:"auto",spacing:"spacing.xl",w:"100%"};let Te=(0,o.Ay)()(ge=class extends s.Component{constructor(e){super(e),this.state={mail:e.userEmail,picture:e.data.USER_DATA.USER_PICTURE,confirmUpdate:!1,errorPayload:null,requestStatus:null},this._dayRef=s.createRef(),this._monthRef=s.createRef(),this._yearRef=s.createRef(),this._blogNameRef=s.createRef(),this._languageRef=s.createRef(),this._onSave=this._onSave.bind(this),this._onChangePicture=this._onChangePicture.bind(this),this._openConsentModal=this._openConsentModal.bind(this),this._onToggleFacebook=this._onToggleFacebook.bind(this),this._onToggleGoogle=this._onToggleGoogle.bind(this),this._onToggleApple=this._onToggleApple.bind(this),this._onUserRequestData=this._onUserRequestData.bind(this),this._onRequestData=this._onRequestData.bind(this)}componentDidMount(){M.A.subscribe(M.A.user.updatePicture,this._onChangePicture),i.A.call({method:"user.getDataExportStatus",data:{USER_ID:this.props.userID},success:e=>{this.setState({requestStatus:e})},catch:()=>{this.setState({requestStatus:{requested:!1,available:!1}})}})}componentWillUnmount(){i.A.cancel(this._fetchApiRef),M.A.unsubscribe(M.A.user.updatePicture,this._onChangePicture)}render(){return s.createElement(ue,null,s.createElement(N,{title:(0,d.AP)("Mes informations")},s.createElement(b.B,{direction:"column",maxW:"container.sm",mx:"auto",spacing:"spacing.xl",w:"100%"},this._renderSubscription(),this._renderCredentials(),this._renderProfileMigration(),this._renderLinkAccount(),this._renderPublicInformations(),this._renderPrivateInformations(),this._renderMessage())),!this.props.isSubProfile&&(_e||(_e=s.createElement(E.c,{mt:"spacing.m",mb:"spacing.l"}))),!1)}_renderSubscription(){const{MANAGE_SUBSCRIPTION:e,OFFER_NAME:t}=this.props.data;let n;if(this.props.hasParent){const e=this.props.isSubAccount?(0,d.AP)("deezerfamilyprofilemigration_text_yourindependentaccountpartofuserXplanX_web",{sprintf:[t,this._getParentName()]}):(0,d.AP)("Votre profil est rattaché au compte de %s.",{sprintf:[this._getParentName()]});n=s.createElement(A.a,{color:"text.neutral.secondary.default",fontSize:"sm"},s.createElement(v.E,{"data-testid":"offer-name",textAlign:"center"},t),s.createElement(v.E,{textAlign:"center"},e))}else{const e=(0,d.AP)("planrenaming_text_youreenjoyingplanX_web",{sprintf:["free"===t?(0,d.AP)("deezerplans_title_deezerfree_web"):t]});n=s.createElement(v.E,{fontSize:"sm",textAlign:"center",color:"text.neutral.secondary.default","data-testid":"offer-name"},e)}return s.createElement(b.B,{direction:"column",spacing:"spacing.xl",alignItems:"center"},s.createElement(A.a,{borderRadius:"full",overflow:"hidden",flex:"none"},s.createElement(ae.AG,{value:{onSuccess:this._onChangePicture,onError:this._onChangePictureError}},s.createElement(ne.A,{id:this.props.userID,type:"user",imgSrc:Se.A.getImageSrc("user",this.state.picture,125,125),bordered:!1,forceImmediateUpload:!0,width:125,height:125,uploadCover:"on",coverLink:!1,alt:this.props.userName}))),s.createElement(b.B,{direction:"column"},s.createElement(f.D,{as:"h3",variant:"heading.l",textAlign:"center"},this.props.data.USER_DATA.BLOG_NAME),n),!this.props.hasParent&&e&&s.createElement(y.$n,{variant:"outline",onClick:this._onOpenSubscription},(0,d.AP)("Gérer mon abonnement")))}_renderCredentials(){return this.props.hasParent&&!this.props.isSubAccount||!this.props.userEmail?null:s.createElement(I,{title:(0,d.AP)("Connexion"),className:"account-credentials"},s.createElement(De,null,s.createElement(w.MJ,null,s.createElement(S.l,null,(0,d.AP)("Votre E-mail :")),s.createElement(b.B,{direction:"row",alignItems:"center"},s.createElement(P.p,{value:this.state.mail,isDisabled:!0,w:"100%"}),!O.A.isAllowed("disable_change_email")&&s.createElement(C.m,{label:(0,d.AP)("Modifier"),"aria-label":(0,d.AP)("Modifier")},s.createElement(y.K0,{variant:"outline","aria-label":(0,d.AP)("Modifier"),onClick:this._onOpenModal.bind(this,"mail"),icon:be||(be=s.createElement(re.r,null))})))),s.createElement(w.MJ,null,s.createElement(S.l,null,(0,d.AP)("Votre mot de passe :")),s.createElement(b.B,{direction:"row",alignItems:"center"},Ee||(Ee=s.createElement(P.p,{isDisabled:!0,w:"100%",value:"*****"})),!O.A.isAllowed("disable_change_password")&&s.createElement(C.m,{label:(0,d.AP)("Modifier"),"aria-label":(0,d.AP)("Modifier")},s.createElement(y.K0,{variant:"outline","aria-label":(0,d.AP)("Modifier"),onClick:this._onOpenModal.bind(this,"pwd"),icon:Ae||(Ae=s.createElement(re.r,null))}))))))}_renderLinkAccount(){return this.props.isSubProfile,null}_renderProfileMigration(){return this.props.isSubProfileMigrationAllowed,null}_renderConnectAction(){const{userFacebookId:e,userGoogleId:t,userAppleId:n}=this.props,a=e?(0,d.AP)("generic_action_unlinksocialaccountX_web",{sprintf:["Facebook"]}):(0,d.AP)("generic_action_connectwithsocialaccountX_web",{sprintf:["Facebook"]}),r=t?(0,d.AP)("generic_action_unlinksocialaccountX_web",{sprintf:["Google"]}):(0,d.AP)("generic_action_connectwithsocialaccountX_web",{sprintf:["Google"]}),i=n?(0,d.AP)("generic_action_unlinksocialaccountX_web",{sprintf:["Apple"]}):(0,d.AP)("generic_action_connectwithsocialaccountX_web",{sprintf:["Apple"]});return s.createElement(b.B,{alignItems:"center",direction:"row",mx:"auto",spacing:"spacing.m"},s.createElement(b.B,{direction:"column",spacing:"spacing.m",alignItems:"center"},s.createElement(v.E,{variant:"body.m.default"},a),s.createElement(y.K0,{variant:"outline","aria-label":a,icon:ve||(ve=s.createElement(se.i,null)),onClick:this._onToggleFacebook})),s.createElement(b.B,{direction:"column",spacing:"spacing.m",alignItems:"center"},s.createElement(v.E,{variant:"body.m.default"},r),s.createElement(y.K0,{variant:"outline","aria-label":r,icon:fe||(fe=s.createElement(ie.N,null)),onClick:this._onToggleGoogle})),s.createElement(b.B,{direction:"column",spacing:"spacing.m",alignItems:"center"},s.createElement(v.E,{variant:"body.m.default"},i),s.createElement(y.K0,{variant:"outline","aria-label":i,icon:ye||(ye=s.createElement(oe.Y,null)),onClick:this._onToggleApple})))}_renderPublicInformations(){return s.createElement(I,{title:(0,d.AP)("Informations Deezer visibles par les internautes"),className:"account-public"},s.createElement(De,null,s.createElement(w.MJ,null,s.createElement(S.l,{htmlFor:"sexe_m",mb:"3"},O.A.isAllowed("gender_nonbinary")?(0,d.AP)("genderscreen_title_iidentifyas_web"):(0,d.AP)("Genre")),s.createElement(k.z,{defaultValue:this.props.data.USER_DATA.SEX},s.createElement(b.B,{direction:"row",alignItems:"center",spacing:"6"},s.createElement("label",{htmlFor:"sexe_m"},s.createElement(x.s,{id:"sexe_m",name:"sex",value:"M",type:"radio"},(0,d.AP)("genderoption_text_male_web"))),s.createElement("label",{htmlFor:"sexe_f"},s.createElement(x.s,{id:"sexe_f",name:"sex",value:"F",type:"radio"},(0,d.AP)("genderoption_text_female_web"))),O.A.isAllowed("gender_nonbinary")&&s.createElement("label",{htmlFor:"sexe_nb"},s.createElement(x.s,{id:"sexe_nb",name:"sex",value:"NonBinary",type:"radio"},(0,d.AP)("genderoption_text_nonbinary_web")))))),s.createElement(w.MJ,null,s.createElement(S.l,{htmlFor:"blog_name"},(0,d.AP)("Pseudo")),s.createElement(P.p,{id:"blog_name",name:"blog_name",ref:this._blogNameRef,type:"text",defaultValue:this.props.data.USER_DATA.BLOG_NAME,w:"100%"}))))}_renderPrivateInformations(){var e,t;return s.createElement(s.Fragment,null,s.createElement(I,{title:(0,d.AP)("Informations privées"),className:"account-private"},s.createElement(De,null,s.createElement(b.B,{direction:"row"},!this.props.isKid&&s.createElement(y.$n,{variant:"outline",onClick:this._openConsentModal},(0,d.AP)("trackingconsent_action_opensettings_web")),s.createElement(R,{requestStatus:this.state.requestStatus,email:this.state.mail,onUpdateStatus:this._onUserRequestData})),s.createElement(he,{initialDate:this.props.data.USER_DATA.BIRTHDAY,onChange:e=>this.setState({date:e})}),null,s.createElement(A.a,null,s.createElement(y.$n,{onClick:this._onSave},(0,d.AP)("Enregistrer"))))),(null===(e=this.state.requestStatus)||void 0===e?void 0:e.available)&&s.createElement(I,{title:(0,d.AP)("requestmydatasettings_text_downloaddescription_web",{sprintf:[(0,ke.A)(null===(t=this.state)||void 0===t||null===(t=t.requestStatus)||void 0===t?void 0:t.created_at,{},30)]})},s.createElement(A.a,null,s.createElement(y.$n,{variant:"outline",leftIcon:we||(we=s.createElement(le.m,null)),onClick:this._onRequestData},(0,d.AP)("Télécharger")))))}_renderMessage(){if(!this.state.confirmUpdate)return null;let e,t;switch(this.state.confirmUpdate){case"success":t="success",e=(0,d.AP)("Vos données ont été mises à jour.");break;case"min_legal_age":t="error",e=(0,d.WI)("formerrormessage_text_accountcreationagerestriction_web","formerrormessage_text_accountcreationagerestriction_web",{sprintf:[this.state.errorPayload.age],count:this.state.errorPayload.age});break;case"blogname_not_valid":case"no_emoji_blogname":t="error",e=(0,d.AP)("errormessage_text_usernamecannotcontainsemojis_web");break;case"pwd_updated":t="success",e=(0,d.AP)("Votre mot de passe a été modifié avec succès.");break;case"email_updated":t="success",e=(0,d.AP)("Votre adresse email a été mise à jour.");break;default:t="error",e=(0,d.AP)("Vos données n'ont pas été mises à jour.")}return s.createElement(D.N,{status:t},e)}_renderSelectLanguage(){for(var e=[],t=this.props.data.LANGUAGES,n=0,a=t.length;n<a;n++)e.push(s.createElement("option",{key:n,value:t[n].code},t[n].label));return s.createElement(T.l,{id:"language",ref:this._languageRef,defaultValue:this.props.userLang,w:"100%"},e)}_renderSelectDate(e){const t=this._yearRef.current?this._yearRef.current.value:1900,n=this._monthRef.current?this._monthRef.current.value:1;for(var a={day:{start:1,end:new Date(t,n,0).getDate()},month:{start:1,end:12},year:{start:1900,end:(new Date).getFullYear()-1}},[r,i,o]=this.props.data.USER_DATA.BIRTHDAY.split("-"),l={year:r,month:i,day:o},c=[],d=a[e].start,u=a[e].end;d<=u;d++)c.push(s.createElement("option",{key:d,value:(0,Pe.A)(d,2)},(0,Pe.A)(d,2)));return s.createElement(T.l,{id:"birthday",ref:this[`_${e}Ref`],defaultValue:l[e],w:"100%"},c)}_onSave(){const{valid:e,errorCode:t}=this._verifyFormFields();if(!e)return void this.setState({confirmUpdate:t,errorPayload:t});const n=document.querySelector('input[name="sex"]:checked')?document.querySelector('input[name="sex"]:checked').value:"",a=this._languageRef.current?this._languageRef.current.value.trim():"",r=a&&a!==this.props.userLang,s={USER_DATA:{}};this.state.date&&(s.USER_DATA.BIRTHDAY=this.state.date),n.length>0&&n!==this.props.data.USER_DATA.SEX&&(s.USER_DATA.SEX=n),this._blogNameRef.current.value.trim()&&this._blogNameRef.current.value.trim()!==this.props.userName&&(s.USER_DATA.BLOG_NAME=this._blogNameRef.current.value.trim()),r&&(s.LANG=a),this._fetchApiRef=i.A.call({method:"user.update",data:s,success:e=>{r&&(U.A.href=`/lang?lang=${a}&redirect=/account`),this.props.updateUserName(this._blogNameRef.current.value.trim()),this.setState({confirmUpdate:e?"success":"error"})},error:e=>{var t;new H.A({error:null!==(t=null==e?void 0:e.message)&&void 0!==t?t:null==e?void 0:e.name,journey_type:"update-user-infos",gateway_method:"user.update",server_payload:e}).send(),this.setState({confirmUpdate:e.message||"error",errorPayload:e.payload||null})}})}_onToggleFacebook(){if(!this.props.userFacebookId)return z.A.linkAccount({profile_migration:this.props.isSubProfile}),void this._onLogMigration("facebook");z.A.unlinkAccount({profile_migration:this.props.isSubProfile})}_onToggleGoogle(){if(!this.props.userGoogleId)return this._onLogMigration("google"),void q.A.linkAccount({profile_migration:this.props.isSubProfile});q.A.unlinkAccount()}_onToggleApple(){if(!this.props.userAppleId)return this._onLogMigration("apple"),void(async e=>{try{const t=await J().linkAccount(e);(0,V.V7)(t,null==e?void 0:e.profile_migration)}catch(r){var t,n,a;(0,$.O)(r)&&((0,V.kL)(new $.A(r),G({intent:j.d6.Link})),new H.A({error:null!==(t=null!==(n=null===(a=r.payload)||void 0===a?void 0:a.status)&&void 0!==n?n:r.message)&&void 0!==t?t:r.name,journey_type:null!=e&&e.profile_migration?"family-convert-independent":"link-apple",gateway_method:"apple.linkAccount",server_payload:r}).send())}})({profile_migration:this.props.isSubProfile});W.A.dispatch((0,L.qf)({name:K.b.THIRD_PARTY_CONFIRM_UNLINK,size:"small",props:{method:B.K.APPLE,confirmCallback:Y}}))}_onLogMigration(e){this.props.isSubProfileMigrationAllowed&&this.props.tracking.trackEvent({eventaction:"convert-independent-account",eventcategory:"family-account-management",event:"click",eventlabel:e})}_onOpenSubscription(){(0,F.A)("/account/subscription")}async _onOpenModal(e){const t=await this._getIsSecuredSessionRequired();"mail"===e&&(null==t?void 0:t.change_email)||"pwd"===e&&(null==t?void 0:t.change_password)?this._openCodeRequest(e):this._openCredentialsUpdate(e),"mail"===e&&M.A.subscribeOnce(M.A.user.updateEmail,(e,t)=>{this.setState({mail:t.email,confirmUpdate:"email_updated"}),(0,xe.u)().identify({email:t.email})}),"pwd"===e&&M.A.subscribeOnce(M.A.user.updatePassword,()=>{this.setState({confirmUpdate:"pwd_updated"})})}_getIsSecuredSessionRequired(){return new Promise((e,t)=>{i.A.call({method:"user.isSecuredSessionRequired",data:{USER_ID:this.props.userID},success:t=>{e(t)},error:e=>{t(e)}})})}_downloadData(){i.A.call({method:"user.getDataExportLink",success:e=>{e.link&&window.open(e.link)},catch:e=>{var t;new H.A({error:null!==(t=null==e?void 0:e.message)&&void 0!==t?t:null==e?void 0:e.name,journey_type:"request-data-download",gateway_method:"user.getDataExportLink",server_payload:null==e?void 0:e.response}).send(),(0,ee.A)({body:(0,d.AP)("errormessage_text_anerroroccurredpleasetryagain_web"),status:"error"})}})}async _onRequestData(){const e=await this._getIsSecuredSessionRequired();null!=e&&e.data_request?this._openCodeRequest("dl_data",this._downloadData):this._downloadData()}_onUserRequestData(){this.setState({requestStatus:{requested:!0,available:!1}})}_onChangePicture(e){this.setState({picture:e}),this.props.updateUserPicture(e)}_onChangePictureError(){(0,ee.A)({body:(0,d.AP)("Une erreur est survenue, merci de réessayer plus tard."),status:"error"})}_verifyFormFields(){let e,t=!0;const n=this._blogNameRef.current.value.trim();return((0,Ce.Sx)(n)||(0,Ce.BB)(n))&&(t=!1,e="no_emoji_blogname"),{valid:t,errorCode:e}}_openCodeRequest(e,t){this.props.openModal({name:"CODE_REQUEST",props:{email:this.state.mail,requestType:e,...t&&{cb:t}},size:"small"})}_openCredentialsUpdate(e){this.props.openModal({name:"mail"===e?"UPDATE_EMAIL":"UPDATE_PASSWORD",size:"small"})}_getParentName(){return""===this.props.data.PARENT_USER_DATA.FIRSTNAME&&""===this.props.data.PARENT_USER_DATA.LASTNAME?this.props.data.PARENT_USER_DATA.BLOG_NAME:`${this.props.data.PARENT_USER_DATA.FIRSTNAME} ${this.props.data.PARENT_USER_DATA.LASTNAME}`}_openConsentModal(){window.consentScreenApi&&window.consentScreenApi.openPreferences(3,"purposes")}})||ge;const Ne=(0,l.Ng)(({user:e})=>({userEmail:(0,p.hS)(e),userID:e.id,userLang:e.SETTING_LANG,userName:(0,p.Mn)(e),userFacebookId:(0,p.$u)(e),userGoogleId:(0,p.md)(e),userAppleId:(0,p.NK)(e),isKid:(0,p.zI)(e),hasParent:(0,p.p7)(e),isSubAccount:(0,p.m0)(e),isSubProfile:(0,p.W$)(e),isSubProfileMigrationAllowed:(0,p.Q6)(e)}),{openModal:L.qf,closeModal:L.Oo,updateUserPicture:te.Ff,updateUserName:te.Km})(Te);var Ie=n("PF77");class Le extends s.Component{constructor(...e){super(...e),this.state={updatedOptin:null,showNotif:!1}}render(){return s.createElement(ue,null,s.createElement(b.B,{direction:"column",spacing:"spacing.xl",className:"account-wrapper"},this._renderSocial(),this._renderSettings()))}_renderSocial(){return null}_renderSettings(){return s.createElement(N,{title:(0,d.AP)("Je souhaite :")},s.createElement(b.B,{as:"form",direction:"column",className:"form-horizontal"},s.createElement(Ie.S,{isChecked:!this.props.userSettings.global.social,onChange:this._onChangeSetting.bind(this,"global","social"),isDisabled:this.props.isKid,size:"sm"},this.props.data.USER_SETTINGS_LABEL.global.social),this._renderPopupUnload()))}_renderPopupUnload(){return null}async _onChangeSetting(e,t,n){n.preventDefault();const a=!this.props.userSettings[e][t];await this.props.updateSettings({[e]:{[t]:Number(a)}})}}const Re=(0,l.Ng)(({user:e})=>({userSettings:e.USER.SETTING,isKid:(0,p.zI)(e)}),{updateSettings:te.Xx})(Le);var Ve,Me=n("QqEF"),Oe=n("TnRy"),Ue=n("LmGy"),Fe=n("wAmb"),qe=n("Qx5r"),ze=n("g1Fm"),Be=n("Caim");const je={"device_android_mobile.png":n.p+"images/device/device_android_mobile.ab12a24585dea551e56d.png","device_android_tablet.png":n.p+"images/device/device_android_tablet.20bf3a3be0d8bd4ce72d.png","device_ipad.png":n.p+"images/device/device_ipad.0e255db9c2d9a4aeba29.png","device_iphone.png":n.p+"images/device/device_iphone.0df04eb92efd7e29338c.png"};class Ge extends s.Component{constructor(...e){super(...e),this.state={deletedDevices:[]}}componentWillUnmount(){i.A.cancel(this._fetchApiRef)}get devices(){return(this.props.data.USER_DEVICE_SERIALS?this.props.data.USER_DEVICE_SERIALS.data:[]).filter(e=>!this.state.deletedDevices.includes(e.USER_DEVICE_SERIAL_ID))}render(){return s.createElement(ue,null,0===this.devices.length?this._renderPlaceholder():this._renderDevice())}_renderPlaceholder(){return s.createElement(b.B,{direction:"column"},s.createElement(v.E,{fontSize:"sm"},(0,d.AP)("Vous n'avez actuellement aucun appareil connecté à ce compte.")),s.createElement(v.E,{color:"text.neutral.secondary.default",fontSize:"xs"},(0,d.AP)("Pour en ajouter un, connectez-vous avec votre appareil sur l'application Deezer.")))}_renderDevice(){return s.createElement("div",null,s.createElement(N,{title:(0,d.AP)("Votre compte Deezer est actuellement relié aux appareils suivants :")},s.createElement(Me.X,null,s.createElement(Oe.N,null,this.devices.map((e,t)=>{if(t>=this.props.data.MAX_NB_DEVICES)return null;let n=e.DEVICE_NAME?(0,ze.A)(e.DEVICE_NAME):(0,ze.A)(e.NAME);e.DEVICE_OS&&(n+=` - ${e.DEVICE_OS}`);const a=(0,Be.A)(new Date(e.DATE.replace(" ","T")).getTime()/1e3,!0,"/",!1),r=e.LAST_CONNECTION?`${(0,d.AP)("Dernière connexion")} ${(0,Be.A)(new Date(e.LAST_CONNECTION.replace(" ","T")).getTime()/1e3,!0,"/",!1)}`:"";return s.createElement(Ue.Tr,{key:e.DEVICE_SERIAL},s.createElement(Fe.Td,null,s.createElement("img",{src:je[e.PICTURE],alt:e.DEVICE_OS})),s.createElement(Fe.Td,null,s.createElement(v.E,{variant:"body.2xs.default"},n),s.createElement(v.E,{variant:"body.2xs.default"},(0,d.AP)("Ajouté le %s",{sprintf:[a]})),s.createElement(v.E,{variant:"body.2xs.default"},r)),s.createElement(Fe.Td,null,s.createElement(C.m,{label:(0,d.AP)("Supprimer l'appareil"),"aria-label":(0,d.AP)("Supprimer l'appareil")},s.createElement(y.K0,{variant:"outline","aria-label":(0,d.AP)("Supprimer l'appareil"),onClick:this._onRemoveDevice.bind(this,e.USER_DEVICE_SERIAL_ID),icon:Ve||(Ve=s.createElement(qe.u,null))}))))})))),s.createElement(v.E,{pt:"spacing.m",variant:"body.2xs.default",className:"device-limit",dangerouslySetInnerHTML:{__html:(0,d.WI)("Votre compte Deezer ne peut être relié qu'à un seul appareil.","Votre compte Deezer peut être relié à %s appareils maximum.",{sprintf:['<strong class="nb-device-limit">'+this.props.data.MAX_NB_DEVICES+"</strong>"],count:this.props.data.MAX_NB_DEVICES})}}))}_onRemoveDevice(e){confirm((0,d.AP)("Voulez-vous réellement supprimer cet appareil ?"))&&(this._fetchApiRef=i.A.call({method:"device.deleteSerial",data:{serial:e},success:t=>{if(t){const{deletedDevices:t}=this.state;this.setState({deletedDevices:[...t,e]})}}}))}}const Ke=Ge;var We=n("FVVF"),$e=n("CdHq"),He=n("LjZa"),Xe=n("7sx+"),Je=n("r2u9");const Ye="UPDATED_IS_OPEN_AT_LOGIN",Qe={isOpenAtLogin:!0,isOpenAsHidden:!1};var Ze=n("shsj"),et=n("oh0j"),tt=n("G3sm");const nt={updateSetting:te.bB},at=(0,l.Ng)(({user:e})=>({active:(0,p.AU)(e)}),nt)(e=>{const{active:t,updateSetting:n}=e;return s.createElement("div",{className:"explicit-settings-container"},s.createElement(w.MJ,null,s.createElement($e.s,{alignItems:"center"},s.createElement(S.l,{mb:"0",color:"text.neutral.primary.default"},(0,d.AP)("Notifications de bureau")),s.createElement(et.d,{className:"setting-input-item",isChecked:t,onChange:()=>n(!t)})),s.createElement(tt.e,{fontSize:"xs",mt:0},(0,d.AP)("Afficher une notification sur le bureau lorsqu'un nouveau titre commence."))))});var rt,st=n("CyAC"),it=n("sAMA"),ot=n("U7Z4");class lt extends s.Component{constructor(e){super(e),this.handleChangeFirstLevel=this.handleChangeFirstLevel.bind(this),this.handleChangeSecondLevel=this.handleChangeSecondLevel.bind(this),this.setExplicitLevel=this.setExplicitLevel.bind(this),this.state={isExplicitToggle:!1}}setExplicitLevel(e,t,n){return{EXPLICIT_CONTENT_LEVEL:e?t:n}}handleChangeFirstLevel(e){this.props.updateUserExplicitLevel(this.setExplicitLevel(e,it.Nq,it.Mt)),this.setState({isExplicitToggle:!0})}handleChangeSecondLevel(e){this.props.updateUserExplicitLevel(this.setExplicitLevel(e,it.g,it.Nq)),this.setState({isExplicitToggle:!0})}render(){return s.createElement(s.Fragment,null,this._renderFirstLevel(),this._renderSecondLevel(),this._renderToggleInformation())}_renderFirstLevel(){const{userLevel:e,availableLevels:t}=this.props;if(!(0,st.ek)(it.Mt,t))return null;const n=e!==it.Mt;return s.createElement("div",{className:"explicit-settings-container"},s.createElement(w.MJ,null,s.createElement($e.s,{alignItems:"center"},s.createElement(S.l,{mb:"0",color:"text.neutral.primary.default"},(0,d.AP)("settingspage_title_donotrecommendexplicitcontent_web")),this._renderCheckbox(n,this.handleChangeFirstLevel)),s.createElement(tt.e,{fontSize:"xs",mt:0},(0,d.AP)("settingspage_subtitle_explicitcontentexcludedfromreco_web"))))}_renderSecondLevel(){const{userLevel:e}=this.props;if(e===it.Mt)return null;const t=e===it.g;return s.createElement("div",{className:"explicit-settings-container"},s.createElement(w.MJ,null,s.createElement($e.s,{alignItems:"center"},s.createElement(S.l,{mb:"0",color:"text.neutral.primary.default"},(0,d.AP)("settingspage_title_hideexplicitcontent_web")),this._renderCheckbox(t,this.handleChangeSecondLevel)),s.createElement(tt.e,{fontSize:"xs",mt:0},(0,d.AP)("settingspage_subtitle_explicitcontentnotrecoplayablesearchable_web"))))}_renderToggleInformation(){const{isExplicitToggle:e}=this.state;return e?s.createElement(ot.Fc,{mt:4,"data-testid":"explicit-update-delay-info"},rt||(rt=s.createElement(ot._0,null)),s.createElement(ot.TN,null,(0,d.AP)("warningmessage_text_updatemighttakeafewhours_web"))):null}_renderCheckbox(e,t){const{isEditableExplicitLevel:n}=this.props,a=s.createElement(et.d,{isChecked:e||!n,isDisabled:!n,onChange:e=>{var n;return t(null==e||null===(n=e.target)||void 0===n?void 0:n.checked)}});return n?a:s.createElement(C.m,{label:(0,d.AP)("infomessage_text_explicitcontentturnedoffbyadmin_web",{sprintf:[(0,d.AP)("deezerplans_title_deezerfamily_web")]})},a)}}const ct={updateUserExplicitLevel:te.xf},dt=(0,l.Ng)(e=>({userLevel:(0,p.Uw)(e.user),availableLevels:(0,p.n3)(e.user),isEditableExplicitLevel:(0,p.Kw)(e.user)}),ct)(lt);var ut,pt;const mt=(0,l.Ng)(function(e){return{availableExplicitLevels:(0,p.n3)(e.user)}})(({availableExplicitLevels:e})=>s.createElement(N,{title:(0,d.AP)("settingspage_title_displaysettings_web")},e.length>0?ut||(ut=s.createElement(dt,null)):null,pt||(pt=s.createElement(at,null))));function ht(e,t=2){if(0===e)return"0 Bytes";const n=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,n)).toFixed(t))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][n]}var gt,_t,bt,Et;class At extends s.Component{constructor(e){super(e),this._clearAll=()=>{Xe.default.clear().then(()=>this.getStorageStats())},this.props.updateData(),this.state={quota:0,usageCache:0,usageDownloaded:0}}async componentDidMount(){await this.getStorageStats()}async getStorageStats(){const{user:e,ua:t}=await Xe.default.estimate();this.setState({usageCache:e.usage.cached,usageDownloaded:e.usage.persisted,quota:t?t.quota:e.quota})}render(){return s.createElement(ue,null,s.createElement(We.T,{spacing:"spacing.xl",alignItems:"flex-start"},this._renderCache(),gt||(gt=s.createElement(mt,null)),this._renderOtherSettings()))}_renderCache(){const e=Math.max(Math.round(this.state.usageCache/this.state.quota*100)||0,0),t=Math.max(Math.round(this.state.usageDownloaded/this.state.quota*100)||0,0);return s.createElement(N,{title:(0,d.AP)("settings_title_diskusage_web")},s.createElement(We.T,{spacing:"spacing.l"},s.createElement("div",{className:"progress progress-bar-origin"},s.createElement("div",{className:"progress-bar progress-bar-cache",role:"progressbar",style:{width:e+"%"},"aria-valuenow":e,"aria-valuemin":"0","aria-valuemax":"100"}),s.createElement("div",{className:"progress-bar progress-bar-downloads",role:"progressbar",style:{width:t+"%"},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})),s.createElement("table",null,s.createElement("tbody",null,s.createElement("tr",null,_t||(_t=s.createElement("td",{className:"setting-legend-cell"},s.createElement("div",{className:"progress-bar-cache progress-bar-legend"}))),s.createElement("td",{className:"setting-legend-cell"},s.createElement("span",{className:"setting-cache-label"},(0,d.AP)("Smart Cache"))),s.createElement("td",{className:"setting-legend-cell"},s.createElement("span",{className:"setting-cache-used setting-input"},ht(Math.max(this.state.usageCache||0,0))))),s.createElement("tr",null,bt||(bt=s.createElement("td",{className:"setting-legend-cell"},s.createElement("div",{className:"progress-bar-downloads progress-bar-legend"}))),s.createElement("td",{className:"setting-legend-cell"},s.createElement("span",{className:"setting-cache-label"},(0,d.AP)("desktopapp_title_downloads_web"))),s.createElement("td",{className:"setting-legend-cell"},s.createElement("span",{className:"setting-cache-used setting-input"},ht(Math.max(this.state.usageDownloaded||0,0))))),s.createElement("tr",null,Et||(Et=s.createElement("td",{className:"setting-legend-cell"},s.createElement("div",{className:"progress-bar-origin progress-bar-legend"}))),s.createElement("td",{className:"setting-legend-cell"},s.createElement("span",{className:"setting-cache-label"},(0,d.AP)("diskusage_title_available_web"))),s.createElement("td",{className:"setting-legend-cell"},s.createElement("span",{className:"setting-cache-used setting-input"},ht(Math.max(this.state.quota-(this.state.usageCache+this.state.usageDownloaded)||0,0))))))),s.createElement("div",{className:"setting-action"},s.createElement("div",{className:"setting-action-item"},s.createElement(y.$n,{onClick:this._clearAll},(0,d.AP)("diskusage_action_clearall_web"))))))}_renderOtherSettings(){const{isOpenAtLogin:e}=this.props;return s.createElement(N,{title:(0,d.AP)("Autre")},s.createElement(w.MJ,null,s.createElement($e.s,{alignItems:"center"},s.createElement(S.l,null,(0,d.AP)("Lancer Deezer au démarrage")),s.createElement(et.d,{className:"setting-input-item",isChecked:e,onChange:()=>this.props.setOpenAtLogin(!e)}))))}}At.defaultProps={cachePath:null,setCachePath:He.A},W.A.addReducers({electronSettings:function(e=Qe,t={}){switch(t.type){case Ye:return{...e,isOpenAtLogin:t.isOpenAtLogin};case"UPDATED_IS_OPEN_AS_HIDDEN":return{...e,isOpenAsHidden:t.isOpenAsHidden};default:return e}}});const vt={setOpenAtLogin:e=>t=>{Je.Ay.setAutoStart(e),t({type:Ye,isOpenAtLogin:e})},updateData:()=>e=>{e({type:Ye,isOpenAtLogin:Je.Ay.isOpenAtLogin()})}},ft=(0,l.Ng)(({electronSettings:e,cache:t})=>({cached:(0,Ze.oC)(t),isOpenAtLogin:e.isOpenAtLogin,isOpenAsHidden:e.isOpenAsHidden}),vt)(At);var yt;const wt=()=>yt||(yt=s.createElement(ue,null,s.createElement(mt,null)));var St,Pt=n("tU3/");const Ct=()=>St||(St=s.createElement(ue,null,s.createElement(Pt.A,null)));n("W8Tb");var kt=n("6EMc"),xt=n("70bL");class Dt extends s.Component{constructor(e){super(e),this.state={currentCountry:e.userRecoCountry},this._handleChange=this._handleChange.bind(this)}render(){return s.createElement(ue,null,s.createElement(N,{title:(0,d.AP)("countryselector_title_countryselector_web")},s.createElement(w.MJ,null,s.createElement(S.l,{htmlFor:"recommendation-country"},(0,d.AP)("countryselector_title_chooseyourcountry_web")),this._renderSelectCountry(),s.createElement(tt.e,{fontSize:"xs",mt:4},(0,d.AP)("countryselector_text_chgecountryasoftenasyouwant_web")),s.createElement(tt.e,{fontSize:"xs",mt:"0"},(0,d.AP)("countryselector_text_fewhourstoapplychanges_web")))))}_renderSelectCountry(){const{data:e}=this.props,t=e.COUNTRIES||null;if(!Array.isArray(t))return null;t.sort(function(e,t){return(0,kt.A)(e.label.toLowerCase(),t.label.toLowerCase())});const n=t.map(e=>s.createElement("option",{key:e.code,value:e.code},e.label));return s.createElement(T.l,{id:"recommendation-country",value:this.state.currentCountry,onChange:this._handleChange,isDisabled:!this.props.isOnline,maxW:"300px"},n)}_handleChange(e){this.setState({currentCountry:e.target.value}),this.props.setRecoCountry(e.target.value).catch(()=>{(0,ee.A)({body:(0,d.AP)("Une erreur est survenue, merci de réessayer plus tard."),status:"error"}),this._resetCurrentCountry()})}_resetCurrentCountry(){this.setState({currentCountry:this.props.userRecoCountry})}}const Tt=(0,l.Ng)(e=>({isOnline:(0,xt.sc)(e),userRecoCountry:(0,p.kY)(e)}),{setRecoCountry:te.Iy})(Dt);var Nt=n("i6DM");const It=()=>{const e=(0,l.d4)(xt.sc),[n,a]=s.useState(!1),[r,i]=(0,l.d4)(e=>[(0,p.F6)(e.user),(0,p.Mn)(e.user)]);return s.createElement(ue,null,s.createElement(N,{title:(0,d.AP)("libraryimporter_title_transferyourfavorites_web")},s.createElement($e.s,{justifyContent:"space-between",width:"100%"},s.createElement(v.E,{fontSize:"md"},(0,d.AP)("libraryimporter_text_moveplaylistsandfavoritestodzr_web")),s.createElement(y.$n,{onClick:async()=>{a(!0);const e=await(0,Nt.Kl)(r,i,true).catch(()=>(0,ee.A)({body:(0,d.AP)("Une erreur est survenue, merci de réessayer plus tard."),status:"error"}));e&&open(e),a(!1)},isDisabled:n||!e},(0,ze.A)((0,d.AP)("libraryimporter_action_selectaserviceUPP_web"),!0)))))},Lt={apps:"apps",countrySelector:"country_selector",devices:"devices",display:"display",home:"home",notifications:"notifications",settings:"settings",share:"share",libraryTransfer:"transfer"},Rt=[Lt.share,Lt.devices,Lt.apps,Lt.countrySelector,Lt.home];var Mt,Ot,Ut,Ft,qt;class zt extends s.Component{constructor(e){super(e),this._onTabClick=this._onTabClick.bind(this)}render(){return s.createElement("div",{id:"page_account"},s.createElement(h.A,{items:this._getTabList(),active:this.props.tab}),this._renderTabContent())}_renderTabContent(){const{data:e,isFetching:t,tab:n}=this.props;if(t)return Mt||(Mt=s.createElement(m.A,null));switch(n){case Lt.countrySelector:return s.createElement(Tt,{data:e});case Lt.devices:return s.createElement(Ke,{data:e});case Lt.display:return Ot||(Ot=s.createElement(wt,null));case Lt.home:return s.createElement(Ne,{data:e});case Lt.notifications:return s.createElement(Ct,{data:e});case Lt.share:return s.createElement(Re,{data:e});case Lt.settings:return Ut||(Ut=s.createElement(ft,null));case Lt.libraryTransfer:return Ft||(Ft=s.createElement(It,null));default:return qt||(qt=s.createElement(g.A,null))}}_onTabClick(e){if(e.id===Lt.apps)window.open(`https://${u.default.get("host_account")}/apps/`,"_blank");else{const t=e.id===Lt.home?"":"/"+e.id;this.props.history.push("/account"+t)}}_getTabList(){const{userIsKid:e,userOptins:t}=this.props;return[{id:Lt.home,label:(0,d.AP)("Mes informations"),action:this._onTabClick},{id:Lt.notifications,label:(0,d.AP)("optinpreferences_title_notificationpreferences_web"),action:this._onTabClick,disabled:0===t.channel.length||0===t.optin.length},{id:Lt.devices,label:(0,d.AP)("Mes appareils connectés"),action:this._onTabClick},{id:Lt.apps,label:(0,d.AP)("Mes Applications"),action:this._onTabClick,disabled:!0},{id:Lt.display,label:(0,d.AP)("settingspage_title_displaysettings_web"),action:this._onTabClick,disabled:!0},{id:Lt.settings,label:(0,d.AP)("Paramètres de l'application"),action:this._onTabClick,disabled:!1},{id:Lt.share,label:(0,d.AP)("optinpreferences_title_sharingpreferences_web"),action:this._onTabClick},{id:Lt.countrySelector,label:(0,d.AP)("countryselector_title_countryselector_web"),action:this._onTabClick},{id:Lt.libraryTransfer,label:(0,d.AP)("libraryimporter_title_transferyourfavorites_web"),action:this._onTabClick,disabled:e}]}}zt.defaultProps={data:null};const Bt=(0,c.y)((0,l.Ng)(e=>({userIsKid:(0,p.zI)(e.user),userOptins:e.user.USER.OPTINS}))(zt));var Vt,jt;let Gt=(0,o.Ay)({event:"updatepage",pagename:"account_management",pagecategory:"account_management"})(((jt=class extends s.Component{constructor(e){super(e),this.state={isFetching:!1,data:e.appState||null,error:null,tab:e.match.params.tab||Lt.home}}static getDerivedStateFromProps(e,t){const n=e.match.params.tab||Lt.home;return n!==t.tab?{data:null,tab:n}:null}componentDidMount(){this.state.data||this._fetchData(this.state.tab)}componentDidUpdate(){this.state.data||this.state.isFetching||this._fetchData(this.state.tab)}componentWillUnmount(){i.A.cancel(this._fetchPageApiRef)}render(){const{data:e,error:t,isFetching:n,tab:a}=this.state;if(t)throw t;return s.createElement(Bt,{data:e,tab:a,isFetching:null===e||n})}_fetchData(e){this._isTabAllowed(e)&&(Rt.includes(e)?(this.setState({isFetching:!0}),this._fetchPageApiRef=i.A.call({method:"deezer.pageAccount",data:{tab:e},success:e=>{this.setState({isFetching:!1,data:e})},error:e=>{this.setState({isFetching:!1,error:e})}})):this.setState({data:{}}))}_isTabAllowed(e){return Object.values(Lt).includes(e)}}).displayName="account",jt.defaultProps={appState:null},Vt=jt))||Vt},DLZI:(e,t,n)=>{n.d(t,{A:()=>l});var a=n("/0+J"),r=n("MVPB"),s=n("4OMY"),i=(0,s.A)("api"),o=(0,s.A)("env");class l{constructor(e,t){Object.defineProperty(this,i,{writable:!0,value:void 0}),Object.defineProperty(this,o,{writable:!0,value:void 0}),this.facebook=void 0,this.google=void 0,this.apple=void 0,(0,r.A)(this,i)[i]=e,(0,r.A)(this,o)[o]=t}init(e,t){var s=this;return(0,a.A)(function*(){const l=[];return(e=Array.isArray(e)?e:[e]).forEach(e=>{switch(e){case"facebook":const e=function(){var e=(0,a.A)(function*(){const{FacebookAuth:e}=yield n.e(3537).then(n.bind(n,"T53H"));s.facebook||(s.facebook=new e((0,r.A)(s,i)[i],null==t?void 0:t.facebook)),yield s.facebook.init({env:(0,r.A)(s,o)[o]})});return function(){return e.apply(this,arguments)}}();l.push(e());break;case"google":const c=function(){var e=(0,a.A)(function*(){const{GoogleAuth:e}=yield n.e(5404).then(n.bind(n,"JtTf"));s.google||(s.google=new e((0,r.A)(s,i)[i],null==t?void 0:t.google)),yield s.google.init({})});return function(){return e.apply(this,arguments)}}();l.push(c());break;case"apple":const d=function(){var e=(0,a.A)(function*(){const{AppleAuth:e}=yield n.e(9133).then(n.bind(n,"ALjf"));s.apple||(s.apple=new e((0,r.A)(s,i)[i],null==t?void 0:t.apple)),yield s.apple.init({})});return function(){return e.apply(this,arguments)}}();l.push(d());break;default:return}}),Promise.allSettled(l)})()}}},FSqQ:(e,t,n)=>{n.d(t,{A:()=>i});var a,r=n("q1tI"),s=n("juqV");class i extends r.Component{render(){const{className:e}=this.props;let t=(0,s.A)("loader-container",e);return r.createElement("div",{className:t,"data-testid":"loader"},a||(a=r.createElement("div",{className:"loader animate-spin"})))}}},G3sm:(e,t,n)=>{n.d(t,{e:()=>i});var a=n("nKUr"),r=n("80JK");function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const i=(0,n("xi32").R)((e,t)=>(0,a.jsx)(r.eK,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){s(e,t,n[t])})}return e}({color:"text.neutral.secondary.default",ref:t},e)))},Jpjb:(e,t,n)=>{n.d(t,{A:()=>_}),n("/eM8");var a=n("WLHJ"),r=n("p1TQ"),s=n("PbG0");const i=e=>({method:a.K.GOOGLE,...e});var o=n("WrS5"),l=n("TqF5"),c=n("WKgy"),d=n("rVxF"),u=n("dgkV"),p=n("IZLt");const m=(0,r.e7)("google"),h=()=>{if(!m.google)throw new Error("LegacyAuth - Google not found, have you called init with google as a param?");return m.google},g=async()=>{try{const e=await h().unlinkAccount();(0,r.s5)(e)}catch(t){var e;const n=t;(0,r.kL)(n,i({intent:s.d6.Link})),new p.A({error:null!==(e=n.message)&&void 0!==e?e:n.name,journey_type:"unlink-google",gateway_method:"google.unlinkAccount",server_payload:n}).send()}},_={login:async(e,t)=>{try{const t=await h().signin(e);(0,r.oj)(t,{redirect:(0,r.Ae)(null==e?void 0:e.redirect),method:s.qR.Google})}catch(o){var n,a;if((0,d.O)(o))new u.A({error:null!==(n=o.message)&&void 0!==n?n:null===(a=o.payload)||void 0===a?void 0:a.status,journey_type:"google",error_message:o.message,gateway_method:"google.auth"}).send(),(0,r.kL)(new d.A(o),i({intent:s.d6.Login,redirect:null==e?void 0:e.redirect}));null==t||t(o)}},signup:async(e,t)=>{try{const t=await h().signin(e);(0,r.oj)(t,{redirect:(0,r.Ae)(null==e?void 0:e.redirect),method:s.qR.Google})}catch(o){var n,a;if((0,d.O)(o))new u.A({error:null!==(n=null===(a=o.payload)||void 0===a?void 0:a.status)&&void 0!==n?n:o.name,journey_type:"google",error_message:o.message,gateway_method:"google.auth"}).send(),(0,r.kL)(new d.A(o),i({intent:s.d6.Login,redirect:null==e?void 0:e.redirect}));null==t||t(o)}},linkAccount:async e=>{try{const t=await h().linkAccount(e);(0,r.V7)(t,null==e?void 0:e.profile_migration)}catch(o){var t,n,a;if((0,d.O)(o))(0,r.kL)(new d.A(o),i({intent:s.d6.Link})),new p.A({error:null!==(t=null!==(n=null===(a=o.payload)||void 0===a?void 0:a.status)&&void 0!==n?n:o.message)&&void 0!==t?t:o.name,journey_type:null!=e&&e.profile_migration?"family-convert-independent":"link-google",gateway_method:"google.linkAccount",server_payload:o}).send()}},unlinkAccount:()=>{c.A.dispatch((0,l.qf)({name:o.b.THIRD_PARTY_CONFIRM_UNLINK,size:"small",props:{method:a.K.GOOGLE,confirmCallback:g}}))}}},MTsA:(e,t,n)=>{n.d(t,{A:()=>m});var a,r,s=n("q1tI"),i=n("juqV"),o=n("Wp0Y"),l=n("H/eQ"),c=n("yCtO"),d=n("GPus"),u=n("pVdW");class p extends s.Component{constructor(e){super(e),this._onClickOutsideDropDown=e=>{this._navbarLinks.contains(e.target)||(this.setState({isOpenDropDown:!1}),document.removeEventListener("click",this._onClickOutsideDropDown))},this._onResize=this._onResize.bind(this),this._onToggleDropDown=this._onToggleDropDown.bind(this),this.state={items:e.items,lastVisibleElementIndex:1/0,isOpenDropDown:!1}}componentDidMount(){this._getTabWidth(),l.A.subscribe(l.A.layout.resize,this._onResize),l.A.subscribe(l.A.layout.adsBackground,this._onResize),l.A.trigger(l.A.navigation.tab_displayed,{type:this.props.active})}UNSAFE_componentWillReceiveProps(e){this.setState({lastVisibleElementIndex:1/0,items:e.items},this._getTabWidth)}componentWillUnmount(){l.A.unsubscribe(l.A.layout.resize,this._onResize),l.A.unsubscribe(l.A.layout.adsBackground,this._onResize)}render(){const e=(0,i.A)({navbar:!0,"navbar-center":"center"===this.props.align});return s.createElement("nav",{className:e},s.createElement("div",{style:this.props.style,className:"container"},s.createElement("ul",{className:"navbar-nav",ref:e=>this._navbarLinks=e,role:"tablist"},this._renderList())))}_renderList(){const e=[],{items:t,lastVisibleElementIndex:n}=this.state;for(let a=0,r=t.length;a<r;a++)if(!t[a].disabled){if(!(a<n)){e.push(this._renderViewMore(a));break}e.push(this._renderItem(a))}return e}_renderItem(e,t=!1){const{active:n,textSize:a}=this.props,r=this.state.items[e],o=(0,i.A)({"navbar-item":!t,"dropdown-item":t,active:n===r.id}),l=r.isButton&&n!==r.id,c=(0,i.A)({"navbar-link":!t,"navbar-button":l}),d=n===r.id?void 0:this._onItemClick.bind(this,r);return s.createElement("li",{key:r.id,className:o},s.createElement(u.E,{as:"a",color:l?"text.accent.onAccent.default":"text.neutral.secondary.default",fontWeight:n===r.id?"semibold":"normal",_hover:{color:l?"text.accent.onAccent.default":"text.neutral.secondary.hovered"},className:c,role:"tab",tabIndex:"0","aria-selected":n===r.id,onClick:d,onKeyDown:d,"data-testid":`${r.id}-tab`,variant:{large:"body.l.default",medium:"body.m.default"}[a]},r.label))}_renderViewMore(e){const{isOpenDropDown:t,items:n,lastVisibleElementIndex:l}=this.state,p=(0,i.A)("navbar-item","navbar-dropdown",{"dropdown-active":t}),m=[];for(let t=e,a=n.length;t<a;t++)n[t].disabled||m.push(this._renderItem(t,!0));return s.createElement("li",{className:p,key:"viewmore_"+l},s.createElement(u.E,{as:"button",color:"text.neutral.secondary.default",_hover:{color:"text.neutral.secondary.hovered"},className:"navbar-link",type:"button","data-testid":"more_button",onClick:this._onToggleDropDown},(0,o.AP)("Plus"),t?a||(a=s.createElement(d.o,{marginStart:"5px",marginTop:"3px"})):r||(r=s.createElement(c.e,{marginStart:"5px",marginTop:"3px"}))),s.createElement("ul",{className:"dropdown-menu is-right"},m))}_onToggleDropDown(e){if(e.stopPropagation(),void 0!==e.keyCode&&13!==e.keyCode)return;const t=!this.state.isOpenDropDown;this.setState({isOpenDropDown:t}),t&&document.addEventListener("click",this._onClickOutsideDropDown,{once:!0,capture:!0})}_onItemClick(e,t){void 0!==t.keyCode&&13!==t.keyCode||(e.action&&e.action(e),this.setState({isOpenDropDown:!1}),l.A.trigger(l.A.navigation.tab_displayed,{type:e.id}))}_onResize(){let e=1/0,t=0,n=0;const a=this._navbarLinks.offsetWidth,r=this._linksWidth.entries();for(const[s,i]of r){if(t+=i,t>a){e=n;break}n=s}this.state.lastVisibleElementIndex!==e&&this.setState({lastVisibleElementIndex:e})}_getTabWidth(){this._linksWidth=[],Array.from(this._navbarLinks.childNodes).forEach((e,t)=>{this._linksWidth[t]=e.getBoundingClientRect().width}),this._onResize()}}p.defaultProps={align:"left",textSize:"large"};const m=p},PBDT:(e,t,n)=>{n.d(t,{o:()=>i});var a=n("nKUr"),r=n("IRKz"),s=n("xi32");const i=(0,r.B)("div",{baseStyle:{display:"flex",alignItems:"center",justifyContent:"center"}});i.displayName="Center";const o={horizontal:{insetStart:"50%",transform:"translateX(-50%)"},vertical:{top:"50%",transform:"translateY(-50%)"},both:{insetStart:"50%",top:"50%",transform:"translate(-50%, -50%)"}};(0,s.R)(function(e,t){const{axis:n="both",...s}=e;return(0,a.jsx)(r.B.div,{ref:t,__css:o[n],...s,position:"absolute"})})},XuBo:(e,t,n)=>{n.d(t,{cx:()=>a});const a=(...e)=>e.filter(Boolean).join(" ")},ZDlI:(e,t,n)=>{n.d(t,{m:()=>c});var a=n("nKUr"),r=n("p1Zg"),s=n("8EFB"),i=n("xi32"),o=n("JFGw"),l=n("IRKz");const c=(0,i.R)(function(e,t){const{className:n,centerContent:i,...c}=(0,r.M)(e),d=(0,o.V)("Container",e);return(0,a.jsx)(l.B.div,{ref:t,className:(0,s.cx)("chakra-container",n),...c,__css:{...d,...i&&{display:"flex",flexDirection:"column",alignItems:"center"}}})});c.displayName="Container"},ZOeD:(e,t,n)=>{n.d(t,{V:()=>o}),n("/eM8");var a,r=n("Vd8Q");n("EV0h"),n("gS5K");const s={Spotify:"https://open.spotify.com/track/",Apple:`https://music.apple.com/${null!==(a=function(){if("undefined"==typeof window)return null;const e=window.location.href;return new URL(e).pathname.split("/")[1]||null}())&&void 0!==a?a:"en"}/song/`,YouTubeMusic:"https://music.youtube.com/watch?v="},i=`//${r.default.get("host_website_ssl")}/profile/me`;class o{constructor(){this.token=""}async v1(e){const t={...e};this.token&&(t.deezer_access_token=this.token);const n=await fetch("https://www.tunemymusic.com/api/AuthenticateUser.php",{method:"POST",cache:"default",body:JSON.stringify(t)}).catch(e=>{throw e});if(!n.ok||200!==n.status)throw new Error("TMM: response error");return n.json()}async v2(e,t){const n=await fetch("https://api.tunemymusic.com/v2/api"+e,{headers:{"Content-Type":"application/json"},method:"POST",cache:"default",body:JSON.stringify({...t})});if(!n.ok||200!==n.status)throw new Error("TMM: response error");return n.json()}setToken(e){this.token=e}async getLibraryTransferUrl(e,t,n){return this.v1({deezer_user_id:e,deezer_user_name:t,deezer_redirect_url:n?"deezer://reload":i})}async findTrack(e){var t;const n={...e,region:"Apple"===e.platform?null===(t=e.region)||void 0===t?void 0:t.toUpperCase():void 0},a=await this.v2("/FindTrack",n);return"not found"===a.result?Promise.reject(new Error("Track not found")):{...a,url:(r=e.platform,i=a.trackId,s[r]+i)};var r,i}}},bDF2:(e,t,n)=>{n.d(t,{bg:()=>s,R2:()=>o,Fj:()=>i});var a=n("+9dH");let r=function(e){return e.CLICK="click",e.PAGE="updatepage",e}({});function s(){var e,t,n;return(e=window).dataLayer||(e.dataLayer=[]),null!=(t=null==(n=window.dataLayer.findLast(e=>e.pagename))?void 0:n.pagename)?t:null}function i(e){var t;Object.keys(e).length&&((t=window).dataLayer||(t.dataLayer=[]),window.dataLayer.push(e))}function o(e){if(void 0===(t=e).eventcategory||void 0===t.eventaction)throw new Error("The following fields are missing or undefined: eventcategory, eventaction");var t;i((0,a.A)({event:r.CLICK},e))}},i6DM:(e,t,n)=>{n.d(t,{KI:()=>u,Kl:()=>o,rS:()=>d}),n("/eM8"),n("EV0h"),n("gS5K");var a=n("nrKQ"),r=n("Wp0Y"),s=n("fkXJ");const i=new(n("ZOeD").V),o=async(e,t,n=!1)=>{const r=await a.A.callAsync({method:"libraryimport.getTMMAccessToken",data:{}}).catch(e=>{throw e});i.setToken(r);const s=await i.getLibraryTransferUrl(e,t,n);try{const e=new URL(s.migration_url);return e.searchParams.append("mode","deezer"),e.href}catch(e){throw new Error("TMM: migration url not valid")}},l={apple:"apple-music",youtubemusic:"youtube-music"},c={ww:"/en",ar:"/ar",cs:"/cs",es:"/es",mx:"/es",fr:"/fr",da:"/da",de:"/de",nl:"/nl",hu:"/hu",ja:"/jp",it:"/it",pl:"/pl",pt:"/pt",br:"/pt",ro:"/ro",sv:"/sv",tr:"/tr"},d=(e,t)=>{var n,a;const r=null!==(n=c[t])&&void 0!==n?n:c.ww,s=new URL(`https://www.tunemymusic.com${r}/export?mode=shaker`);return s.searchParams.set("fdest",null!==(a=l[e.toLowerCase()])&&void 0!==a?a:e.toLowerCase()),s},u=()=>{(0,s.A)({body:(0,r.AP)("libraryimporterdismiss_text_transferstillavailableinsettings_web")}),a.A.callAsync({method:"libraryimport.flagTMMAsDismissed"}).catch(e=>{throw e})}},y8BT:(e,t,n)=>{n.d(t,{A:()=>u});var a,r=n("q1tI"),s=n("TRpf"),i=n("GkjM"),o=n("Wp0Y"),l=n("WmA5"),c=n("HmE0");class d extends r.Component{constructor(e){super(e),this._onClick=this._onClick.bind(this)}render(){const{userID:e,userLang:t}=this.props,n=(0,o.AP)("Pour profiter du meilleur de Deezer, jetez un œil à nos <a %1$s>Univers</a> ou à <a %2$s>vos Coups de cœur</a>.",{sprintf:[`href="/${t}/channels/explore"`,`href="/${t}/profile/${e}/loved"`]});return r.createElement("div",{className:"naboo-not-found"},a||(a=r.createElement("div",{className:"title"},"404")),r.createElement("div",{className:"unavailable"},(0,o.AP)("Désolé, nous ne trouvons pas la page que vous recherchez")),r.createElement("div",{className:"description",dangerouslySetInnerHTML:{__html:n},onClick:this._onClick}),r.createElement(c.$n,{as:i.A,to:`/${this.props.userLang}/`},(0,o.AP)("Explorer")))}_onClick(e){const t=e.target;"a"===t.tagName.toLowerCase()&&(l.A.replace(t.getAttribute("href")),e.preventDefault())}}const u=(0,s.Ng)(({user:e})=>({userID:e.id,userLang:e.SETTING_LANG}))(d)}}]);