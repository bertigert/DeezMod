"use strict";(self.webpackJsonpDeezer=self.webpackJsonpDeezer||[]).push([[4822],{MG7B:(t,e,s)=>{function i(t){const e=document.createElement("div");return e.textContent=t,e.innerHTML}s.d(e,{A:()=>i})},PBDT:(t,e,s)=>{s.d(e,{o:()=>a});var i=s("nKUr"),r=s("IRKz"),n=s("xi32");const a=(0,r.B)("div",{baseStyle:{display:"flex",alignItems:"center",justifyContent:"center"}});a.displayName="Center";const o={horizontal:{insetStart:"50%",transform:"translateX(-50%)"},vertical:{top:"50%",transform:"translateY(-50%)"},both:{insetStart:"50%",top:"50%",transform:"translate(-50%, -50%)"}};(0,n.R)(function(t,e){const{axis:s="both",...n}=t;return(0,i.jsx)(r.B.div,{ref:e,__css:o[s],...n,position:"absolute"})})},R3ky:(t,e,s)=>{s.r(e),s.d(e,{default:()=>pt});var i=s("q1tI"),r=s("TRpf"),n=s("Wp0Y"),a=s("WmA5"),o=s("aHAS"),c=s("2+nF"),l=s("YG/N"),d=s("GkjM"),p=s("X6oL"),h=s("nKUr");const m=(0,s("QSQl").w)({displayName:"ThumbUpIcon",viewBox:"0 0 24 24",pathSmall:[(0,h.jsx)("path",{clipRule:"evenodd",d:"m18.8092 19.63s-4.2727.28-7.0244.35c-1.4108.03-3.39207.02-4.45273.01l-3.33207-.01v-10.93h2.59161s.30019.01.74046-.03c.39024-.04.89055-.12 1.40087-.29 1.14071-.38 1.95126-2.04 2.46156-3.4.2901-.78 1.0206-1.33 1.8511-1.33 1.1808 0 2.0813 1.04 1.9112 2.21l-.4102 2.84 4.2526.37s1.2007.04 1.2007 5.13c.01 5.09-1.1907 5.08-1.1907 5.08zm-12.17757-9.25c-.02001 0-.04002 0-.05003 0h-1.25077v8.27h1.34083v-8.28c-.01001.01-.03002.01-.04003.01zm11.59717.32-5.1932-.45.6104-4.23c.05-.36-.2302-.69-.5904-.69-.2401 0-.5003.16-.6204.47-.2701.71-.6304 1.57-1.1207 2.32-.4602.71-1.1607 1.54-2.1613 1.87-.42026.14-.8005.21-1.15071.27v8.4c1.09067.01 2.61161.01 3.75231-.01 1.3509-.03 3.0919-.12 4.4928-.2.7004-.04 1.3208-.08 1.7611-.1.0801-.01.1601-.01.2301-.01.1802-.44.4303-1.49.4303-3.79.01-2.35-.2601-3.42-.4403-3.85z",fillRule:"evenodd"})],pathMedium:[(0,h.jsx)("path",{clipRule:"evenodd",d:"m21.3408 22.49s-5.8674.39-9.6457.48c-2.78869.07-7.13672 0-7.13672 0h-3.55838v-15.03h3.56838s1.42935.06 2.92867-.44c1.56928-.52 2.67875-2.81 3.37845-4.67.3998-1.08 1.4094-1.83 2.5588-1.83 1.6193 0 2.8587 1.43 2.6289 3.03l-.5598 3.9 5.8473.5s1.6493.06 1.6493 7.06-1.6592 7-1.6592 7zm-16.74244-12.55c-.01999 0-.04997 0-.05997 0h-1.5393v11.03h1.78919.17992v-11.04c-.03999 0-.08996 0-.12994 0-.09996.01-.17992.01-.2399.01zm15.83284.43-7.2168-.62.8697-6c.0599-.39-.2499-.75-.6498-.75-.2498 0-.5497.17-.6896.53-.3699.99-.8796 2.17-1.5493 3.22-.6397.99-1.6193 2.17-3.05864 2.65-.39982.13-.78964.23-1.15948.31v11.28h.12994c1.41936.01 3.17858.01 4.53798-.02 1.8491-.04 4.238-.16 6.1672-.27.9695-.05 1.8091-.11 2.4189-.14.0699 0 .1399-.01.2099-.01.2399-.63.5497-2.07.5497-5.05 0-3.05-.3298-4.51-.5597-5.13z",fillRule:"evenodd"})]});m.defaultProps={fill:"currentColor",boxSize:"24px",display:"block","data-testid":"ThumbUpIcon"};var u,A,g=s("CdHq"),S=s("PBDT");let f=(0,p.Ay)({pagename:"onboarding",pagecategory:"onboarding-artists",virtualpageurl:"/onboarding-completed",event:"virtualpageview"},{dispatchOnMount:!0})(u=class extends i.Component{render(){return i.createElement(g.s,{direction:"column",alignItems:"center"},i.createElement(l.A.Header,{mt:"O",pt:"45px"},(0,n.AP)("Splendide !")),A||(A=i.createElement(S.o,{bg:"background.accent.primary.default",borderRadius:"full",w:"200px",h:"200px",padding:"35px 0"},i.createElement(m,{size:"medium",color:"icon.accent.onDark.default"}))))}})||u;var b=s("RGaU"),E=s("HmE0"),v=s("ZDlI"),x=s("eOc8"),L=s("y7xR"),_=s("pVdW"),y=s("TDRX"),T=s("nrKQ");const R=(t,e)=>t.map(t=>({id:t.ART_ID,name:t.ART_NAME,image:t.ART_PICTURE||{format:"jpg",type:"artist",md5:"d41d8cd98f00b204e9800998ecf8427e"},isSelected:!1,reference:e})),C=t=>t.id,w=(t,e,s)=>{T.A.call({method:"onboarding.getTopArtists",data:{CONTEXT:t},success:t=>{e(R(t))},error:s})};var I=s("34sk"),k=s("kSUS"),N=s("3o0m"),P=s("Z9kq"),O=s("LjZa"),G=s("ntT5"),z=s("5G9X"),D=s("rXlm"),M=s("MG7B"),B=s("hz5U");const X=({artist:t,onClick:e})=>i.createElement("div",{className:"onboarding-screen-search-item",onClick:e},i.createElement("img",{className:"onboarding-screen-search-item-picture",src:B.A.getImageSrc("artist",t.image.md5,55,55)}),i.createElement("div",{className:"onboarding-screen-search-item-name ellipsis"},t.name));var W,U=s("4liH"),j=s("7E8A");class q extends i.Component{constructor(...t){super(...t),this.state={isOpened:!1,searchResult:[],query:"",searchResultLoaded:!1},this.textInput=i.createRef(),this.popoverElement=i.createRef(),this.focusInput=()=>{this.textInput.current&&this.textInput.current.focus()},this.searchArtist=(0,k.A)(()=>{var t,e,s,i;this.state.query&&(t=this.state.query,e=this.props.context,s=this.setSearchResult,i=O.A,T.A.call({method:"onboarding.searchArtist",data:{QUERY:t,CONTEXT:e},success:t=>{s(R(t.data))},error:i}))},500),this.setSearchResult=t=>{this.setState({searchResult:t,searchResultLoaded:!0,isOpened:!0})},this.clickOutsideSearch=t=>{const e=t.target;null===this.textInput.current||this.textInput.current.contains(e)||e.className.includes("onboarding-screen-search-item")||this.closePopper()},this.closePopper=()=>{this.props.onPopoverOpened(!1),this.setState({isOpened:!1})},this.onArtistSelection=t=>{(0,G.Fw)(this.state.query,"",j.CONTEXT_PAGE_SEARCH_ONBOARDING,U.SA,{...t,type:z.Ay.Artist}),this.closePopper(),this.props.onArtistSelection(t),this.setState({query:"",searchResult:[],isOpened:!1,searchResultLoaded:!1})},this.onInputChange=t=>{const e=Boolean(t.target.value);this.setState({isOpened:e,query:t.target.value,searchResultLoaded:!1}),this.props.onPopoverOpened(e),e||this.closePopper(),this.searchArtist()},this.onWrapperClick=()=>{this.focusInput(),this.props.onPopoverOpened(this.state.searchResultLoaded),this.setState({isOpened:this.state.searchResultLoaded})},this.onCancelClick=()=>{this.props.onPopoverOpened(!1),this.setState({query:"",searchResult:[],isOpened:!1,searchResultLoaded:!1})}}componentDidMount(){document.addEventListener("click",this.clickOutsideSearch,!0)}get resultList(){if(!this.state.searchResultLoaded)return W||(W=i.createElement(b.k,null));if(!this.state.searchResult.length){const t=(0,n.AP)("Aucun résultat pour «<strong>%s</strong>»",{sprintf:[" "+(0,M.A)(this.state.query)+" "]});return i.createElement("div",{className:"onboarding-screen-search-no-results",dangerouslySetInnerHTML:{__html:t}})}return i.createElement(D.A,{className:"onboarding-screen-search-list"},this.state.searchResult.map(t=>i.createElement(X,{key:t.id,artist:t,onClick:this.onArtistSelection.bind(this,t)})))}render(){return i.createElement(g.s,{w:"100%"},i.createElement(P.D,{ref:this.textInput,id:"onBoardingSearchAnchor",className:"onboarding-screen-search-input",type:"text",autoComplete:"off",placeholder:(0,n.AP)("Rechercher"),onChange:this.onInputChange,value:this.state.query,onClick:this.onWrapperClick}),this.state.isOpened&&i.createElement(N.A,{anchorNode:this.textInput.current,className:"onboarding-screen-search-popper"},this.resultList))}}var F=s("+9dH"),H=s("juqV"),K=s("siwx"),V=s("VQs7"),Q=s("AlG7");const Y=242;class Z extends i.Component{constructor(...t){super(...t),this.self=i.createRef(),this.onClick=()=>{this.props.onClick(this.props.id,this.self.current)}}get imageUrl(){const{image:{type:t,md5:e}}=this.props;return B.A.getImageSrc(t,e,Y,Y)}render(){const t=(0,H.A)("onboarding-screen-artist-item",{"onboarding-screen-artist-item--selected":this.props.isSelected});return i.createElement("div",{ref:this.self,className:t,onClick:this.onClick},i.createElement(V.P.div,{layout:!0,transition:{duration:.2}},i.createElement(V.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.2,delay:.1}},i.createElement(y.a,{w:"100%",h:"100%",borderRadius:"rounded",borderColor:this.props.isSelected?"border.accent.primary.default":"transparent",borderWidth:"border.m",borderStyle:"solid",overflow:"hidden",transition:"border-color 0.5s ease",position:"relative",_after:{content:'""',position:"absolute",inset:0,h:"100%",w:"100%",transition:"opacity 0.5s ease",backgroundColor:"background.accent.onLight.default",opacity:this.props.isSelected?.6:0},_hover:{_after:{opacity:.6}}},i.createElement(K._,{loading:"lazy",w:"100%",h:"100%",zIndex:1,src:this.imageUrl,htmlWidth:Y,htmlHeight:Y}),i.createElement(Q.C,{sx:{color:"icon.accent.primary.default",position:"absolute",top:"calc(50% - 25px)",left:"calc(50% - 18px)",boxSize:8,opacity:this.props.isSelected?1:0,transition:"opacity 0.5s ease"}})),i.createElement("div",{className:"onboarding-screen-artist-item-name ellipsis"},this.props.name))))}}const J=Z;var $;const tt=t=>{const[e,s]=(0,i.useState)(!1);if((0,i.useEffect)(()=>{const t=setTimeout(()=>{s(!0)},250);return()=>clearTimeout(t)},[]),!e)return $||($=i.createElement(S.o,null,i.createElement(b.k,null)));const r=t.artists.map(e=>i.createElement(J,(0,F.A)({key:e.id,onClick:t.toggleArtistSelection},e)));return i.createElement(y.a,{className:"onboarding-screen-grid-wrapper",w:"100%"},i.createElement(D.A,{className:"onboarding-screen-grid-scroller"},i.createElement(y.a,{className:"onboarding-screen-grid"},r)))};let et=function(t){return t.Welcome="welcome",t.Improve="improve",t}({});const st=({onSelected:t,context:e})=>{const[s,r]=(0,i.useState)([]),[n,a]=(0,i.useState)();return(0,i.useEffect)(()=>{((t,e,s)=>{T.A.call({method:"onboarding.getTopGenres",data:{CONTEXT:t},success:t=>{(t=>{r(t.map(t=>({...t,isSelected:!1})))})(t.map(t=>({id:t.GENRE_ID,name:t.GENRE_NAME})))},error:s})})(e,0,O.A)},[]),i.createElement(x.B,{direction:"row",spacing:3,align:"center",w:"fit-content",py:"4px"},s.map(e=>{const s=e.id===(null==n?void 0:n.id);return i.createElement(E.$n,{key:e.id,variant:s?"contain":"outline",onClick:()=>(e=>{const s=n&&n.id===e.id?void 0:e;a(s),t(s)})(e),size:"sm",fontWeight:"normal"},e.name)}))};var it,rt,nt=s("xobL"),at=s("g1Fm"),ot={name:"y0dhib",styles:"&::-webkit-scrollbar{display:none;}scrollbar-width:none"};let ct=(0,p.Ay)({pagename:"onboarding",pagecategory:"onboarding-artists",virtualpageurl:"/onboarding-artists",event:"virtualpageview"},{dispatchOnMount:!0})(it=class extends i.Component{constructor(...t){super(...t),this.state={artistList:[],artistListLoaded:!1,finalizing:!1,searchDisplay:!0,popoverOpened:!1,canShowMaxAlert:!0},this.currentGetRelatedCall=void 0,this.selectedArtists={},this.mainListSnapShot=[],this.selectedGenre=void 0,this.addArtistAtTopOfList=t=>{const e=this.state.artistList.filter(e=>t.id!==e.id);this.setState({artistList:this.rebuildArtistList([t,...e])})},this.addRelatedArtistsToList=(t,e)=>{const s=[...this.state.artistList],i=s.findIndex(e=>t.id===e.id)+1;s.splice(i,0,...e),this.setState({artistList:this.rebuildArtistList(s)})},this.toggleArtist=(t,e)=>{if(this.selectedArtists[t])delete this.selectedArtists[t];else{if(!this._maxArtistSelectionSafeGuard())return;this.selectedArtists[t]=!0}const s=this.rebuildArtistList(this.state.artistList);this.setState({artistList:s});const i=s.find(e=>e.id===t&&e.isSelected);i&&this.getRelatedArtistsAndAddTolist({...i,reference:e})},this.onGenreSelected=t=>{this.setState({artistListLoaded:!1},()=>{if(t)void 0===this.selectedGenre&&(this.mainListSnapShot=this.state.artistList),this.selectedGenre=t,e=t.id,s=this.props.context,i=t=>this.setState({artistList:this.rebuildArtistList(t),artistListLoaded:!0}),r=O.A,T.A.call({method:"onboarding.getTopArtistsByGenre",data:{GENRE_ID:e,CONTEXT:s},success:t=>{i(R(t))},error:r});else{if(this.selectedGenre=void 0,this.mainListSnapShot)return void this.setState({artistList:this.rebuildArtistList(this.mainListSnapShot),artistListLoaded:!0});w(this.props.context,t=>this.setState({artistList:this.rebuildArtistList(t),artistListLoaded:!0}),O.A)}var e,s,i,r})},this.getRelatedArtistsAndAddTolist=t=>{var e,s,i,r,n,a;this.currentGetRelatedCall=(e=t,s=this.state.artistList,i=this.props.context,r=this.addRelatedArtistsToList,n=O.A,(a=this.currentGetRelatedCall)&&T.A.cancel(a),T.A.call({method:"onboarding.getRelatedArtists",data:{ART_ID:e.id,CONTEXT:i,EXCLUDED_ARTISTS:s.map(C)},success:t=>{r(e,R(t,e.reference))},error:n}))},this.onCompleted=()=>{if(this.setState({finalizing:!0}),this.props.context===et.Improve){const t=(0,nt.mI)({SERVER_TIMESTAMP:this.props.serverTimestamp,clientTimestampDelta:this.props.clientTimestampDelta});this.props.addMultipleFavoritesAction(this.selectedArtistList,z.Ay.Artist,t,{},!1)}var t,e,s,i;t=this.selectedArtistList,e=this.props.context,s=()=>this.props.finishStep(),i=O.A,T.A.call({method:"onboarding.setArtists",data:{CONTEXT:e,SELECTED_ARTISTS:t},success:()=>{s()},error:i})},this.onSearchSelected=t=>{this._maxArtistSelectionSafeGuard()&&(this.selectedArtists[t.id]=!0,this.mainListSnapShot=[t,...this.mainListSnapShot.filter(e=>e.id!==t.id)],this.addArtistAtTopOfList({...t,isSelected:!0}),this.getRelatedArtistsAndAddTolist(t))},this.onPopoverOpened=t=>{this.setState({popoverOpened:t})}}componentDidMount(){w(this.props.context,t=>this.setState({artistList:t,artistListLoaded:!0}),O.A)}get selectedArtistList(){return Object.keys(this.selectedArtists)}get artistGrid(){return this.state.artistListLoaded?i.createElement(tt,{artists:this.state.artistList,toggleArtistSelection:this.toggleArtist}):rt||(rt=i.createElement("div",{className:"onboarding-screen-artists-loader"},i.createElement(b.k,null)))}get isSelectionCompleted(){return this.selectedArtistList.length>=this.props.minArtistsToSelect}get nextButton(){let t,e=!0;const s=this.selectedArtistList.length;return 0===this.props.minArtistsToSelect?(t=(0,at.A)((0,n.AP)("TERMINER"),!0),e=!1):s?s<this.props.minArtistsToSelect?t=(0,n.WI)("artistselectionoptimization_action_chooseXmoreartistsUPP_web","artistselectionoptimization_action_chooseXmoreartistsUPP_web",{sprintf:[this.props.minArtistsToSelect-s],count:this.props.minArtistsToSelect-s}):(t=(0,n.WI)("artistselectionoptimization_action_continuewithXartistsUPP_web","artistselectionoptimization_action_continuewithXartistsUPP_web",{sprintf:[s],count:s}),e=!1):t=(0,n.WI)("artistselectionoptimization_action_chooseatleastXartistsUPP_web","artistselectionoptimization_action_chooseatleastXartistsUPP_web",{sprintf:[this.props.minArtistsToSelect],count:this.props.minArtistsToSelect}),i.createElement(E.$n,{isDisabled:e,onClick:this.onCompleted},t)}showMaxAlert(){this.state.canShowMaxAlert&&alert((0,n.AP)("errormessage_title_maximumreached_web")+"\n"+(0,n.AP)("errormessage_text_maxnberartistreachedforthisstage_web")+"\n"+(0,n.AP)("errormessage_text_dontworrycanaddmorelater_web"))}rebuildArtistList(t){return t.map(t=>({...t,isSelected:Boolean(this.selectedArtists[t.id])}))}_maxArtistSelectionSafeGuard(){return!(this.selectedArtistList.length>=this.props.maxArtistsToSelect&&(this.showMaxAlert(),1))}render(){const t=et.Welcome;return i.createElement(i.Fragment,null,i.createElement(g.s,{w:"100%",alignItems:"center",justifyContent:"center"},i.createElement(v.m,{maxW:"800px"},i.createElement(x.B,{direction:"column",spacing:"4",textAlign:"center"},i.createElement(L.D,{as:"h1",fontSize:"30px",className:"onboarding-screen-artists-header"},t?(0,n.AP)("onboardingartistpicker_title_createyourcrew_web"):(0,at.A)((0,n.AP)("artistselectionoptimization_action_chooseartistUPP_web"),!0)),i.createElement(_.E,{fontSize:"14px"},t?(0,n.WI)("onboardingartistpicker_text_pickatleastXartistsforbetterreco_web","onboardingartistpicker_text_pickatleastXartistsforbetterreco_web",{sprintf:[this.props.minArtistsToSelect],count:this.props.minArtistsToSelect}):(0,n.AP)("onboardingartistpicker_text_improverecoselectfavartists_web")),i.createElement(q,{onArtistSelection:this.onSearchSelected,onPopoverOpened:this.onPopoverOpened,context:this.props.context})))),i.createElement(g.s,{w:"100%",alignItems:"center",justifyContent:{base:"flex-start",md:"center"},overflow:"auto",css:ot},this.props.showGenreFilter&&i.createElement(st,{onSelected:this.onGenreSelected.bind(this),context:this.props.context})),i.createElement(y.a,{w:"100%",id:"artist-grid",flex:"1"},i.createElement(v.m,{maxW:"1400px",display:"flex",alignItems:"center",justifyContent:"center",h:"100%"},this.artistGrid)),i.createElement(g.s,{w:"100%",alignItems:"center",justifyContent:"center"},i.createElement(v.m,{maxW:"800px",display:"flex",alignItems:"center",justifyContent:"center",mb:"6",className:"onboarding-block-footer"},this.nextButton)))}})||it;const lt=(0,r.Ng)(({user:t})=>({clientTimestampDelta:(0,nt.gE)(t),serverTimestamp:(0,nt.mS)(t)}),{addMultipleFavoritesAction:I.jo})(ct);var dt;const pt=({closeScreen:t,showGenreFilter:e=!1,showCloseButton:s=!1,context:p=et.Welcome,onBoardingMinSelection:h=10,maxSelection:m=500,callbackLink:u="/"})=>{const[A,g]=(0,i.useState)(!1),S=(0,r.wA)();return i.createElement(x.B,{direction:"column",spacing:"6",h:"100vh",w:"100vw",position:"absolute",top:"0",left:"0",px:"4",py:"6"},s?i.createElement(l.A.Close,{customClose:t}):null,A?dt||(dt=i.createElement(f,null)):i.createElement(lt,{context:p,showGenreFilter:e,minArtistsToSelect:p===et.Welcome?h:0,maxArtistsToSelect:m,finishStep:()=>{g(!0),p!==et.Welcome?S((0,o.Sk)(()=>{a.A.replace(u),t()})):(0,c.Cb)()}}),i.createElement(l.A.Footer,null,i.createElement(d.A,{to:"http://support.deezer.com/",target:"_blank",className:"onboarding-screen-help"},(0,n.AP)("Aide"))))}},"YG/N":(t,e,s)=>{s.d(e,{A:()=>A});var i=s("WKgy"),r=s("q1tI"),n=s("juqV");var o=s("TRpf"),c=s("DVo4"),l=s("nxAS");const d=(0,o.Ng)(null,{closeScreen:l.Fn})(({customClose:t,closeScreen:e})=>{const s=t||e;return r.createElement(c.J,{position:"absolute",top:"8px",insetInlineEnd:"8px",size:"lg",onClick:s,zIndex:2})});var h=s("+9dH"),m=s("TDRX");i.A.addReducers({modal:l.Ay});const A={Body:({className:t,children:e})=>{const s=(0,n.A)("full-screen-body",t);return r.createElement("div",{className:s},e)},Close:d,Footer:({className:t,children:e})=>{const s=(0,n.A)("full-screen-footer",t);return r.createElement("div",{className:s},e)},Header:({className:t,children:e,...s})=>{const i=(0,n.A)("full-screen-header",t);return r.createElement(m.a,(0,h.A)({as:"h1",className:i},s),e)}}},ZDlI:(t,e,s)=>{s.d(e,{m:()=>l});var i=s("nKUr"),r=s("p1Zg"),n=s("8EFB"),a=s("xi32"),o=s("JFGw"),c=s("IRKz");const l=(0,a.R)(function(t,e){const{className:s,centerContent:a,...l}=(0,r.M)(t),d=(0,o.V)("Container",t);return(0,i.jsx)(c.B.div,{ref:e,className:(0,n.cx)("chakra-container",s),...l,__css:{...d,...a&&{display:"flex",flexDirection:"column",alignItems:"center"}}})});l.displayName="Container"}}]);