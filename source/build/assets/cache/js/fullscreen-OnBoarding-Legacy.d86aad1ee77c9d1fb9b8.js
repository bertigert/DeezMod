"use strict";(self.webpackJsonpDeezer=self.webpackJsonpDeezer||[]).push([[4822],{MG7B:(e,t,s)=>{function i(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}s.d(t,{A:()=>i})},PBDT:(e,t,s)=>{s.d(t,{o:()=>a});var i=s("nKUr"),r=s("IRKz"),n=s("xi32");const a=(0,r.B)("div",{baseStyle:{display:"flex",alignItems:"center",justifyContent:"center"}});a.displayName="Center";const o={horizontal:{insetStart:"50%",transform:"translateX(-50%)"},vertical:{top:"50%",transform:"translateY(-50%)"},both:{insetStart:"50%",top:"50%",transform:"translate(-50%, -50%)"}};(0,n.R)((function(e,t){const{axis:s="both",...n}=e;return(0,i.jsx)(r.B.div,{ref:t,__css:o[s],...n,position:"absolute"})}))},R3ky:(e,t,s)=>{s.r(t),s.d(t,{default:()=>pe});var i=s("q1tI"),r=s("TRpf"),n=s("Wp0Y"),a=s("WmA5"),o=s("aHAS"),c=s("2+nF"),l=s("YG/N"),d=s("GkjM"),p=s("X6oL"),h=s("nKUr");const m=(0,s("QSQl").w)({displayName:"ThumbUpIcon",viewBox:"0 0 24 24",pathSmall:[(0,h.jsx)("path",{clipRule:"evenodd",d:"m18.8092 19.63s-4.2727.28-7.0244.35c-1.4108.03-3.39207.02-4.45273.01l-3.33207-.01v-10.93h2.59161s.30019.01.74046-.03c.39024-.04.89055-.12 1.40087-.29 1.14071-.38 1.95126-2.04 2.46156-3.4.2901-.78 1.0206-1.33 1.8511-1.33 1.1808 0 2.0813 1.04 1.9112 2.21l-.4102 2.84 4.2526.37s1.2007.04 1.2007 5.13c.01 5.09-1.1907 5.08-1.1907 5.08zm-12.17757-9.25c-.02001 0-.04002 0-.05003 0h-1.25077v8.27h1.34083v-8.28c-.01001.01-.03002.01-.04003.01zm11.59717.32-5.1932-.45.6104-4.23c.05-.36-.2302-.69-.5904-.69-.2401 0-.5003.16-.6204.47-.2701.71-.6304 1.57-1.1207 2.32-.4602.71-1.1607 1.54-2.1613 1.87-.42026.14-.8005.21-1.15071.27v8.4c1.09067.01 2.61161.01 3.75231-.01 1.3509-.03 3.0919-.12 4.4928-.2.7004-.04 1.3208-.08 1.7611-.1.0801-.01.1601-.01.2301-.01.1802-.44.4303-1.49.4303-3.79.01-2.35-.2601-3.42-.4403-3.85z",fillRule:"evenodd"})],pathMedium:[(0,h.jsx)("path",{clipRule:"evenodd",d:"m21.3408 22.49s-5.8674.39-9.6457.48c-2.78869.07-7.13672 0-7.13672 0h-3.55838v-15.03h3.56838s1.42935.06 2.92867-.44c1.56928-.52 2.67875-2.81 3.37845-4.67.3998-1.08 1.4094-1.83 2.5588-1.83 1.6193 0 2.8587 1.43 2.6289 3.03l-.5598 3.9 5.8473.5s1.6493.06 1.6493 7.06-1.6592 7-1.6592 7zm-16.74244-12.55c-.01999 0-.04997 0-.05997 0h-1.5393v11.03h1.78919.17992v-11.04c-.03999 0-.08996 0-.12994 0-.09996.01-.17992.01-.2399.01zm15.83284.43-7.2168-.62.8697-6c.0599-.39-.2499-.75-.6498-.75-.2498 0-.5497.17-.6896.53-.3699.99-.8796 2.17-1.5493 3.22-.6397.99-1.6193 2.17-3.05864 2.65-.39982.13-.78964.23-1.15948.31v11.28h.12994c1.41936.01 3.17858.01 4.53798-.02 1.8491-.04 4.238-.16 6.1672-.27.9695-.05 1.8091-.11 2.4189-.14.0699 0 .1399-.01.2099-.01.2399-.63.5497-2.07.5497-5.05 0-3.05-.3298-4.51-.5597-5.13z",fillRule:"evenodd"})]});m.defaultProps={fill:"currentColor",boxSize:"24px",display:"block","data-testid":"ThumbUpIcon"};var u,A,g=s("CdHq"),S=s("PBDT");let f=(0,p.Ay)({pagename:"onboarding",pagecategory:"onboarding-artists",virtualpageurl:"/onboarding-completed",event:"virtualpageview"},{dispatchOnMount:!0})(u=class extends i.Component{render(){return i.createElement(g.s,{direction:"column",alignItems:"center"},i.createElement(l.A.Header,{mt:"O",pt:"45px"},(0,n.AP)("Splendide !")),A||(A=i.createElement(S.o,{bg:"background.accent.primary.default",borderRadius:"full",w:"200px",h:"200px",padding:"35px 0"},i.createElement(m,{size:"medium",color:"icon.accent.onDark.default"}))))}})||u;var E=s("RGaU"),b=s("HmE0"),v=s("ZDlI"),x=s("eOc8"),L=s("y7xR"),y=s("pVdW"),T=s("TDRX"),R=s("nrKQ");const C=(e,t)=>e.map((e=>({id:e.ART_ID,name:e.ART_NAME,image:e.ART_PICTURE||{format:"jpg",type:"artist",md5:"d41d8cd98f00b204e9800998ecf8427e"},isSelected:!1,reference:t}))),_=e=>e.id,w=(e,t,s)=>{R.A.call({method:"onboarding.getTopArtists",data:{CONTEXT:e},success:e=>{t(C(e))},error:s})};var I=s("34sk"),N=s("kSUS"),k=s("3o0m"),P=s("Z9kq"),O=s("LjZa"),z=s("ntT5"),G=s("5G9X"),D=s("rXlm"),B=s("MG7B"),M=s("hz5U");const U=({artist:e,onClick:t})=>i.createElement("div",{className:"onboarding-screen-search-item",onClick:t},i.createElement("img",{className:"onboarding-screen-search-item-picture",src:M.A.getImageSrc("artist",e.image.md5,55,55)}),i.createElement("div",{className:"onboarding-screen-search-item-name ellipsis"},e.name));var W,X=s("4liH"),j=s("7E8A");class q extends i.Component{constructor(...e){super(...e),this.state={isOpened:!1,searchResult:[],query:"",searchResultLoaded:!1},this.textInput=i.createRef(),this.popoverElement=i.createRef(),this.focusInput=()=>{this.textInput.current&&this.textInput.current.focus()},this.searchArtist=(0,N.A)((()=>{var e,t,s,i;this.state.query&&(e=this.state.query,t=this.props.context,s=this.setSearchResult,i=O.A,R.A.call({method:"onboarding.searchArtist",data:{QUERY:e,CONTEXT:t},success:e=>{s(C(e.data))},error:i}))}),500),this.setSearchResult=e=>{this.setState({searchResult:e,searchResultLoaded:!0,isOpened:!0})},this.clickOutsideSearch=e=>{const t=e.target;null===this.textInput.current||this.textInput.current.contains(t)||t.className.includes("onboarding-screen-search-item")||this.closePopper()},this.closePopper=()=>{this.props.onPopoverOpened(!1),this.setState({isOpened:!1})},this.onArtistSelection=e=>{(0,z.Fw)(this.state.query,"",j.CONTEXT_PAGE_SEARCH_ONBOARDING,X.SA,{...e,type:G.Ay.Artist}),this.closePopper(),this.props.onArtistSelection(e),this.setState({query:"",searchResult:[],isOpened:!1,searchResultLoaded:!1})},this.onInputChange=e=>{const t=Boolean(e.target.value);this.setState({isOpened:t,query:e.target.value,searchResultLoaded:!1}),this.props.onPopoverOpened(t),t||this.closePopper(),this.searchArtist()},this.onWrapperClick=()=>{this.focusInput(),this.props.onPopoverOpened(this.state.searchResultLoaded),this.setState({isOpened:this.state.searchResultLoaded})},this.onCancelClick=()=>{this.props.onPopoverOpened(!1),this.setState({query:"",searchResult:[],isOpened:!1,searchResultLoaded:!1})}}componentDidMount(){document.addEventListener("click",this.clickOutsideSearch,!0)}get resultList(){if(!this.state.searchResultLoaded)return W||(W=i.createElement(E.k,null));if(!this.state.searchResult.length){const e=(0,n.AP)("Aucun résultat pour «<strong>%s</strong>»",{sprintf:[" "+(0,B.A)(this.state.query)+" "]});return i.createElement("div",{className:"onboarding-screen-search-no-results",dangerouslySetInnerHTML:{__html:e}})}return i.createElement(D.A,{className:"onboarding-screen-search-list"},this.state.searchResult.map((e=>i.createElement(U,{key:e.id,artist:e,onClick:this.onArtistSelection.bind(this,e)}))))}render(){return i.createElement(g.s,{w:"100%"},i.createElement(P.D,{ref:this.textInput,id:"onBoardingSearchAnchor",className:"onboarding-screen-search-input",type:"text",autoComplete:"off",placeholder:(0,n.AP)("Rechercher"),onChange:this.onInputChange,value:this.state.query,onClick:this.onWrapperClick}),this.state.isOpened&&i.createElement(k.A,{anchorNode:this.textInput.current,className:"onboarding-screen-search-popper"},this.resultList))}}var F=s("+9dH"),H=s("juqV"),K=s("siwx"),V=s("VQs7"),Q=s("AlG7");const Y=242;class Z extends i.Component{constructor(...e){super(...e),this.self=i.createRef(),this.onClick=()=>{this.props.onClick(this.props.id,this.self.current)}}get imageUrl(){const{image:{type:e,md5:t}}=this.props;return M.A.getImageSrc(e,t,Y,Y)}render(){const e=(0,H.A)("onboarding-screen-artist-item",{"onboarding-screen-artist-item--selected":this.props.isSelected});return i.createElement("div",{ref:this.self,className:e,onClick:this.onClick},i.createElement(V.P.div,{layout:!0,transition:{duration:.2}},i.createElement(V.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.2,delay:.1}},i.createElement(T.a,{w:"100%",h:"100%",borderRadius:"rounded",borderColor:this.props.isSelected?"border.accent.primary.default":"transparent",borderWidth:"border.m",borderStyle:"solid",overflow:"hidden",transition:"border-color 0.5s ease",position:"relative",_after:{content:'""',position:"absolute",inset:0,h:"100%",w:"100%",transition:"opacity 0.5s ease",backgroundColor:"background.accent.onLight.default",opacity:this.props.isSelected?.6:0},_hover:{_after:{opacity:.6}}},i.createElement(K._,{loading:"lazy",w:"100%",h:"100%",zIndex:1,src:this.imageUrl,htmlWidth:Y,htmlHeight:Y}),i.createElement(Q.C,{sx:{color:"icon.accent.primary.default",position:"absolute",top:"calc(50% - 25px)",left:"calc(50% - 18px)",boxSize:8,opacity:this.props.isSelected?1:0,transition:"opacity 0.5s ease"}})),i.createElement("div",{className:"onboarding-screen-artist-item-name ellipsis"},this.props.name))))}}const J=Z;var $;const ee=e=>{const[t,s]=(0,i.useState)(!1);if((0,i.useEffect)((()=>{const e=setTimeout((()=>{s(!0)}),250);return()=>clearTimeout(e)}),[]),!t)return $||($=i.createElement(S.o,null,i.createElement(E.k,null)));const r=e.artists.map((t=>i.createElement(J,(0,F.A)({key:t.id,onClick:e.toggleArtistSelection},t))));return i.createElement(T.a,{className:"onboarding-screen-grid-wrapper",w:"100%"},i.createElement(D.A,{className:"onboarding-screen-grid-scroller"},i.createElement(T.a,{className:"onboarding-screen-grid"},r)))};let te=function(e){return e.Welcome="welcome",e.Improve="improve",e}({});const se=({onSelected:e,context:t})=>{const[s,r]=(0,i.useState)([]),[n,a]=(0,i.useState)();return(0,i.useEffect)((()=>{((e,t,s)=>{R.A.call({method:"onboarding.getTopGenres",data:{CONTEXT:e},success:e=>{(e=>{r(e.map((e=>({...e,isSelected:!1}))))})(e.map((e=>({id:e.GENRE_ID,name:e.GENRE_NAME}))))},error:s})})(t,0,O.A)}),[]),i.createElement(x.B,{direction:"row",spacing:3,align:"center",w:"fit-content",py:"4px"},s.map((t=>{const s=t.id===(null==n?void 0:n.id);return i.createElement(b.$n,{key:t.id,variant:s?"contain":"outline",onClick:()=>(t=>{const s=n&&n.id===t.id?void 0:t;a(s),e(s)})(t),size:"sm",fontWeight:"normal"},t.name)})))};var ie,re,ne=s("xobL"),ae=s("g1Fm"),oe={name:"y0dhib",styles:"&::-webkit-scrollbar{display:none;}scrollbar-width:none"};let ce=(0,p.Ay)({pagename:"onboarding",pagecategory:"onboarding-artists",virtualpageurl:"/onboarding-artists",event:"virtualpageview"},{dispatchOnMount:!0})(ie=class extends i.Component{constructor(...e){super(...e),this.state={artistList:[],artistListLoaded:!1,finalizing:!1,searchDisplay:!0,popoverOpened:!1,canShowMaxAlert:!0},this.currentGetRelatedCall=void 0,this.selectedArtists={},this.mainListSnapShot=[],this.selectedGenre=void 0,this.addArtistAtTopOfList=e=>{const t=this.state.artistList.filter((t=>e.id!==t.id));this.setState({artistList:this.rebuildArtistList([e,...t])})},this.addRelatedArtistsToList=(e,t)=>{const s=[...this.state.artistList],i=s.findIndex((t=>e.id===t.id))+1;s.splice(i,0,...t),this.setState({artistList:this.rebuildArtistList(s)})},this.toggleArtist=(e,t)=>{if(this.selectedArtists[e])delete this.selectedArtists[e];else{if(!this._maxArtistSelectionSafeGuard())return;this.selectedArtists[e]=!0}const s=this.rebuildArtistList(this.state.artistList);this.setState({artistList:s});const i=s.find((t=>t.id===e&&t.isSelected));i&&this.getRelatedArtistsAndAddTolist({...i,reference:t})},this.onGenreSelected=e=>{this.setState({artistListLoaded:!1},(()=>{if(e)void 0===this.selectedGenre&&(this.mainListSnapShot=this.state.artistList),this.selectedGenre=e,t=e.id,s=this.props.context,i=e=>this.setState({artistList:this.rebuildArtistList(e),artistListLoaded:!0}),r=O.A,R.A.call({method:"onboarding.getTopArtistsByGenre",data:{GENRE_ID:t,CONTEXT:s},success:e=>{i(C(e))},error:r});else{if(this.selectedGenre=void 0,this.mainListSnapShot)return void this.setState({artistList:this.rebuildArtistList(this.mainListSnapShot),artistListLoaded:!0});w(this.props.context,(e=>this.setState({artistList:this.rebuildArtistList(e),artistListLoaded:!0})),O.A)}var t,s,i,r}))},this.getRelatedArtistsAndAddTolist=e=>{var t,s,i,r,n,a;this.currentGetRelatedCall=(t=e,s=this.state.artistList,i=this.props.context,r=this.addRelatedArtistsToList,n=O.A,(a=this.currentGetRelatedCall)&&R.A.cancel(a),R.A.call({method:"onboarding.getRelatedArtists",data:{ART_ID:t.id,CONTEXT:i,EXCLUDED_ARTISTS:s.map(_)},success:e=>{r(t,C(e,t.reference))},error:n}))},this.onCompleted=()=>{if(this.setState({finalizing:!0}),this.props.context===te.Improve){const e=(0,ne.mI)({SERVER_TIMESTAMP:this.props.serverTimestamp,clientTimestampDelta:this.props.clientTimestampDelta});this.props.addMultipleFavoritesAction(this.selectedArtistList,G.Ay.Artist,e,{},!1)}var e,t,s,i;e=this.selectedArtistList,t=this.props.context,s=()=>this.props.finishStep(),i=O.A,R.A.call({method:"onboarding.setArtists",data:{CONTEXT:t,SELECTED_ARTISTS:e},success:()=>{s()},error:i})},this.onSearchSelected=e=>{this._maxArtistSelectionSafeGuard()&&(this.selectedArtists[e.id]=!0,this.mainListSnapShot=[e,...this.mainListSnapShot.filter((t=>t.id!==e.id))],this.addArtistAtTopOfList({...e,isSelected:!0}),this.getRelatedArtistsAndAddTolist(e))},this.onPopoverOpened=e=>{this.setState({popoverOpened:e})}}componentDidMount(){w(this.props.context,(e=>this.setState({artistList:e,artistListLoaded:!0})),O.A)}get selectedArtistList(){return Object.keys(this.selectedArtists)}get artistGrid(){return this.state.artistListLoaded?i.createElement(ee,{artists:this.state.artistList,toggleArtistSelection:this.toggleArtist}):re||(re=i.createElement("div",{className:"onboarding-screen-artists-loader"},i.createElement(E.k,null)))}get isSelectionCompleted(){return this.selectedArtistList.length>=this.props.minArtistsToSelect}get nextButton(){let e,t=!0;const s=this.selectedArtistList.length;return 0===this.props.minArtistsToSelect?(e=(0,ae.A)((0,n.AP)("TERMINER"),!0),t=!1):s?s<this.props.minArtistsToSelect?e=(0,n.WI)("artistselectionoptimization_action_chooseXmoreartistsUPP_web","artistselectionoptimization_action_chooseXmoreartistsUPP_web",{sprintf:[this.props.minArtistsToSelect-s],count:this.props.minArtistsToSelect-s}):(e=(0,n.WI)("artistselectionoptimization_action_continuewithXartistsUPP_web","artistselectionoptimization_action_continuewithXartistsUPP_web",{sprintf:[s],count:s}),t=!1):e=(0,n.WI)("artistselectionoptimization_action_chooseatleastXartistsUPP_web","artistselectionoptimization_action_chooseatleastXartistsUPP_web",{sprintf:[this.props.minArtistsToSelect],count:this.props.minArtistsToSelect}),i.createElement(b.$n,{isDisabled:t,onClick:this.onCompleted},e)}showMaxAlert(){this.state.canShowMaxAlert&&alert((0,n.AP)("errormessage_title_maximumreached_web")+"\n"+(0,n.AP)("errormessage_text_maxnberartistreachedforthisstage_web")+"\n"+(0,n.AP)("errormessage_text_dontworrycanaddmorelater_web"))}rebuildArtistList(e){return e.map((e=>({...e,isSelected:Boolean(this.selectedArtists[e.id])})))}_maxArtistSelectionSafeGuard(){return!(this.selectedArtistList.length>=this.props.maxArtistsToSelect&&(this.showMaxAlert(),1))}render(){const e=te.Welcome;return i.createElement(i.Fragment,null,i.createElement(g.s,{w:"100%",alignItems:"center",justifyContent:"center"},i.createElement(v.m,{maxW:"800px"},i.createElement(x.B,{direction:"column",spacing:"4",textAlign:"center"},i.createElement(L.D,{as:"h1",fontSize:"30px",className:"onboarding-screen-artists-header"},e?(0,n.AP)("Bienvenue"):(0,ae.A)((0,n.AP)("artistselectionoptimization_action_chooseartistUPP_web"),!0)),i.createElement(y.E,{fontSize:"14px"},e?(0,n.AP)("artistselectionoptimization_text_chooseartistsformorepersonalizedreco_web"):(0,n.AP)("onboardingartistpicker_text_improverecoselectfavartists_web")),i.createElement(q,{onArtistSelection:this.onSearchSelected,onPopoverOpened:this.onPopoverOpened,context:this.props.context})))),i.createElement(g.s,{w:"100%",alignItems:"center",justifyContent:{base:"flex-start",md:"center"},overflow:"auto",css:oe},this.props.showGenreFilter&&i.createElement(se,{onSelected:this.onGenreSelected.bind(this),context:this.props.context})),i.createElement(T.a,{w:"100%",id:"artist-grid",flex:"1"},i.createElement(v.m,{maxW:"1400px",display:"flex",alignItems:"center",justifyContent:"center",h:"100%"},this.artistGrid)),i.createElement(g.s,{w:"100%",alignItems:"center",justifyContent:"center"},i.createElement(v.m,{maxW:"800px",display:"flex",alignItems:"center",justifyContent:"center",mb:"6",className:"onboarding-block-footer"},this.nextButton)))}})||ie;const le=(0,r.Ng)((({user:e})=>({clientTimestampDelta:(0,ne.gE)(e),serverTimestamp:(0,ne.mS)(e)})),{addMultipleFavoritesAction:I.jo})(ce);var de;const pe=({closeScreen:e,showGenreFilter:t=!1,showCloseButton:s=!1,context:p=te.Welcome,onBoardingMinSelection:h=10,maxSelection:m=500,callbackLink:u="/"})=>{const[A,g]=(0,i.useState)(!1),S=(0,r.wA)();return i.createElement(x.B,{direction:"column",spacing:"6",h:"100vh",w:"100vw",position:"absolute",top:"0",left:"0",px:"4",py:"6"},s?i.createElement(l.A.Close,{customClose:e}):null,A?de||(de=i.createElement(f,null)):i.createElement(le,{context:p,showGenreFilter:t,minArtistsToSelect:p===te.Welcome?h:0,maxArtistsToSelect:m,finishStep:()=>{g(!0),p!==te.Welcome?S((0,o.Sk)((()=>{a.A.replace(u),e()}))):(0,c.Cb)()}}),i.createElement(l.A.Footer,null,i.createElement(d.A,{to:"http://support.deezer.com/",target:"_blank",className:"onboarding-screen-help"},(0,n.AP)("Aide"))))}},"YG/N":(e,t,s)=>{s.d(t,{A:()=>A});var i=s("WKgy"),r=s("q1tI"),n=s("juqV");var o=s("TRpf"),c=s("DVo4"),l=s("nxAS");const d=(0,o.Ng)(null,{closeScreen:l.Fn})((({customClose:e,closeScreen:t})=>{const s=e||t;return r.createElement(c.J,{position:"absolute",top:"8px",insetInlineEnd:"8px",size:"lg",onClick:s,zIndex:2})}));var h=s("+9dH"),m=s("TDRX");i.A.addReducers({modal:l.Ay});const A={Body:({className:e,children:t})=>{const s=(0,n.A)("full-screen-body",e);return r.createElement("div",{className:s},t)},Close:d,Footer:({className:e,children:t})=>{const s=(0,n.A)("full-screen-footer",e);return r.createElement("div",{className:s},t)},Header:({className:e,children:t,...s})=>{const i=(0,n.A)("full-screen-header",e);return r.createElement(m.a,(0,h.A)({as:"h1",className:i},s),t)}}},ZDlI:(e,t,s)=>{s.d(t,{m:()=>l});var i=s("nKUr"),r=s("p1Zg"),n=s("8EFB"),a=s("xi32"),o=s("JFGw"),c=s("IRKz");const l=(0,a.R)((function(e,t){const{className:s,centerContent:a,...l}=(0,r.M)(e),d=(0,o.V)("Container",e);return(0,i.jsx)(c.B.div,{ref:t,className:(0,n.cx)("chakra-container",s),...l,__css:{...d,...a&&{display:"flex",flexDirection:"column",alignItems:"center"}}})}));l.displayName="Container"}}]);