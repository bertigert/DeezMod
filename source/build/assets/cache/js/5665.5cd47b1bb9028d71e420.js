"use strict";(self.webpackJsonpDeezer=self.webpackJsonpDeezer||[]).push([[5665],{"6VLJ":(e,i,t)=>{t.d(i,{B:()=>r,I:()=>s});const r={off:"off",on:"on",force:"force"},s={center:!1,play:r.off,preview:r.off,favorite:r.off,contextMenu:r.off,dislike:r.off}},F3Nm:(e,i,t)=>{t.d(i,{A:()=>V});var r,s,n=t("+9dH"),o=t("q1tI"),a=t("juqV"),d=t("X6oL"),l=t("Ty5D"),c=t("Wp0Y"),_=t("u7vQ"),p=t("nrKQ"),u=t("CxZw"),v=t("H/eQ"),h=t("Vd8Q"),y=t("5G9X"),A=t("hz5U"),w=t("Vynx"),m=t("TYt9"),g=t("h8EF"),P=t("6VLJ"),b=t("M5EV"),f=t("NgX8"),I=t("AfN5"),E=t("HmE0"),T=t("SpbC"),C=t("HQpa");let L=(0,d.Ay)()(((s=class extends o.Component{constructor(e,i){super(e,i),this.state={playing:this._getPlayingStatus(),isHover:!1,previewActive:!1},this._previewTimer=null,this._previewTimeout=500,this._naturalPreviewEnd=!1,this._updateOnAir=this._updateOnAir.bind(this),this._onNaturalPreviewEnd=this._onNaturalPreviewEnd.bind(this),this._onThumbnailClick=this._onThumbnailClick.bind(this),this._onPlay=this._onPlay.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onMouseLeave=this._onMouseLeave.bind(this)}componentDidMount(){v.A.subscribe(v.A.player.finish,this._updateOnAir),v.A.subscribe(v.A.player.playing,this._updateOnAir),v.A.subscribe(v.A.player.finishPreview,this._onNaturalPreviewEnd),v.A.subscribe(v.A.thumbnail.togglePlay,this._onThumbnailClick)}UNSAFE_componentWillReceiveProps(e){this.setState({playing:this._getPlayingStatus(e)})}shouldComponentUpdate(e,i){return this.props.id!==e.id||this.props.presets.preview!==e.presets.preview||this.state.playing!==i.playing||this.state.isHover!==i.isHover||this.state.previewActive!==i.previewActive||this.props.trackListIndex!==e.trackListIndex}componentDidUpdate(e,i){this.props.presets.preview!==P.B.off&&i.previewActive!==this.state.previewActive&&this[this.state.previewActive?"_previewPlay":"_previewStop"](),this._updateOnAir()}componentWillUnmount(){p.A.cancel(this._previewApiRef),v.A.unsubscribe(v.A.player.finish,this._updateOnAir),v.A.unsubscribe(v.A.player.playing,this._updateOnAir),v.A.unsubscribe(v.A.player.finishPreview,this._onNaturalPreviewEnd),v.A.unsubscribe(v.A.thumbnail.togglePlay,this._onThumbnailClick)}render(){const{previewActive:e,isHover:i,playing:t}=this.state,{size:r}=this.props,{play:s,preview:d}=this.props.presets,l={className:(0,a.A)("action-item-tempo-btn",{"action-force":s===P.B.force,active:t}),type:"button","aria-label":t?(0,c.AP)("Pause"):(0,c.AP)("Play"),onMouseDown:this._togglePreview.bind(this,!0),onMouseUp:this._togglePreview.bind(this,!1),onMouseLeave:this._onMouseLeave,onMouseEnter:this._onMouseEnter};r&&(l.size=r);const _=o.createElement(T.Mk.Consumer,null,({dynamicContentlogAction:r})=>o.createElement(E.K0,(0,n.A)({icon:o.createElement(b.A,{isHover:i||e,isActive:t||e,color:"black",size:"small"}),colorScheme:"white",shadow:"md",variant:"onDark",onClick:e=>this._onPlay(e,r)},l)));return d===P.B.off||t?_:o.createElement(f.m,{closeOnScroll:!0,delay:700,label:(0,c.AP)("Cliquer longuement pour Ã©couter un extrait"),placement:"top"},_)}_onPlay(e,i){const{context:t,type:r,moduleId:s,index:n,onClick:o}=this.props,{preview:a}=this.props.presets,d=a!==P.B.off;if(null==o||o(this.state.playing),d){if(this._naturalPreviewEnd)return void(this._naturalPreviewEnd=!1);if(this.state.previewActive)return void e.stopPropagation()}e.stopPropagation(),this._play(),i({action:T.D$.PLAY_CLICKED,payload:{module_id:s,play_type:T.$x.DIRECT_PLAY,item:{id:String(t.ID),type:"show"===r?C.S.SHOW:r,position:n+1}}})}_onMouseLeave(){this.setState({isHover:!1},this._togglePreview(!1))}_onMouseEnter(){this.setState({isHover:!0})}_onThumbnailClick(){const e=_.Ay.getContext();null!==e&&e.ID===this.props.id&&this._play()}_onNaturalPreviewEnd(){this.props.presets.preview!==P.B.off&&this.state.previewActive&&this._updatePreviewState(!1,!0)}_play(){const{presets:{preview:e},context:i,type:t,id:r,radio:s,trackList:n,trackListIndex:o}=this.props;if(e===P.B.force||(0,_._k)(_.Ay.getPlayerType()))return;if(this._shouldTogglePlayState())return w.A.intent((0,m.G)(_.Ay)),_.Ay.control.togglePause(),void(_.Ay.isPlaying()||this._triggerTracking());if("queuelist"===(i.TYPE||i))return w.A.intent("play"),_.Ay.playTrackAtIndex(this.props.trackListIndex),void this._triggerTracking();const a={type:t,id:r,radio:s,context:"string"==typeof i?{ID:r,TYPE:i}:i,data:n};"number"==typeof o&&(a.index=o),n.length>0&&(a.data=n),a.type===y.Ay.Track&&(a.forceAsFirstTrack=!0,a.type=I.Kk.TRACK_MIX,a.data=[],a.index=0),w.A.intent("play"),_.Ay.play(a),this._triggerTracking()}_shouldTogglePlayState(){const{context:e,trackListIndex:i,id:t,type:r}=this.props,s=e.TYPE||e;if("queuelist"===s)return Number(i)===_.Ay.getTrackListIndex();const n=_.Ay.getContext();if(n){const e=h.default.get("log_contexts")[n.TYPE]===h.default.get("log_contexts")[s];return r===y.Ay.Track?e&&String(t)===String(_.Ay.getCurrentSong("MEDIA_ID")):e&&String(n.ID)===String(t)}return!1}_getPlayingStatus(e){if(e=e||this.props,_.Ay.isPlaying()){const i=_.Ay.getContext(),t=i?i.ID:null,r=_.Ay.getCurrentSong("MEDIA_ID"),s=e.type===y.Ay.User?y.Ay.Flow:e.type;if(String(e.id)===String(r)||String(e.id)===String(t))return e.presets.isNotAnimatedFromTrackListIndex||e.type!==y.Ay.Episode||"number"!=typeof e.trackListIndex?s===y.Ay.Track?h.default.get("log_contexts")[i.TYPE]===s&&String(e.id)===String(r):h.default.get("log_contexts")[i.TYPE]===s&&e.radio===_.Ay.isRadio():e.trackListIndex===_.Ay.getIndexSong()}return!1}_updateOnAir(){const e=this._getPlayingStatus();this.setState({playing:e}),this.props.onChange&&this.props.onChange(e)}_togglePreview(e){this.props.presets.preview===P.B.off||e&&this.state.playing||(clearTimeout(this._previewTimer),e&&this.state.previewActive||(0,_._k)(_.Ay.getPlayerType())||(this._previewTimer=setTimeout(()=>{this._updatePreviewState(e)},this._previewTimeout)))}_updatePreviewState(e,i){this.setState({previewActive:e},()=>{this._naturalPreviewEnd=i})}_previewPlay(){const{type:e,id:i}=this.props,t=A.A.getPreviewMethod(e,i);this._previewApiRef=p.A.call({method:t.method,data:t.data,success:e=>{const i=this._extractPreviewData(e.data),t=Number(i.GAIN),r=((i||{}).MEDIA||[]).filter(e=>"preview"===e.TYPE).map(e=>Array.isArray(e.HREF)?e.HREF[0]:e.HREF).shift();r?_.Ay.trigger("audioPlayer_startPreview",[r,t]):this._updatePreviewState(!1,!0)},error:()=>{this._updatePreviewState(!1,!0)}})}_previewStop(){p.A.cancel(this._previewApiRef),_.Ay.trigger("audioPlayer_endPreview")}_extractPreviewData(e){if(!Array.isArray(e)||!e.length)return null;if(!(e[0].MEDIA||[]).filter(e=>"preview"===e.TYPE).length)return null;let i=e[0];if(Number(u.A.checkSongAvailable(i))!==Number(u.A.READABLE)){if(!i.FALLBACK)return null;i=i.FALLBACK}return i}_triggerTracking(){var e;const{id:i,context:t,type:r}=this.props,s=_.Ay.getContext();if(!this.props.tracking||!s||s.ID===i&&_.Ay.isPaused())return;const n=this.props.tracking.getTrackingData(),o=n.pagecategory||n.pagename;if(!o)return;const a=t.TYPE||t;null!==(e=this.props.match.url)&&void 0!==e&&e.includes("/profile/")&&(0,g.h4)({action:g.dJ.PLAY_CLICKED,payload:{path:this.props.match.params.tab||"home",contextType:a}}),this.props.tracking.trackEvent({eventaction:`click-play-${a}`,event:"click",eventcategory:o,eventlabel:`play-${a}`,item:{id:i,type:r,rank:n.index||0}})}}).defaultProps={id:null,radio:!1,context:"",trackList:[],trackListIndex:null,presets:P.I,onChange:void 0},r=s))||r;const V=(0,l.y)(L)},HQpa:(e,i,t)=>{t.d(i,{H:()=>r,S:()=>s});let r=function(e){return e.FETCH="elapsed_time_api",e.PARSE="elapsed_time_parsing",e.DISPLAY="elapsed_time_page_display",e}({}),s=function(e){return e.ARTIST="artist",e.ALBUM="album",e.SHOW="podcast",e.PLAYLIST="playlist",e.CHANNEL="channel",e.SONG="track",e.FLOW="flow",e.LIVESTREAM="livestream",e.EXTERNALLINK="promotionallink",e.VIDEO="video",e.SMARTTRACKLIST="smarttracklist",e.LIVEEVENT="liveevent",e.MIX="mix",e.MESSAGE="message",e.EPISODE="episode",e.USER="profile",e}({})},Hews:(e,i,t)=>{t.d(i,{A:()=>o});var r=t("q1tI"),s=t("AlG7"),n=t("DcKU");const o=({isActive:e=!1,size:i})=>e?r.createElement(s.C,{size:i,color:"icon.accent.primary.default"}):r.createElement(n.M,{size:i})},SpbC:(e,i,t)=>{t.d(i,{D$:()=>j,Mk:()=>B,$x:()=>R,i7:()=>K,D2:()=>z});var r=t("q1tI"),s=t("LOQS"),n=t("HQK9");const o=new class{constructor(e){this._logCenter=void 0,this._logCenter=e}_isValideLog(e){const{screen_view_name:i,screen_view_id_type:t,screen_view_id:r,render_id:s,user_id:n}=e;return[i,t,r,s,n].every(Boolean)}log({screen_view_name:e,screen_view_id_type:i,screen_view_id:t,render_id:r,user_id:s}){this._isValideLog({screen_view_name:e,screen_view_id_type:i,screen_view_id:t,render_id:r,user_id:s})&&this._logCenter.log((0,n.L)("dynamic_content.screen_view","1.0.0",{screen_view_name:e,screen_view_id_type:i,screen_view_id:t,render_id:r,user_id:s}))}}(s.A),a=new class{constructor(e){this._logCenter=void 0,this._logCenter=e}_isValideLog(e){const{screen_view_name:i,screen_view_id_type:t,screen_view_id:r,render_id:s,module_id:n,user_id:o}=e;return[i,t,r,s,n,o].every(Boolean)}log({screen_view_name:e,screen_view_id_type:i,screen_view_id:t,render_id:r,module_id:s,user_id:o}){this._isValideLog({screen_view_name:e,screen_view_id_type:i,screen_view_id:t,render_id:r,module_id:s,user_id:o})&&this._logCenter.log((0,n.L)("dynamic_content.view_all_clicked","1.0.0",{screen_view_name:e,screen_view_id_type:i,screen_view_id:t,render_id:r,module_id:s,user_id:o}))}}(s.A),d=new class{constructor(e){this._logCenter=void 0,this._logCenter=e}_isValideLog(e){const{screen_view_name:i,screen_view_id_type:t,screen_view_id:r,render_id:s,module_id:n,item:o,user_id:a}=e;return[i,t,r,s,n,null==o?void 0:o.id,null==o?void 0:o.type,null==o?void 0:o.position,a].every(Boolean)}log({screen_view_name:e,screen_view_id_type:i,screen_view_id:t,render_id:r,module_id:s,item:o,user_id:a}){this._isValideLog({screen_view_name:e,screen_view_id_type:i,screen_view_id:t,render_id:r,module_id:s,item:o,user_id:a})&&this._logCenter.log((0,n.L)("dynamic_content.item_clicked","1.0.0",{screen_view_name:e,screen_view_id_type:i,screen_view_id:t,render_id:r,module_id:s,item:o,user_id:a}))}}(s.A),l=new class{constructor(e){this._logCenter=void 0,this._logCenter=e}_isValideLog(e){const{screen_view_name:i,screen_view_id_type:t,screen_view_id:r,render_id:s,module_id:n,item:o,play_type:a,user_id:d}=e;return[i,t,r,s,n,null==o?void 0:o.id,null==o?void 0:o.type,null==o?void 0:o.position,a,d].every(Boolean)}log({screen_view_name:e,screen_view_id_type:i,screen_view_id:t,render_id:r,module_id:s,item:o,play_type:a,user_id:d}){this._isValideLog({screen_view_name:e,screen_view_id_type:i,screen_view_id:t,render_id:r,module_id:s,item:o,play_type:a,user_id:d})&&this._logCenter.log((0,n.L)("dynamic_content.play_clicked","1.0.0",{screen_view_name:e,screen_view_id_type:i,screen_view_id:t,render_id:r,module_id:s,item:o,play_type:a,user_id:d}))}}(s.A);var c=t("7E8A"),_=t("bmsN"),p=t("MVPB"),u=t("4OMY"),v=(0,u.A)("screenViewName"),h=(0,u.A)("screenViewIdType"),y=(0,u.A)("screenViewId");const A=class{constructor(e){Object.defineProperty(this,v,{writable:!0,value:void 0}),Object.defineProperty(this,h,{writable:!0,value:void 0}),Object.defineProperty(this,y,{writable:!0,value:void 0}),(0,p.A)(this,v)[v]=e.screenViewName,(0,p.A)(this,h)[h]=e.screenViewIdType,(0,p.A)(this,y)[y]=e.screenViewId}serialize(){return{type:"cdp",eventName:"screen_view",customAttributes:{screen_view_name:(0,p.A)(this,v)[v],screen_view_id_type:(0,p.A)(this,h)[h],screen_view_id:(0,p.A)(this,y)[y]}}}};var w=(0,u.A)("screenViewName"),m=(0,u.A)("screenViewIdType"),g=(0,u.A)("screenViewId"),P=(0,u.A)("moduleId");const b=class{constructor(e){Object.defineProperty(this,w,{writable:!0,value:void 0}),Object.defineProperty(this,m,{writable:!0,value:void 0}),Object.defineProperty(this,g,{writable:!0,value:void 0}),Object.defineProperty(this,P,{writable:!0,value:void 0}),(0,p.A)(this,w)[w]=e.screenViewName,(0,p.A)(this,m)[m]=e.screenViewIdType,(0,p.A)(this,g)[g]=e.screenViewId,(0,p.A)(this,P)[P]=e.moduleId}serialize(){return{type:"cdp",eventName:"view_all_clicked",customAttributes:{screen_view_name:(0,p.A)(this,w)[w],screen_view_id_type:(0,p.A)(this,m)[m],screen_view_id:(0,p.A)(this,g)[g],module_id:(0,p.A)(this,P)[P]}}}};var f=(0,u.A)("screenViewName"),I=(0,u.A)("screenViewIdType"),E=(0,u.A)("screenViewId"),T=(0,u.A)("moduleId"),C=(0,u.A)("itemId"),L=(0,u.A)("itemType"),V=(0,u.A)("itemPosition");const k=class{constructor(e){Object.defineProperty(this,f,{writable:!0,value:void 0}),Object.defineProperty(this,I,{writable:!0,value:void 0}),Object.defineProperty(this,E,{writable:!0,value:void 0}),Object.defineProperty(this,T,{writable:!0,value:void 0}),Object.defineProperty(this,C,{writable:!0,value:void 0}),Object.defineProperty(this,L,{writable:!0,value:void 0}),Object.defineProperty(this,V,{writable:!0,value:void 0}),(0,p.A)(this,f)[f]=e.screenViewName,(0,p.A)(this,I)[I]=e.screenViewIdType,(0,p.A)(this,E)[E]=e.screenViewId,(0,p.A)(this,T)[T]=e.moduleId,(0,p.A)(this,C)[C]=e.item.id,(0,p.A)(this,L)[L]=e.item.type,(0,p.A)(this,V)[V]=e.item.position}serialize(){return{type:"cdp",eventName:"item_clicked",customAttributes:{screen_view_name:(0,p.A)(this,f)[f],screen_view_id_type:(0,p.A)(this,I)[I],screen_view_id:(0,p.A)(this,E)[E],module_id:(0,p.A)(this,T)[T],item_id:(0,p.A)(this,C)[C],item_type:(0,p.A)(this,L)[L],item_position:(0,p.A)(this,V)[V]}}}};var S=(0,u.A)("screenViewName"),D=(0,u.A)("screenViewIdType"),x=(0,u.A)("screenViewId"),N=(0,u.A)("moduleId"),O=(0,u.A)("item"),M=(0,u.A)("playType"),H=(0,u.A)("eventVersion");const Y=class{constructor(e){Object.defineProperty(this,S,{writable:!0,value:void 0}),Object.defineProperty(this,D,{writable:!0,value:void 0}),Object.defineProperty(this,x,{writable:!0,value:void 0}),Object.defineProperty(this,N,{writable:!0,value:void 0}),Object.defineProperty(this,O,{writable:!0,value:void 0}),Object.defineProperty(this,M,{writable:!0,value:void 0}),Object.defineProperty(this,H,{writable:!0,value:void 0}),(0,p.A)(this,S)[S]=e.screenViewName,(0,p.A)(this,D)[D]=e.screenViewIdType,(0,p.A)(this,x)[x]=e.screenViewId,(0,p.A)(this,N)[N]=e.moduleId,(0,p.A)(this,O)[O]={id:e.item.id,type:e.item.type,position:e.item.position},(0,p.A)(this,M)[M]=e.playType,"eventVersion"in e&&((0,p.A)(this,H)[H]=e.eventVersion)}serialize(){var e;return{type:"cdp",eventName:"play_clicked",eventVersion:null!==(e=(0,p.A)(this,H)[H])&&void 0!==e?e:2,customAttributes:{screen_view_name:(0,p.A)(this,S)[S],screen_view_id_type:(0,p.A)(this,D)[D],screen_view_id:(0,p.A)(this,x)[x],module_id:(0,p.A)(this,N)[N],item_id:(0,p.A)(this,O)[O].id,item_type:(0,p.A)(this,O)[O].type,item_position:(0,p.A)(this,O)[O].position,play_type:(0,p.A)(this,M)[M]}}}};let R=function(e){return e.GRID_PLAY="grid_play",e.MASTHEAD_PLAY="masthead_play",e.DIRECT_PLAY="direct_play",e.SHUFFLE="shuffle",e.BOTTOM_SHEET_30S_PREVIEW="bottom_sheet_30s_preview",e}({}),j=function(e){return e.SCREEN_VIEW="screen_view",e.ITEM_CLICKED="item_clicked",e.VIEW_ALL_CLICKED="view_all_clicked",e.PLAY_CLICKED="play_clicked",e}({});const B=(0,r.createContext)({dynamicContentlogAction:()=>{},setDefaultValue:()=>{}}),K=({children:e})=>{const i=_.It.get().user_id,[t,n]=(0,r.useState)(null);return r.createElement(B.Provider,{value:{setDefaultValue:n,dynamicContentlogAction:({action:e,payload:r})=>{const n=c.CONTEXT_PAGE_DYNAMIC_PAGE,_=(p=r.screen_view_name||(null==t?void 0:t.screen_view_name)).includes("/module/")?"module":p.includes("explore-")?"explore":p.includes("channels/")?"channel":"home";var p;const u=r.render_id||(null==t?void 0:t.render_id);switch(e){case j.SCREEN_VIEW:{o.log({...t,screen_view_id_type:n,user_id:i,...r});const e=new A({screenViewName:_,screenViewIdType:"render",screenViewId:u}).serialize();s.A.log(e);break}case j.VIEW_ALL_CLICKED:{a.log({...t,screen_view_id_type:n,user_id:i,...r});const e=new b({screenViewName:_,screenViewIdType:"render",screenViewId:u,moduleId:r.module_id}).serialize();s.A.log(e);break}case j.ITEM_CLICKED:{d.log({...t,screen_view_id_type:n,user_id:i,...r});const e=new k({screenViewName:_,screenViewIdType:"render",screenViewId:u,moduleId:r.module_id,item:{id:r.item.id,type:r.item.type,position:r.item.position}}).serialize();s.A.log(e);break}case j.PLAY_CLICKED:{l.log({...t,screen_view_id_type:n,user_id:i,...r});const e=new Y({screenViewName:_,screenViewIdType:"render",screenViewId:u,moduleId:r.module_id,item:{id:r.item.id,type:r.item.type,position:r.item.position},playType:r.play_type}).serialize();s.A.log(e);break}}}}},e)},z=()=>{const e=(0,r.useContext)(B);if(!e)throw new Error("useDynamicContentLogContext must be used within DynamicContentLogProvider");return e}},TYt9:(e,i,t)=>{t.d(i,{G:()=>r});const r=e=>e.isPaused()||e.isPlaying()?e.isPaused()?e.getPosition()?"resume":"play":"pause":"play"}}]);