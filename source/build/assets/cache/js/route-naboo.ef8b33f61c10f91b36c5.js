"use strict";(self.webpackJsonpDeezer=self.webpackJsonpDeezer||[]).push([[2416],{"/uRm":(e,t,n)=>{n.d(t,{F:()=>a});let a=function(e){return e.ONBOARDING="ON_BOARDING",e.ONBOARDING_LEGACY="ON_BOARDING_LEGACY",e.SELECT_PROFILE="SELECT_PROFILE",e.BRIDGED_WEBVIEW="BRIDGED_WEBVIEW",e.PLAYLIST_ASSISTANT="PLAYLIST_ASSISTANT",e}({})},"1EyH":(e,t,n)=>{n.d(t,{BB:()=>i,Sx:()=>a,UC:()=>r});const a=e=>/[\u2000-\u2BFF]/.test(e),i=e=>/[\u{10000}-\u{10FFFF}]/u.test(e),r=e=>!!e.match(/^[_0-9a-z-+]+[_.0-9a-z-+]*@([0-9a-z-]+\.)+[a-z]{2,13}$/i)},"23mk":(e,t,n)=>{n.d(t,{A:()=>h});var a=n("Au7y"),i=n("Sb6s"),r=n("TRpf"),s=n("Fzox"),o=n("Nz/Y"),l=n("34sk"),c=n("yJX9"),d=n("vXsw"),u=n("xobL"),p=n("A2sV");const m=a.J1`
	fragment isArtistFavorite on Artist {
		isFavorite
	}
`,h=e=>{const t={artistId:e},n=(0,r.wA)(),a=(0,s.G)(({user:e})=>(0,u.UJ)(e)),h=(0,o.A)(),{data:g}=(0,i.I)({fragment:m,from:{__typename:"Artist",id:e},optimistic:!0}),[y]=(0,p.BXP)({variables:t,optimisticResponse:{__typename:"Mutation",addArtistToFavorite:{favoritedAt:Date.now(),artist:{id:e,isFavorite:!0,__typename:"Artist"},__typename:"ArtistMutationFavoriteAddOut"}},onCompleted:()=>{n((0,l.TD)(c.Z.favorites,{id:e,timestamp:Date.now()},"artist"))}}),[A]=(0,p.a40)({variables:t,onCompleted:()=>{n((0,l.E$)(c.Z.favorites,e,"artist"))},optimisticResponse:{__typename:"Mutation",removeArtistFromFavorite:{artist:{id:e,isFavorite:!1,__typename:"Artist"},__typename:"ArtistMutationFavoriteRemoveOut"}}}),E=(0,s.G)(t=>t.feedbacks.favorites.artist.feedbacks[e]),_=Boolean(E||(null==g?void 0:g.isFavorite));return{isFavorite:_,toggleFavorite:()=>{a?_?A():(h(),y()):d.g.goToConnection()}}}},"3JOg":(e,t,n)=>{n.d(t,{A:()=>r});var a=n("q1tI"),i=n("juqV");const r=({children:e})=>{var t;return a.cloneElement(e,{className:(0,i.A)(null===(t=e.props)||void 0===t?void 0:t.className,"animate-wobble")})}},"4PKR":(e,t,n)=>{n.d(t,{Ay:()=>m,gA:()=>u,wZ:()=>p});var a=n("q1tI"),i=n("JsMx"),r=n("oRM/");const s=[2160,1e3],o=[1630,360],l=[[0,0],[1e3,90],[1e3,250],[970,90],[970,250],[728,90],s],c=[[1e3,90],[728,90]],d=(0,a.createContext)({isScriptLoaded:!1,isSponsored:!1,setIsSponsored:()=>{},destroySlot1:()=>{},destroySponsored:()=>{},displayAdSlot:()=>{},displaySponsored:()=>{},isArchBanner:!1}),u=()=>(0,a.useContext)(d),p=({children:e})=>{var t;const[n,u]=(0,a.useState)(!1),[p,m]=(0,a.useState)(!1),[h,g]=(0,a.useState)(""),[y,A]=(0,a.useState)(!1),[E,_]=(0,a.useState)(1),f=(0,a.useRef)(null),b=(0,a.useRef)(null),v=(0,a.useRef)(null),k=(0,a.useRef)(null),T=(0,a.useRef)(null),C=(0,a.useRef)(null),w=(0,a.useRef)(null),{adsConfigState:S}=(0,i.Y9)(),{logAdView:x,logBannerAdDisplay:I,logNoAds:P}=(0,r.Dy)(S),R=null===(t=S.config)||void 0===t?void 0:t.banner,L=(null==R?void 0:R.refresh)||30,N=e=>{e.isEmpty?P(r.eQ.BANNER):(e.size&&e.size[0]===s[0]?A(!0):A(!1),I(r.eQ.BANNER))},O=e=>{const t=e.slot;x(r.eQ.BANNER,{adCount:E}),_(E+1),setTimeout(()=>{googletag.pubads().refresh([t])},1e3*L)},D=()=>{const e=window.googletag;p&&M(),e.cmd.push(()=>{f.current&&(e.pubads().removeEventListener("impressionViewable",f.current),f.current=null),b.current&&(e.pubads().removeEventListener("slotRenderEnded",b.current),b.current=null),v.current&&(e.destroySlots([v.current]),v.current=null)}),y&&A(!1)},M=()=>{const e=window.googletag;e.cmd.push(()=>{k.current&&(e.pubads().removeEventListener("slotRenderEnded",k.current),k.current=null),T.current&&(e.pubads().removeEventListener("impressionViewable",T.current),T.current=null);const t=[];C.current&&(t.push(C.current),C.current=null),w.current&&(t.push(w.current),w.current=null),t.length>0&&e.destroySlots(t)})},U=e=>{const t=window.googletag;var n;return"function"==typeof t.pubads&&(t&&(null==t||null===(n=t.pubads())||void 0===n?void 0:n.getSlots())).some(t=>t.getSlotElementId()===e)};return(0,a.useEffect)(()=>((()=>{const t=document.createElement("script");t.src="https://securepubads.g.doubleclick.net/tag/js/gpt.js",t.async=!0,document.body.appendChild(t),t.onload=()=>{window.googletag=window.googletag||{cmd:[]},u(!0)}})(),()=>{D(),M()}),[]),a.createElement(d.Provider,{value:{isScriptLoaded:n,setIsSponsored:m,isSponsored:p,displayAdSlot:e=>{const t=window.googletag;e&&g(e);const n=e||h;n&&(D(),setTimeout(()=>{t.cmd.push(()=>{if(!U("adslot1")){var e;const a=null===(e=t.defineSlot(n,l,"adslot1"))||void 0===e||null===(e=e.addService(t.pubads()))||void 0===e?void 0:e.setTargeting("placement","web_adslot1");a&&(v.current=a,f.current=O,b.current=N,t.pubads().addEventListener("impressionViewable",f.current),t.pubads().addEventListener("slotRenderEnded",b.current),t.pubads().refresh([a]))}})},100))},displaySponsored:(e,t)=>{const n=window.googletag;M(),setTimeout(()=>{n.cmd.push(()=>{if(!U("adslot2")&&!U("sponsored_playlist")){var a,i;const s=null===(a=n.defineSlot(e("web_adslot2"),c,"adslot2"))||void 0===a?void 0:a.addService(n.pubads()).setTargeting("placement","web_adslot2"),l=null===(i=n.defineSlot(e("web_sponsored_playlist"),o,"sponsored_playlist"))||void 0===i?void 0:i.addService(n.pubads()).setTargeting("placement","web_sponsored_playlist");s&&(C.current=s),l&&(w.current=l),k.current=t(l),T.current=()=>{x(r.eQ.PLAYLIST)},n.pubads().addEventListener("slotRenderEnded",k.current),n.pubads().addEventListener("impressionViewable",T.current),n.pubads().refresh(s&&l&&[l,s])}})},100)},destroySlot1:D,destroySponsored:M,isArchBanner:y}},e)},m=d},"5pmF":(e,t,n)=>{n.d(t,{A:()=>v});var a=n("q1tI"),i=n("TRpf"),r=n("xobL"),s=(n("/eM8"),n("Vd8Q"));const o=s.default.get("host_website_ssl"),l=s.default.get("host_cookie"),c=`https://${s.default.get("host_common_assets_ssl")}/js/gdpr-appliance.js`,d=s.default.get("bot_crawler"),u=new RegExp(d,"i");var h=n("zKOv"),g=n("vGT4"),y=n("39Zz"),A=n("uHHB"),E=n("G04z"),_=n("ebSJ"),f=n("y7Wb");const b=({locale:e,darkMode:t,userId:n})=>{const{dispatch:r}=(0,g.b)(),s=(0,i.wA)();return(0,a.useEffect)(()=>{window.location.pathname.includes("register")&&(0,_.A)(y.J)&&((0,A.A)(y.J,"",0),(0,A.A)("euconsent-v2","",0)),window.onDzrGDPRReady=a=>{(async(e,t)=>{const{lang:n="en_US",darkMode:a=!1,onConsentUpdate:i,userID:r="0"}=t||{};window.consentScreenApi=await e({cookieDomain:l,darkMode:a,gatewayHost:o,isWebview:!1,lang:n,onConsentUpdate:i,userID:r})})(a,{lang:e,darkMode:t,userID:n,onConsentUpdate:e=>{var t;r((t=e,{type:h.X,value:t})),(0,E.u)().setConsent(e),s((0,f.j$)())}})},((e="dzr-gdpr-script")=>{if(u.test(navigator.userAgent))return;if(document.getElementById(e))return;const t=document.createElement("script");t.async=!0,t.crossOrigin="anonymous",t.defer=!0,t.id=e,t.src=c,document.head.appendChild(t)})("gdpr-web-script")},[]),(0,a.useEffect)(()=>{var a;null===(a=window.consentScreenApi)||void 0===a||a.update({darkMode:t,userID:n,lang:e})},[t,e,n]),null},v=()=>{const e=(0,i.d4)(e=>(0,r.JK)(e.user)),t=(0,i.d4)(e=>(0,r.NF)(e.user)),n=(0,i.d4)(e=>(0,r.F6)(e.user).toString());return a.createElement(b,{darkMode:t,userId:n,locale:e})}},"63mb":(e,t,n)=>{n.d(t,{F:()=>u});var a=n("77Ru"),i=n.n(a),r=n("QSbk"),s=n("Vd8Q"),o=n("eC9Z"),l=n("pUfN"),c=n("gLR9");const d=`https://${(0,o.WV)({itemType:l.Wi.CONFIG,itemName:"pipe"})||s.default.get("host_pipe")}/api`,u=new(i().com.deezer.kmp.pipe.apollo.NetworkClientsFactory)(d).create(i().com.deezer.kmp.pipe.apollo.jwt.sharedJwtTokenProvider({providesToken:e=>{(0,r.gf)(c.C.sessionState instanceof i().com.deezer.kmp.usersession.api.UserSessionState.LoggedIn).then(t=>{e.onResult(t)})},forceExpiredToken:r.M4,canRetryRequest:()=>"undefined"!=typeof window&&window.navigator.onLine}),"undefined"!=typeof window?window.navigator.userAgent:"")},"7bA3":(e,t,n)=>{n.d(t,{A:()=>l});var a=n("q1tI"),i=n("F3Nm"),r=n("CrR0"),s=n("0JBE"),o=n("GjdC");const l=({id:e,type:t,displayForce:n,shouldPlayRadio:l=!1,onClick:c})=>{const{legacyContext:d}=(0,s.iQ)(),u=(0,o.A)();return a.createElement(r.U,{"aria-label":"",as:"div",displayForce:n,icon:a.createElement(i.A,{id:e,type:t,context:d,radio:l,onClick:e=>{null==c||c(),e||u("direct_play")}})})}},"92X9":(e,t,n)=>{n.d(t,{ap:()=>T,uX:()=>C});var a=n("q1tI"),i=n("XkdG"),r=n("HmE0"),s=n("PF77"),o=n("jysG"),l=n("CdHq"),c=n("80JK"),d=n("8WIx"),u=n("mbHV"),p=n("Votb"),m=n("FVVF"),h=n("pVdW"),g=n("h65K"),y=n("Wp0Y"),A=n("tZCQ"),E=n("H9G8"),_=n("zerP"),f=n("5U+Y"),b=n("X6oL"),v=n("kDgj");function k(e,t){switch(t.type){case"update_blogname":{const{isValid:n,message:a}=(e=>{try{return(0,_.iE)(t.value),{isValid:!0,message:""}}catch(e){return e instanceof E.jQ?{isValid:!1,message:e.message}:{isValid:!1,message:""}}})(()=>(0,_.iE)(t.value));return{...e,blogname:{value:t.value,isValid:n,error:a}}}case"update_kid":return{...e,isKid:{value:t.value,error:"",isValid:!0}};case"update_gender":return{...e,gender:{value:t.value,isValid:!0,error:""}};case"update_age":{if(!t.value)return{...e,age:{value:t.value,isValid:!1,error:(0,y.AP)("familyprofileswitcheraddprofile_text_pleaseselectage_web")}};const n={value:t.value,isValid:!0,error:""};return t.value<f.fB?{...e,age:n,isKid:{value:!0,error:"",isValid:!0},hideExplicitConsent:!0}:{...e,age:n,isKid:{value:!1,error:"",isValid:!0},hideExplicitConsent:!1}}default:return{...e,...t.value}}}const T=e=>{var t,n;const i=!parseInt(e.USER_ID,10),[r,s]=(0,a.useReducer)(k,{blogname:{value:e.BLOG_NAME||"",isValid:!0,error:""},isKid:{value:e.IS_KID||!1,isValid:!0,error:""},gender:{value:e.SEX||"F",isValid:!0,error:""},age:{value:e.BIRTHDAY?(new Date).getFullYear()-new Date(e.BIRTHDAY).getFullYear():18,isValid:!0,error:""},kidsConsent:{value:!i,isValid:!0,error:""},hideExplicitConsent:null!==(t=e.EXTRA_FAMILY.TOGGLE_EXPLICIT_CONTROL)&&void 0!==t&&t}),o=r.blogname.value.length>0&&r.blogname.isValid&&r.age.isValid&&r.gender.isValid&&(r.age.value>=f.fB||r.kidsConsent.value);return{state:r,dispatch:s,isExplicitLevelEditable:!r.isKid.value||!i&&null!==(n=e.EXTRA_FAMILY.IS_EXPLICIT_LEVEL_EDITABLE)&&void 0!==n&&n,isFormValid:o,isNew:i}},C=({user:e,...t})=>{const{trackEvent:n}=(0,b.z1)(),E=A.A.isAllowed("gender_nonbinary")?(0,y.AP)("genderscreen_title_identity_web"):(0,y.AP)("Genre"),{state:_,dispatch:k,isExplicitLevelEditable:C,isFormValid:w,isNew:S}=T(e),x=_.hideExplicitConsent||_.isKid.value;return a.createElement(g.m,{"data-testid":"account-editor-sub-profile"},a.createElement(m.T,{alignItems:"start",spacing:"4"},a.createElement(c.MJ,{isRequired:!0,isInvalid:!_.blogname.isValid},a.createElement(d.l,null,(0,y.AP)("Username")),a.createElement(i.p,{"data-testid":"subprofile-edit-username",onChange:e=>k({type:"update_blogname",value:e.target.value}),value:_.blogname.value}),a.createElement(o.Wt,null,_.blogname.error)),a.createElement(c.MJ,{isRequired:!0,isInvalid:!_.gender.isValid},a.createElement(d.l,{htmlFor:"subprofile-edit-gender"},E),a.createElement(u.l,{id:"subprofile-edit-gender",onChange:e=>k({type:"update_gender",value:e.target.value}),value:_.gender.value},a.createElement("option",{value:"F"},(0,y.AP)("genderoption_text_female_web")),a.createElement("option",{value:"M"},(0,y.AP)("genderoption_text_male_web")),A.A.isAllowed("gender_nonbinary")&&a.createElement("option",{value:"NonBinary"},(0,y.AP)("genderoption_text_nonbinary_web"))),a.createElement(o.Wt,null,_.gender.error)),a.createElement(c.MJ,{isRequired:!0,isInvalid:!_.age.isValid},a.createElement(d.l,{htmlFor:"subprofile-edit-age"},(0,y.AP)("Age")),a.createElement(u.l,{id:"subprofile-edit-age","data-testid":"subprofile-edit-age",onChange:e=>k({type:"update_age",value:parseInt(e.target.value,10)}),value:_.age.value},[...Array(99)].map((e,t)=>{const n=t+1;return a.createElement("option",{key:n,value:n},n)})),a.createElement(o.Wt,null,_.age.error)),a.createElement(s.S,{"data-testid":"subprofile-toggle-explicit",isChecked:x,isDisabled:!C,onChange:e=>{k({type:"state",value:{hideExplicitConsent:e.target.checked}}),n({event:"click",eventlabel:e.target.checked?v.w:v.E})}},(0,y.AP)("settingspage_title_hideexplicitcontent_web")),a.createElement(s.S,{isChecked:_.isKid.value,onChange:e=>k({type:"update_kid",value:e.target.checked}),"data-testid":"subprofile-toggle-kid",isDisabled:t.currentUserIsKid||_.age.value<f.fB},(0,y.AP)("familyprofileswitcheraddprofile_title_kidprofile_web")),_.age.value<f.fB&&a.createElement(a.Fragment,null,a.createElement(c.MJ,{isInvalid:!_.kidsConsent.isValid},a.createElement(s.S,{isChecked:_.kidsConsent.value,"data-testid":"subprofile-toggle-kid-consent",onChange:e=>k({type:"state",value:{kidsConsent:{value:e.target.checked,isValid:!0,error:""}}}),isDisabled:t.currentUserIsKid},(0,y.AP)("familyprofileminorconsent_title_gdpchildconsent_web")),a.createElement(o.Wt,null,_.kidsConsent.error)),a.createElement(h.E,{color:"text.neutral.secondary.default",fontSize:"11px",sx:{"> a":{color:"text.neutral.primary.default"}},dangerouslySetInnerHTML:{__html:(0,y.WI)("familyprofileminorconsent_text_termsandconditions_web","familyprofileminorconsent_text_termsandconditions_web",{count:f.fB,sprintf:[f.fB,'target="_blank" href="/legal/cgu"']})}})),a.createElement(p.z,{spacing:"8",w:"100%",justifyContent:"center"},a.createElement(r.$n,{variant:"outline",onClick:t.onCancel,"data-testid":"subprofile-cancel-btn"},(0,y.AP)("generic_action_cancel_web")),a.createElement(r.$n,{onClick:()=>{var n;w&&t.onSave({userId:e.USER_ID,isPersonalDataEditable:null!==(n=e.EXTRA_FAMILY.IS_PERSONAL_DATA_EDITABLE)&&void 0!==n&&n,blogname:_.blogname.value,isKid:_.isKid.value,gender:_.gender.value,age:_.age.value,kidsConsent:_.kidsConsent.value,isExplicitLevelEditable:C,forceExplicitLevel:x})},isLoading:t.formLoading,isDisabled:Boolean(t.formLoading)||!w,"data-testid":"subprofile-save-btn"},S?(0,y.AP)("Créer"):(0,y.AP)("Enregistrer"))),!S&&e.EXTRA_FAMILY.IS_DELETABLE&&a.createElement(l.s,{w:"100%",justifyContent:"center"},a.createElement(r.$n,{margin:"auto",variant:"ghost",onClick:()=>t.onRemove(e),"data-testid":"subprofile-remove-btn"},(0,y.AP)("Supprimer")))))}},"9odk":(e,t,n)=>{n.d(t,{AP:()=>c,Ay:()=>o,kA:()=>l});var a=n("q1tI"),i=n("A2sV"),r=n("TRpf");const s=a.createContext({loading:!0}),o=(0,r.Ng)(({user:{id:e}})=>({legacyUserId:e}))(({legacyUserId:e,children:t})=>{const{data:n,loading:r,error:o,refetch:l}=(0,i.ONi)({});if(a.useEffect(()=>{var t;n&&e.toString()!==(null===(t=n.me)||void 0===t?void 0:t.user.id)&&l()},[e,n,l]),o)throw o;if(!r&&void 0===n)throw new Error("Missing user data from pipe");const c=n&&null!==n&&null!==n.me?{isLogged:!0,data:n.me}:{isLogged:!1,data:null};return a.createElement(s.Provider,{value:r?{loading:!0}:{loading:r,...c,refetch:()=>{l({})}}},t)}),l=()=>{const e=a.useContext(s);if(!e)throw new Error("usePipeUserContext must be used whithin a PipeUserContext");return e},c=()=>{const e=l();if(!e.loading&&e.isLogged){const{__typename:t,...n}=e.data.onboarding;return n}return null}},Aw62:(e,t,n)=>{n.d(t,{J0:()=>C,Ay:()=>w,ZQ:()=>k}),n("/eM8"),n("gS5K");var a=n("q1tI"),i=n("nrKQ"),r=n("WKgy"),s=n("H/eQ"),o=n("tZCQ"),l=n("JsMx");const d=`https://${(n("Dk60"),n("Vd8Q")).default.get("host_img_url_ssl")}/misc/813a92a67ed0a543380451ce8b47bb15/540x540-000000-90-0-0.jpg`;let u=null;const p=window,m=()=>{u=null},h=()=>{return p.google&&p.google.ima?Promise.resolve(p.google.ima):u||(u=(e="https://imasdk.googleapis.com/js/sdkloader/ima3.js",new Promise((t,n)=>{const a=document.createElement("script");a.async=!0,a.src=e,a.onload=()=>t(a),a.onerror=()=>n(new Error(`Failed to load script, possible adblock: ${e}`)),document.body.appendChild(a)})).then(()=>{if(p.google&&p.google.ima)return p.google.ima;throw new Error("IMA SDK failed to load correctly.")}).finally(m),u);var e},g=async(e,t,n,a)=>{const i=document.createElement("div");i.id="mediaElement",Object.assign(i.style,{position:"fixed",top:"0",left:"0",width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.3)",backdropFilter:"blur(10px)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:"999"}),document.body.appendChild(i);const r=document.createElement("div");r.id="adContainer",Object.assign(r.style,{zIndex:"1000",cursor:"pointer",top:"0",left:"0",margin:"auto",position:"fixed",width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.3)"}),document.body.appendChild(r),r.focus();try{const s=await h(),o=new s.AdsRenderingSettings;o.uiElements=[s.UiElements.AD_ATTRIBUTION,s.UiElements.COUNTDOWN],s.settings.setFeatureFlags({audioPosterImageEnabled:!0,audioPosterImageDefaultUrl:d});const l=document.getElementById("mediaElement");if(!l)throw new Error("mediaElement not found or not a video element.");l.volume=1,l.muted=!1;const c=new s.AdDisplayContainer(r,l);c.initialize();const u=new s.AdsLoader(c),p=new s.AdsRequest;p.adsResponse=(e=>{const t=(new DOMParser).parseFromString(e,"application/xml"),n=t.getElementsByTagName("MediaFile");for(let e=0;e<n.length;e++){const t=n[e];"audio/mp3"===t.getAttribute("type")&&t.setAttribute("type","audio/mpeg")}const a=t.getElementsByTagName("Companion");let i=null;for(let e=0;e<a.length;e++){const t=a[e],n=t.getAttribute("width"),s=t.getAttribute("height"),o=t.getElementsByTagName("CompanionClickThrough");var r;if(o.length>0&&(i=(null===(r=o[0].textContent)||void 0===r?void 0:r.trim())||null),n&&s){const e=parseInt(n,10),a=parseInt(s,10);if(a>540){const n=e/a;t.setAttribute("height",540..toString()),t.setAttribute("width",(540*n).toFixed(0))}}}const s=t.getElementsByTagName("CompanionAds");for(let e=0;e<s.length;e++)s[e].removeAttribute("required");const o=t.getElementsByTagName("Linear");for(let e=0;e<o.length;e++){const n=o[e];let a=n.getElementsByTagName("VideoClicks")[0];if(a||(a=t.createElement("VideoClicks"),n.appendChild(a)),0===a.getElementsByTagName("ClickThrough").length&&i){a=t.createElement("VideoClicks");const e=t.createElement("ClickThrough");e.textContent=i,a.appendChild(e),n.appendChild(a)}}return(new XMLSerializer).serializeToString(t)})(e),p.linearAdSlotWidth=r.clientWidth,p.linearAdSlotHeight=r.clientHeight,p.nonLinearAdSlotWidth=r.clientWidth,p.nonLinearAdSlotHeight=r.clientHeight/3;let m=null;const g=new ResizeObserver(()=>{if(m){const e=r.clientWidth,t=r.clientHeight;m.resize(e,t,s.ViewMode.NORMAL)}});g.observe(r);const y="audio"===a;u.addEventListener(s.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,e=>{try{m=e.getAdsManager(l,o),m.addEventListener(s.AdEvent.Type.PAUSED,()=>{y&&m.resume()}),m.addEventListener(s.AdEvent.Type.COMPLETE,()=>{t(),b()}),m.addEventListener(s.AdEvent.Type.SKIPPED,()=>{t(),b()}),m.addEventListener(s.AdErrorEvent.Type.AD_ERROR,e=>{throw t(),b(),new Error(e.getError().toString())}),m.addEventListener(s.AdEvent.Type.CONTENT_RESUME_REQUESTED,()=>{t(),b()}),document.addEventListener("visibilitychange",E),window.addEventListener("focus",_),window.addEventListener("blur",f),m.addEventListener(s.AdEvent.Type.ALL_ADS_COMPLETED,()=>{document.removeEventListener("visibilitychange",E),window.removeEventListener("focus",_),window.removeEventListener("blur",f),g.disconnect(),b()});try{const e=1600,t=900,n=Math.min(r.clientWidth,e),a=Math.min(r.clientHeight,t);m.init(n,a,s.ViewMode.NORMAL),m.start(),setTimeout(()=>{var e;null===(e=m)||void 0===e||e.resize(r.clientWidth,r.clientHeight,s.ViewMode.NORMAL)},10)}catch(e){throw t(),b(),new Error("AdsManager initialization error: "+e)}}catch(e){throw t(),b(),new Error("AdsManager Loaded Error: "+e)}}),u.addEventListener(s.AdErrorEvent.Type.AD_ERROR,e=>{throw t(),b(),new Error(e.getError().toString())}),u.requestAds(p),l.style.background="transparent";const A=()=>{y||m.pause()},E=()=>{document.hidden?(A(),n(!1)):(m.resume(),n(!0))},_=()=>{m.resume(),n(!0)},f=()=>{A(),n(!1)};document.addEventListener("visibilitychange",E),window.addEventListener("focus",_),window.addEventListener("blur",f);const b=()=>{document.removeEventListener("visibilitychange",E),window.removeEventListener("focus",_),window.removeEventListener("blur",f),i.parentNode&&i.parentNode.removeChild(i),r.parentNode&&r.parentNode.removeChild(r)}}catch(e){throw t(),new Error("Error during ad display: "+e)}};var y=n("u7vQ"),A=n("AfN5");class E{constructor(e){this.trackCount=void 0,this.totalPlayTime=void 0,this.lastPlayTimestamp=void 0,this.hasCountedCurrentTrack=void 0,this.isResumingOrPlaying=void 0,this.trackCountCallback=void 0,this.adPlayCallback=void 0,this.adConfig=void 0,this.playCheckInterval=void 0,this.DEFAULT_TIME_BEFORE_COUNTING=void 0,this.FAST_TIME_BEFORE_COUNTING=void 0,this.getLimitTimeToCount=()=>this.adConfig?this.adConfig.fastAds?this.FAST_TIME_BEFORE_COUNTING:this.DEFAULT_TIME_BEFORE_COUNTING:1/0,this.updateConfig=e=>{this.adConfig=e},this.onTrackCountChange=e=>{this.trackCountCallback=e},this.onAdPlayRequired=e=>{this.adPlayCallback=e},this.startListening=()=>{s.A.subscribe(s.A.player.play,this.onPlay),s.A.subscribe(s.A.player.resume,this.onResume),s.A.subscribe(s.A.player.paused,this.onPause),s.A.subscribe(s.A.player.seek,this.onSeek),s.A.subscribe(s.A.player.trackChange,this.onTrackEndOrSkipped),s.A.subscribe(s.A.player.trackSkipped,this.onTrackEndOrSkipped)},this.stopListening=()=>{s.A.unsubscribe(s.A.player.play,this.onPlay),s.A.unsubscribe(s.A.player.resume,this.onResume),s.A.unsubscribe(s.A.player.paused,this.onPause),s.A.unsubscribe(s.A.player.seek,this.onSeek),s.A.unsubscribe(s.A.player.trackChange,this.onTrackEndOrSkipped),s.A.unsubscribe(s.A.player.trackSkipped,this.onTrackEndOrSkipped),this.clearPlayCheckInterval()},this.onPlay=()=>{this.resetPlayTime(),this.isResumingOrPlaying=!0,this.lastPlayTimestamp=Date.now(),this.startPlayCheckInterval()},this.onResume=()=>{this.isResumingOrPlaying=!0,this.lastPlayTimestamp=Date.now(),this.startPlayCheckInterval()},this.onPause=()=>{this.isResumingOrPlaying?this.isResumingOrPlaying=!1:y.Ay.isPlaying()&&(this.updateTotalPlayTime(),this.clearPlayCheckInterval())},this.onSeek=()=>{this.updateTotalPlayTime(),this.lastPlayTimestamp=Date.now(),this.isResumingOrPlaying=y.Ay.isPlaying()},this.onTrackEndOrSkipped=()=>{this.resetPlayTime(),this.clearPlayCheckInterval(),this.hasCountedCurrentTrack=!1,this.isResumingOrPlaying=!1},this.updateTotalPlayTime=()=>{if(y.Ay.isPlaying()){const e=(Date.now()-this.lastPlayTimestamp)/1e3;this.totalPlayTime+=e,this.lastPlayTimestamp=Date.now()}},this.getCurrentPlayTime=()=>(this.updateTotalPlayTime(),this.totalPlayTime),this.checkTrackCountTrigger=()=>{this.adConfig&&!this.hasCountedCurrentTrack&&this.getCurrentPlayTime()>=this.getLimitTimeToCount()&&(this.trackCount+=1,this.hasCountedCurrentTrack=!0,this.trackCountCallback&&this.trackCountCallback(this.trackCount),(this.trackCount===this.adConfig.start||this.trackCount>this.adConfig.start&&(this.trackCount-this.adConfig.start)%this.adConfig.interval==0)&&this.adPlayCallback&&this.adPlayCallback())},this.startPlayCheckInterval=()=>{this.adConfig&&(this.clearPlayCheckInterval(),this.playCheckInterval=setInterval(()=>{this.getCurrentPlayTime()>=this.getLimitTimeToCount()&&(this.checkTrackCountTrigger(),this.clearPlayCheckInterval())},500))},this.clearPlayCheckInterval=()=>{this.playCheckInterval&&(clearInterval(this.playCheckInterval),this.playCheckInterval=void 0)},this.resetPlayTime=()=>{this.totalPlayTime=0,this.lastPlayTimestamp=0,this.hasCountedCurrentTrack=!1},this.getTrackCount=()=>this.trackCount,this.trackCount=0,this.totalPlayTime=0,this.lastPlayTimestamp=0,this.hasCountedCurrentTrack=!1,this.isResumingOrPlaying=!1,this.adConfig=e,this.DEFAULT_TIME_BEFORE_COUNTING=30,this.FAST_TIME_BEFORE_COUNTING=5}}var _=n("oRM/");const f=new URLSearchParams(window.location.search).get("fastAds"),b=()=>o.A.isAllowed("ad_audio_break_vast_audio")?"VAST_AD":"VIDEO_AD",v=(0,a.createContext)({audioBreakState:{},fetchAudioBreak:async e=>0,isAdsReady:!1}),k=()=>(0,a.useContext)(v),T={type:"",content:null,cta:{},tracking:{},smartad_mediation_parameters:{}},C=({children:e})=>{const[t,n]=(0,a.useState)(T),[c,d]=(0,a.useState)(!0),[u,p]=(0,a.useState)(!1),[m,h]=(0,a.useState)(0),[k,C]=(0,a.useState)(0),{getAdsAudioFrequency:w,adsConfigReady:S,adsConfigState:x}=(0,l.Y9)(),I=w(),P=I&&"number"==typeof(null==I?void 0:I.start)&&"number"==typeof(null==I?void 0:I.interval)?{...I,fastAds:"true"===f}:null,R=(0,a.useRef)(null),{logAdView:L,logAdCall:N,logNoAds:O,logAdCallError:D,logAdViewError:M}=(0,_.Dy)(x),U=_.eQ.AUDIO;(0,a.useEffect)(()=>(R.current||(R.current=new E(P),R.current.startListening(),R.current.onAdPlayRequired(()=>{z()})),()=>{var e;null===(e=R.current)||void 0===e||e.stopListening()}),[]),(0,a.useEffect)(()=>{S&&0===(null==P?void 0:P.start)&&y.Ay.playerLoaded&&setTimeout(()=>{z(),h(1)},100)},[S,null==P?void 0:P.start,y.Ay.playerLoaded]),(0,a.useEffect)(()=>{var e;null===(e=R.current)||void 0===e||e.updateConfig(P)},[P]);const z=(0,a.useCallback)(()=>{u||(s.A.subscribe(s.A.triton.audioEnd,B),s.A.subscribe(s.A.ads.callAudio,()=>p(!0)),y.Ay.onAudioAdsReady())},[u]),F=()=>{s.A.trigger(s.A.triton.audioEnd);const e=document.getElementById("mediaElement");null==e||e.remove();const t=document.getElementById("adContainer");null==t||t.remove()},B=()=>{s.A.unsubscribe(s.A.player.trackSkipped),s.A.unsubscribe(s.A.player.trackChange),s.A.unsubscribe(s.A.player.displayNextSong),s.A.unsubscribe(s.A.triton.audioEnd),s.A.unsubscribe(s.A.ads.callAudio,()=>p(!0)),y.Ay.hasAudioAds=!1,y.Ay.eventAudio=!1,y.Ay.stopAudioAds(!1),p(!1)};return y.Ay.getPlayerType()!==A.Cc.ADS&&y.Ay.getPlayerType()!==A.Cc.TRITON_AD||location.pathname.includes("/game/")&&(s.A.trigger(s.A.triton.audioEnd),s.A.trigger(s.A.ads.adEnd)),a.createElement(v.Provider,{value:{audioBreakState:t,fetchAudioBreak:async e=>{const t=r.A.getState().player,a=new Date,l=i.A.call({method:"deezer.getAudiobreak",data:{consent_string:e||"",listening_context:"",track_list:t.music.list,player_track_id:t.music.track.SNG_ID,player_content_type:t.music.context.TYPE,player_content_id:t.music.context.ID,focus:c?1:0,preroll:m,vastFormat:"VAST_AD"===b()?1:0},success:e=>{const t={...T,...e};"string"==typeof t.cta.tracking_url&&(t.cta.tracking_url=""!==t.cta.tracking_url.trim()?[t.cta.tracking_url]:[]),o.A.isAllowed("ad_force_video")&&(t.type=b()),n(t),N(U,{loadingDuration:(new Date).getTime()-a.getTime()}),(e=>{const{type:t,content:n}=e;if(t!==b())return O(U),setTimeout(()=>s.A.trigger(s.A.triton.audioEnd),100),void setTimeout(()=>s.A.trigger(s.A.ads.adEnd),100);g(n.vast,F,d,n.vastFormatType).then(()=>{L(U,{adCount:k}),C(k+1)}).catch(e=>{M(U,e)})})(t),h(0)},error:e=>{throw D(U,e),e}});return await l},isAdsReady:u}},e)},w=v},Dmvo:(e,t,n)=>{n.d(t,{A:()=>d,q:()=>c});var a=n("q1tI"),i=n("HmE0"),r=n("u7vQ"),s=n("H/eQ"),o=n("fkXJ"),l=n("Wp0Y");const c="flow_tuner_skip_alert",d=({playerContext:e,openModalFlowTuner:t,shouldSkip:n})=>{let c=0,d=null,u=!1;function p(){"next"!==r.Ay.previousSkipAction||u||(c++,1===c?d=setTimeout(()=>{u||(c=0),clearTimeout(d),d=null},9e4):c>=3&&(d&&clearTimeout(d),u=!0,(0,o.A)({title:(0,l.AP)("flowtunerskiptriggerpopup_title_notsatisfiedwithflow_web"),body:(0,l.AP)("flowtunerskiptriggerpopup_subtitle_selectpreferredgenres_web"),status:"info",action:e=>a.createElement(i.$n,{variant:"outline",size:"small",onClick:()=>{t(),e()}},(0,l.AP)("flowtuner_action_tunethisflow_web"))})))}a.useEffect(()=>{if(!n)return c=0,u=!1,s.A.subscribe(s.A.player.trackSkipped,p),()=>{n||(d&&clearTimeout(d),s.A.unsubscribe(s.A.player.trackSkipped,p))}},[n,e.ID])}},EBWn:(e,t,n)=>{n.d(t,{A:()=>l});var a=n("lXQd"),i=n("nLzw"),r=n("Oqsq"),s=n("1Pdy"),o=n("t08u");const l=(e,t,n,l)=>{const{triggerTracking:c}=(0,o.A)(n.TYPE),d={},u=t.toDisplay.map(e=>((0,r.A)(d,e.uuid,e.item.id),e.uuid));return(t,n,r)=>{if("function"!=typeof l)return;const o=u.filter(e=>!t.includes(e));let p=0;if(t.includes(n)){for(p=u.indexOf(n);t.includes(u[p])&&p>0;)p--;p>0&&(p+=1)}else p=o.indexOf(n),p+=r===s.Nz.TOP?0:1;var m;o.splice(p,0,...t),(0,i.A)(o,u)||(l({id:e,order:(m=o,m.map(e=>(0,a.A)(d,e)))}),c({action:"dragdrop",eventaction:t.length>1?"dragdrop-multi":"dragdrop-single"}))}}},EYlq:(e,t,n)=>{n.d(t,{u:()=>i});var a=n("Wp0Y");const i=e=>{switch(e){case"invalid_msisdn":return(0,a.AP)("errormessage_text_invalidphonenumber_web");case"sms_login_limit":return(0,a.AP)("SMScoderesentconfirmationscreen_text_allattemptsused_web");case"internal_error":case"swap_limit":default:return(0,a.AP)("errormessage_text_anerroroccurredpleasetryagain_web");case"invalid_code":case"invalid_code_wrong":return(0,a.AP)("errormessage_text_invalidcode_web");case"code_too_short":return(0,a.AP)("errormessage_text_codeincomplete_web");case"code_too_long":return(0,a.AP)("errormessage_text_codetoomanydigits_web");case"phone_already_used":return(0,a.AP)("Ce numéro est déjà utilisé.")}}},FSqQ:(e,t,n)=>{n.d(t,{A:()=>s});var a,i=n("q1tI"),r=n("juqV");class s extends i.Component{render(){const{className:e}=this.props;let t=(0,r.A)("loader-container",e);return i.createElement("div",{className:t,"data-testid":"loader"},a||(a=i.createElement("div",{className:"loader animate-spin"})))}}},GkgI:(e,t,n)=>{n.d(t,{b:()=>o});var a=n("Wp0Y");let i={},r=!1;const s=()=>{i={full:{active:(0,a.AP)("successmessage_text_addedtoyourfavorites_web"),active_favorite_friend:(0,a.AP)("Suivi"),active_favorite_song:(0,a.AP)("successmessage_text_addedtoyourfavorites_web"),active_play:(0,a.AP)("À l'écoute"),active_play_artist:(0,a.AP)("Mix"),active_play_user:(0,a.AP)("FLOW"),active_shuffle_user:(0,a.AP)("favoritestab_action_shufflemymusic_web"),add:(0,a.AP)("contextualmenu_text_addtomyfavorites_web"),add_favorite_friend:(0,a.AP)("Suivre"),add_favorite_song:(0,a.AP)("Ajouter aux Coups de cœur"),add_dislike_song:(0,a.AP)("bantrack_action_dontrecommendthistrack_web"),add_dislike_artist:(0,a.AP)("banartist_action_dontrecommendthisartist_web"),add_play:(0,a.AP)("Écouter"),add_play_artist:(0,a.AP)("Mix"),add_play_user:(0,a.AP)("FLOW"),add_shuffle_user:(0,a.AP)("favoritestab_action_shufflemymusic_web"),default:(0,a.AP)("contextualmenu_text_addtomyfavorites_web"),default_favorite_friend:(0,a.AP)("Suivre"),default_favorite_song:(0,a.AP)("Ajouter aux Coups de cœur"),default_dislike_song:(0,a.AP)("bantrack_action_dontrecommendthistrack_web"),default_dislike_artist:(0,a.AP)("banartist_action_dontrecommendthisartist_web"),default_play:(0,a.AP)("Écouter"),default_play_artist:(0,a.AP)("Mix"),default_play_user:(0,a.AP)("FLOW"),default_shuffle_user:(0,a.AP)("favoritestab_action_shufflemymusic_web"),hover:(0,a.AP)("contextualmenu_text_deletefrommyfavorites_web"),hover_favorite_app:(0,a.AP)("Retirer de ma bibliothèque"),hover_favorite_friend:(0,a.AP)("Ne plus suivre"),hover_favorite_song:(0,a.AP)("Retirer des Coups de cœur"),hover_dislike_song:(0,a.AP)("banartist_action_allowinmyrecommendations_web"),hover_dislike_artist:(0,a.AP)("banartist_action_allowinmyrecommendations_web"),hover_play:(0,a.AP)("Pause"),hover_play_artist:(0,a.AP)("Mix"),hover_play_user:(0,a.AP)("FLOW"),hover_shuffle_user:(0,a.AP)("favoritestab_action_shufflemymusic_web"),paused_play:(0,a.AP)("Pause"),paused_play_artist:(0,a.AP)("Mix"),paused_play_user:(0,a.AP)("FLOW"),paused_shuffle_user:(0,a.AP)("favoritestab_action_shufflemymusic_web"),resume_play:(0,a.AP)("Reprendre"),resume_play_artist:(0,a.AP)("Mix"),resume_play_user:(0,a.AP)("FLOW"),resume_shuffle_user:(0,a.AP)("favoritestab_action_shufflemymusic_web")},standard:{active:(0,a.AP)("Ajouté"),add:(0,a.AP)("generic_action_add_web"),default:(0,a.AP)("generic_action_add_web"),default_play_small:(0,a.AP)("Écouter"),hover_play_small:(0,a.AP)("Pause"),paused_play_small:(0,a.AP)("Pause"),resume_play_small:(0,a.AP)("Reprendre"),active_play_small:(0,a.AP)("À l'écoute"),hover:(0,a.AP)("Retirer"),active_follow_user:(0,a.AP)("Suivi"),add_follow_user:(0,a.AP)("Suivre"),default_follow_user:(0,a.AP)("Suivre"),hover_follow_user:(0,a.AP)("Ne plus suivre"),default_download:(0,a.AP)("Télécharger"),active_download:(0,a.AP)("Téléchargé"),hover_download:(0,a.AP)("Retirer")}}};function o(e,t,n){!1===r&&(s(),r=!0);var a=n||e.wording;return"none"===a?"":i[a][t+"_"+e.action+"_"+e.type]?i[a][t+"_"+e.action+"_"+e.type]:i[a][t+"_"+e.action]?i[a][t+"_"+e.action]:i[a][t]}},H9G8:(e,t,n)=>{n.d(t,{CZ:()=>d,Ee:()=>u,Hf:()=>o,In:()=>g,RQ:()=>p,SY:()=>l,U9:()=>m,aS:()=>h,jQ:()=>s,qb:()=>c,r_:()=>y,vM:()=>A});var a=n("Wp0Y"),i=n("5U+Y"),r=n("guCc");class s extends Error{constructor(e){super(e),this.name=r.U.FORM_ERROR}}class o extends s{constructor(){super((0,a.AP)("formerrormessage_text_emailaddressformatnotvalid_web")),this.name=r.U.EMAIL_NOT_VALID}}class l extends s{constructor(e){super((0,a.AP)("errormessage_text_domainnnamenotallowed_web",{sprintf:[e]})),this.name=r.U.EMAIL_DOMAIN_NOT_VALID}}class c extends s{constructor(){super((0,a.AP)("errormessage_title_accountalrdyassociatedwithemail_web")),this.name=r.U.EMAIL_ALREADY_USED}}class d extends s{constructor(){super((0,a.WI)("formerrormessage_text_passwordnotenoughchars_web","formerrormessage_text_passwordnotenoughchars_web",{sprintf:[i.wz],count:i.wz})),this.name=r.U.PASSWORD_TOO_SHORT}}class u extends s{constructor(){super((0,a.WI)("formerrormessage_text_passwordtoomanychars_web","formerrormessage_text_passwordtoomanychars_web",{sprintf:[i.K9],count:i.K9})),this.name=r.U.PASSWORD_TOO_LONG}}class p extends s{constructor(){super((0,a.AP)("errormessage_text_passwordnbeginendwithspace_web")),this.name=r.U.PASSWORD_HAS_TRAILLING_WHITESPACE}}class m extends s{constructor(){super((0,a.WI)("formerrormessage_text_usernamenotenoughchars_web","formerrormessage_text_usernamenotenoughchars_web",{sprintf:[i.D6],count:i.D6})),this.name=r.U.BLOGNAME_TOO_SHORT}}class h extends s{constructor(){super((0,a.WI)("formerrormessage_text_usernametoomanychars_web","formerrormessage_text_usernametoomanychars_web",{sprintf:[i.d0],count:i.d0})),this.name=r.U.BLOGNAME_TOO_LONG}}class g extends s{constructor(){super((0,a.AP)("errormessage_text_usernamecannotcontainsemojis_web")),this.name=r.U.BLOGNAME_HAS_SPECIAL_CHARS}}class y extends s{constructor(e){super((0,a.WI)("agerestrictionerrormessage_text_mustbeXyearsentervaliddate_web","agerestrictionerrormessage_text_mustbeXyearsentervaliddate_web",{sprintf:[e],count:e})),this.name=r.U.MIN_LEGAL_AGE}}class A extends s{constructor(){super((0,a.AP)("errormessage_text_ageisinvalid_web")),this.name=r.U.AGE_INVALID}}},I36q:(e,t,n)=>{n.d(t,{d:()=>a});let a=function(e){return e.Welcome="welcome",e.Improve="improve",e}({})},JsMx:(e,t,n)=>{n.d(t,{Ay:()=>h,Ov:()=>m,Y9:()=>p}),n("/eM8");var a=n("q1tI"),i=n("nrKQ"),r=n("lXQd"),s=n("7+7Q"),o=n("TRpf"),l=n("6yJ+"),c=n("vGT4"),d=n("Fzox");const u=(0,a.createContext)({adsConfigState:{},loadAdConfig:async()=>{},getAdsAudioFrequency:()=>({interval:2,start:0,refresh:30,sections:[]}),getProfileType:()=>"regular",getProfileReg:()=>"0",getProfileUs:()=>"0",getIsWhitelisted:()=>"0",getProfileOfferType:()=>"",getDzgroup:()=>[],hasDisplayAds:()=>!0,adsConfigReady:!1,isMidTierOffer:()=>!1}),p=()=>(0,a.useContext)(u),m=({children:e})=>{const[t,n]=(0,a.useState)({profile:{hasConsent:!0}}),[p,m]=(0,a.useState)(!1),{state:h}=(0,c.b)(),g=(0,d.G)(e=>e.user),y=(0,o.wA)();let A=!1;(0,a.useEffect)(()=>{const e="GB"===g.COUNTRY?[1,2,3,4,5,6,7,8,9,10,11]:[1,2,3,4,7],t=null==h||!h.settings||h.settings.noIabVendors.includes(1),n=!(null==h||!h.settings)&&e.every(e=>{var t;const n=null===(t=h.settings)||void 0===t?void 0:t.purposes.find(t=>t.id===e);return!0===(null==n?void 0:n.value)});E({profile:{hasConsent:t&&n}})},[h]);const E=e=>{const a=(0,s.A)(t,e);n(a),y({type:l.J,data:a})},_=()=>(0,r.A)(t,"profile.name");return a.createElement(u.Provider,{value:{adsConfigState:t,loadAdConfig:async()=>{A||await(async()=>{A=!0;try{await i.A.call({method:"deezer.adConfig",success:e=>{E(e)}}),A=!1,m(!0)}catch(e){throw A=!1,e}})()},getProfileType:_,hasDisplayAds:()=>"starter"!==_(),getProfileReg:()=>{var e;return null===(e=(0,r.A)(t,"profile.reg"))||void 0===e?void 0:e.toString()},getDzgroup:()=>(0,r.A)(t,"targeting.smart.dzgroup"),getIsWhitelisted:()=>{var e;return null===(e=(0,r.A)(t,"targeting.smart.whitelisted_users"))||void 0===e?void 0:e.toString()},adsConfigReady:p,getProfileOfferType:()=>{var e;return null===(e=(0,r.A)(t,"profile.offer_type"))||void 0===e?void 0:e.toString()},isMidTierOffer:()=>(0,r.A)(t,"profile.offer_type")===l.u.DEEZER_NOW,getAdsAudioFrequency:()=>(0,r.A)(t,"config.audio")}},e)},h=u},KGX5:(e,t,n)=>{n.r(t),n.d(t,{default:()=>b}),n("/eM8");var a=n("q1tI"),i=n("u7vQ"),r=n("WKgy"),s=n("tZCQ"),o=n("9odk"),l=n("RTUF"),c=n("JsMx"),d=n("Aw62"),u=n("4PKR");const p=({children:e})=>a.createElement(u.wZ,null,a.createElement(c.Ov,null,a.createElement(d.J0,null,e)));var m=n("A2sV"),h=n("jCk4");const g=()=>{const{dispatch:e}=(0,h.w)(),{data:t}=(0,m.JAg)(),{data:n}=(0,m.CN7)();return(0,a.useEffect)(()=>{var n;null!=t&&null!==(n=t.theming)&&void 0!==n&&n.palette&&e({type:"UPDATE_PALETTE",palette:t.theming.palette,accentIdentifier:t.theming.palette.accentIdentifier})},[t,e]),(0,a.useEffect)(()=>{var t;e({type:"UPDATE_PALETTE_PERMISSION",hasPalettePermission:Boolean(null==n||null===(t=n.permissions)||void 0===t?void 0:t.access.hasPaletteSelector)})},[n,e]),null};var y;const A=a.lazy(()=>Promise.all([n.e(9169),n.e(4201),n.e(9842),n.e(7987),n.e(1260),n.e(7783),n.e(7982),n.e(5310),n.e(2818),n.e(4897),n.e(8199),n.e(26),n.e(6463),n.e(7765),n.e(1421),n.e(781),n.e(7456),n.e(5665),n.e(2223),n.e(1925),n.e(7681),n.e(3284),n.e(308),n.e(2416)]).then(n.bind(n,"fSih"))),E=a.lazy(()=>n.e(4569).then(n.bind(n,"tpKx"))),_=a.lazy(()=>n.e(3592).then(n.bind(n,"fUz9"))),f=a.lazy(()=>Promise.resolve().then(n.bind(n,"bbm1"))),b=e=>{const t=()=>0!==r.A.getState().user.USER.USER_ID&&r.A.getState().user.USER.OPTIONS.ads_display&&i.Ay.isAdvertisingAllowed()&&0!==r.A.getState().user.USER.USER_ID,n=t()?E:A,c=s.A.isAllowed("public_api_onboarding")?a.createElement(o.Ay,null,a.createElement(n,e)):a.createElement(n,e),d=a.createElement(_,{offline:s.A.isAllowed("public_api_album")},c,y||(y=a.createElement(g,null))),u=s.A.isAllowed("redcar")?a.createElement(f,null,d):d,m=t()?a.createElement(p,null,u):u;return a.createElement(a.Suspense,{fallback:null},a.createElement(l.m,null,m))}},LOxp:(e,t,n)=>{n.d(t,{$:()=>E,r:()=>A}),n("EV0h"),n("gS5K");var a=n("hYAH"),i=n("AY3M"),r=n("AfN5"),s=n("5G9X"),o=n("u7vQ"),l=n("H/eQ"),c=n("WmA5"),d=n("p/gB"),u=n("nxAS"),p=n("/uRm"),m=n("aoCz"),h=n("tZCQ"),g=n("TqF5");const y={"/":"/","/home":"/","/settings":"/account","/settings/app":"/account/settings","/settings/display_settings":"/account/display","/premiumtab":"/offers"},A=["/game","/story"];function E(e,{dispatch:t,lovedTracksId:n,userId:A}){if(!e.startsWith("deezer://"))return!1;const{pathname:E,searchParams:_}=new URL(e.replace("deezer://","https://"));if(y[E])return"/premiumtab"===E?(window.open(`${y[E]}?${_.toString()}`,"_blank"),!0):(c.A.push(y[E]),!0);if("/settings/audio"===E)return l.A.trigger(l.A.player.openAudioSettings),!0;if(E.startsWith("/album")||E.startsWith("/artist")||E.startsWith("/channels")||E.startsWith("/playlist")||E.startsWith("/profile")||E.startsWith("/track"))return"/profile/me/playlists/create"===E?(t((0,g.qf)({name:"PLAYLIST_ASSISTANT",props:{type:m.F.CREATION},background:"background.neutral.primary.default"})),!0):(c.A.push(E),"true"===_.get("autoplay")||_.get("autoplay"),!0);if(E.startsWith("/simplestory")){const[,,e]=E.split("/");return!!e&&(t((0,a.o)({id:e})),!0)}if("/user/me/flow"===E)return o.Ay.play({context:{ID:A,TYPE:(0,d.Pe)(s.Ay.Flow,i.pN)},id:A,radio:!0,type:r.Kk.USER}),!0;if("/user/me/tracks"===E)return o.Ay.play({context:{ID:n,TYPE:(0,d.Pe)(s.Ay.Playlist,i.x6)},id:n,type:s.Ay.Playlist}),!0;if(E.startsWith("/game"))return t((0,u.J2)({name:p.F.BRIDGED_WEBVIEW,data:{pathname:E,searchParams:_,hideLogo:!0,disableDisplayPadding:!0}})),!0;if(E.startsWith("/story")||E.startsWith("/genplaylist")&&h.A.isAllowed("employee_feature"))return t((0,u.J2)({name:p.F.BRIDGED_WEBVIEW,data:{pathname:E,fixedLogo:!0}})),!0;if(E.startsWith("/redirect")){const e=_.get("url");return!!e&&(window.open(e,"_blank"),!0)}if(E.startsWith("/smarttracklist")){const[,,e]=E.split("/");return c.A.push(E),"true"===_.get("autoplay")&&o.Ay.play({context:{ID:e,TYPE:"smarttracklist_page"},id:e,type:s.Ay.Smarttracklist}),!0}if(E.startsWith("/flow_tuner")&&h.A.isAllowed("feature_2025_flow_custo")){const[,,e]=E.split("/");return!!e&&(t((0,g.qf)({name:"FLOW_CUSTO",props:{flowId:e},background:"background.neutral.primary.default"})),!0)}return!1}},WHSZ:(e,t,n)=>{n.d(t,{O:()=>c,x:()=>u});var a=n("77Ru"),i=n.n(a),r=n("eC9Z"),s=n("pUfN"),o=n("gLR9"),l=n("63mb");const c=i().com.deezer.kmp.gatekeeper.KmpGatekeep.values().map(e=>e.value),d=c.map(e=>{const t=(0,r.WV)({itemType:s.Wi.GATEKEEP,itemName:e});return"boolean"!=typeof t?null:new(i().com.deezer.kmp.gatekeeper.GatekeepValue)(e,t)}).filter(Boolean),u=0===d.length?(new(i().com.deezer.kmp.gatekeeper.GatekeepProviderFactory)).create(l.F,i().com.deezer.kmp.usersession.api.sharedUserSessionApi(o.C)):(new(i().com.deezer.kmp.gatekeeper.GatekeepProviderFactory)).createWithOverrides(l.F,i().com.deezer.kmp.mp.copyToMPList(c),i().com.deezer.kmp.mp.copyToMPList(d),i().com.deezer.kmp.usersession.api.sharedUserSessionApi(o.C))},ZOeD:(e,t,n)=>{n.d(t,{V:()=>o}),n("/eM8");var a,i=n("Vd8Q");n("EV0h"),n("gS5K");const r={Spotify:"https://open.spotify.com/track/",Apple:`https://music.apple.com/${null!==(a=function(){if("undefined"==typeof window)return null;const e=window.location.href;return new URL(e).pathname.split("/")[1]||null}())&&void 0!==a?a:"en"}/song/`,YouTubeMusic:"https://music.youtube.com/watch?v="},s=`//${i.default.get("host_website_ssl")}/profile/me`;class o{constructor(){this.token=""}async v1(e){const t={...e};this.token&&(t.deezer_access_token=this.token);const n=await fetch("https://www.tunemymusic.com/api/AuthenticateUser.php",{method:"POST",cache:"default",body:JSON.stringify(t)}).catch(e=>{throw e});if(!n.ok||200!==n.status)throw new Error("TMM: response error");return n.json()}async v2(e,t){const n=await fetch("https://api.tunemymusic.com/v2/api"+e,{headers:{"Content-Type":"application/json"},method:"POST",cache:"default",body:JSON.stringify({...t})});if(!n.ok||200!==n.status)throw new Error("TMM: response error");return n.json()}setToken(e){this.token=e}async getLibraryTransferUrl(e,t,n){return this.v1({deezer_user_id:e,deezer_user_name:t,deezer_redirect_url:n?"deezer://reload":s})}async findTrack(e){var t;const n={...e,region:"Apple"===e.platform?null===(t=e.region)||void 0===t?void 0:t.toUpperCase():void 0},a=await this.v2("/FindTrack",n);return"not found"===a.result?Promise.reject(new Error("Track not found")):{...a,url:(i=e.platform,s=a.trackId,r[i]+s)};var i,s}}},Zah6:(e,t,n)=>{n.d(t,{A:()=>g});var a,i=n("+9dH"),r=n("q1tI"),s=n("TRpf"),o=n("TqF5"),l=n("Zlrv"),c=n("nspE"),d=n("PvuB"),u=n("WKgy"),p=n("Qi9J");const m=e=>{switch(e){case"small":return"lg";case"medium":return"xl";default:return"3xl"}};class h extends r.Component{constructor(e){super(e),this._open=this._open.bind(this),this._close=this._close.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onOutsideMouseDown=this._onOutsideMouseDown.bind(this),this._contentRef=r.createRef()}componentDidMount(){document.addEventListener("keydown",this._onKeyDown),document.addEventListener("mousedown",this._onOutsideMouseDown),document.addEventListener("touchstart",this._onOutsideMouseDown)}componentWillUnmount(){document.removeEventListener("keydown",this._onKeyDown),document.removeEventListener("mousedown",this._onOutsideMouseDown),document.removeEventListener("touchstart",this._onOutsideMouseDown)}render(){const{isOpen:e,data:t,name:n,size:s,variant:o,testid:u,background:h,padding:g}=this.props;if(!e)return null;const y=(0,p.C)(n);return y?r.createElement(l.aF,{isOpen:e,variant:null!=o?o:"foundation",size:m(s),isCentered:!0,onClose:this._close,closeOnOverlayClick:!this.props.disableClosingAction},a||(a=r.createElement(c.m,null)),r.createElement(d.$,{ref:this._contentRef,"data-testid":u,background:h||void 0,padding:g||void 0},r.createElement(r.Suspense,{fallback:null},r.createElement(y,(0,i.A)({},t,{name:n}))))):null}_onKeyDown(e){const{isOpen:t,disableClosingAction:n}=this.props;t&&!n&&27===e.keyCode&&this._close()}_onOutsideMouseDown(e){const{isOpen:t,disableClosingAction:n}=this.props;t&&!n&&"HTML"!==e.target.tagName&&e.target.contains(this._contentRef.current)&&(e.stopPropagation(),this._close())}_close(){this.props.closeModal(!0)}_open(){this.props.openModal()}}h.defaultProps={size:"large",addRadius:!1},u.A.addReducers({modal:o.Ay});const g=(0,s.Ng)(({modal:e})=>({name:e.name,data:e.props,disableClosingAction:e.disableClosingAction,isOpen:""!==e.name,size:e.size,classNameClose:e.classNameClose,addRadius:e.addRadius,variant:e.variant,testid:e.testid,background:e.background,padding:e.padding}),{closeModal:o.Oo,openModal:o.qf})(h)},axbb:(e,t,n)=>{n.d(t,{s:()=>l});var a=n("Fzox"),i=n("xobL"),r=n("q1tI"),s=n("G04z"),o=n("nLzw");const l=()=>{const[e,t]=(0,r.useState)(!1),n=(0,a.G)(({user:e})=>{const t=(0,i.qo)(e);return{userId:(0,i.F6)(e).toString(),...t&&{email:t}}}),l=(0,s.u)(),c=(0,r.useRef)({userDetail:n}).current;return(0,r.useEffect)(()=>{l.init(),c.userDetail={},t(!0)},[]),(0,r.useEffect)(()=>{const{userId:t,...a}=n;e&&t&&((0,o.A)(c.userDetail,n)||(l.identify({userId:t,...a}),c.userDetail=n))},[e,n]),null}},bbm1:(e,t,n)=>{n.r(t),n.d(t,{DeeztoolsContext:()=>u,default:()=>m,useDeezToolsContext:()=>p});var a=n("q1tI"),i=n("eC9Z"),r=n("tZCQ"),s=n("Fzox"),o=n("xobL"),l=n("pUfN");const c={[l.Wi.CONFIG]:{},[l.Wi.FEATURE]:{},[l.Wi.GATEKEEP]:{},isAuthorized:!1,dispatch:()=>{}},d=(e=c,t)=>{switch(t.type){case l.nh:var n;if(!t.item)throw new Error("An item to update has to be provided");if(!e.isAuthorized)return;return void 0!==(null===(n=e[t.item.category])||void 0===n?void 0:n[t.item.name])?(delete e[t.item.category][t.item.name],localStorage.removeItem((0,i.Fl)({itemType:t.item.category,itemName:t.item.name})),{...e}):{...e,[t.item.category]:{...e[t.item.category],[t.item.name]:t.item.value}};case l.u3:if(!t.item)throw new Error("An item to update has to be provided");if(!e.isAuthorized)return;return{...e,[t.item.category]:{...e[t.item.category],[t.item.name]:t.item.value}};case l.u5:return{...c};default:throw new Error(`Action type ${t.type} is not handled`)}},u=(0,a.createContext)(void 0),p=()=>{const e=(0,a.useContext)(u);if(null==e||!e.isAuthorized)return{};if(void 0===e)throw new Error("useDeezToolsContext must be used within a DeezToolsProvider");return e},m=({children:e})=>{const t=(0,s.G)(e=>(0,o.FE)(e.user)),n=t&&(r.A.isAllowed("redcar")||!1),[i,l]=(0,a.useReducer)(d,{...c,isAuthorized:n});return a.createElement(u.Provider,{value:{...i,dispatch:l,isAuthorized:n}},e)}},fEzs:(e,t,n)=>{n.d(t,{h:()=>i});var a=n("q1tI");function i(){const[e,t]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{const e=document.getElementsByClassName("naboo")[0],n=()=>{window.innerWidth<=1160?(e.style.setProperty("--layout-sidebar-width","80px"),t(!0)):(e.style.setProperty("--layout-sidebar-width",""),t(!1))};return n(),window.addEventListener("resize",n,{passive:!0}),()=>window.removeEventListener("resize",n)},[]),e}},fSih:(e,t,n)=>{n.r(t),n.d(t,{App:()=>yA,default:()=>EA});var a=n("+9dH"),i=(n("/eM8"),n("q1tI")),r=n("TRpf"),s=n("juqV"),o=n("X6oL"),l=n("Qyje"),c=n.n(l),d=n("WmA5"),u=n("D+Zh"),p=n("ntT5"),m=n("WBQ7");const h="local",g="session",y=window.sessionStorage,A={getStorageKey:e=>`ALERT_DISMISSED_${e}`,markAsDismissed(e,t=h){const n=this.getStorageKey(e);t!==g?m.default.set(n,!0):y.setItem(n,!0)},isDismissed(e,t=h){const n=this.getStorageKey(e);return t===g?Boolean(y.getItem(n)):m.default.isset(n)}};var E=n("H/eQ"),_=n("tZCQ"),f=n("yyc2"),b=n("z+LD"),v=n("e2eG"),k=n("iooo"),T=n("MVPB"),C=n("4OMY"),w=n("m+Ot"),S=n("xobL"),x=n("WKgy"),I=n("LOQS"),P=n("HQK9");n("EV0h"),n("gS5K");const R=e=>{const t=new URL(e).pathname.split("/").filter(Boolean);return t.length<=1?"home":2!==t[0].length?t[0]:t[1]};var L=(0,C.A)("logCenter"),N=(0,C.A)("log");const O=new class{constructor(e){Object.defineProperty(this,L,{writable:!0,value:void 0}),Object.defineProperty(this,N,{writable:!0,value:e=>{if(0!==Math.floor(100*Math.random())||!e)return;const t={name:e.name,value:e.value,navigation_type:e.navigationType,rating:e.rating,url:window.location.href,page_category:R(window.location.href),user_id:(0,S.F6)(x.A.getState().user).toString(),is_premium:(0,S.ki)(x.A.getState().user)};(0,T.A)(this,L)[L].log((0,P.L)("vitals.web_vitals","1.0.0",t))}}),(0,T.A)(this,L)[L]=e}init(){(0,w.IN)(e=>{(0,T.A)(this,N)[N](e)}),(0,w.zB)(e=>{(0,T.A)(this,N)[N](e)}),(0,w.rH)(e=>{(0,T.A)(this,N)[N](e)}),(0,w.fK)(e=>{(0,T.A)(this,N)[N](e)}),(0,w.Ck)(e=>{(0,T.A)(this,N)[N](e)})}}(I.A);var D=n("aHAS"),M=n("MeIc"),U=n("nxAS"),z=n("mUtM"),F=n("TqF5"),B=n("Qi9J"),q=n("Zah6"),G=n("Zlrv"),H=n("nspE"),V=n("PvuB"),Y=n("CV49"),Q=n("yN0V"),W=n("HfhX"),K=n("LSdk"),j=n("LjZa"),$=n("WfRu"),X=n("/uRm");const J={[X.F.ONBOARDING_LEGACY]:i.lazy(()=>n.e(4822).then(n.bind(n,"R3ky"))),[X.F.ONBOARDING]:i.lazy(()=>n.e(5986).then(n.bind(n,"5s/P"))),[X.F.SELECT_PROFILE]:i.lazy(()=>n.e(6224).then(n.bind(n,"eyqC"))),[X.F.BRIDGED_WEBVIEW]:i.lazy(()=>n.e(5528).then(n.bind(n,"nMxs"))),[X.F.PLAYLIST_ASSISTANT]:i.lazy(()=>n.e(5528).then(n.bind(n,"9kfl")))};var ee,te;class ne extends i.Component{constructor(...e){super(...e),this._containerRef=i.createRef(),this.renderModal=(e,t,n)=>i.createElement(G.aF,{isOpen:t,motionPreset:"none",size:"full",portalProps:{containerRef:this._containerRef},onClose:()=>{},trapFocus:!1},ee||(ee=i.createElement(H.m,null)),i.createElement(V.$,{mx:"0",py:"0",bg:"background.neutral.primary.default"},n?i.createElement(Y.c,{bg:"background.neutral.primary.default",maxH:"100vh"},e):i.createElement(i.Fragment,null,e))),this.renderDrawer=(e,t,n)=>i.createElement(Q._s,{isOpen:t,placement:"bottom",size:"full",portalProps:{containerRef:this._containerRef},onClose:()=>{},trapFocus:!1},te||(te=i.createElement(H.m,null)),i.createElement(W.z,null,n?i.createElement(Y.c,{bg:"background.neutral.primary.default",overflow:"hidden",overflowY:"auto"},e):i.createElement(i.Fragment,null,e))),this._close=()=>{this.props.closeScreen()}}componentDidUpdate(e){!e.isOpen&&this.props.isOpen&&this.props.hidePopper()}render(){const{isOpen:e,data:t,name:n,withTransition:r}=this.props,s=!("hideLogo"in t)||!1===t.hideLogo,o="fixedLogo"in t&&!0===t.fixedLogo,l=!("disableDisplayPadding"in t)||!1===t.disableDisplayPadding,c=function(e){return J[e]||!1}(n),d=e&&Boolean(c),u=i.createElement(i.Fragment,null,s?i.createElement("div",{className:"full-screen-logo-holder"},i.createElement(K.T,{h:"24px",mt:"20px",position:o?"fixed":void 0})):null,d&&c&&i.createElement(i.Suspense,{fallback:null},i.createElement(c,(0,a.A)({},t,{closeScreen:this._close}))));return i.createElement("div",{ref:this._containerRef},r?this.renderDrawer(u,d,l):this.renderModal(u,d,l))}}ne.defaultProps={closeScreen:j.A,withTransition:!1},x.A.addReducers({fullscreen:U.Ay});const ae=(0,r.Ng)(({fullscreen:{name:e,data:t}})=>({name:e,data:t,isOpen:Boolean(e)}),{closeScreen:U.Fn,hidePopper:$.Lm})(ne);var ie=n("k9rF"),re=n("VQs7"),se=n("vHlZ"),oe=n("Wp0Y");const le=e=>{const t={status:"info",message:(0,oe.AP)("Votre ordinateur semble être hors ligne. Nous essayons de vous reconnecter."),...e};return i.createElement(se.A,t)};var ce=n("vbKs"),de=n("TDRX");class ue extends i.PureComponent{constructor(...e){super(...e),this.alertComponents={[ce.ts]:le,[ce.B6]:i.lazy(()=>n.e(1970).then(n.bind(n,"x38L"))),[ce.Iv]:i.lazy(()=>n.e(98).then(n.bind(n,"0vC3"))),[ce.AT]:i.lazy(()=>n.e(1169).then(n.bind(n,"/AoH"))),[ce.I6]:i.lazy(()=>n.e(846).then(n.bind(n,"eRco"))),[ce.mu]:i.lazy(()=>n.e(591).then(n.bind(n,"mYFn"))),[ce.v4]:i.lazy(()=>n.e(877).then(n.bind(n,"pSuW"))),[ce.KE]:i.lazy(()=>n.e(2344).then(n.bind(n,"jFpR"))),[ce.cn]:i.lazy(()=>n.e(6745).then(n.bind(n,"598w"))),[ce.aC]:i.lazy(()=>n.e(3918).then(n.bind(n,"2UWz"))),[ce.h5]:i.lazy(()=>n.e(1017).then(n.bind(n,"AhgF"))),[ce.IV]:i.lazy(()=>n.e(4333).then(n.bind(n,"y+nF"))),[ce.jE]:i.lazy(()=>n.e(3287).then(n.bind(n,"cueV")))}}render(){const{alerts:e}=this.props;return i.createElement(de.a,{className:"page-alerts"},i.createElement(ie.N,null,e.map(e=>{const t=this.alertComponents[e.id]||se.A;return i.createElement(re.P.div,{key:e.id,initial:{opacity:0,transform:"translate3d(0, -8px, 0)"},animate:{opacity:1,transform:"translate3d(0, 0, 0)"},exit:{opacity:0,transform:"translate3d(0, -8px, 0)"}},i.createElement("div",{className:"alert-wrapper"},i.createElement(i.Suspense,{fallback:null},i.createElement(t,(0,a.A)({id:e.id},e.options)))))})))}}const pe=(0,r.Ng)(({alerts:e})=>({alerts:e}))(ue);var me=n("VkUI"),he=n("WrS5");const ge=[{name:"gift_result_premium",modal:he.b.LIGHTBOX_GIFT_RESULT,getProps:e=>{const t=new URL(e);return{email:decodeURIComponent(t.searchParams.get("email")||""),code:t.searchParams.get("code")}},size:"small"}],ye=()=>{const e=window.__DZR_MODAL_PATH__||{},t=(0,r.wA)();return(0,i.useEffect)(()=>{var n;if("string"==typeof(null==(n=e)?void 0:n.type)&&"string"==typeof(null==n?void 0:n.page)&&"modal"===e.type){const n=ge.find(t=>e.page.includes(t.name));var a;if(n)return void t((0,F.qf)({name:n.modal,props:n.getProps(e.page),size:null!==(a=n.size)&&void 0!==a?a:"small"}));me.default.open(decodeURIComponent(e.page))}},[e]),null};var Ae=n("ea/m"),Ee=n("5pmF"),_e=n("axbb"),fe=n("kSUS"),be=n("Ty5D"),ve=n("go2a"),ke=n("Swh8"),Te=n("HmE0"),Ce=n("XkdG"),we=n("V5pB"),Se=n("7bxg"),xe=n("D2sd"),Ie=n("4liH"),Pe=n("Fzox"),Re=n("xOQS"),Le=n("3o0m"),Ne=n("CdHq"),Oe=n("y7xR"),De=n("Qx5r"),Me=n("KVgY"),Ue=n("A2sV"),ze=n("p/gB"),Fe=n("0O3b"),Be=n("5G9X");function qe(e){switch(e){case"Track":case"Livestream":case"Artist":case"Playlist":case"Album":return Be.Ay[e];case"Podcast":return Be.Ay.Show;case"PodcastEpisode":return Be.Ay.Episode;default:return""}}var Ge=n("Weh+"),He=n("gXj/"),Ve=n("lhvF"),Ye=n("FFW9"),Qe=n("A0BP"),We=n("lD5d"),Ke=n("pVdW"),je=n("AfN5"),$e=n("u7vQ"),Xe=n("9OcB"),Je=n("7bA3"),Ze=n("GkjM"),et=n("3gOz"),tt=n("Hews");const nt=({isFavorite:e,toggleFavorite:t,...n})=>i.createElement(Te.K0,(0,a.A)({icon:i.createElement(tt.A,{isActive:e}),onClick:t,variant:"ghost","aria-label":e?(0,oe.AP)("Retirer des Coups de cœur"):(0,oe.AP)("Ajouter aux Coups de cœur")},n));var at=n("gczi"),it=n("gVf4"),rt=n("0JBE");const st=({track:e,hovered:t})=>{var n,a;const{isFavorite:r,toggleFavorite:s}=(0,at.A)(e.id),{isPaused:o,isPlaying:l}=(0,it.A)(Be.Ay.Track,e.id),{legacyContext:c}=(0,rt.iQ)();return i.createElement(Ge.Q,null,i.createElement(He.h,null,i.createElement(Xe.A,{src:null===(n=e.album)||void 0===n||null===(n=n.cover)||void 0===n?void 0:n.small[0],isExplicitCover:Boolean(null===(a=e.album)||void 0===a||null===(a=a.cover)||void 0===a?void 0:a.explicitStatus),type:Be.Ay.Track},i.createElement(Ve.Q,null,i.createElement(Je.A,{type:Be.Ay.Track,id:e.id,displayForce:t})))),i.createElement(Ye.f,{flex:1,role:"button",onClick:()=>{l||o?$e.Ay.control.togglePause():$e.Ay.play({id:e.id,type:je.Kk.TRACK_MIX,context:c,forceAsFirstTrack:!0})},textAlign:"left"},i.createElement(et.A,null,i.createElement(Qe.n,{"data-testid":"track_title"},e.title)),i.createElement(et.A,null,i.createElement(We.P,null,i.createElement(Ke.E,{as:"span"},(0,oe.AP)("generic_title_track_web"))," • ",e.contributors.edges.map((t,n)=>i.createElement(i.Fragment,{key:`track_contributors_${t.node.id}`},i.createElement(Ze.A,{underlined:!0,to:`/artist/${t.node.id}`,onClick:e=>e.stopPropagation(),"data-testid":"track_subtitle_contributor"},t.node.name),n<e.contributors.edges.length-1&&", "))))),i.createElement(Ye.f,null,i.createElement(nt,{isFavorite:r,toggleFavorite:s,size:"small"})))};var ot=n("x4+n");const lt=({episode:e,hovered:t})=>{var n,a;const{isPaused:r,isPlaying:s}=(0,it.A)(Be.Ay.Episode,e.id),{legacyContext:o}=(0,rt.iQ)(),[l]=(0,Pe.G)(e=>[(0,S.mI)({SERVER_TIMESTAMP:(0,S.mS)(e.user),clientTimestampDelta:(0,S.gE)(e.user)})]);return i.createElement(Ge.Q,null,i.createElement(He.h,null,i.createElement(Xe.A,{src:null===(n=e.podcast.cover)||void 0===n?void 0:n.small[0],type:Be.Ay.Episode,isExplicitCover:Boolean(null===(a=e.podcast.cover)||void 0===a?void 0:a.explicitStatus)},i.createElement(Ve.Q,null,i.createElement(Je.A,{type:Be.Ay.Episode,id:e.id,displayForce:t})))),i.createElement(Ye.f,{flex:1,role:"button",onClick:()=>{s||r?$e.Ay.control.togglePause():$e.Ay.play({id:e.id,type:je.Kk.EPISODE,context:o})},textAlign:"left"},i.createElement(et.A,null,i.createElement(Qe.n,{"data-testid":"episode_title"},e.title)),i.createElement(et.A,null,i.createElement(We.P,null,i.createElement(Ke.E,{as:"span"},(0,oe.AP)("generic_title_episode_web"))," • ",i.createElement(Ze.A,{underlined:!0,to:`/show/${e.podcast.id}`,onClick:e=>e.stopPropagation(),"data-testid":"episode_subtitle_podcastTitle"},e.podcast.displayTitle)," • ",i.createElement(Ke.E,{as:"span","data-testid":"episode_subtitle_publicationDate"},(0,ot.E)(e.publicationDate,l))))))},ct=({liveStream:e,hovered:t})=>{var n,a;const{isPaused:r,isPlaying:s}=(0,it.A)(Be.Ay.Livestream,e.id),{legacyContext:o}=(0,rt.iQ)();return i.createElement(Ge.Q,null,i.createElement(He.h,null,i.createElement(Xe.A,{src:null===(n=e.cover)||void 0===n?void 0:n.small[0],type:Be.Ay.Livestream,isExplicitCover:Boolean(null===(a=e.cover)||void 0===a?void 0:a.explicitStatus)},i.createElement(Ve.Q,null,i.createElement(Je.A,{shouldPlayRadio:!0,type:Be.Ay.Livestream,id:e.id,displayForce:t})))),i.createElement(Ye.f,{flex:1,role:"button",onClick:()=>{s||r?$e.Ay.control.togglePause():$e.Ay.play({id:e.id,type:je.Kk.LIVESTREAM,context:o})},textAlign:"left"},i.createElement(et.A,null,i.createElement(Qe.n,{"data-testid":"livestream_title"},e.name)),i.createElement(We.P,null,i.createElement(Ke.E,{as:"span"},(0,oe.AP)("generic_title_liveradioSingular_web")),e.isOnStream&&i.createElement(i.Fragment,null," • ",i.createElement(Ke.E,{as:"span","data-testid":"livestream_subtitle_onStream"},(0,oe.AP)("liveradio_title_onair_web"))))))};var dt=n("23Qi"),ut=n("23mk");const pt=({artist:e,hovered:t})=>{var n;const{isFavorite:a,toggleFavorite:r}=(0,ut.A)(e.id);return i.createElement(Ge.Q,null,i.createElement(He.h,null,i.createElement(Xe.A,{src:null===(n=e.picture)||void 0===n?void 0:n.small[0],type:Be.Ay.Artist,borderRadius:"rounded"},i.createElement(Ve.Q,null,i.createElement(Je.A,{shouldPlayRadio:!0,type:Be.Ay.Artist,id:e.id,displayForce:t})))),i.createElement(Ye.f,{as:Ze.A,flex:1,to:`/artist/${e.id}`},i.createElement(et.A,null,i.createElement(Qe.n,{_hover:{textDecoration:"underline"},width:"fit-content","data-testid":"artist_title"},e.name)),i.createElement(We.P,null,i.createElement(Ke.E,{as:"span"},(0,oe.AP)("generic_title_artist_web"))," • ",i.createElement(Ke.E,{as:"span","data-testid":"artist_subtitle_fans"},(0,oe.WI)("%s fan","%s fans",{count:e.fansCount,sprintf:[(0,dt.A)(e.fansCount)]})))),i.createElement(Ye.f,null,i.createElement(nt,{isFavorite:a,toggleFavorite:r,size:"small"})))};var mt=n("syib");const ht=({playlist:e,hovered:t})=>{var n,a,r,s;const{isFavorite:o,toggleFavorite:l}=(0,mt.A)(e.id);return i.createElement(Ge.Q,null,i.createElement(He.h,null,i.createElement(Xe.A,{src:null===(n=e.picture)||void 0===n?void 0:n.small[0],isExplicitCover:Boolean(null===(a=e.picture)||void 0===a?void 0:a.explicitStatus),type:Be.Ay.Playlist},i.createElement(Ve.Q,null,i.createElement(Je.A,{type:Be.Ay.Playlist,id:e.id,displayForce:t})))),i.createElement(Ye.f,{flex:1},i.createElement(et.A,null,i.createElement(Qe.n,{as:Ze.A,to:`/playlist/${e.id}`,"data-testid":"playlist_title"},i.createElement(Ke.E,{as:"span",_hover:{textDecoration:"underline"}},e.title))),i.createElement(et.A,null,i.createElement(We.P,null,i.createElement(Ke.E,{as:"span"},(0,oe.AP)("generic_title_playlist_web"))," • ",i.createElement(Ze.A,{underlined:!0,to:`/profile/${null===(r=e.owner)||void 0===r?void 0:r.id}`,"data-testid":"playlist_subtitle_owner"},null===(s=e.owner)||void 0===s?void 0:s.name)))),i.createElement(Ye.f,null,i.createElement(nt,{isFavorite:o,toggleFavorite:l,size:"small"})))};var gt=n("nQur");const yt=({album:e,hovered:t})=>{var n,a;const{isFavorite:r,toggleFavorite:s}=(0,gt.A)(e.id);return i.createElement(Ge.Q,null,i.createElement(He.h,null,i.createElement(Xe.A,{src:null===(n=e.cover)||void 0===n?void 0:n.small[0],isExplicitCover:Boolean(null===(a=e.cover)||void 0===a?void 0:a.explicitStatus),type:Be.Ay.Album},i.createElement(Ve.Q,null,i.createElement(Je.A,{type:Be.Ay.Album,id:e.id,displayForce:t})))),i.createElement(Ye.f,{flex:1},i.createElement(et.A,null,i.createElement(Qe.n,{as:Ze.A,to:`/album/${e.id}`,"data-testid":"album_title"},i.createElement(Ke.E,{as:"span",_hover:{textDecoration:"underline"}},e.displayTitle))),i.createElement(et.A,null,i.createElement(We.P,null,i.createElement(Ke.E,{as:"span"},(0,oe.AP)("generic_title_album_web"))," • ",e.contributors.edges.map((t,n)=>i.createElement(i.Fragment,{key:`search_history_${t.node.id}`},i.createElement(Ze.A,{underlined:!0,to:`/artist/${t.node.id}`,"data-testid":"album_subtitle_contributor"},t.node.name),n<e.contributors.edges.length-1&&", "))))),i.createElement(Ye.f,null,i.createElement(nt,{isFavorite:r,toggleFavorite:s,size:"small"})))};n("aRRr");var At=n("6rbY");const Et=({podcast:e,hovered:t})=>{var n,a;const{isFavorite:r,toggleFavorite:s}=(0,At.A)(e.id);return i.createElement(Ge.Q,null,i.createElement(He.h,null,i.createElement(Xe.A,{src:null===(n=e.cover)||void 0===n?void 0:n.small[0],isExplicitCover:Boolean(null===(a=e.cover)||void 0===a?void 0:a.explicitStatus),type:Be.Ay.Show},i.createElement(Ve.Q,null,i.createElement(Je.A,{type:Be.Ay.Show,id:e.id,displayForce:t})))),i.createElement(Ye.f,{flex:1},i.createElement(et.A,null,i.createElement(Qe.n,{as:Ze.A,to:`/show/${e.id}`,"data-testid":"podcast_title"},i.createElement(Ke.E,{as:"span",_hover:{textDecoration:"underline"}},e.displayTitle))),i.createElement(et.A,null,i.createElement(We.P,null,i.createElement(Ke.E,{as:"span"},(0,oe.AP)("generic_title_podcast_web")),e.description&&i.createElement(i.Fragment,null," • ",i.createElement(Ke.E,{as:"span","data-testid":"podcast_subtitle_description"},e.description))))),i.createElement(Ye.f,null,i.createElement(nt,{isFavorite:r,toggleFavorite:s,size:"small"})))};var _t,ft,bt=n("FSqQ");const vt=()=>{var e,t;const[n,a]=i.useState(null),s=i.useRef(null),{data:o,fetchMore:l}=(0,Ue.CwG)({fetchPolicy:"cache-only"}),[c]=(0,Ue.g1V)({update:(e,t)=>{var n;null!==(n=t.data)&&void 0!==n&&n.clearSearchSuccessResult.status&&e.updateQuery({query:Ue.epo},e=>e&&e.me?{me:{...e.me,searchHistory:{...e.me.searchHistory,successResults:{...e.me.searchHistory.successResults,edges:[]}}}}:e)}}),d=(0,r.wA)(),u=(0,Fe.A)(null==o||null===(e=o.me)||void 0===e||null===(e=e.searchHistory.successResults)||void 0===e?void 0:e.edges);return null!=o&&o.me&&0!==u.length?i.createElement(Ne.s,{direction:"column",maxHeight:"385px"},i.createElement(Ne.s,{direction:"row",ps:"spacing.l",pe:"spacing.m",py:"spacing.s",justify:"space-between",align:"center"},i.createElement(Oe.D,{variant:"heading.s","data-testid":"recent_search_title"},(0,oe.AP)("searchsubsection_title_recentsearches_web")),i.createElement(Te.K0,{variant:"ghost","aria-label":(0,oe.AP)("Effacer"),onClick:()=>{c(),d((0,$.Lm)())},size:"small","data-testid":"recent_search_clear_button"},_t||(_t=i.createElement(De.u,null)))),i.createElement(de.a,{overflow:"auto",ref:s},i.createElement(Me.A,{hasMore:null==o||null===(t=o.me)||void 0===t||null===(t=t.searchHistory.successResults)||void 0===t?void 0:t.pageInfo.hasNextPage,loadMore:()=>{var e;return l({variables:{cursor:null==o||null===(e=o.me)||void 0===e||null===(e=e.searchHistory.successResults)||void 0===e?void 0:e.pageInfo.endCursor}})},loader:ft||(ft=i.createElement(bt.A,{key:"loader"})),useWindow:!1,getScrollParent:()=>s.current},u.filter(e=>"Mix"!==e.__typename).map((e,t)=>i.createElement(rt.OJ,{key:`${t}_${e.id}`,value:{legacyContext:{ID:e.id,TYPE:(0,ze.TU)(qe(e.__typename))}}},i.createElement(de.a,{ps:"spacing.l",pe:u.length>6?0:"spacing.m",py:"spacing.s",onMouseEnter:()=>{a(`${t}_${e.id}`)},onMouseLeave:()=>a(null)},((e,t)=>{const a=n===t;switch(e.__typename){case"Track":return i.createElement(st,{track:e,hovered:a});case"PodcastEpisode":return i.createElement(lt,{episode:e,hovered:a});case"Livestream":return i.createElement(ct,{liveStream:e,hovered:a});case"Artist":return i.createElement(pt,{artist:e,hovered:a});case"Playlist":return i.createElement(ht,{playlist:e,hovered:a});case"Album":return i.createElement(yt,{album:e,hovered:a});case"Podcast":return i.createElement(Et,{podcast:e,hovered:a});default:return null}})(e,`${t}_${e.id}`))))))):null};var kt,Tt=n("zDvJ");const Ct=(0,Re.A)(({hasRecentSearches:e})=>e?i.createElement(Le.A,{className:"popper-search",size:Tt.W8,"data-testid":"search_popper"},i.createElement(Ne.s,{flexDirection:"column",maxHeight:"440px",overflowY:"auto",onClick:e=>e.stopPropagation()},kt||(kt=i.createElement(vt,null)))):null);var wt;const St="topbar-search",xt=()=>{var e;const t=(0,be.W6)(),n=(0,be.zy)(),[o,{data:l}]=(0,Ue.SNU)({variables:{first:20,cursor:null},fetchPolicy:"network-only"}),c=i.useCallback(e=>{var t,a;const i=/^\/(?<type>search|tags)\/(?<query>.*?)(\/|$)/.exec((null==e?void 0:e.pathname)||n.pathname);if(!i)return"";const r=decodeURIComponent((null===(t=i.groups)||void 0===t?void 0:t.query)||"");return"tags"===(null===(a=i.groups)||void 0===a?void 0:a.type)?`#${r}`:"+"===r.charAt(0)&&r.length>1?r.substring(1):r},[n.pathname]),[d,u]=i.useState(c()),m=(0,r.wA)(),[h,g]=(0,Pe.G)(e=>[(0,$.Pu)(e.popper,St),(0,S.UJ)(e.user)]),y=()=>m((0,$.Lm)()),A=i.useRef(null),_=i.useCallback((0,fe.A)(e=>{(e=>{e.trim()?(h&&y(),(0,p.Uw)(e,"",p.vg,Ie.dZ,0,p.P$),t.push((e=>e.length>1&&0===e.lastIndexOf("#",0)?`/tags/${encodeURIComponent(e.replace(/#/g,""))}`:`/search/${encodeURIComponent(e)}`)(e))):f()})(e)},300),[]),f=e=>{null==e||e.stopPropagation(),u(""),A&&A.current&&A.current.focus()},b=()=>{xe.A.sendLog()};i.useEffect(()=>{window.addEventListener("visibilitychange",b);const e=t.listen(e=>{e.pathname.includes("search")||b(),u(c(e))});return()=>{e(),window.removeEventListener("visibilitychange",b)}});const v=""!==d,k=(0,s.A)("topbar-search-form",{"topbar-search-active":v}),T=(0,s.A)("topbar-search-clear",{"is-active":v}),C={"aria-label":(0,oe.AP)("Rechercher"),placeholder:(0,oe.AP)("searchfielddescription_text_artiststrackspodcasts_web"),value:d,onChange:e=>{const t=e.target.value;xe.A.addQuery(t),u(t),_(t)},onKeyDown:h?e=>{if("Tab"===e.key&&h)y();else if("Enter"===e.key){const e=d.trim();_(e)}}:void 0,onFocus:()=>{""===d&&!h&&g&&o()},ref:A,autoComplete:"off"},w={popperId:St,hasArrow:!1,closeOnClick:!1,isFullWidth:!0,data:{hasRecentSearches:Boolean(null==l||null===(e=l.me)||void 0===e||null===(e=e.searchHistory.successResults)||void 0===e?void 0:e.edges.length)}};return i.createElement("div",{className:"topbar-search"},i.createElement(Ct,w,i.createElement(de.a,{className:k,"data-testid":"search_container"},i.createElement(ve.M,null,wt||(wt=i.createElement(ke.W,{pointerEvents:"auto"},i.createElement(Te.K0,{variant:"link",type:"submit","aria-label":"","aria-labelledby":"topbar-search",icon:i.createElement(we.o,{color:"icon.neutral.primary.default"}),pointerEvents:"none"}))),i.createElement(Ce.p,(0,a.A)({id:"topbar-search",type:"search"},C,{"data-testid":"search_field"})),i.createElement(ke.t,{className:T},i.createElement(Te.K0,{variant:"link",onClick:f,"aria-hidden":!v,"aria-label":(0,oe.AP)("Effacer"),icon:i.createElement(Se.w,{color:"icon.neutral.secondary.default",_hover:{color:"icon.neutral.secondary.hovered"}})}))))))};var It=n("AtZM"),Pt=n("M3gt"),Rt=n("nrKQ"),Lt=n("tZJO"),Nt=n("rXlm"),Ot=n("7E8A"),Dt=n("hz5U"),Mt=n("QOhT");class Ut extends i.Component{constructor(e){super(e),this._markAsRead=this._markAsRead.bind(this),this.state={data:e.data}}shouldComponentUpdate(e,t){return t.data.NOTIFICATION_ID!==this.state.data.NOTIFICATION_ID||t.data.READ!==this.state.data.READ}render(){const{data:e}=this.state,t=!e.READ,n=(0,s.A)("notifications-item",{"is-unread":t}),a=t?this._markAsRead:void 0;return i.createElement("li",{className:n,onMouseOver:a},i.createElement("div",{className:"notifications-item-container"},i.createElement("div",{className:"notifications-item-content"},i.createElement("div",{className:"notifications-item-media"},i.createElement("div",{className:"notifications-item-media-picture"},this._renderPicture()),i.createElement("div",{className:"notifications-item-media-title"},i.createElement("div",{className:"heading-4"},i.createElement(Ze.A,{to:e.URL},e.TITLE)),i.createElement("div",{className:"heading-4-sub"},e.SUBTITLE))),i.createElement("div",null,i.createElement("div",{className:"notifications-item-info"},e.QUOTATION_TITLE),i.createElement("div",{className:"notifications-item-comment"},e.QUOTATION_MESSAGE)),i.createElement("div",{className:"notifications-item-date"},e.FOOTER))))}_renderPicture(){const{data:e}=this.state,t=Dt.A.getImageSrc(e.COVER_TYPE,e.PICTURE,56,56,null,100);return i.createElement(Mt.A,{type:e.MEDIA_TYPE,height:56,width:56,imgSrc:t,context:`menu_panel_notification_${e.MEDIA_TYPE}`,pageContext:Ot[`CONTEXT_TOPBAR_POPPER_${e.MEDIA_TYPE.toUpperCase()}`],id:e.MEDIA_ID,redirectUrl:e.URL})}_markAsRead(){let e={...this.state.data};e.READ||(e.READ=1,this.setState({data:e},()=>{v.A.markNotificationAsRead(e.NOTIFICATION_ID)}))}}const zt=(0,r.Ng)(({user:e})=>({serverTimestamp:e.SERVER_TIMESTAMP,clientTimestampDelta:e.clientTimestampDelta}))(Ut);var Ft,Bt,qt=n("fSLK"),Gt=n("I36q");class Ht extends i.Component{constructor(e){super(e),this._fetchNext=()=>{this.state.isNextPageLoading||this.state.rows&&this.state.rows.length===this.props.totalNotifs||this.setState({isNextPageLoading:!0},()=>{setTimeout(()=>{this._fetchNotificationsPage=Rt.A.call({method:"notification.list",data:{USER_ID:this.props.userId,LAST_NOTIFICATION_ID:this.state.lastNotifId,NB:20},success:e=>{if(e.data&&e.data.length>0){const t=e.data.map(e=>Lt.A.getNormalizedData(e));this.setState({rows:[...this.state.rows].concat(t),lastNotifId:t[t.length-1].NOTIFICATION_ID,isNextPageLoading:!1})}}})},2500)})},this.state={rows:e.data,lastNotifId:e.data&&e.data.length>0?e.data[e.data.length-1].NOTIFICATION_ID:0,isNextPageLoading:!1}}componentWillUnmount(){Rt.A.cancel(this._fetchNotificationsPage)}render(){const{data:e,isLoading:t}=this.props;return t?this._renderLoading():e.length>0?this._renderList():this._renderPlaceholder()}_renderList(){const e=this.state.rows,t=({index:t,style:n})=>e[t]?i.createElement("div",{style:n},i.createElement(zt,{key:`notification_${e[t].NOTIFICATION_ID}`,data:e[t],index:t})):null,n=t=>{const n=e[t];return n?125+(n.QUOTATION_MESSAGE?30*Math.ceil(n.QUOTATION_MESSAGE.length/80):0)+(n.QUOTATION_TITLE?20*Math.ceil(n.QUOTATION_TITLE.length/100):0):0};return i.createElement(Pt.A,{isItemLoaded:()=>!1,itemCount:this.props.totalNotifs,loadMoreItems:this._fetchNext},({onItemsRendered:a,ref:r})=>i.createElement(qt._m,{itemCount:e?e.length:0,onItemsRendered:a,ref:r,height:450,itemSize:n,width:"100%"},t))}_renderLoading(){return i.createElement("div",{className:"popper-body"},i.createElement("div",{className:"notifications-placeholder"},Ft||(Ft=i.createElement("div",{className:"notifications-placeholder-image notifications-placeholder-loader animate-spin"})),i.createElement("div",{className:"notifications-placeholder-title"},(0,oe.AP)("Chargement en cours"))))}_renderPlaceholder(){return i.createElement(Nt.A,{className:"popper-body"},i.createElement("div",{className:"notifications-placeholder"},Bt||(Bt=i.createElement("div",{className:"notifications-placeholder-image notifications-placeholder-friends"})),i.createElement("div",{className:"notifications-placeholder-title"},(0,oe.AP)("Ne restez pas dans votre coin.")),i.createElement(Te.$n,{onClick:this.props.openOnboardingScreen},(0,oe.AP)("onboardingartistpicker_title_addartists_web"))))}}Ht.defaultProps={isLoading:!1};const Vt=(0,r.Ng)(({user:e})=>({userId:e.USER.USER_ID}),e=>({openOnboardingScreen:()=>e((0,U.J2)({name:_.A.isAllowed("public_api_onboarding")?X.F.ONBOARDING:X.F.ONBOARDING_LEGACY,data:{showCloseButton:!0,context:Gt.d.Improve,callbackLink:"/profile/me"}}))}))(Ht);var Yt=n("hIIJ");class Qt extends i.Component{constructor(e){super(e),this._currentList=[],this._nbDisplay=20,this._updateNotifications=this._updateNotifications.bind(this),this.state={data:[...v.A.data.NOTIFICATIONS],notificationCount:v.A.getNotificationCount(),nbDisplay:this._nbDisplay}}componentDidMount(){E.A.subscribe(E.A.live.notificationNew,this._updateNotifications,"popper_notifications"),E.A.subscribe(E.A.live.notificationRead,this._updateNotifications,"popper_notifications")}shouldComponentUpdate(e,t){return e.selected!==this.props.selected||t.notificationCount!==this.state.notificationCount||t.data.length!==this.state.data.length||t.nbDisplay!==this.state.nbDisplay}componentWillUnmount(){E.A.unsubscribeAll("popper_notifications")}render(){const{nbDisplay:e}=this.state,t=this.state.data.slice(0,e),n=v.A.data.TOTAL_NOTIFICATIONS;return i.createElement(Le.A,{className:"popper-notifications",size:"lg"},i.createElement("div",{className:"popper-headings"},_.A.isAllowed("revamp2023")?i.createElement(Yt.A,{title:(0,oe.AP)("Notifications")}):i.createElement("h2",{className:"heading-2"})),i.createElement(Vt,{data:t,totalNotifs:n,key:"notifications-list"}))}_updateNotifications(){this.setState({notificationCount:v.A.getNotificationCount(),data:[...v.A.data.NOTIFICATIONS]})}}Qt.defaultProps={selected:null};const Wt=(0,Re.A)(Qt);var Kt,jt=n("DSCs");class $t extends i.Component{constructor(e){super(e),this._updateUnseenNotifications=this._updateUnseenNotifications.bind(this),this.state={unseenNotificationCount:0}}componentDidMount(){E.A.subscribe(E.A.live.notificationNew,this._updateUnseenNotifications),E.A.subscribe(E.A.live.notificationRead,this._updateUnseenNotifications),E.A.ready(E.A.user.userReady,this._updateUnseenNotifications)}componentWillUnmount(){E.A.unsubscribe(E.A.live.notificationNew,this._updateUnseenNotifications),E.A.unsubscribe(E.A.live.notificationRead,this._updateUnseenNotifications)}render(){const e={popperId:"topbar-notification",trigger:[Tt.uW],delay:500,isDisabled:!1};return i.createElement(Wt,(0,a.A)({className:"topbar-action"},e),i.createElement(Te.K0,{"aria-label":(0,oe.AP)("Notifications"),variant:"ghost",size:"small",icon:i.createElement(i.Fragment,null,Kt||(Kt=i.createElement(jt.$,null)),i.createElement(It.x,{count:this.state.unseenNotificationCount,fontSize:"10px",top:"5px",right:"5px","aria-label":"topbar-notification-counter"}))}))}_updateUnseenNotifications(){this.setState({unseenNotificationCount:v.A.getNotificationCount()})}}var Xt,Jt,Zt,en,tn,nn,an=n("2qhg"),rn=n("r2u9"),sn=n("04sm"),on=n("dPin"),ln=n("3JOg"),cn=n("rYh+"),dn=n("mmFw"),un=n("wZBD"),pn=n("oh0j"),mn=n("w/ZN"),hn=n("70bL"),gn=n("P1K6");const yn=["GB","FR","DE","BE","BR","US"];let An=(0,o.Ay)()(Xt=class extends i.Component{constructor(...e){super(...e),this._onClose=(e,t=null)=>{void 0!==e.key&&"Enter"!==e.key||"function"==typeof t&&t()}}render(){return i.createElement(Le.A,{className:"popper-account",size:"lg"},this._renderHeader(),this._renderContent())}_renderHeader(){const{userId:e,userPicture:t,displayName:n}=this.props;return i.createElement(i.Fragment,null,i.createElement(ln.A,null,i.createElement(Ze.A,{className:"account-header animate-wobble",to:`/profile/${e}`},i.createElement(dn.e,{size:"size.l",variant:"neutral",name:n,src:t?(0,gn.AE)(Be.Ay.User,t,100,100):""}),i.createElement("div",{className:"account-heading ellipsis"},i.createElement("span",{className:"account-name"},this.props.displayName)),Jt||(Jt=i.createElement(cn.A,null)))),this._renderEntryPoint())}_renderContent(){return i.createElement("ul",{className:"account-menu",role:"navigation"},this._getLinks().map(e=>this._renderElement(e)))}_renderElement(e){if(e.isDisabled)return null;const t=(0,s.A)("account-item",{"is-divider":e.isDivider});return i.createElement("li",{className:t,key:e.id,"data-testid":e.id},e.isCheckbox?this._renderCheckbox(e):this._renderLink(e))}_renderLink(e){const t={className:(0,s.A)("account-link",{"is-main":e.isMain}),to:e.to||"",onClick:t=>this._onClose(t,e.onClick),target:e.isExternal?"_blank":void 0};return e.to||Object.assign(t,{role:"button",tabIndex:0,onKeyPress:t=>this._onClose(t,e.onClick)}),e.isAnimated?i.createElement(ln.A,null,i.createElement(Ze.A,t,i.createElement("span",{className:"account-link-label"},e.label,e.isNew?this._renderIsNew():null),"multiAccount"===e.id?this._renderWarning():null,Zt||(Zt=i.createElement(cn.A,null)))):i.createElement(Ze.A,t,e.label)}_renderEntryPoint(){const{entryPoints:e}=this.props;return void 0!==e.SUBSCRIBE_FROM_SETTINGS&&""!==e.SUBSCRIBE_FROM_SETTINGS.action&&""!==e.SUBSCRIBE_FROM_SETTINGS.label&&""!==e.SUBSCRIBE_FROM_SETTINGS.description?i.createElement(ln.A,null,i.createElement(Ze.A,{className:"account-header",to:e.SUBSCRIBE_FROM_SETTINGS.action,target:"_blank"},i.createElement("div",{className:"account-entrypoint"},i.createElement("span",{className:"account-link-label account-entrypoint-label"},e.SUBSCRIBE_FROM_SETTINGS.label),en||(en=i.createElement("br",null)),i.createElement("span",{className:"account-link-label account-entrypoint-description"},e.SUBSCRIBE_FROM_SETTINGS.description)),tn||(tn=i.createElement(cn.A,null)))):null}_renderWarning(){return this.props.remainingAccountsCount<0?nn||(nn=i.createElement(mn.i,{className:"multi-account-warning"})):null}_renderIsNew(){return i.createElement(un.J,{variant:"accent",size:"small",marginStart:"spacing.s"},(0,oe.AP)("generic_title_new_web"))}_renderCheckbox(e){const t=(0,s.A)("account-input-label",{"is-main":e.isMain});return i.createElement("div",{className:"account-input"},i.createElement("div",{className:t},e.label),i.createElement(pn.d,{isChecked:e.isChecked,onChange:e.onClick}))}_setDarkModeOption(e){sn.A.set({global:{dark_mode:e}}),this.props.tracking&&this.props.tracking.trackEvent({eventaction:"click-darkmode-toggle",event:"click",eventlabel:`darkmode-${e}`}),Rt.A.call({method:"log_central.log",data:{BATCH:[{channel:"feature_activation",params:{ts:Math.floor(Date.now()/1e3),state:e,feature:"darkmode-toggle",os_based:!1}}]}})}_manageMyAccount(){this.props.tracking&&this.props.tracking.trackEvent({eventaction:"manage-subscription-button",event:"click",eventcategory:"account"}),open("/account/subscription")}_trackGiftCard(){this.props.tracking&&this.props.tracking.trackEvent({eventaction:"get-voucher",event:"click",eventcategory:"account"})}_getLinks(){var e,t,a,i;const{darkModeOption:r,userLang:s}=this.props;return[{id:"multiAccount",label:(0,oe.AP)("settingspage_title_members_web"),isDisabled:this.props.isSubAccount||!this.props.isOnline||!(this.props.hasMultiAccountEnabled||this.props.hasChildAccounts),isMain:!0,isAnimated:!0,onClick:()=>this.props.openScreen({name:X.F.SELECT_PROFILE,data:{}})},{id:"account",label:(0,oe.AP)("accountsettingspage_title_accountsettings_web"),to:"/account",isMain:!0,isAnimated:!0},{id:"subscription",label:(0,oe.AP)("Gérer mon abonnement"),onClick:()=>this._manageMyAccount(),isMain:!0,isAnimated:!0,isDisabled:this.props.isSubAccount||this.props.hasParent},{id:"partners",label:null===(e=this.props.entryPoints.SUBSCRIPTION_DAZN_FROM_SETTINGS)||void 0===e?void 0:e.label,to:null===(t=this.props.entryPoints.SUBSCRIPTION_DAZN_FROM_SETTINGS)||void 0===t?void 0:t.action,isMain:!0,isAnimated:!0,isDisabled:void 0===this.props.entryPoints.SUBSCRIPTION_DAZN_FROM_SETTINGS||""===(null===(a=this.props.entryPoints.SUBSCRIPTION_DAZN_FROM_SETTINGS)||void 0===a?void 0:a.action)||""===(null===(i=this.props.entryPoints.SUBSCRIPTION_DAZN_FROM_SETTINGS)||void 0===i?void 0:i.label)},_.A.isAllowed("feature_2025_algo_settings")?{id:"recommendations",label:(0,oe.AP)("algointeractionssettings_action_managereco_web"),to:`/${s}/recommendations/included/home`,isMain:!0,isAnimated:!0}:{id:"exclusions",label:(0,oe.AP)("banfeatures_action_managemyexclusions_web"),to:`/${s}/exclusions`,isMain:!0,isAnimated:!0},{id:"getGiftCard",label:(0,oe.AP)("planspage_action_getagiftcard_web"),to:"/payment/go.php?id=1&gift=1&origin=gift-account-menu-desktop",onClick:()=>this._trackGiftCard(),isMain:!0,isAnimated:!0,isExternal:!0,isDisabled:!yn.includes(this.props.country)},{id:"gift",label:(0,oe.AP)("Activer un code"),to:"/gift",isMain:!0,isAnimated:!0,isExternal:!0,isDisabled:this.props.hasParent||this.props.userHasOffer},{id:"logout",label:(0,oe.AP)("Déconnexion"),isMain:!0,onClick:async()=>{if(rn.Ay){const{default:e}=await Promise.resolve().then(n.bind(n,"7sx+"));await e.logout();const{default:t}=await Promise.resolve().then(n.bind(n,"WBQ7"));t.set("selectedChildAccount",!1,!0),rn.Ay.deleteLoginInfo()}else an.default.logout()}},{id:"kid",label:(0,oe.AP)("Activer Deezer Kids"),onClick:()=>an.default.setKidStatus(),isMain:!0,isDivider:!0,isCheckbox:!0,isChecked:this.props.isKid,isDisabled:!this.props.hasParent||this.props.isSubAccount||this.props.isKid},_.A.isAllowed("feature_2025_accent_color")?{id:"display",label:(0,oe.AP)("displaysettings_title_themeandcolor_web"),isMain:!1,isDivider:!0,isCheckbox:!1,isExternal:!1,isAnimated:!0,isNew:!0,onClick:()=>this.props.openModal({name:he.b.RETHEMING,props:{currentDarkMode:r!==on.wA,userLang:this.props.userLang},padding:"0"})}:{id:"display",label:(0,oe.AP)("accountmenu_title_darkmode_web"),isMain:!0,isDivider:!0,isCheckbox:!0,isChecked:r!==on.wA,onClick:()=>this._setDarkModeOption(r===on.wA?on.h_:on.wA)},{id:"support",label:(0,oe.AP)("generic_title_support_web"),to:"https://support.deezer.com/",isAnimated:!0,isDivider:!0,isExternal:!0},{id:"community",label:(0,oe.AP)("generic_title_communityandfeedback_web"),to:"/support",isAnimated:!0,isDivider:!1,isExternal:!0},{id:"features",label:(0,oe.AP)("Fonctionnalités"),to:(0,k.Tn)(s),isAnimated:!0,isExternal:!0},{id:"offers",label:(0,oe.AP)("Offres"),to:"/offers",isAnimated:!0,isExternal:!0,isDisabled:this.props.userHasOffer},{id:"report_content",label:(0,oe.AP)("settingspage_title_DSAreportcontent_web"),to:"https://support.deezer.com/hc/requests/new?ticket_form_id=18694766502813",isAnimated:!0,isExternal:!0},{id:"company",label:(0,oe.AP)("À propos"),to:"/company",isAnimated:!0,isExternal:!0},{id:"jobs",label:(0,oe.AP)("Jobs"),to:"https://www.deezerjobs.com/",isAnimated:!0,isExternal:!0},{id:"legal",label:(0,oe.AP)("Légal"),to:"/legal/cgu",isAnimated:!0,isExternal:!0}]}})||Xt;const En=(0,Re.A)((0,r.Ng)(e=>({userId:(0,S.F6)(e.user),userPicture:(0,S.jg)(e.user),userHasOffer:(0,S.jQ)(e.user),userLang:(0,S.Z0)(e.user),displayName:(0,S.Mn)(e.user),langDirection:(0,S.iJ)(e.user),darkModeOption:(0,S.HZ)(e.user),hasChildAccounts:(0,S.bU)(e.user),hasMultiAccountEnabled:(0,S.mE)(e.user),hasParent:(0,S.p7)(e.user),isSubAccount:(0,S.m0)(e.user),isKid:(0,S.zI)(e.user),isOnline:(0,hn.sc)(e),childs:(0,S.TW)(e.user),remainingAccountsCount:(0,S.KU)(e.user),country:(0,S.JJ)(e.user),entryPoints:(0,S.WL)(e.user)}),{openScreen:U.J2,openModal:F.qf})(An));var _n,fn=n("55Ip"),bn=n("FVVF"),vn=n("w5XR"),kn=n("zm7j"),Tn=n("6vqc");const Cn=({onProfileClick:e,isCollapsed:t})=>{const n=(0,r.d4)(e=>e.user),a=(0,S.Mn)(n),s=(0,S.jg)(n),o=(0,S.mE)(n),l=!(0,S.p7)(n)&&o,c=Dt.A.getImageSrc(Be.Ay.User,s,120,120);return i.createElement(de.a,{as:"button",display:"flex",alignItems:"center",gap:"spacing.s",onClick:e,"data-testid":"sidebar-profile"},i.createElement(dn.e,{size:"size.xl",variant:"neutral",src:c,name:a,isHoverEnabled:!0}),!t&&i.createElement(de.a,{display:"flex",flexDirection:"column",justifyContent:"flex-start",width:"100%",gap:"spacing.xxxs"},i.createElement(de.a,{display:"flex",flexDirection:"column",justifyContent:l?"flex-start":"center",width:"100%",gap:l?"spacing.xxxs":"none"},i.createElement(de.a,{display:"flex",alignItems:"center",justifyContent:"space-between"},i.createElement(Oe.D,{variant:"heading.s",textAlign:"left",lineHeight:"1.2",wordBreak:"break-word"},a),_n||(_n=i.createElement(Tn.v,{size:"small"}))),l&&i.createElement(Ke.E,{variant:"body.l.default",fontWeight:"light",color:"text.neutral.secondary.default",textAlign:"left"},(0,oe.AP)("familymemberselectorlabel_title_admin_web")))))},wn=({icon:e,iconActive:t,iconOnly:n,to:a,children:r,"data-testid":s})=>{const{pathname:o}=(0,be.zy)(),l=o.startsWith(a);return i.createElement(Ne.s,{"data-testid":s,as:Ze.A,to:a,alignItems:"center",paddingX:"spacing.s",paddingY:"spacing.s",borderRadius:"s",color:l?"text.accent.primary.default":"text.neutral.primary.default",background:l?"background.neutral.tertiary.default":void 0,justifyContent:n?"center":void 0,_hover:{background:l?void 0:"background.neutral.secondary.hovered"},_active:{background:l?void 0:"background.neutral.secondary.pressed"}},l?t:e,!n&&i.createElement(Oe.D,{variant:"heading.s"},r))},Sn=()=>{const e=(0,r.d4)(e=>e.user),t=(0,S.Mn)(e),n=(0,S.Ck)(e),a=(0,S.mE)(e),i=(0,S.m0)(e),s=(0,S.p7)(e),o=(0,S.TW)(e),l=(0,S.WL)(e),c=(0,S.E1)(e),d=(0,S.JJ)(e),u=(0,S.F6)(e),p=(0,S.qo)(e),m=(0,S.zI)(e),h=(0,S.yi)(e),g=(0,S.W$)(e),y=(0,S.KU)(e),A=(0,S.jQ)(e),E="Deezer Free"===n,_=a&&!i,f=!s&&a,b=o.length,v=l.SUBSCRIPTION_DAZN_FROM_SETTINGS,k=!s||i;return{offerName:n,username:t,isFamilyAccount:_,isFree:E,isAdmin:f,childCount:b,isEligibleToDazn:!(null==v||!v.action),daznEntry:v,parentName:c,hasParentAccount:s,country:d,userID:u,userEmail:p,renderEmail:k&&Boolean(p)?p:null,hasOwnCredentials:k,isKidAccount:m,userOptins:h,isSubprofile:g,remainingMembers:y,userHasOffer:A}};n("pELI");var xn=n("Q3UE"),In=n("pmZX"),Pn=n("UDqN"),Rn=n("IA1y"),Ln=n("10Ql"),Nn=n("mC/8"),On=n("Ymw2"),Dn=n("Xf48"),Mn=n("xSkb"),Un=n("9Un8");const zn_ROOT="/plan-management",zn_MANAGE_ACCOUNTS="/plan-management/manage-accounts",Fn_ROOT="/account",Fn_MANAGE_ACCOUNTS={ROOT:"/account/manage-accounts",CREATE:"/account/manage-accounts/create-profile",EDIT:"/account/manage-accounts/edit-profile",CONVERT:"/account/manage-accounts/convert-independant",INVITE:"/account/manage-accounts/send-invitation"},Fn_EDIT_INFOS="/account/edit-infos",Bn_ROOT="/music",qn_ROOT="/offline-data",Gn_ROOT="/display",Hn_ROOT="/help-legal",Vn={"plan-management":(0,oe.AP)("settingspage_title_planmanagement_web"),account:(0,oe.AP)("navigationbar_title_account_web"),music:(0,oe.AP)("navigationbar_title_music_web"),"offline-data":(0,oe.AP)("settingspage_title_offlineanddata_web"),display:(0,oe.AP)("settingspage_title_display_web"),"help-legal":(0,oe.AP)("settingspage_title_helpandlegal_web"),"manage-accounts":(0,oe.WI)("settingspage_action_managemyaccounts_web","settingspage_action_managemyaccounts_web",{count:2,sprintf:[2]}),"edit-infos":(0,oe.AP)("settingspage_action_editmyinformation_web"),"create-profile":(0,oe.AP)("family_action_addaprofile_web"),"edit-profile":(0,oe.AP)("generic_action_editaccount_web"),"convert-independant":(0,oe.AP)("generic_action_makeindependentaccount_web"),"send-invitation":(0,oe.AP)("familymemberinvite_action_sendaninvite_web")},Yn={[Fn_MANAGE_ACCOUNTS.CREATE]:`${zn_MANAGE_ACCOUNTS}/create-profile`,[Fn_MANAGE_ACCOUNTS.EDIT]:`${zn_MANAGE_ACCOUNTS}/edit-profile`,[Fn_MANAGE_ACCOUNTS.CONVERT]:`${zn_MANAGE_ACCOUNTS}/convert-independant`,[Fn_MANAGE_ACCOUNTS.INVITE]:`${zn_MANAGE_ACCOUNTS}/send-invitation`},Qn=()=>{var e;const{isFamilyAccount:t,hasParentAccount:n}=Sn(),a=(0,be.zy)(),r=[{id:"plan-management",path:zn_ROOT,tabLabel:(0,oe.AP)("settingspage_title_planmanagement_web"),icon:(e,t)=>t?i.createElement(xn.b,e):i.createElement(In.h,e)},{id:"account",path:Fn_ROOT,tabLabel:(0,oe.AP)("navigationbar_title_account_web"),icon:(e,t)=>t?i.createElement(Pn.Z,e):i.createElement(Rn.L,e)},{id:"music",path:Bn_ROOT,tabLabel:(0,oe.AP)("navigationbar_title_music_web"),icon:(e,t)=>t?i.createElement(Ln.z,e):i.createElement(Nn.Z,e)},{id:"offline-data",path:qn_ROOT,tabLabel:(0,oe.AP)("settingspage_title_offlineanddata_web"),icon:(e,t)=>t?i.createElement(On.M,e):i.createElement(Dn.m,e)},{id:"display",path:Gn_ROOT,tabLabel:(0,oe.AP)("settingspage_title_display_web"),icon:e=>i.createElement(Mn.X,e)},{id:"help-legal",path:Hn_ROOT,tabLabel:(0,oe.AP)("settingspage_title_helpandlegal_web"),icon:e=>i.createElement(Un.u,e)}],s=t&&n?r.filter(e=>"plan-management"!==e.id):r,o="/"+a.pathname.split("/").filter(Boolean).join("/"),l=(null!==(e=Yn[o])&&void 0!==e?e:o).split("/").filter(Boolean);return{mainRoutes:s,breadcrumbs:l.map((e,t)=>{var n;const a=((e,t)=>"/"+e.slice(0,t+1).join("/"))(l,t);return{segment:e,breadcrumbLabel:null!==(n=Vn[e])&&void 0!==n?n:e.replaceAll("-"," "),navigationPath:a,isActive:t===l.length-1}})}};var Wn,Kn;const jn=({onSwitchProfileClick:e,isCollapsed:t})=>{const{isFamilyAccount:a}=Sn(),{mainRoutes:s}=Qn(),o=a,l=(0,r.wA)();return i.createElement(de.a,{minHeight:"672px",width:t?"80px":"272px",bg:"background.neutral.secondary.default",display:"flex",flexDirection:"column",justifyContent:"space-between",borderRight:"1px",borderRightColor:"divider.neutral.primary.default"},i.createElement(bn.T,{align:t?"centrer":"stretch",spacing:"spacing"},i.createElement(de.a,{borderBottom:"1px",borderBottomColor:"divider.neutral.primary.default",w:"100%"},i.createElement(de.a,{p:"spacing.l",display:"flex",flexDirection:"column",gap:"spacing.s"},i.createElement(Cn,{onProfileClick:()=>window.open("/profile","_blank"),isCollapsed:t}),o&&i.createElement(Te.$n,{"data-testid":"switch-account-btn","aria-label":(0,oe.AP)("sso_action_switchaccount_web"),mt:"spacing.s",variant:"outline",leftIcon:Wn||(Wn=i.createElement(vn.R,null)),gap:"spacing.l",onClick:()=>{e(),l((0,U.J2)({name:X.F.SELECT_PROFILE,data:{}}))},display:"flex",alignItems:"center",padding:t?"0":void 0,borderRadius:t?"3xl":"m"},!t&&(0,oe.AP)("sso_action_switchaccount_web")))),i.createElement(bn.T,{pt:"spacing.l",px:"spacing.s",alignItems:"stretch",w:"100%"},s.map(({path:e,tabLabel:n,icon:a,id:r})=>i.createElement(wn,{key:e,to:e,icon:a({color:"icon.secondary.default",mr:"spacing.xs",boxSize:"32px"},!1),iconActive:a({color:"icon.accent.primary.default",mr:"spacing.xs",boxSize:"32px"},!0),iconOnly:t,"data-testid":`${r}-nav-item`},n)))),i.createElement(de.a,{py:"spacing.l",px:"spacing.s"},i.createElement(Te.$n,{"data-testid":"log-out-btn","aria-label":(0,oe.AP)("Déconnexion"),width:"100%",leftIcon:Kn||(Kn=i.createElement(kn.o,{size:"small"})),variant:"ghost",justifyContent:t?"center":"flex-start",onClick:async()=>{if(rn.Ay){const{default:e}=await Promise.resolve().then(n.bind(n,"7sx+"));await e.logout();const{default:t}=await Promise.resolve().then(n.bind(n,"WBQ7"));t.set("selectedChildAccount",!1,!0),rn.Ay.deleteLoginInfo()}else an.default.logout()}},!t&&(0,oe.AP)("Déconnexion"))))};var $n,Xn,Jn=n("Votb");const Zn=()=>{const{breadcrumbs:e}=Qn();return i.createElement(Jn.z,{justify:"space-between",align:"center",paddingLeft:"spacing.xl",paddingRight:"spacing.m",py:"spacing.s"},i.createElement(de.a,{maxW:"600px",display:"flex",flexWrap:"wrap",alignItems:"center",wordBreak:"break-word",gap:"spacing.xs"},e.map((t,n)=>{const a=n===e.length-1;return i.createElement(i.Fragment,{key:n},i.createElement(Ke.E,{"data-testid":"modal-breadcrumb-link",as:a?void 0:fn.N_,to:a?void 0:t.navigationPath,cursor:a?"default":"pointer",variant:"heading.m",fontWeight:"bold",fontSize:"lg",color:a?"text.neutral.primary.default":"text.neutral.secondary.default"},t.breadcrumbLabel),!a&&($n||($n=i.createElement(Tn.v,{size:"small",color:"icon.neutral.secondary.default"}))))})),Xn||(Xn=i.createElement(G.s_,{position:"static"})))};var ea,ta=n("SYyZ"),na=n("6jI4"),aa=n("GHTP");const ia=({items:e,title:t,footer:n,value:a,onChange:r})=>i.createElement(Ne.s,{direction:"column",width:"100%"},t&&i.createElement(de.a,{paddingY:"spacing.s"},i.createElement(Oe.D,{variant:"heading.s",noOfLines:1,textAlign:"left"},t)),i.createElement(de.a,{borderRadius:"s",overflow:"hidden",background:"background.neutral.secondary.default"},i.createElement(ta.z,{value:a,onChange:r},i.createElement(bn.T,{divider:ea||(ea=i.createElement(de.a,{border:"none"},i.createElement(na.c,{orientation:"horizontal",w:"auto",mx:"spacing.l",color:"divider.neutral.primary.default"}))),spacing:0,align:"stretch"},e.map(e=>i.createElement(de.a,{key:e.value,paddingX:"spacing.l",paddingY:"spacing.m",_hover:{background:"background.neutral.secondary.hovered"},_active:{background:"background.neutral.secondary.pressed"},width:"100%",cursor:"pointer",onClick:()=>{e.isDarkModeDisabled||null==r||r(e.value)}},i.createElement(Ne.s,{justifyContent:"space-between",alignItems:"center",width:"100%"},i.createElement(Oe.D,{variant:"heading.xs",noOfLines:1,textColor:e.isDarkModeDisabled?"text.neutral.primary.disabled":void 0},e.theme),i.createElement(aa.s,{value:e.value,size:"md",isDisabled:e.isDarkModeDisabled}))))))),n&&i.createElement(de.a,{paddingY:"spacing.xs"},i.createElement(Ke.E,{variant:"body.default.s",textColor:"text.neutral.secondary.default"},n))),ra=(0,o.Ay)()(({tracking:e})=>{const{darkModeOption:t,setDarkModeOption:n,isDarkModeDisabled:a}=(e=>{const t="on"===(0,S.HZ)((0,r.d4)(e=>e.user))?"dark":"light",n=!(0,on.Xt)();return{setDarkModeOption:t=>{const a="dark"===t?on.h_:on.wA;sn.A.set({global:{dark_mode:!n&&a}}),e&&e.trackEvent({eventaction:"click-darkmode-toggle",event:"click",eventlabel:`darkmode-${a}`}),Rt.A.call({method:"log_central.log",data:{BATCH:[{channel:"feature_activation",params:{ts:Math.floor(Date.now()/1e3),state:a,feature:"darkmode-toggle",os_based:"system"===t}}]}})},isDarkModeDisabled:n,darkModeOption:t}})(e),s=[{theme:(0,oe.AP)("displaysettings_title_dark_web"),value:"dark",isDarkModeDisabled:a},{theme:(0,oe.AP)("displaysettings_title_light_web"),value:"light",isDarkModeDisabled:!1}];return i.createElement(de.a,{px:"spacing.xl",paddingBottom:"spacing.2xl",paddingTop:"spacing.l"},i.createElement(ia,{title:(0,oe.AP)("displaysettings_title_theme_web"),items:s,value:t,onChange:n}))});var sa=n("X5lq");const oa=({highlightColor:e,textColor:t,label:n})=>i.createElement(Ne.s,{bg:e,borderRadius:"2xs",p:"spacing.xs"},i.createElement(Ke.E,{variant:"body.default.m",textAlign:"center",textColor:t,fontWeight:"semibold"},n));var la,ca=n("jiu+"),da=n("6Va4");const ua=(0,r.Ng)(({user:{USER:{ENTRYPOINTS:e}}})=>({conversionEntrypoints:e}))(({conversionEntrypoints:e})=>{const{CONVERSION_BANNER_FREE:t,CONVERSION_BANNER_TRIAL:n}=e,a=t||n;return a?i.createElement(ca.QQ,null,i.createElement(Jn.z,{as:"a",href:(0,da.hY)(a.action),target:"_blank",padding:"spacing.l",borderRadius:"xs",bg:"background.accent.primary.default",alignItems:"center",w:"100%","data-testid":"subscriptionBanner",_hover:{textDecoration:"none"},spacing:"spacing.m",shadow:"md"},la||(la=i.createElement(In.h,{size:"medium",color:"icon.accent.onAccent.default"})),i.createElement(bn.T,{spacing:"spacing.2xs",alignItems:"flex-start"},i.createElement(Ke.E,{color:"text.accent.onAccent.default",fontWeight:"bold",variant:"body.default.xl"},(0,oe.AP)("generic_action_subscribe_web")),i.createElement(Ke.E,{textColor:"text.accent.onAccent.default",variant:"body.default.l",opacity:"0.7"},a.description)))):null}),pa={"Deezer Free":{highlightColor:"background.neutral.tertiary.default",textColor:"text.neutral.secondary.default"},"Deezer Premium":{highlightColor:"background.accent.primary.default",textColor:"text.accent.onDark.default"},"Deezer Family":{highlightColor:"background.brand.orange.default",textColor:"text.accent.onDark.default"},"Deezer Famille":{highlightColor:"background.brand.orange.default",textColor:"text.accent.onDark.default"},"Deezer Duo":{highlightColor:"background.brand.teal.default",textColor:"text.accent.onLight.default"}};var ma,ha;const ga=()=>{const e=(0,r.d4)(e=>e.user),{offerName:t,parentName:n}=Sn(),{highlightColor:a,textColor:s}=(({offerName:e})=>{var t;return null!==(t=pa[e])&&void 0!==t?t:{highlightColor:"background.neutral.tertiary.default",textColor:"text.neutral.secondary.default"}})({offerName:t}),o=e.USER.USER_ID,l=(0,S.TW)(e).filter(e=>null!==e.PARENT_ID).find(e=>Number(e.USER_ID)===o),c=!!l&&!l.EXTRA_FAMILY.IS_LOGGABLE_AS;return i.createElement(bn.T,{display:"flex",alignItems:"flex-start",width:"100%",gap:"spacing.s"},i.createElement(Oe.D,{variant:"heading.s",textColor:"text.neutral.primary.default",textAlign:"left"},(0,oe.AP)("settingspage_title_currentplan_web")),i.createElement(oa,{highlightColor:a,textColor:s,label:t}),c&&i.createElement(Jn.z,{gap:"spacing.xs",w:"100%"},ma||(ma=i.createElement(sa.u,{boxSize:"22px",color:"icon.neutral.secondary.default"})),i.createElement(Ke.E,{variant:"body.default.l",textColor:"text.neutral.primary.default"},`You are part of the ${n}'s family`)),ha||(ha=i.createElement(ua,null)))},ya=({label:e,header:t,title:n,footer:a,customLabel:r,rightElement:s,to:o,isExternal:l,isDisabled:c,onClick:d,ariaLabel:u,testId:p})=>{var m,h,g;const y=i.createElement(Ne.s,{justifyContent:"space-between",alignItems:"center",width:"100%"},i.createElement(Ne.s,{alignItems:"center",gap:"spacing.s"},i.createElement(Oe.D,{variant:"heading.xs",textAlign:"left",noOfLines:1},e),r),s);return(e=>i.createElement(Ne.s,{direction:"column",width:"100%"},t&&(m||(m=i.createElement(de.a,{paddingY:"spacing.xs"},i.createElement(Ke.E,{variant:"body.default.s",textColor:"text.neutral.secondary.default"},t)))),n&&(h||(h=i.createElement(de.a,{paddingY:"spacing.s"},i.createElement(Oe.D,{variant:"heading.s",noOfLines:1,textAlign:"left"},n)))),e,a&&(g||(g=i.createElement(de.a,{paddingY:"spacing.xs"},i.createElement(Ke.E,{variant:"body.default.s",textColor:"text.neutral.secondary.default"},a))))))(c?i.createElement(de.a,{"data-testid":p,"aria-label":u,paddingX:"spacing.l",paddingY:"spacing.m",borderRadius:"s",width:"100%",cursor:"not-allowed",background:"background.neutral.secondary.default",textColor:"text.accent.onDark.disabled"},y):o&&l?i.createElement(de.a,{as:"a",href:o,target:"_blank",rel:"noopener noreferrer",onClick:d,"data-testid":p,"aria-label":u,paddingX:"spacing.l",paddingY:"spacing.m",borderRadius:"s",width:"100%",background:"background.neutral.secondary.default",textDecoration:"none",_hover:{background:"background.neutral.secondary.hovered"},_active:{background:"background.neutral.secondary.pressed"}},y):o?i.createElement(de.a,{as:fn.N_,to:o,onClick:d,"data-testid":p,"aria-label":u,paddingX:"spacing.l",paddingY:"spacing.m",borderRadius:"s",width:"100%",background:"background.neutral.secondary.default",textDecoration:"none",_hover:{background:"background.neutral.secondary.hovered"},_active:{background:"background.neutral.secondary.pressed"}},y):i.createElement(de.a,{as:"button",onClick:d,"data-testid":p,"aria-label":u,paddingX:"spacing.l",paddingY:"spacing.m",borderRadius:"s",width:"100%",textAlign:"left",background:"background.neutral.secondary.default",_hover:{background:"background.neutral.secondary.hovered"},_active:{background:"background.neutral.secondary.pressed"}},y))};var Aa;const Ea=()=>{const{isAdmin:e,remainingMembers:t}=Sn();return e?i.createElement(ya,{header:(0,oe.AP)("settingspage_title_multiaccountmgmt_web"),label:(0,oe.WI)("settingspage_action_managemyaccounts_web","settingspage_action_managemyaccounts_web",{count:2,sprintf:[2]}),footer:(0,oe.WI)("settingspage_subtitle_youhaveXaccountsleft_web","settingspage_subtitle_youhaveXaccountsleft_web",{count:t,sprintf:[t]}),rightElement:Aa||(Aa=i.createElement(Tn.v,{boxSize:"24px"})),to:zn_MANAGE_ACCOUNTS,ariaLabel:"Manage my accounts",testId:"manage-accounts-list-item"}):null};var _a,fa=n("ej6z");const ba=({item:e})=>{var t;const n=null!==(t=e.isDisabled)&&void 0!==t&&t,a=i.createElement(Ne.s,{justifyContent:"space-between",alignItems:"center",width:"100%"},i.createElement(Ne.s,{alignItems:"center",gap:"spacing.s"},e.leftElement&&e.leftElement,i.createElement(Oe.D,{variant:"heading.xs",noOfLines:1},e.label)),e.rightElement);return n?i.createElement(de.a,{"data-testid":e.testId,"aria-label":e.ariaLabel,paddingX:"spacing.l",paddingY:"spacing.m",textAlign:"left",width:"100%",cursor:"not-allowed",textColor:"text.accent.onDark.disabled"},a):e.to&&e.isExternal?i.createElement(fa.N,{href:e.to,isExternal:!0,onClick:e.onClick,"aria-label":e.ariaLabel,"data-testid":e.testId,textDecoration:"none",paddingX:"spacing.l",paddingY:"spacing.m",display:"block",width:"100%",_hover:{background:"background.neutral.secondary.hovered"},_active:{background:"background.neutral.secondary.pressed"}},a):e.to?i.createElement(fn.N_,{to:e.to,onClick:e.onClick,"aria-label":e.ariaLabel,"data-testid":e.testId,style:{textDecoration:"none",display:"block",width:"100%"}},i.createElement(de.a,{paddingX:"spacing.l",paddingY:"spacing.m",_hover:{background:"background.neutral.secondary.hovered"},_active:{background:"background.neutral.secondary.pressed"}},a)):i.createElement(de.a,{as:"button",onClick:e.onClick,"aria-label":e.ariaLabel,"data-testid":e.testId,paddingX:"spacing.l",paddingY:"spacing.m",width:"100%",textAlign:"left",_hover:{background:"background.neutral.secondary.hovered"},_active:{background:"background.neutral.secondary.pressed"}},a)},va=({items:e,title:t,footer:n})=>i.createElement(Ne.s,{direction:"column",width:"100%"},t&&i.createElement(de.a,{paddingY:"spacing.s"},i.createElement(Oe.D,{variant:"heading.s",noOfLines:1,textAlign:"left"},t)),i.createElement(de.a,{borderRadius:"s",overflow:"hidden",background:"background.neutral.secondary.default"},i.createElement(bn.T,{divider:_a||(_a=i.createElement(de.a,{border:"none"},i.createElement(na.c,{orientation:"horizontal",w:"auto",mx:"spacing.l",color:"divider.neutral.primary.default"}))),spacing:0,align:"stretch"},e.map((e,t)=>{var n;return i.createElement(ba,{key:null!==(n=e.id)&&void 0!==n?n:t,item:e})}))),n&&i.createElement(de.a,{paddingY:"spacing.xs"},i.createElement(Ke.E,{variant:"body.default.s",textColor:"text.neutral.secondary.default"},n)));var ka,Ta,Ca;const wa=["GB","FR","DE","BE","BR","US"],Sa=()=>{const{hasParentAccount:e,country:t,userHasOffer:n}=Sn(),a=[{label:(0,oe.AP)("planspage_action_getagiftcard_web"),to:"/payment/go.php?id=1&gift=1&origin=gift-account-menu-desktop",rightElement:ka||(ka=i.createElement(Tn.v,{boxSize:"24px"})),ariaLabel:(0,oe.AP)("planspage_action_getagiftcard_web"),testId:"gift-card-list-item",isExternal:!0,isDisabled:!wa.includes(t),onClick:()=>{}},{label:(0,oe.AP)("settingspage_title_plandetailsandinvoices_web"),to:"/account/subscription",rightElement:Ta||(Ta=i.createElement(Tn.v,{boxSize:"24px"})),ariaLabel:(0,oe.AP)("settingspage_title_plandetailsandinvoices_web"),testId:"subscription-list-item",isExternal:!0,onClick:()=>{}},...n?[]:[{label:(0,oe.AP)("Activer un code"),to:"/gift",rightElement:Ca||(Ca=i.createElement(Tn.v,{boxSize:"24px"})),ariaLabel:(0,oe.AP)("Activer un code"),testId:"activate-code-list-item",isExternal:!0,isDisabled:e}]];return i.createElement(va,{title:(0,oe.AP)("settingspage_title_subscriptionmanagement_web"),items:a})};var xa,Ia;const Pa=()=>{const{isEligibleToDazn:e}=Sn();return e?i.createElement(ya,{label:"Subscribe to DAZN",title:(0,oe.AP)("settingspage_title_codistribpartners_web"),to:"",rightElement:xa||(xa=i.createElement(Tn.v,{boxSize:"24px"})),customLabel:Ia||(Ia=i.createElement(un.J,{variant:"accent",size:"medium"},"New")),ariaLabel:(0,oe.AP)("settingspage_title_codistribpartners_web"),testId:"partners-offer-item-list"}):null};var Ra;var Na,Oa=n("eTJY");const Da=({label:e,account:t,icon:n})=>{var r;const s=null==t?void 0:t.BLOG_NAME,o=null==t?void 0:t.USER_PICTURE,l="Admin"==t.EXTRA_FAMILY.CAPTION;return i.createElement(Ne.s,{direction:"column",width:"100%"},e&&i.createElement(de.a,{paddingY:"spacing.s"},i.createElement(Oe.D,{variant:"heading.s",noOfLines:1,textAlign:"left"},e)),i.createElement(de.a,{display:"flex",alignItems:"center",gap:"spacing.l",borderRadius:"m",background:"background.neutral.secondary.default",p:"spacing.l"},i.createElement(de.a,{position:"relative"},i.createElement(dn.e,(0,a.A)({size:"size.xl",variant:"neutral"},o?{src:Dt.A.getImageSrc("user",o,120,120)}:{},{name:s})),l&&(Na||(Na=i.createElement(de.a,{position:"absolute",bottom:"-2px",right:"-3px",maxWidth:"24px",maxHeight:"24px",display:"flex",alignItems:"center",justifyContent:"start",borderRadius:"full",background:"background.accent.primary.default",boxShadow:"md"},i.createElement(Oa.S,{color:"icon.accent.onAccent.default",boxSize:"24px"}))))),i.createElement(de.a,{display:"flex",flexDirection:"column",justifyContent:"flex-start",width:"100%",gap:"spacing.xxxs"},i.createElement(Oe.D,{variant:"heading.s",textAlign:"left",lineHeight:"1.2"},s),i.createElement(Ke.E,{variant:"body.l.default",fontWeight:"light",color:"text.neutral.secondary.default",textAlign:"left"},null==t||null===(r=t.EXTRA_FAMILY)||void 0===r?void 0:r.CAPTION)),n&&i.createElement(de.a,{boxSize:"24px",marginLeft:"spacing.xs"},n)))};var Ma,Ua,za,Fa=n("FFEP"),Ba=n("RQNg"),qa=n("Ti9p"),Ga=n("9vg6"),Ha=n("7yJB"),Va=n("yJYf"),Ya=n("ZUSG"),Qa=n("Jbs0"),Wa=n("lb8X"),Ka=n("5Loq"),ja=n("U5Vl"),$a=n("92X9"),Xa=n("IYB/"),Ja=n("IZLt");function Za(){const e=(0,r.wA)();return{createSubProfile:(0,i.useCallback)(t=>new Promise((n,a)=>{Rt.A.call({method:"user.createAndGetChild",data:{blog_name:t.blogName,is_kid:t.isKid,sex:t.sex,force_explicit_level:t.forceExplicitLevel,birthday:(new Date).getFullYear()-t.age+"-01-01"},success:t=>{Array.isArray(t)&&1===t.length&&(e({type:Xa.D.CREATE_CHILD_ACCOUNT,data:t[0]}),n(t[0]))},error:e=>{var t;new Ja.A({error:null!==(t=null==e?void 0:e.message)&&void 0!==t?t:null==e?void 0:e.name,journey_type:"family-create-member",gateway_method:"user.createAndGetChild",server_payload:e}).send(),a(e)}})}),[e]),deleteSubprofile:(0,i.useCallback)(t=>new Promise((n,a)=>{Rt.A.call({method:"user.deleteChild",data:{child_id:t.id},success:()=>{e({type:Xa.D.DELETE_CHILD_ACCOUNT,data:t.id}),n()},error:e=>{var t;new Ja.A({error:null!==(t=null==e?void 0:e.message)&&void 0!==t?t:null==e?void 0:e.name,journey_type:"family-delete-member",gateway_method:"user.deleteChild",server_payload:e}).send(),a(e)}})}),[e]),unlinkSubProfile:(0,i.useCallback)(t=>new Promise((n,a)=>{Rt.A.call({method:"family.unlinkUserFromFamily",data:{member_id:t.id},success:()=>{e({type:Xa.D.UNLINK_CHILD_ACCOUNT,data:t.id}),n()},error:e=>{var t;new Ja.A({error:null!==(t=null==e?void 0:e.message)&&void 0!==t?t:null==e?void 0:e.name,journey_type:"family-remove-independent-member",gateway_method:"family.unlinkUserFromFamily",server_payload:e}).send(),a(e)}})}),[e])}}const ei=({user:e,isOpen:t,onClose:n})=>{const a=!("Admin"===e.EXTRA_FAMILY.CAPTION||e.EXTRA_FAMILY.IS_LOGGABLE_AS),{isNew:r}=(0,$a.ap)(e),{deleteSubprofile:s,unlinkSubProfile:o}=Za(),l=(0,ja.d)(),c=a?"Remove":"Delete";return i.createElement(G.aF,{isOpen:t,onClose:n},Ma||(Ma=i.createElement(H.m,null)),i.createElement(V.$,{maxW:"565px",p:"spacing.3xl",gap:"spacing.xl"},i.createElement(bn.T,{alignItems:"flex-start",gap:"spacing.l"},i.createElement(Oe.D,{variant:"heading.l"},`Are you sure you want to ${c.toLowerCase()} ${e.BLOG_NAME}'s profile?`),Ua||(Ua=i.createElement(Ke.E,{variant:"body.default.l",textColor:"text.neutral.secondary.default"},"This action cannot be undone."))),i.createElement(de.a,{gap:"spacing.l",display:"flex",flexDirection:"row-reverse"},!r&&e.EXTRA_FAMILY.IS_DELETABLE&&i.createElement(Te.$n,{"data-testid":"subprofile-delete-btn",onClick:async()=>{try{const t=a?o:s;await t({id:e.USER_ID}),n(),l({description:`"${e.BLOG_NAME}" has been successfully ${a?"removed":"deleted"} from your account`,status:"success",duration:9e3,position:"bottom-right"})}catch(t){l({description:`An error occurred while deleting "${e.BLOG_NAME}". Please try again.`,status:"error",duration:9e3,position:"bottom-right"})}},leftIcon:za||(za=i.createElement(De.u,{color:"icon.feedback.error.default"})),variant:"outline",borderColor:"border.feedback.error.default",textColor:"text.feedback.error.default",borderRadius:"m",_hover:{textColor:"text.feedback.error.hovered"}},c," account"),i.createElement(Te.$n,{variant:"ghost",onClick:n},"Cancel"))))};var ti,ni,ai,ii,ri,si,oi,li;const ci=({user:e})=>{const t=!("Admin"===e.EXTRA_FAMILY.CAPTION||e.EXTRA_FAMILY.IS_LOGGABLE_AS),[n,a]=(0,i.useState)(!1),r=()=>a(!0),s=e.IS_KID?[{icon:ti||(ti=i.createElement(Ya.r,{boxSize:"32px",color:"icon.neutral.secondary.default"})),title:(0,oe.AP)("generic_action_editaccount_web"),helper:"",onClick:void 0},{icon:ni||(ni=i.createElement(Qa.x,{boxSize:"32px",color:"icon.neutral.secondary.default"})),title:(0,oe.AP)("generic_action_deleteaccount_web"),helper:(0,oe.AP)("settingshelper_text_permanentlydeletedaccount_web"),onClick:r}]:t?[{icon:ai||(ai=i.createElement(Wa.G,{boxSize:"32px",color:"icon.neutral.secondary.default"})),title:(0,oe.AP)("familymemberremove_title_removethismember_web"),helper:"",onClick:r}]:[{icon:ii||(ii=i.createElement(Ya.r,{boxSize:"32px",color:"icon.neutral.secondary.default"})),title:(0,oe.AP)("generic_action_editaccount_web"),helper:"",onClick:void 0},{icon:ri||(ri=i.createElement(Qa.x,{boxSize:"32px",color:"icon.neutral.secondary.default"})),title:(0,oe.AP)("generic_action_deleteaccount_web"),helper:(0,oe.AP)("settingshelper_text_permanentlydeletedaccount_web"),onClick:r},{icon:si||(si=i.createElement(Fa.X,{boxSize:"32px",color:"icon.neutral.secondary.default"})),title:(0,oe.AP)("generic_action_makeindependentaccount_web"),helper:(0,oe.AP)("settingshelper_text_independentaccountcredentials_web"),onClick:void 0}];return i.createElement(i.Fragment,null,i.createElement(Ba.A,{placement:"right",closeOnBlur:!0},oi||(oi=i.createElement(qa.W,null,i.createElement(Te.K0,{"aria-label":"options-profil","data-testid":"option-profile-btn",icon:i.createElement(Ka.j,{boxSize:"32px"}),variant:"ghost",boxSize:"32px"}))),i.createElement(Ga.h,{"data-testid":"option-profile-popover",zIndex:"4001",w:"sm",px:"0",py:"2",bg:"background.neutral.tertiary.default",borderRadius:"lg"},li||(li=i.createElement(Ha.R,{bg:"background.neutral.tertiary.default"})),i.createElement(Va.e,{p:0},s.map((e,t)=>i.createElement(de.a,{"data-testid":"option-profile",as:"button",key:t,onClick:e.onClick,display:"flex",alignItems:"center",w:"100%",textAlign:"left",px:"spacing.l",py:"spacing.m",_hover:{bg:"background.neutral.tertiary.hovered"}},e.icon,i.createElement(de.a,{ml:"spacing.l",flex:"1"},i.createElement(Oe.D,{variant:"heading.xs"},e.title),e.helper&&i.createElement(Ke.E,{variant:"body.default.2xs",textColor:"text.neutral.secondary.default"},e.helper))))))),i.createElement(ei,{user:e,isOpen:n,onClose:()=>a(!1)}))};var di,ui;const pi=({label:e,footer:t,items:n})=>0===(0,r.d4)(e=>(0,S.TW)(e.user)).filter(e=>null!==e.PARENT_ID).length?null:i.createElement(Ne.s,{direction:"column",width:"100%"},e&&i.createElement(de.a,{paddingY:"spacing.s"},i.createElement(Oe.D,{variant:"heading.s",noOfLines:1,textAlign:"left"},e)),i.createElement(de.a,{borderRadius:"m",overflow:"hidden",background:"background.neutral.secondary.default"},i.createElement(bn.T,{divider:di||(di=i.createElement(de.a,{border:"none"},i.createElement(na.c,{orientation:"horizontal",w:"auto",mx:"spacing.l",color:"divider.neutral.primary.default"}))),spacing:0,align:"stretch"},n.map(e=>{const t=null==e?void 0:e.BLOG_NAME,n=null==e?void 0:e.USER_PICTURE,r=!("Admin"===e.EXTRA_FAMILY.CAPTION||e.EXTRA_FAMILY.IS_LOGGABLE_AS);return i.createElement(de.a,{key:e.USER_ID,w:"100%",display:"flex",alignItems:"center",gap:"spacing.l",py:"spacing.l",paddingLeft:"spacing.l",paddingRight:"spacing.s",_hover:{background:"background.neutral.secondary.hovered"},"data-testid":`subprofile-item-${e.USER_ID}`},i.createElement(de.a,{position:"relative"},i.createElement(dn.e,(0,a.A)({size:"size.xl",variant:"neutral"},n?{src:Dt.A.getImageSrc("user",n,120,120)}:{},{name:t})),r&&(ui||(ui=i.createElement(de.a,{position:"absolute",bottom:"-2px",right:"-3px",width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"full",background:"background.accent.onDark.default",boxShadow:"md"},i.createElement(Fa.X,{boxSize:"24px",color:"icon.accent.onLight.default"}))))),i.createElement(de.a,{flex:"1"},i.createElement(Oe.D,{variant:"heading.s",lineHeight:"1.2"},t),i.createElement(Ke.E,{variant:"body.l.default",fontWeight:"light",color:"text.neutral.secondary.default",textAlign:"left"},e.EXTRA_FAMILY.CAPTION)),i.createElement(de.a,{display:"flex",alignItems:"center"},i.createElement(ci,{user:e})))}))),t&&i.createElement(de.a,{paddingY:"spacing.xs"},i.createElement(Oe.D,{variant:"body.default.s",textColor:"text.neutral.secondary.default"},t)));var mi,hi,gi,yi,Ai=n("j7yM"),Ei=n("P4bz"),_i=n("7Gye");const fi=()=>{const e=[{icon:mi||(mi=i.createElement(Ai.r,{boxSize:"32px",color:"icon.neutral.secondary.default"})),title:(0,oe.AP)("familymemberinvite_action_sendaninvite_web"),helper:(0,oe.AP)("familymemberinvite_text_independentownaccountcredentials_web"),to:Fn_MANAGE_ACCOUNTS.CONVERT},{icon:hi||(hi=i.createElement(Ei.H,{boxSize:"32px",color:"icon.neutral.secondary.default"})),title:(0,oe.AP)("family_action_addaprofile_web"),helper:(0,oe.AP)("familymemberinvite_text_adminaccountsamecredentials_web"),to:Fn_MANAGE_ACCOUNTS.CREATE}];return i.createElement(Ba.A,{placement:"right",closeOnBlur:!0},gi||(gi=i.createElement(qa.W,null,i.createElement(de.a,{as:"button",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",width:"48px",height:"48px",borderRadius:"full",background:"background.neutral.tertiary.default",p:"spacing.m","aria-label":"add-subprofile","data-testid":"add-subprofile-btn"},i.createElement(_i.c,{size:"medium",color:"text.neutral.secondary.default"})))),i.createElement(Ga.h,{"data-testid":"add-subprofile-popover",zIndex:"4001",w:"sm",px:"0",py:"2",bg:"background.neutral.tertiary.default",borderRadius:"lg"},yi||(yi=i.createElement(Ha.R,{bg:"background.neutral.tertiary.default"})),i.createElement(Va.e,{p:0},e.map((e,t)=>i.createElement(de.a,{as:fn.N_,to:e.to,key:t,display:"flex",alignItems:"flex-start",w:"100%",textAlign:"left",px:"spacing.l",py:"spacing.m",_hover:{bg:"background.neutral.tertiary.hovered"},gap:"spacing.l"},e.icon,i.createElement(de.a,{flex:"1"},i.createElement(Oe.D,{variant:"heading.xs"},e.title),e.helper&&i.createElement(Ke.E,{variant:"body.default.2xs",textColor:"text.neutral.secondary.default"},e.helper)))))))};var bi;const vi=()=>0===(0,r.d4)(e=>(0,S.KU)(e.user))?null:i.createElement(Ne.s,{direction:"column",width:"100%",alignItems:"center",borderRadius:"m",background:"background.neutral.secondary.default",p:"spacing.l",gap:"spacing.xl"},i.createElement(de.a,{display:"flex",alignItems:"center",gap:"spacing.l",width:"100%"},bi||(bi=i.createElement(fi,null)),i.createElement(Oe.D,{variant:"heading.s",lineHeight:"1.2"}," ","Add an account"))),ki=(e,t,n)=>{var a;return{__TYPE__:"parent",BLOG_NAME:t,BIRTHDAY:e.BIRTHDAY,EXTRA_FAMILY:null!==(a=e.EXTRA_FAMILY)&&void 0!==a?a:{CAPTION:"Admin",IS_DELETABLE:!1,IS_DELINKABLE:!1,IS_EXPLICIT_LEVEL_EDITABLE:!1,IS_LOGGABLE_AS:!1,IS_PERSONAL_DATA_EDITABLE:!1,TOGGLE_EXPLICIT_CONTROL:!1},IS_KID:!1,PARENT_ID:null,SEX:e.SEX,USER_ID:String(e.id),USER_PICTURE:n}};var Ti;var wi,Si,xi,Ii=n("80JK"),Pi=n("8WIx"),Ri=n("jysG"),Li=n("mbHV"),Ni=n("SH0+"),Oi=n("iZAa"),Di=n("kqs6");const Mi=({state:e,dispatch:t})=>i.createElement(i.Fragment,null,wi||(wi=i.createElement(de.a,{as:"button","data-testid":"update-subprofile-picture-btn",cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center",bg:"background.neutral.secondary.default",rounded:"full",minW:"107px",minH:"107px"},i.createElement(Di.x,{"aria-label":"Add or Edit user photo",color:"icon.neutral.secondary.default",boxSize:"32px"}))),i.createElement(Ii.MJ,{isRequired:!0,isInvalid:!e.blogname.isValid},i.createElement(Pi.l,{htmlFor:"username",color:"text.neutral.primary.default"},(0,oe.AP)("generic_text_username_web")),i.createElement(Ce.p,{"data-testid":"edit-subprofile-username-input",id:"edit-subprofile-username-input",minH:"56px",bgColor:"background.neutral.secondary.default",onChange:e=>t({type:"update_blogname",value:e.target.value}),value:e.blogname.value}),i.createElement(Ri.Wt,null,e.blogname.error)),i.createElement(Ii.MJ,{isRequired:!0,isInvalid:!e.identity.isValid},i.createElement(Pi.l,{htmlFor:"identity",color:"text.neutral.primary.default"},(0,oe.AP)("genderscreen_title_identity_web")),i.createElement(Li.l,{id:"edit-subprofile-identity-input","data-testid":"edit-subprofile-identity",minH:"56px",bgColor:"background.neutral.secondary.default",onChange:e=>{t({type:"update_identity",value:e.target.value})},value:e.identity.value},i.createElement("option",{value:"F"},(0,oe.AP)("genderoption_text_female_web")),i.createElement("option",{value:"M"},(0,oe.AP)("genderoption_text_male_web")),_.A.isAllowed("gender_nonbinary")&&i.createElement("option",{value:"NonBinary"},(0,oe.AP)("genderoption_text_nonbinary_web"))),i.createElement(Ri.Wt,null,e.identity.error)),i.createElement(Ii.MJ,{isRequired:!0,isInvalid:!e.age.isValid},i.createElement(Pi.l,{htmlFor:"age",color:"text.neutral.primary.default",variant:"heading.s"},(0,oe.AP)("generic_title_age_web")),i.createElement(Ni.Q7,{max:99,min:1,defaultValue:18,id:"edit-subprofile-age-input","data-testid":"edit-subprofile-age",onChange:(e,n)=>{t({type:"update_age",value:n})},value:e.age.value},Si||(Si=i.createElement(Ni.OO,{minH:"56px",bgColor:"background.neutral.secondary.default"})),xi||(xi=i.createElement(Ni.lw,null,i.createElement(Oi.Q0,null),i.createElement(Oi.Sh,null)))),i.createElement(Ri.Wt,null,e.age.error))),Ui=({toggleTitle:e,helper:t,isChecked:n,isDisabled:a,onChange:r})=>i.createElement(Ne.s,{minH:"90px",justifyContent:"center",gap:"spacing.s",w:"100%",bgColor:"background.neutral.secondary.default",p:"spacing.l",borderRadius:"lg"},i.createElement(Jn.z,null,i.createElement(bn.T,{gap:"spacing.2xs",alignItems:"flex-start"},i.createElement(Ke.E,{variant:"heading.xs"},e),i.createElement(Ke.E,{variant:"body.s.default",color:"text.neutral.secondary.default"},t)),i.createElement(pn.d,{size:"lg",isChecked:n,isDisabled:a,onChange:r})));var zi=n("5U+Y"),Fi=n("H9G8"),Bi=(n("WpbS"),n("1EyH"));(0,fe.A)((e,t,n,a)=>(async(e,t=!1)=>{if(e=e.trim(),!(0,Bi.UC)(e))throw new Fi.Hf;const n=await Rt.A.callAsync({method:"deezer.emailCheck",data:{EMAIL:e}});if(!n.domain_validity)throw new Fi.SY(n.domain);if(n.availability)return t&&n.suggestion?{success:!0,suggestion:n.suggestion}:{success:!0};throw new Fi.qb})(e,t).then(n).catch(a),400);const qi=e=>{if((e=e.trim()).length<2)throw new Fi.U9;if(e.length>50)throw new Fi.aS;if((0,Bi.Sx)(e)||(0,Bi.BB)(e))throw new Fi.In;return!0},Gi=e=>{if("string"==typeof e){if(!/^\d+$/.test(e.toString()))throw new Fi.vM;e=parseInt(e,10)}if(e<1)throw new Fi.vM;if(e>99)throw new Fi.vM;return!0},Hi=e=>{try{return e(),{isValid:!0,message:""}}catch(e){return e instanceof Fi.jQ?{isValid:!1,message:e.message}:{isValid:!1,message:""}}},Vi=(e,t)=>{switch(t.type){case"update_blogname":{const{isValid:n,message:a}=Hi(()=>qi(t.value));return{...e,blogname:{value:t.value,isValid:n,error:a}}}case"update_kid":return{...e,isKid:{value:t.value,isValid:!0,error:""}};case"update_identity":return{...e,identity:{value:t.value,isValid:!0,error:""}};case"update_age":{if(!t.value)return{...e,age:{value:Number.isNaN(t.value)?0:t.value,isValid:!1,error:(0,oe.AP)("familyprofileswitcheraddprofile_text_pleaseselectage_web")}};const{isValid:n,message:a}=Hi(()=>Gi(t.value)),i=t.value<12;return{...e,age:{value:t.value,isValid:n,error:a},isKid:{value:i,isValid:!0,error:""},hideExplicitConsent:t.value<16||e.hideExplicitConsent}}default:return{...e,...t.value}}},Yi={blogname:{value:"",isValid:!0,error:""},isKid:{value:!1,isValid:!0,error:""},identity:{value:"F",isValid:!0,error:""},age:{value:18,isValid:!0,error:""},hideExplicitConsent:!1};var Qi=n("kDgj");const Wi=({onSave:e,onCancel:t,isSaveDisabled:n,saveLabel:a,cancelLabel:r,isLoading:s})=>i.createElement(de.a,{borderTop:"1px",borderTopColor:"divider.neutral.primary.default",px:"spacing.xl",py:"spacing.l",position:"sticky",bottom:0,bg:"background.neutral.primary.default"},i.createElement(Jn.z,{justifyContent:"flex-end",gap:"spacing.l"},i.createElement(Te.$n,{variant:"ghost",borderRadius:"xl",onClick:t},r),i.createElement(Te.$n,{borderRadius:"xl",onClick:e,isDisabled:n,isLoading:s},a)));var Ki;const ji=({user:e,isFormLoading:t})=>{const{state:n,dispatch:a,isFormValid:r,isNew:s}=(e=>{var t;const n=!parseInt(e.USER_ID,10),[a,r]=(0,i.useReducer)(Vi,Yi),s=a.blogname.value.length>0&&a.blogname.isValid&&a.age.isValid&&a.identity.isValid;return{state:a,dispatch:r,isExplicitLevelEditable:!a.isKid.value||!n&&null!==(t=e.EXTRA_FAMILY.IS_EXPLICIT_LEVEL_EDITABLE)&&void 0!==t&&t,isFormValid:s,isNew:n}})(e),{createSubProfile:l}=Za(),{trackEvent:c}=(0,o.z1)(),d=(0,ja.d)();return(0,i.useEffect)(()=>{n.age.value>=zi.fB&&n.hideExplicitConsent&&a({type:"form",value:{hideExplicitConsent:!1}})},[n.age.value]),i.createElement(i.Fragment,null,i.createElement(de.a,{flex:1,overflowY:"auto",scrollBehavior:"smooth"},i.createElement(bn.T,{px:"spacing.xl",gap:"spacing.xl",paddingTop:"spacing.l",paddingBottom:"spacing.2xl"},i.createElement(Mi,{state:n,dispatch:a}),Ki||(Ki=i.createElement(de.a,{gap:"spacing.s",alignSelf:"flex-start"},i.createElement(Ke.E,{variant:"heading.m"}," Admin Settings"),i.createElement(Ke.E,{variant:"body.s.default",color:"text.neutral.secondary.default"},"This member won’t be able to change the following settings on his own."))),i.createElement(Ui,{"data-testid":"isKid-switch",toggleTitle:(0,oe.AP)("familymemberselectorlabel_title_kids_web"),helper:(0,oe.WI)("familyaccountmgmt_text_onlycontentsuitableforXageandunder_web","familyaccountmgmt_text_onlycontentsuitableforXageandunder_web",{count:12,sprintf:[12]}),isChecked:n.isKid.value,onChange:e=>a({type:"update_kid",value:e.target.checked})}),!n.isKid.value&&i.createElement(Ui,{"data-testid":"hide-explicit-consent-switch",toggleTitle:(0,oe.AP)("settingspage_title_hideexplicitcontent_web"),helper:`${(0,oe.AP)("familyaccountmgmt_text_activatingwillhideexplicitcontent_web")}\n\t\t\t\t\t ${(0,oe.AP)("familyaccountmgmt_text_profilescannoteditthissetting_web")}`,isChecked:n.hideExplicitConsent,onChange:e=>{a({type:"form",value:{hideExplicitConsent:e.target.checked}}),c({event:"click",eventlabel:e.target.checked?Qi.w:Qi.E})}}),n.age.value<zi.fB&&i.createElement(Ke.E,{color:"text.neutral.secondary.default",variant:"body.s.default",sx:{"> a":{color:"text.accent.primary.default",textDecor:"underline"}},dangerouslySetInnerHTML:{__html:(0,oe.WI)("familyaccountmgmt_text_TCsprivacypolicyforunderXyearold_web","familyaccountmgmt_text_TCsprivacypolicyforunderXyearold_web",{count:zi.fB,sprintf:[zi.fB,'target="_blank" href="/legal/personal-datas"']})}}))),i.createElement(Wi,{onSave:async()=>{if(s){const e={blogName:n.blogname.value,isKid:n.isKid.value,sex:n.identity.value,forceExplicitLevel:n.hideExplicitConsent,age:n.age.value};try{await l(e),window.location.hash=zn_MANAGE_ACCOUNTS}catch(e){d({description:`An error occurred while adding "${n.blogname.value}". Please try again.`,status:"error",duration:9e3,position:"bottom-right"})}}},onCancel:()=>{window.location.hash=zn_MANAGE_ACCOUNTS},isSaveDisabled:!r,saveLabel:(0,oe.AP)("familyaccountmgmt_action_createprofile_web"),cancelLabel:(0,oe.AP)("generic_action_cancel_web"),isLoading:t}))},$i={__TYPE__:"user_child",BIRTHDAY:"",BLOG_NAME:"",EXTRA_FAMILY:{CAPTION:"",IS_DELETABLE:!1,IS_DELINKABLE:!1,IS_EXPLICIT_LEVEL_EDITABLE:!0,IS_LOGGABLE_AS:!1,IS_PERSONAL_DATA_EDITABLE:!0,TOGGLE_EXPLICIT_CONTROL:!1},IS_KID:!1,PARENT_ID:null,SEX:"",USER_ID:"",USER_PICTURE:""};var Xi;var Zi,er,tr,nr=n("rHBS");const ar=()=>{const{userID:e,userEmail:t,renderEmail:n}=Sn(),a=(0,ja.d)(),r=e=>{e&&navigator.clipboard.writeText(e).then(()=>{a({description:"The content has been copied successfully.",status:"success",duration:3e3,position:"bottom-right"})})},s=[{label:`${(0,oe.AP)("settingspage_title_idnumber_web")} ${e}`,ariaLabel:"copy-id-number",testId:"id-copy-item",rightElement:Zi||(Zi=i.createElement(nr.T,{boxSize:"24px"})),onClick:()=>r(String(e))},...n?[{label:t,rightElement:er||(er=i.createElement(nr.T,{boxSize:"24px"})),ariaLabel:"copy-email",testId:"email-copy-item",onClick:()=>r(t)}]:[],{label:(0,oe.AP)("settingspage_action_editmyinformation_web"),to:Fn_EDIT_INFOS,ariaLabel:(0,oe.AP)("settingspage_action_editmyinformation_web"),testId:"edit-infos-list-item",rightElement:tr||(tr=i.createElement(Tn.v,{boxSize:"24px"}))}];return i.createElement(va,{title:(0,oe.AP)("settingspage_title_accountdetails_web"),items:s})};var ir,rr,sr;const or=()=>{const{hasOwnCredentials:e}=Sn(),t=[{label:(0,oe.AP)("settingspage_action_changemyemail_web"),rightElement:ir||(ir=i.createElement(Tn.v,{boxSize:"24px"})),ariaLabel:(0,oe.AP)("settingspage_action_changemyemail_web"),testId:"change-email-list-item"},{label:(0,oe.AP)("settingspage_action_changemypassword_web"),rightElement:rr||(rr=i.createElement(Tn.v,{boxSize:"24px"})),ariaLabel:(0,oe.AP)("settingspage_action_changemypassword_web"),testId:"change-password-list-item"}];return e?i.createElement(va,{title:(0,oe.AP)("settingspage_title_loginandsecurity_web"),items:t}):i.createElement(Ne.s,{direction:"column",gap:"spacing.s"},i.createElement(Oe.D,{variant:"heading.s",noOfLines:1,textAlign:"left"},(0,oe.AP)("settingspage_title_loginandsecurity_web")),i.createElement(Jn.z,{spacing:"spacing.s"},sr||(sr=i.createElement(sa.u,{alignSelf:"flex-start",boxSize:"24px",color:"icon.neutral.secondary.default"})),i.createElement(bn.T,null,i.createElement(Ke.E,{variant:"body.l.default",flex:"1"},(0,oe.AP)("infomessage_text_entercredentialsforindependent_web")),i.createElement(Te.$n,{alignSelf:"flex-start",size:"md",borderRadius:"xl",py:"spacing.l",px:"spacing.xl",minH:"48px",backgroundColor:"accent.primary",_hover:{backgroundColor:"accent.primary.hover"},"data-testid":"add-my-credentials-btn"},(0,oe.AP)("infomessage_action_addmycredentials_web")))))};var lr,cr,dr,ur=n("2Av+"),pr=n("Ae9q"),mr=n("JlHZ");const hr=()=>{const{hasOwnCredentials:e}=Sn(),t=[{leftElement:lr||(lr=i.createElement(ur.i,{boxSize:"24px"})),label:"Facebook",rightElement:i.createElement(Ke.E,{variant:"body.l.default",color:"text.neutral.primary.selected",cursor:"pointer"},(0,oe.AP)("generic_action_link_web")),ariaLabel:"link-facebook",testId:"facebook-link-item"},{leftElement:cr||(cr=i.createElement(pr.N,{boxSize:"24px"})),label:"Google",rightElement:i.createElement(Ke.E,{variant:"body.l.default",color:"text.neutral.primary.selected",cursor:"pointer"},(0,oe.AP)("generic_action_link_web")),ariaLabel:"link-google",testId:"google-link-item"},{leftElement:dr||(dr=i.createElement(mr.Y,{boxSize:"24px"})),label:"Apple ID",rightElement:i.createElement(Ke.E,{variant:"body.l.default",color:"text.neutral.primary.selected",cursor:"pointer"},(0,oe.AP)("generic_action_link_web")),ariaLabel:"link-apple",testId:"apple-link-item"}];if(e)return i.createElement(va,{title:(0,oe.AP)("settingspage_title_thirdpartyauthentication_web"),items:t})};var gr,yr,Ar,Er,_r=n("Vd8Q");const fr=()=>{const{isKidAccount:e,userOptins:t}=Sn(),n=[...[{id:"cookies",label:(0,oe.AP)("settingspage_action_managemycookies_web"),rightElement:gr||(gr=i.createElement(Tn.v,{boxSize:"24px"})),ariaLabel:(0,oe.AP)("settingspage_action_managemycookies_web"),testId:"manage-cookies-list-item"},{id:"notifications",label:(0,oe.AP)("settingspage_action_managemynotifications_web"),rightElement:yr||(yr=i.createElement(Tn.v,{boxSize:"24px"})),ariaLabel:(0,oe.AP)("settingspage_action_managemynotifications_web"),testId:"manage-notifications-list-item"},{id:"data",label:(0,oe.AP)("generic_action_requestmydata_web"),rightElement:Ar||(Ar=i.createElement(Tn.v,{boxSize:"24px"})),ariaLabel:(0,oe.AP)("generic_action_requestmydata_web"),testId:"download-data-list-item"},{id:"apps",label:(0,oe.AP)("settingspage_title_myapps_web"),ariaLabelIcon:"navigate",rightElement:Er||(Er=i.createElement(Tn.v,{boxSize:"24px"})),ariaLabel:(0,oe.AP)("settingspage_title_myapps_web"),testId:"apps-list-item",to:`https://${_r.default.get("host_account")}/apps/`,isExternal:!0}].filter(n=>(!e||"cookies"!==n.id)&&("notifications"!==n.id||0!==t.channel.length&&0!==t.optin.length)&&"apps"!==n.id)];return i.createElement(va,{title:(0,oe.AP)("settingspage_title_privacy_web"),items:n})};var br,vr,kr,Tr,Cr;var Sr,xr,Ir,Pr=n("o4K4");var Lr,Nr,Or;var Mr,Ur,zr,Fr,Br=n("i6DM"),qr=n("fkXJ");const Gr=()=>{const{isKidAccount:e,username:t,userID:n}=Sn(),a=(0,r.d4)(hn.sc),o=[{id:"tmm",label:(0,oe.AP)("generic_action_importmymusic_web"),ariaLabel:(0,oe.AP)("generic_action_importmymusic_web"),testId:"tmm-list-item",rightElement:Mr||(Mr=i.createElement(Tn.v,{boxSize:"24px"})),onClick:async()=>{const e=await(0,Br.Kl)(String(n),t,true).catch(()=>(0,qr.A)({body:(0,oe.AP)("Une erreur est survenue, merci de réessayer plus tard.")}));e&&open(e)},isDisabled:!a,isExternal:!0},{id:"explicit-content",label:(0,oe.AP)("settingspage_action_manageexplicitcontent_web"),ariaLabel:(0,oe.AP)("settingspage_action_manageexplicitcontent_web"),testId:"manage-explicit-content-list-item",rightElement:Ur||(Ur=i.createElement(Tn.v,{boxSize:"24px"}))},{id:"change-country",label:(0,oe.AP)("settingspage_action_changecountryselection_web"),ariaLabel:(0,oe.AP)("settingspage_action_changecountryselection_web"),testId:"change-country-list-item",rightElement:zr||(zr=i.createElement(Tn.v,{boxSize:"24px"}))},{id:"recommendations",label:(0,oe.AP)("settingspage_title_managerecommendations_web"),ariaLabel:(0,oe.AP)("settingspage_title_managerecommendations_web"),testId:"manage-recommendation-list-item",rightElement:Fr||(Fr=i.createElement(Tn.v,{boxSize:"24px"}))}].filter(t=>!e||"tmm"!==t.id&&"explicit-content"!==t.id);return i.createElement(va,{title:(0,oe.AP)("settingspage_title_contentpreferences_web"),items:o})};var Hr,Vr;const Yr=()=>{const{hasParentAccount:e}=Sn(),t=[{id:"sync-playlist",label:(0,oe.AP)("settingspage_action_syncacrossdevices_web"),ariaLabel:(0,oe.AP)("settingspage_action_syncacrossdevices_web"),testId:"synchronise-playlist-switch-item",rightElement:Hr||(Hr=i.createElement(pn.d,null))},{id:"last-fm",label:"Last FM",ariaLabel:"Last FM",testId:"last-fm-list-item",rightElement:Vr||(Vr=i.createElement(Tn.v,{boxSize:"24px"}))}].filter(t=>"last-fm"!==t.id||!e);return i.createElement(va,{title:(0,oe.AP)("settingspage_title_otherpreferences_web"),items:t})};var Qr;const Kr=[{path:zn_ROOT,component:()=>Ra||(Ra=i.createElement(bn.T,{px:"spacing.xl",gap:"spacing.xl",paddingBottom:"spacing.2xl",paddingTop:"spacing.l"},i.createElement(ga,null),i.createElement(Ea,null),i.createElement(Sa,null),i.createElement(Pa,null)))},{path:Gn_ROOT,component:ra},{path:zn_MANAGE_ACCOUNTS,component:()=>{const e=(0,r.d4)(e=>e.user),t=(0,S.Mn)(e),n=(0,S.kL)(e),a=(0,S.TW)(e).filter(e=>null!==e.PARENT_ID),s=a.length;return i.createElement(de.a,{flex:1,overflowY:"auto",scrollBehavior:"smooth"},i.createElement(bn.T,{gap:"spacing.xl",px:"spacing.xl",paddingBottom:"spacing.2xl",paddingTop:"spacing.l"},i.createElement(Da,{label:(0,oe.AP)("generic_action_myaccount_web"),account:ki(e,t,(0,S.jg)(e)),index:0,isMe:!0}),i.createElement(pi,{label:(0,oe.WI)("settingspage_title_otheraccountsXtotal_web","settingspage_title_otheraccountsXtotal_web",{count:s,sprintf:[s,n]}),items:a}),Ti||(Ti=i.createElement(vi,null))))}},{path:Fn_MANAGE_ACCOUNTS.CREATE,component:()=>Xi||(Xi=i.createElement(ji,{user:$i}))},{path:Fn_ROOT,component:()=>{const{isSubprofile:e}=Sn();return i.createElement(de.a,{flex:1,overflowY:"auto",scrollBehavior:"smooth"},i.createElement(bn.T,{px:"spacing.xl",gap:"spacing.xl",paddingBottom:"spacing.2xl",paddingTop:"spacing.l"},br||(br=i.createElement(ar,null)),vr||(vr=i.createElement(or,null)),kr||(kr=i.createElement(hr,null)),Tr||(Tr=i.createElement(fr,null)),!e&&i.createElement(Te.$n,{alignSelf:"flex-end","data-testid":"account-delete-btn",leftIcon:Cr||(Cr=i.createElement(De.u,{color:"icon.feedback.error.default"})),variant:"outline",borderColor:"border.feedback.error.default",textColor:"text.feedback.error.default",borderRadius:"m",_hover:{textColor:"text.feedback.error.hovered"}},(0,oe.AP)("settingspage_action_deletemyaccount_web"))))}},{path:Fn_MANAGE_ACCOUNTS.CONVERT,component:()=>{const[e,t]=(0,i.useState)(!0),[n,a]=(0,i.useState)(""),s=(0,r.d4)(({user:e})=>(0,S.KU)(e)),o=(0,ja.d)();return(0,i.useEffect)(()=>{Rt.A.call({method:"family.generateInvitationLink",success:e=>{a(e),t(!1)},error:e=>{var n;new Ja.A({error:null!==(n=null==e?void 0:e.message)&&void 0!==n?n:null==e?void 0:e.name,journey_type:"invite-member",gateway_method:"family.generateInvitationLink",server_payload:e}).send(),t(!1)}})},[]),i.createElement(bn.T,{px:"spacing.xl",paddingBottom:"spacing.2xl",paddingTop:"spacing.l",display:"flex",alignItems:"flex-start",flex:1,gap:"spacing.xl"},i.createElement(Jn.z,{gap:"spacing.xs"},Sr||(Sr=i.createElement(sa.u,{boxSize:"32px"})),i.createElement(Ke.E,{variant:"body.default.l",textColor:"text.neutral.primary.default"},(0,oe.WI)("familymemberinvite_text_youcanaddXmoremembers_web","familymemberinvite_text_youcanaddXmoremembers_web",{sprintf:[s],count:s}))),e?xr||(xr=i.createElement(bt.A,null)):i.createElement(bn.T,{gap:"spacing.s",alignItems:"stretch",width:"100%"},i.createElement(Ke.E,{variant:"body.default.m"},(0,oe.AP)("generic_title_shareinvitelink_web")),i.createElement(ve.M,{size:"lg"},Ir||(Ir=i.createElement(ke.t,{pointerEvents:"none",marginRight:"spacing.m"},i.createElement(Pr.q,{boxSize:"32px",color:"icon.neutral.secondary.default"}))),i.createElement(Ce.p,{value:n,textColor:"text.neutral.primary.default",variant:"body.default.l",readOnly:!0,id:"member-link"}))),i.createElement(Te.$n,{size:"md",borderRadius:"xl",py:"spacing.l",px:"spacing.xl",minH:"48px",alignSelf:"flex-end",onClick:()=>{n&&navigator.clipboard.writeText(n).then(()=>{o({description:(0,oe.AP)("L'URL a bien été copiée."),status:"success",duration:9e3,position:"bottom-right"})})},"data-testid":"copy-link-invite-btn"},(0,oe.AP)("generic_action_copythelink_web")))}},{path:Fn_EDIT_INFOS,component:()=>{const e=(0,r.d4)(e=>e.user),t=(0,ja.d)(),{updateAccountInformation:n}=function(){const e=(0,r.wA)();return{updateAccountInformation:(0,i.useCallback)(t=>new Promise((n,a)=>{try{const i={USER_DATA:{}};if(t.blogName&&(i.USER_DATA.BLOG_NAME=t.blogName),t.identity&&(i.USER_DATA.SEX=t.identity),void 0!==t.age){const e=(new Date).getFullYear()-t.age;i.USER_DATA.BIRTHDAY=`${e}-01-01`}Rt.A.call({method:"user.update",data:i,success:()=>{t.blogName&&e((0,D.Km)(t.blogName)),e((0,D.Sk)()),n()},error:e=>{new Ja.A({error:e instanceof Error?e.message:String(e),journey_type:"update-user-infos",gateway_method:"user.update",server_payload:e}).send(),a(e)}})}catch(e){a(e)}}),[e])}}(),[a,s]=(0,i.useState)({blogName:(0,S.Mn)(e)||"",blogNameValid:!0,blogNameError:"",identity:(0,S.o_)(e)||"F",age:(0,S.QO)(e)||18,ageValid:!0,ageError:"",picture:(0,S.jg)(e)||""}),o=a.blogNameValid&&a.blogName.length>0&&a.ageValid&&a.age>=16&&a.age<=99,l=(0,i.useCallback)(async()=>{const e={blogName:a.blogName,identity:a.identity,age:a.age};try{await n(e),window.location.hash=Fn_ROOT,t({description:"Your profile has been edited successfully",status:"success",duration:9e3,position:"bottom-right"})}catch(e){t({description:`An error occurred while editing "${a.blogName}". Please try again.`,status:"error",duration:9e3,position:"bottom-right"})}},[a,t,n]),c=(0,i.useCallback)(()=>{window.location.hash=Fn_ROOT},[]);return i.createElement(i.Fragment,null,i.createElement(de.a,{flex:1,overflowY:"auto",scrollBehavior:"smooth"},i.createElement(bn.T,{px:"spacing.xl",gap:"spacing.xl",paddingTop:"spacing.l",paddingBottom:"spacing.2xl"},i.createElement(bn.T,{gap:"spacing.l"},Lr||(Lr=i.createElement(de.a,{as:"button",cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center",bg:"background.neutral.secondary.default",rounded:"full",minW:"107px",minH:"107px"},i.createElement(Di.x,{"aria-label":"Add or Edit user photo",color:"icon.neutral.secondary.default",boxSize:"32px"}))),i.createElement(Te.$n,{variant:"outline",borderRadius:"xl",size:"md"},"Change picture")),i.createElement(Ii.MJ,{isRequired:!0,isInvalid:!a.blogNameValid},i.createElement(Pi.l,{htmlFor:"edit-username-input",color:"text.neutral.primary.default"},(0,oe.AP)("generic_text_username_web")),i.createElement(Ce.p,{id:"edit-username-input","data-testid":"edit-username-input",minH:"56px",bgColor:"background.neutral.secondary.default",value:a.blogName,onChange:e=>(e=>{const{isValid:t,message:n}=Hi(()=>qi(e));s(a=>({...a,blogName:e,blogNameValid:t,blogNameError:n}))})(e.target.value)}),i.createElement(Ri.Wt,null,a.blogNameError)),i.createElement(Ii.MJ,{isRequired:!0},i.createElement(Pi.l,{htmlFor:"edit-identity-input",color:"text.neutral.primary.default"},(0,oe.AP)("genderscreen_title_identity_web")),i.createElement(Li.l,{id:"edit-identity-select","data-testid":"edit-identity-input",minH:"56px",bgColor:"background.neutral.secondary.default",value:a.identity,onChange:e=>s(t=>({...t,identity:e.target.value}))},i.createElement("option",{value:"F"},(0,oe.AP)("genderoption_text_female_web")),i.createElement("option",{value:"M"},(0,oe.AP)("genderoption_text_male_web")),_.A.isAllowed("gender_nonbinary")&&i.createElement("option",{value:"NonBinary"},(0,oe.AP)("genderoption_text_nonbinary_web")))),i.createElement(Ii.MJ,{isRequired:!0,isInvalid:!a.ageValid},i.createElement(Pi.l,{htmlFor:"edit-age-input",color:"text.neutral.primary.default"},(0,oe.AP)("generic_title_age_web")),i.createElement(Ni.Q7,{"data-testid":"edit-age-input",max:99,min:1,value:Number.isNaN(a.age)?"":a.age,onChange:(e,t)=>{s(e=>({...e,age:t}))},onBlur:()=>{s(e=>{const t=Number.isNaN(e.age)?0:e.age;return(e=>{const{isValid:t,message:n}=Hi(()=>Gi(e));s(a=>({...a,age:e,ageValid:t,ageError:n}))})(t),{...e,age:t}})}},Nr||(Nr=i.createElement(Ni.OO,{id:"edit-age-input",minH:"56px",bgColor:"background.neutral.secondary.default"})),Or||(Or=i.createElement(Ni.lw,null,i.createElement(Oi.Q0,null),i.createElement(Oi.Sh,null)))),i.createElement(Ri.Wt,null,a.ageError)))),i.createElement(Wi,{onSave:l,onCancel:c,isSaveDisabled:!o,saveLabel:(0,oe.AP)("generic_action_save_web"),cancelLabel:(0,oe.AP)("generic_action_cancel_web")}))}},{path:Bn_ROOT,component:()=>Qr||(Qr=i.createElement(de.a,{flex:1,overflowY:"auto",scrollBehavior:"smooth"},i.createElement(bn.T,{px:"spacing.xl",gap:"spacing.xl",paddingBottom:"spacing.2xl",paddingTop:"spacing.l"},i.createElement(Gr,null),i.createElement(Yr,null))))}];var jr;const $r=()=>{var e,t;const{mainRoutes:n}=Qn(),a=(null===(e=n[0])||void 0===e?void 0:e.path)||Fn_ROOT;return i.createElement(de.a,{h:"672px",bg:"background.neutral.primary.default",borderTopRightRadius:"md",borderBottomRightRadius:"md",display:"flex",flexDirection:"column",flex:1},jr||(jr=i.createElement(de.a,{borderBottom:"1px",borderBottomColor:"divider.neutral.primary.default"},i.createElement(Zn,null))),i.createElement(de.a,{flex:"1",scrollBehavior:"smooth",overflowY:"auto"},i.createElement(be.dO,null,t||(t=i.createElement(be.qh,{exact:!0,path:"/"},i.createElement(be.rd,{to:a}))),Kr.map(({path:e,component:t})=>i.createElement(be.qh,{key:e,exact:!0,path:e,component:t})))))};var Xr,Jr,Zr=n("fEzs");function es({isOpen:e=!1,onClose:t}){const[n,a]=(0,i.useState)(!1),r=(0,Zr.h)();(0,i.useEffect)(()=>{window.location.hash.includes("/settings")&&a(!0)},[]);const s=()=>{window.history.pushState(null,"",window.location.pathname+window.location.search),a(!1),t()},o=e||n;return o?i.createElement(fn.I9,{basename:"settings"},i.createElement(G.aF,{isOpen:o,onClose:s,isCentered:!0},Xr||(Xr=i.createElement(H.m,null)),i.createElement(V.$,{p:0,borderRadius:"m",overflow:"hidden",display:"flex",flexDir:"row",maxW:"900px"},i.createElement(jn,{onSwitchProfileClick:s,isCollapsed:r}),Jr||(Jr=i.createElement($r,null))))):null}class ts extends i.Component{constructor(...e){super(...e),this.state={isEntryPointModalOpen:!1},this.openEntryPointModal=()=>{this.setState({isEntryPointModalOpen:!0})},this.closeEntryPointModal=()=>{this.setState({isEntryPointModalOpen:!1})}}render(){const{userPicture:e,userName:t}=this.props,n="true"===new URLSearchParams(window.location.search).get("new_setting_revamp_2025"),r=_r.default.get("env").includes("development")&&n||_.A.isAllowed("new_setting_revamp_2025"),s={popperId:"topbar-profile",trigger:[Tt.uW],delay:500,isDisabled:!1};return i.createElement(i.Fragment,null,i.createElement(En,(0,a.A)({className:"topbar-action"},s),i.createElement(dn.e,(0,a.A)({as:"button","data-testid":"topbar-profile",size:"size.m",variant:"neutral",name:t,src:e?(0,gn.AE)(Be.Ay.User,e,100,100):"",isHoverEnabled:!0},r&&{onClick:this.openEntryPointModal}))),i.createElement(es,{isOpen:this.state.isEntryPointModalOpen,onClose:this.closeEntryPointModal}))}}const ns=(0,r.Ng)(({user:e})=>({userPicture:e.USER.USER_PICTURE,userName:(0,S.Mn)(e)}))(ts);var as,is=n("17x9"),rs=n.n(is),ss=n("LvjZ"),os=n("XBvc");function ls(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}as=document.head&&document.head.dataset?{set:function(e,t,n){e.dataset[t]=n},get:function(e,t){return e.dataset[t]},del:function(e,t){delete e.dataset[t]},getAll:function(e){return e.dataset}}:{set:function(e,t,n){return e.setAttribute("data-"+ls(t),n),n},get:function(e,t){var n=e.getAttribute("data-"+ls(t));return null===n?void 0:n},del:function(e,t){return e.removeAttribute("data-"+ls(t)),!0},getAll:function(e){for(var t,n,a={},i=0;i<e.attributes.length;i++)"data-"===(t=e.attributes[i].name).substr(0,5)&&(a[(n=t.substr(5),n.toLowerCase().replace(/-(.)/g,function(e,t){return t.toUpperCase()}))]=e.attributes[i].value);return a}};const cs_dataset=function(e,t,n){var a={set:function(t,n){return as.set(e,t,n),a},get:function(t){return as.get(e,t)},del:function(t){return as.del(e,t),a}};return 3===arguments.length?a.set(t,n):2===arguments.length?a.get(t):as.getAll(e)};class ds extends i.Component{render(){const{CONVERSION_BANNER_FREE_MYMENU:e,CONVERSION_BANNER_TRIAL_MYMENU:t}=this.props.conversionEntrypoints,n=e||t;return n?i.createElement(Le.A,{className:"popper-entrypoints",size:Tt.Dn},i.createElement("p",null,n.description)):null}}const us=(0,Re.A)((0,r.Ng)(({user:e})=>({conversionEntrypoints:e.USER.ENTRYPOINTS}))(ds));var ps,ms,hs=n("nzlo");function gs(e){return i.createElement(hs.A,(0,a.A)({name:"add"},e),ps||(ps=i.createElement("path",{fillRule:"evenodd",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M6 1.5v9M1.5 6h9"})))}class ys extends i.Component{constructor(e){super(e),this._onLinkClick=this._onLinkClick.bind(this)}render(){const{conversionEntrypoints:e}=this.props;if(0===Object.keys(e).length)return null;const{CONVERSION_BANNER_FREE:t,CONVERSION_BANNER_TRIAL:n,CONVERSION_BANNER_FREE_MYMENU:a,CONVERSION_BANNER_TRIAL_MYMENU:r,MYMENU:s}=e;if(t||n)return null;const o=a||r||s;if(!o)return null;const l={className:"topbar-entrypoints",popperId:"topbar-entrypoints",trigger:[Tt.mH],delay:0,isDisabled:!o.description},c={as:"a",colorScheme:"primary",leftIcon:s?ms||(ms=i.createElement(gs,null)):void 0,href:(0,da.hY)(o.action),onClick:this._onLinkClick,target:"_blank","data-type":"offers_subscribe"};return i.createElement(us,l,i.createElement(Te.$n,c,o.label))}_onLinkClick(e){this.tracking("menu_click",e.currentTarget)}}const As=(0,r.Ng)(({user:e})=>({conversionEntrypoints:e.USER.ENTRYPOINTS}))((e=>{var t;const n=Object.assign({},e.contextTypes||{},{getTrackingParams:rs().func}),a=((t=class extends e{constructor(...e){super(...e),this.tags={player_click:["type"],context_menu_click:["type","instance"],panel_click:["panel","type","id","index","instance"],menu_click:["type"],lyrics:["ts","action","container","sng","type"],artist_page_click:["type"],discography_click:["type","position","sort","view"],adblock_banner:["group","link","close"],pushbox:["action","box"]},this.platform={lyrics:"deezer_log",pushbox:"deezer_log"}}tracking(e,t){if("object"!=typeof this.tags[e])return!1;let n="function"==typeof this.getTrackingParams?this.getTrackingParams():{};"function"==typeof this.context.getTrackingParams&&Object.assign(n,this.context.getTrackingParams());let a={};"object"==typeof t&&(a=cs_dataset(t));for(let t=0;t<this.tags[e].length;t++){let i=this.tags[e][t];"ts"!==i?void 0!==a[i]&&null!==a[i]&&(n[i]=a[i]):n[i]=(0,S.mI)({SERVER_TIMESTAMP:this.props.serverTimestamp,clientTimestampDelta:this.props.clientTimestampDelta})}let i="";return"string"==typeof a.trackingCallback&&(i=this[a.trackingCallback]||""),"string"==typeof this.platform[e]&&"deezer_log"===this.platform[e]?((0,os.isLogCentralWhitelisted)(e)||b.A.warn(`log_central is deprecated. "${e}" is not a whitelisted event.`),Rt.A.call({method:"log_central.log",data:{BATCH:[{channel:e,params:n}]}}),!0):(i(),!0)}}).displayName=`TrackingComponentHOC(${(0,ss.A)(e)})`,t.contextTypes=n,t);return(0,r.Ng)(({user:e})=>({serverTimestamp:e.SERVER_TIMESTAMP,clientTimestampDelta:e.clientTimestampDelta}),null,null,{forwardRef:!0})(a)})(ys));var Es,_s=n("yiM3");class fs extends i.Component{render(){return i.createElement(i.Fragment,null,Es||(Es=i.createElement(xt,null)),i.createElement(Jn.z,{ms:"8",spacing:"4"},i.createElement(fa.N,{fontWeight:"bold",fontSize:"md",href:(0,k.jd)("/offers"),onClick:this._onTrackingClick.bind(this,"plans-button")},(0,oe.AP)("Offres")),i.createElement(Te.$n,{as:"a",size:"small",id:"topbar-login-button",href:(0,_s.t)({route:"login",comeback:!0}),variant:"outline",onClick:this._onTrackingClick.bind(this,"login-button")},(0,oe.AP)("Connexion")),i.createElement(Te.$n,{as:"a",size:"small",id:"topbar-register-button",href:(0,_s.t)({route:"register",comeback:!0}),onClick:this._onTrackingClick.bind(this,"signup-button")},(0,oe.AP)("Inscription"))))}_onTrackingClick(e){window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"click",eventcategory:"header",eventaction:e})}}const bs=(0,be.y)(fs);var vs,ks=n("ShRA"),Ts=n("NgX8");const Cs=()=>_.A.isAllowed("employee_feature")?i.createElement(Ts.m,{label:"Report a Bug","aria-label":"Report a Bug"},i.createElement(Te.K0,{"aria-label":"Report a bug",variant:"ghost",size:"small",icon:vs||(vs=i.createElement(ks.E,{boxSize:8})),onClick:()=>open("https://deezer.jira.com/servicedesk/customer/portal/7/create/128","_blank"),className:"topbar-action"})):null;var ws,Ss,xs,Is,Ps,Rs,Ls=n("bbm1");const Ns=i.lazy(()=>n.e(3271).then(n.bind(n,"ktXu"))),Os=(0,r.Ng)(({user:e})=>({isUserConnected:(0,S.UJ)(e),user:e}),e=>({updateUser:t=>e((0,D.b6)(t))}))(({isUserConnected:e,user:t,updateUser:n})=>i.createElement("div",{className:"page-topbar",id:"page_topbar"},e?i.createElement(i.Fragment,null,ws||(ws=i.createElement(xt,null)),Ss||(Ss=i.createElement(Cs,null)),i.createElement(Ls.DeeztoolsContext.Consumer,null,e=>e&&e.isAuthorized?i.createElement(Ns,{updateUser:e=>n({...t,...e})}):null),xs||(xs=i.createElement(As,null)),Is||(Is=i.createElement($t,null)),Ps||(Ps=i.createElement(ns,null))):Rs||(Rs=i.createElement(bs,null))));var Ds,Ms;const Us=i.lazy(()=>n.e(5745).then(n.bind(n,"Fs/P"))),zs=i.lazy(()=>n.e(7696).then(n.bind(n,"o5uA"))),Fs=()=>(0,r.d4)(e=>null==e?void 0:e.user.id)>0?Ds||(Ds=i.createElement(zs,null)):Ms||(Ms=i.createElement(Us,null));var Bs=n("y7Wb"),qs=n("HvqQ"),Gs=n("UAd1");let Hs;function Vs(e){document.body.offsetHeight<window.innerHeight?document.body.classList.remove("has-scrollbar-disabled"):(e||(Hs=window.pageYOffset),document.body.classList.toggle("has-scrollbar-disabled",!e),e&&window.scrollTo(0,Hs))}var Ys,Qs=n("yCtO"),Ws=n("hsEi"),Ks=n("W1Rt"),js=n("1lpQ"),$s=n("xvdY"),Xs=n("iuq8"),Js=n("I7+f"),Zs=n("ATrE"),eo=n("a9NY"),to=n("1Uwb"),no=n("lXQd"),ao=n("CxZw"),io=n("o+h5"),ro=n("1Pdy"),so=n("xCFc"),oo=n("pQlO"),lo=n("r4LN");const co=({ariaLabel:e,isDisabled:t=!1,onClick:n})=>i.createElement(Te.K0,{"aria-label":e,icon:Ys||(Ys=i.createElement(Se.w,null)),isDisabled:t,onClick:n,size:"sm",variant:"link"});var uo=n("PJQK"),po=n("STEc");const mo={TITLE:{SIZE:po.uq.Full},ARTIST:{SIZE:po.uq.PercentXs},DURATION:{SIZE:po.uq.sm},REMOVE:{SIZE:po.uq.sm}};var ho,go,yo=n("tgyz"),Ao=n("SehT");const _o=i.memo(({data:e,index:t,style:n})=>{const a=e.toDisplay[t],{context:r,container:s,isOrderable:o,loadingStatus:l,options:c,shouldExplicitBeHidden:d}=i.useContext(so.Gt),{play:u,playerStatus:p,playQueuelistAtIndex:m,isItemLoadedInPlayer:h,removeTrack:g}=(0,yo.A)({...r,ID:a.item.id},s,l.isFullyFetched,!0),y=a.item.hasExplicitLyrics&&d,A=(e,t)=>{m(e,t)},E=(0,i.useCallback)(t=>{u({notify:!1,playIndex:t,playItems:e.toPlay,playLyrics:!0})},[e.toPlay,u]);return i.createElement(to.A.Row,{style:n,uuid:a.uuid,id:a.item.id,index:t,isActive:h(a.item)&&p.isSameContext,isOrderable:o,isReadable:a.item.right===ao.A.READABLE,isRestrictedByExplicit:y,type:a.item.type,isDraggable:!0},i.createElement(uo.A,{size:mo.TITLE.SIZE},i.createElement(uo.A.Play,{ariaLabel:(0,oe.AP)("generic_action_playsongXbyartistX_web",{sprintf:[a.item.title,(0,no.A)(a,"item.artists[0].name","")]}),hasExplicitCover:a.item.parent.hasExplicitCover,onPlayItems:A,pictureUrl:a.item.cover(io.r4).url}),ho||(ho=i.createElement(uo.A.Download,null)),i.createElement(uo.A.PlayableLabel,{hasExplicitLyrics:a.item.hasExplicitLyrics,label:a.item.title,onPlayItems:A,tooltipText:(0,Ao.Y)(a.item,d)}),i.createElement(to.A.IconGroup,null,i.createElement(uo.A.ShowLyrics,{item:a.item,lyricsId:a.item.lyricsId,onPlayLyrics:E}),go||(go=i.createElement(uo.A.AddToFavorite,null)),i.createElement(uo.A.OpenContextMenu,{item:a.item}))),i.createElement(to.A.CellBody,{size:mo.ARTIST.SIZE},i.createElement(lo.A,{links:a.item.artists.map(e=>({...e,type:Be.Ay.Artist}))})),i.createElement(to.A.CellBody,{size:mo.DURATION.SIZE},i.createElement(oo.A,{duration:a.item.duration})),c.includes(ro.Rj.Remove)&&i.createElement(to.A.CellBody,{size:mo.REMOVE.SIZE},i.createElement(co,{ariaLabel:(0,oe.AP)("Retirer de la file d'attente"),isDisabled:0===t&&1===e.toDisplay.length,onClick:()=>g(t)})))},qt.t7);var fo=n("ftFY"),bo=n("EBWn"),vo=n("ijnh");const ko=({indexToScrollTo:e,height:t=0,items:n,options:a=[],onUpdateTracklistOrder:r,scrollAlignment:s,shouldExplicitBeHidden:o})=>{const l={id:"0",type:vo.k},c={ID:l.id,TYPE:l.type},{manageItems:d,tableItems:u}=(0,fo.A)("0",n,c,{generateId:e=>`${e.id}-${(0,no.A)(e,"legacy.TRACK_NUMBER","")}`}),{playerStatus:p}=(0,yo.A)(c,l,!0,!0),m=(0,bo.A)("0",u,c,r),h=i.useRef(null),g=i.useRef(null),y=(0,so.Ay)({container:l,context:c,hasBackground:!1,options:a,manageItems:d,order:m,playerStatus:p,shouldExplicitBeHidden:o,shouldPlayerNeverBeHid:!0});return(0,i.useEffect)(()=>{var t;h&&(null===(t=h.current)||void 0===t||t.scrollToItem(e,s))},[]),i.createElement(so.ru,{value:y},i.createElement(to.A,{tableRef:g,rowCount:u.toDisplay.length},i.createElement(to.A.Body,null,i.createElement(qt.Y1,{height:t,itemCount:u.toDisplay.length,itemData:u,itemSize:ro.F4.md,ref:h,width:"100%"},_o))))},To={TITLE:{SIZE:po.uq.Full},DURATION:{SIZE:po.uq.sm},REMOVE:{SIZE:po.uq.sm}};var Co;const So=i.memo(({data:e,index:t,style:n})=>{const a=e.toDisplay[t],{context:r,container:s,loadingStatus:o,isOrderable:l,shouldExplicitBeHidden:c}=i.useContext(so.Gt),{playerStatus:d,playQueuelistAtIndex:u,isItemLoadedInPlayer:p,removeTrack:m}=(0,yo.A)({...r,ID:a.item.id},s,o.isFullyFetched,!0),h=a.item.hasExplicitLyrics&&c,g=(e,t)=>{u(e,t)};return i.createElement(to.A.Row,{style:n,uuid:a.uuid,id:a.item.id,index:a.index,isActive:p(a.item)&&d.isSameContext,isOrderable:l,isReadable:a.item.right===ao.A.READABLE,isRestrictedByExplicit:h,type:a.item.type},i.createElement(uo.A,{size:To.TITLE.SIZE},i.createElement(uo.A.Play,{ariaLabel:(0,oe.AP)("generic_action_playsongXbyartistX_web",{sprintf:[a.item.title,a.item.parent.name]}),hasExplicitCover:a.item.parent.hasExplicitCover,onPlayItems:g,pictureUrl:a.item.cover(io.r8).url}),Co||(Co=i.createElement(uo.A.Download,null)),i.createElement(uo.A.PlayableLabel,{description:a.item.description,hasExplicitLyrics:a.item.hasExplicitLyrics,label:a.item.title,onPlayItems:g,tooltipText:(0,Ao.Y)(a.item,c)}),i.createElement(to.A.IconGroup,null,i.createElement(uo.A.OpenContextMenu,{item:a.item}))),i.createElement(to.A.CellBody,{size:To.DURATION.SIZE},i.createElement(oo.A,{duration:a.item.duration})),i.createElement(to.A.CellBody,{size:To.REMOVE.SIZE},i.createElement(co,{ariaLabel:(0,oe.AP)("Retirer de la file d'attente"),isDisabled:0===t&&1===e.toDisplay.length,onClick:()=>m(t)})))},qt.t7),xo=({height:e=0,indexToScrollTo:t,items:n,options:a=[],onUpdateTracklistOrder:r,scrollAlignment:s,shouldExplicitBeHidden:o})=>{const l={id:"0",type:vo.k},c={ID:l.id,TYPE:l.type},{manageItems:d,tableItems:u}=(0,fo.A)("0",n,c),{playerStatus:p}=(0,yo.A)(c,l,!0,!0),m=ro.F4.lg,h=(0,bo.A)("0",u,c,r),g=i.useRef(null),y=i.useRef(null),A=(0,so.Ay)({container:l,context:c,hasBackground:!1,options:a,manageItems:d,order:h,playerStatus:p,rowHeight:m,shouldExplicitBeHidden:o,shouldPlayerNeverBeHid:!0});return(0,i.useEffect)(()=>{var e;g&&(null===(e=g.current)||void 0===e||e.scrollToItem(t,s))},[]),i.createElement(so.ru,{value:A},i.createElement(to.A,{tableRef:y,rowCount:u.toDisplay.length},i.createElement(to.A.Body,null,i.createElement(qt.Y1,{height:e,itemCount:u.toDisplay.length,itemData:u,itemSize:m,ref:g,width:"100%"},So))))},Io=({indexToScrollTo:e,items:t,itemsType:n,options:a=[],onUpdateTracklistOrder:r,scrollAlignment:s="end",shouldExplicitBeHidden:o})=>{const{height:l}=(0,eo.A)(),c=(l||0)-216;return n===Be.Ay.Episode?i.createElement(xo,{height:c,indexToScrollTo:e,items:t,options:a,onUpdateTracklistOrder:r,scrollAlignment:s,shouldExplicitBeHidden:o}):i.createElement(ko,{indexToScrollTo:e,height:c,items:t,options:a,onUpdateTracklistOrder:r,scrollAlignment:s,shouldExplicitBeHidden:o})};var Po=n("sAMA");class Ro extends i.Component{constructor(e){super(e),this._updateTracklistOrder=this._updateTracklistOrder.bind(this),this._getNbTracksToDisplay=this._getNbTracksToDisplay.bind(this),this.state={nbDisplayTracks:1e4}}render(){const{index:e,isRadio:t,maxPlayedIndex:n,shouldExplicitBeHidden:a,uiType:r}=this.props,s=[ro.Rj.Reorder];return t||s.push(ro.Rj.Remove),i.createElement("div",{className:"queuelist-tracklist-inner"},i.createElement(Io,{indexToScrollTo:t?n+1:e,items:this._getListToRender(),itemsType:r===Be.Ay.Podcast||r===Be.Ay.Show?Be.Ay.Episode:Be.Ay.Song,onUpdateTracklistOrder:this._updateTracklistOrder,options:s,ref:this._tracklistRef,shouldExplicitBeHidden:a,scrollAlignment:t?"end":"start"}))}_getNbTracksToDisplay(){const{isRadio:e,maxPlayedIndex:t}=this.props,{nbDisplayTracks:n}=this.state;return e?t+1:n}_getListToRender(){const{list:e}=this.props;return e.slice(0,this._getNbTracksToDisplay())}_updateTracklistOrder(e){const{list:t}=this.props;if(!e||!e.order||!Array.isArray(e.order))return;const n=t.slice(this._getNbTracksToDisplay()-1,t.length-1);$e.Ay.orderTracks([...e.order,...n])}}const Lo={dispatchHidePopper:$.Lm},No=(0,r.Ng)(e=>({userID:e.user.id,shouldExplicitBeHidden:(0,S.Uw)(e.user)===Po.g,list:e.player.music.list,index:e.player.music.index,maxPlayedIndex:e.player.music.maxPlayedIndex,isRadio:e.player.config.isRadio,playerUI:(0,Zs.Cu)(e),uiType:(0,Zs.ip)(e)}),Lo)(Ro);class Oo extends i.Component{constructor(e){super(e),this._onUpNextToggle=this._onUpNextToggle.bind(this)}shouldComponentUpdate(e){return this.props.isUpnext!==e.isUpnext||this.props.hasUpNext!==e.hasUpNext}render(){const{isAuth:e,isUpnext:t,playerUI:n,hasUpNext:a}=this.props;return e&&(n.upnext||t)?i.createElement("div",{className:"queuelist-upnext-heading"},i.createElement("span",{className:"queuelist-title"},(0,oe.AP)("Recommandations automatiques")),i.createElement(pn.d,{isChecked:a,onChange:this._onUpNextToggle,ms:2,"data-testid":"automatic_reco_switch_"+(a?"on":"off")})):null}_onUpNextToggle(e){const t=e.currentTarget.checked;this.props.updateSettings({global:{has_up_next:t}})}}const Do=(0,r.Ng)(e=>({isAuth:e.user.isAuth,hasUpNext:e.user.hasUpNext,isUpnext:e.player.config.isUpnext,playerUI:(0,Zs.Cu)(e)}),{updateSettings:D.Xx})(Oo);var Mo=n("CRp+"),Uo=n("zgkh");const zo=({children:e,onClick:t})=>i.createElement(Ne.s,{alignItems:"center",onClick:t,borderRadius:"s",color:"text.neutral.secondary.default",fontSize:"body.m",height:"40px",lineHeight:"40px",paddingX:"spacing.m",width:"100%",transition:"background-color 0.15s, color 0.15s",_hover:{backgroundColor:"background.neutral.tertiary.hovered",color:"text.neutral.primary.default",cursor:"pointer"}},e),Fo=({children:e})=>i.createElement(Ke.E,{noOfLines:1,display:"flex",flex:1},e);var Bo=n("UDcE"),qo=n("DcKU");const Go=({children:e})=>i.createElement(de.a,{as:"span",marginEnd:"spacing.s"},e);var Ho,Vo;const Yo=({onClick:e,tuner:t})=>{const n=(0,i.useCallback)(()=>{const n="default"!==t?"default":"discovery",a=$e.Ay.getContext(),i=_r.default.get("log_contexts")[a.TYPE]===Be.Ay.Flow;$e.Ay.play({type:i?je.Kk.USER:je.Kk.MULTI_FLOW,id:a.ID,radio:!0,tuner:n,context:a}),null==e||e()},[e,t]),a={default:{icon:Ho||(Ho=i.createElement(Bo.A,{size:"medium"})),text:(0,oe.AP)("flowsettings_text_iwantmorediscoveries_web")},discovery:{icon:Vo||(Vo=i.createElement(qo.M,{size:"medium"})),text:(0,oe.AP)("flowsettings_text_iwantmorefavorites_web")}},r=e=>(0,no.A)(a,`[${t}].[${e}]`);return i.createElement(zo,{onClick:n},i.createElement(Go,null,r("icon")),i.createElement(Fo,null,r("text")))};var Qo,Wo=n("WN1e");const Ko=({onClick:e})=>{const[t]=(0,r.d4)(e=>[(0,S.F6)(e.user)]),n=$e.Ay.getContext(),a=(0,i.useCallback)(()=>{$e.Ay.play({type:je.Kk.USER,id:t,radio:!0,context:n}),e&&e()},[e,t,n]);return i.createElement(zo,{onClick:a},Qo||(Qo=i.createElement(Go,null,i.createElement(Wo.R,{size:"medium"}))),i.createElement(Fo,null,(0,oe.AP)("flowsettings_action_changestyle_web")))};var jo,$o,Xo=n("SF1U"),Jo=n("elFM"),Zo=n("olBe"),el=n("LAh4");const tl=({context:e,id:t,onClick:n})=>{const{isBannedFromRecommendation:a,toggleDislike:r}=(0,Zo.A)(t,e),s=(0,el.A)(),o=(0,i.useCallback)(()=>{r(),s({source_trigger:"player",ban:!a}),null==n||n()},[n,r,s,a]),l=a?jo||(jo=i.createElement(Xo.e,null)):$o||($o=i.createElement(Jo.z,null)),c=a?(0,oe.AP)("banartist_action_allowinmyrecommendations_web"):(0,oe.AP)("bantrack_action_dontrecommendthistrack_web");return i.createElement(zo,{onClick:o},i.createElement(Go,null,l),i.createElement(Fo,null,c))};var nl,al,il=n("03m0"),rl=n("BCMr");const sl=({onClick:e})=>{const{isBannedFromRecommendation:t,toggleDislike:n}=(0,rl.A)(),a=(0,el.A)(),r=(0,i.useCallback)(()=>{n(),a({source_trigger:"player",ban:!t}),null==e||e()},[e,n,a,t]),s=t?nl||(nl=i.createElement(il.x,null)):al||(al=i.createElement(Wa.G,null)),o=t?(0,oe.AP)("banartist_action_allowinmyrecommendations_web"):(0,oe.AP)("banartist_action_dontrecommendthisartist_web");return i.createElement(zo,{onClick:r},i.createElement(Go,null,s),i.createElement(Fo,null,o))};var ol,ll;const cl={[Ue.B1A.DEFAULT]:"default",[Ue.B1A.DISCOVERY]:"discovery"},dl=({artistId:e,context:t,onClose:n,trackId:a})=>{var s;const o=(0,r.d4)(({user:e})=>(0,S.H3)(e)),l=(0,r.wA)(),{data:c}=(0,Ue.UJq)({skip:Boolean(o)});(0,i.useEffect)(()=>{var e;if(!o&&null!=c&&null!==(e=c.me)&&void 0!==e&&null!==(e=e.flowTuner)&&void 0!==e&&e.discoveryTuner){const e=cl[c.me.flowTuner.discoveryTuner];l((0,D.mZ)("tuner",e))}},[null==c||null===(s=c.me)||void 0===s||null===(s=s.flowTuner)||void 0===s?void 0:s.discoveryTuner,l,o]);const d=_r.default.get("log_contexts")[t.TYPE]===Be.Ay.Flow,u=_r.default.get("log_contexts")[t.TYPE]===Be.Ay.MultiFlow,p=d||u,m=o&&p;return i.createElement(i.Fragment,null,i.createElement(Uo.D,null,i.createElement(Ke.E,{fontSize:"body.m"},p?(0,oe.AP)("flowsettings_title_notsatisfiedwithyourflow_web"):(0,oe.AP)("banfeatures_title_nothappywithyourmix_web"))),i.createElement(bn.T,{spacing:"spacing.s",marginTop:"spacing.s"},m&&i.createElement(Yo,{tuner:o,onClick:n}),d&&i.createElement(Ko,{onClick:n}),i.createElement(rt.OJ,{key:a,value:{item:Be.Ay.Track,itemId:a,legacyContext:t}},i.createElement(tl,{context:t,id:a,onClick:n})),"0"!==e&&i.createElement(rt.OJ,{key:e,value:{item:Be.Ay.Artist,itemId:e,legacyContext:t}},i.createElement(sl,{onClick:n})),!d&&i.createElement(ln.A,null,i.createElement(Ze.A,{to:"/channels/mixes",width:"100%"},i.createElement(zo,{onClick:n},i.createElement(Fo,null,(0,oe.AP)("banfeatures_title_changemood_web")),ol||(ol=i.createElement(cn.A,null))))),i.createElement(ln.A,null,i.createElement(Ze.A,{to:"/exclusions",width:"100%"},i.createElement(zo,{onClick:n},i.createElement(Fo,null,(0,oe.AP)("banfeatures_action_managemyexclusions_web")),ll||(ll=i.createElement(cn.A,null)))))))};var ul,pl;const ml=({artistId:e,trackId:t,placement:n="top"})=>{const[a,r]=(0,i.useState)(!1),s=()=>r(!1),{context:o,isRadio:l,playerUI:c}=(0,Pe.G)(e=>({context:e.player.music.context,isRadio:e.player.config.isRadio,playerUI:(0,Zs.Cu)(e)}));if(!c.userFeedback||!o.TYPE||!l&&_r.default.get("log_contexts")[o.TYPE]!==Be.Ay.Smarttracklist)return null;const d=_r.default.get("log_contexts")[o.TYPE]===Be.Ay.Flow||_r.default.get("log_contexts")[o.TYPE]===Be.Ay.MultiFlow?(0,oe.AP)("flowsettings_title_notsatisfiedwithyourflow_web"):(0,oe.AP)("banfeatures_title_nothappywithyourmix_web"),u={artistId:e,context:o,trackId:t,onClose:s};return i.createElement(Ba.A,{isLazy:!0,isOpen:a,onOpen:()=>r(!0),onClose:s,placement:n},i.createElement(qa.W,null,i.createElement(de.a,null,i.createElement(Ts.m,{isDisabled:a,label:d},i.createElement(Te.K0,{"data-testid":"angry_face_button",variant:"ghost",isActive:a,_active:{color:"icon.accent.primary.default",bg:"transparent"},"aria-label":d,size:"small",icon:ul||(ul=i.createElement(Mo.h,null))})))),i.createElement(Ga.h,{maxWidth:"400px",width:"auto"},pl||(pl=i.createElement(Ha.R,null)),i.createElement(i.Suspense,{fallback:null},i.createElement(Va.e,{p:"spacing.m"},i.createElement(dl,u)))))};var hl=n("Vsul"),gl=n("CyAC"),yl=n("VwKc"),Al=n("Vzbh");const El=({playerUI:{title:e},track:t})=>e&&e.url&&e.id&&Number(t[e.id])&&t.RIGHTS&&Object.entries(t.RIGHTS).length>0?e.url+t[e.id]:null,_l=({playerUI:{subTitle:e}},{ART_ID:t=0})=>e&&e.url&&Number(t)?e.url+t:null;var fl,bl,vl,kl,Tl,Cl,wl,Sl,xl,Il=n("Qmjy");class Pl extends i.Component{constructor(e){super(e),this._onPlayerClose=this._onPlayerClose.bind(this),this._onLyricsClick=this._onLyricsClick.bind(this)}render(){return i.createElement("div",{className:"player-wrapper player-queuelist"},this._renderHeader(),this._renderContainer())}_renderHeader(){return i.createElement("div",{className:"player-header"},i.createElement("div",{className:"player-close"},i.createElement(Ts.m,{label:(0,oe.AP)("Fermer"),position:"bottom"},i.createElement("button",{className:"svg-icon-group-btn",type:"button",onClick:this._onPlayerClose,"aria-label":(0,oe.AP)("generic_action_closepanel_web")},fl||(fl=i.createElement(Qs.e,null))))))}_renderContainer(){return i.createElement("div",{className:"player-container"},this._renderCover(),this._renderContent())}_renderCover(){return i.createElement("div",{className:"queuelist-cover"},this._renderCoverPicture(),this._renderCoverActions(),this._renderCoverTitle(),this._renderCoverSubTitle(),this._renderLabel())}_renderCoverPicture(){const{cover:e,isExplicitCover:t,trackTitle:n}=this.props;return i.createElement(de.a,{position:"relative",width:"100%"},i.createElement(Xe.A,{src:e,alt:n,isExplicitCover:t}),this._renderCoverExplicit(),this._renderCoverSticker())}_renderLabel(){const{isFlow:e,isUpnext:t,playerUI:n,uiType:a}=this.props;if(!n.label)return null;let r=(0,oe.AP)("MIX");return a===Js.U.AD||a===Js.U.TRITON_AD?r=(0,oe.AP)("PUBLICITÉ"):a===Js.U.LIVESTREAM?r=(0,oe.AP)("EN DIRECT"):t?r=(0,oe.AP)("RECOMMANDÉ"):e&&(r=(0,oe.AP)("FLOW")),i.createElement("span",{className:"queuelist-cover-label"},i.createElement("span",{className:"label"},r))}_renderCoverTitle(){const{trackTitle:e,uiType:t}=this.props;let n=e;if(t===Js.U.AD){const e=window.sasAudioConfig||{},t=e.text,a=decodeURIComponent(e.url),r=e=>{e.preventDefault(),e.stopPropagation(),/^http/.test(a)&&(0,hl.A)(a)};n=i.createElement("a",{className:"queuelist-cover-link",href:a,onClick:r},t)}else null!==El(this.props)&&(n=i.createElement(Ze.A,{className:"queuelist-cover-link",to:El(this.props)},e));return i.createElement("div",{className:"queuelist-cover-title"},this._renderExplicit(),n)}_renderCoverSubTitle(){const{trackArtists:e,uiType:t}=this.props;return t===Js.U.AD?null:i.createElement("div",{className:"queuelist-cover-subtitle"},e.map((e,t)=>[t>0?", ":"",null===_l(this.props,e)?e.ART_NAME:i.createElement(Ze.A,{className:"queuelist-cover-link",key:e.ART_ID,to:_l(this.props,e)},e.ART_NAME)]))}_renderExplicit(){return this.props.isExplicit?bl||(bl=i.createElement(js.A,{size:"small",me:"spacing.s"})):null}_renderCoverExplicit(){const{shouldHideCoverForUser:e}=this.props;return e?null:this.props.isExplicit?vl||(vl=i.createElement("div",{className:"explicit-container"},i.createElement(js.A,null))):null}_renderCoverSticker(){const{audioQuality:e}=this.props;let t;switch(e){case Al.en.LOSSLESS:t=(0,oe.AP)("HiFi");break;case Al.en.HIGH:t="HQ";break;default:return null}return i.createElement("span",{className:"queuelist-cover-sticker sticker"},t)}_renderCoverActions(){return i.createElement("div",{className:"queuelist-cover-actions"},i.createElement("ul",{className:"svg-icon-group"},this._renderActionLyrics(),i.createElement("li",{className:"svg-icon-group-item"},this._renderActionContextMenu("addToPlaylist")),i.createElement("li",{className:"svg-icon-group-item"},this._renderActionLike()),this._renderActionUserFeedback(),i.createElement("li",{className:"svg-icon-group-item"},this._renderActionContextMenu())))}_renderActionLyrics(){const{playerUI:e,isOnline:t}=this.props;if(!e.lyrics||!this.props.hasLyrics||!t)return null;const n=(0,oe.AP)("Afficher les paroles");return i.createElement("li",{className:"svg-icon-group-item"},i.createElement(Ts.m,{label:n},i.createElement("button",{className:"svg-icon-group-btn",type:"button",onClick:this._onLyricsClick,"aria-label":n},kl||(kl=i.createElement(Ws.c,null)))))}_renderActionLike(){const{playerUI:e,id:t,track:n}=this.props;if(!e.like)return null;const a=String(n.SNG_ID_ORIGIN||t);return i.createElement($s.A,{className:"svg-icon-group-btn",type:"song",context:{ID:a,TYPE:"player",CONTEXT_ID:n.SPONSORED?"sponsored=true":void 0},tooltip:!0,id:a})}_renderActionContextMenu(e){const{track:t,index:n,id:a,context:r,playerUI:s,userId:o}=this.props;if(!s.contextMenu)return null;const l="addToPlaylist"===e,c={anchor:i.createElement("button",{className:"svg-icon-group-btn",type:"button"},l?Tl||(Tl=i.createElement(_i.c,null)):Cl||(Cl=i.createElement(Ka.j,null))),context:{ID:o,TYPE:"queuelist"},data:{INDEX:n,SONG:t,PLAYLIST_ID:r.ID},forceShowPlaylists:l,id:a,placement:"right"};return i.createElement(Xs.A,c)}_renderActionUserFeedback(){const{id:e,track:t,trackArtists:n}=this.props,r={artistId:n.length>0?n[0].ART_ID:"0",trackId:String(t.SNG_ID_ORIGIN||e)};return i.createElement(ml,(0,a.A)({placement:"right"},r))}_renderContent(){return i.createElement("div",{className:"queuelist-content"},i.createElement("div",{className:"queuelist-header"},i.createElement("div",{className:"queuelist-heading"},this._renderTitle(),this._renderSubTitle()),wl||(wl=i.createElement(Do,null)),this._renderSaveAsPlaylist()),Sl||(Sl=i.createElement(No,null)))}_renderTitle(){const{isRadio:e,isFlow:t,isUpnext:n}=this.props;let a=(0,oe.AP)("File d'attente");return e&&!n&&(a=t?(0,oe.AP)("Derniers titres écoutés sur Flow"):(0,oe.AP)("Derniers titres écoutés dans le mix")),i.createElement("span",{className:"queuelist-title"},a)}_renderSubTitle(){const{list:e,isRadio:t,tracklistDuration:n}=this.props;if(t)return null;const a=(0,oe.WI)("%s titre","%s titres",{sprintf:[(0,dt.A)(e.length)],count:e.length});return i.createElement("span",{className:"queuelist-subtitle"}," ","· ",a," · ",(0,Il.A)(n))}_renderSaveAsPlaylist(){const{saveAsPlaylist:e}=this.props.playerUI,{list:t,userId:n}=this.props;if(!e)return null;const a=this._getTrack(),r=1===a.length?{SONG:t[0]}:{},s={anchor:i.createElement(Te.K0,{"aria-label":(0,oe.AP)("Ajouter à une playlist"),size:"sm",icon:xl||(xl=i.createElement(Ks.G,null))}),context:{ID:n,TYPE:"queuelist"},data:r,forceShowPlaylists:!0,id:a};return i.createElement(Xs.A,s)}_onPlayerClose(){this.props.setPlayerFull(!1)}_onLyricsClick(){this.props.playerLyrics?this.props.setPlayerFull(!1):this.props.setPlayerLyrics(!0),$e.Ay.isPaused()||$e.Ay.isPlaying()||$e.Ay.control.play()}_getTrack(){const{isUpnext:e,isRadio:t,list:n,maxPlayedIndex:a}=this.props;let i=n;return(t||e)&&(i=i.slice(0,a+1)),[...new Set(i.map(e=>e.SNG_ID||e.UPLOAD_ID))]}}const Rl=(0,r.Ng)(e=>({id:e.player.music.id,track:e.player.music.track,list:e.player.music.list,index:e.player.music.index,context:e.player.music.context,isExplicit:e.player.music.isExplicit,isExplicitCover:(0,gl.cV)(e.player.music.track),maxPlayedIndex:e.player.music.maxPlayedIndex,tracklistDuration:e.player.music.tracklistDuration,trackTitle:e.player.music.trackTitle,trackArtists:e.player.music.trackArtists,shouldHideCoverForUser:(0,gl.vp)(e.user,e.player.music.track),cover:e.player.music.cover,isRadio:e.player.config.isRadio,isFlow:e.player.config.isFlow,isUpnext:e.player.config.isUpnext,playerLyrics:e.player.config.playerLyrics,userId:e.user.id,isOnline:e.app.online,hasLyrics:(0,yl.jk)(e),playerUI:(0,Zs.Cu)(e),uiType:(0,Zs.ip)(e),audioQuality:(0,yl.iQ)(e)}),{setPlayerFull:Gs.no,setPlayerLyrics:Gs.IG})(Pl),Ll=({player:e})=>({backgroundColor:e.ui.backgroundColor,isLightMode:e.ui.isLightMode}),Nl=e=>{const t=(0,r.d4)(e=>(0,S.mS)(e.user)),n=(0,r.d4)(e=>(0,S.gE)(e.user));return(0,i.useCallback)(a=>{const i="lyrics";(0,os.isLogCentralWhitelisted)(i)||b.A.warn(`log_central is deprecated. "${i}" is not a whitelisted event.`);const r={...a,sng:e,container:"panel",ts:(0,S.mI)({SERVER_TIMESTAMP:t,clientTimestampDelta:n})};return Rt.A.call({method:"log_central.log",data:{BATCH:[{channel:i,params:r}]}}),!0},[n,t,e])};let Ol=function(e){return e.SYNCHRO="synchro",e.FULL_TEXT="full_text",e}({}),Dl=function(e){return e.PANEL="panel",e.PAGE_TRACK="page_track",e}({}),Ml=function(e){return e.DISPLAY="display",e.DISPLAY_NEXT="display_next",e.CLICK_TRANSLATE="click_translate",e.CLICK_UNTRANSLATE="click_untranslate",e.CLICK_SHARE="click_share",e.CLICK_CLOSE="click_close",e.CLICK_REPORT_PROBLEM="click_report_problem",e.CLICK_CONFIRM_PROBLEM="click_confirm_problem",e}({}),Ul=function(e){return e.PROBLEM_SYNCHRONIZATION="problem_synchronization",e.PROBLEM_MATCHING="problem_matching",e.PROBLEM_LANGUAGE="problem_language",e.PROBLEM_TYPO="problem_typo",e.PROBLEM_TRANSLATION="problem_translation",e}({}),zl=function(e){return e.NO_LYRICS="no_lyrics",e.ERROR="error",e}({});const Fl={trackId:"",lyricsWordByWord:[],lyricsLineByLine:[],lyricsUnsynchronized:[],lyricsTranslated:[],backgroundColor:"background.neutral.primary.default",isLightMode:!0,isLoading:!1,hasError:!1,hasLyrics:!1,hasSync:!1,hasTranslation:!1,timeToFirstLyric:0,licence:"",copyright:"",writers:"",showTranslation:!1,toggleTranslation:()=>{},showLyricsInHeader:!1,setShowLyricsInHeader:()=>{},currentIndexLine:0,setCurrentIndexLine:()=>{},currentLineRef:i.createRef(),setCurrentLineRef:()=>{},isUserScrolling:!1,setIsUserScrolling:()=>{}},Bl=(0,i.createContext)(Fl),ql=()=>(0,i.useContext)(Bl),Gl=({children:e})=>{const{trackId:t,backgroundColor:n,isLightMode:a}=(0,Pe.G)(e=>({...Ll(e),trackId:e.player.music.id})),[r,s]=(0,i.useReducer)((e,t)=>{switch(t.type){case"SET_IS_USER_SCROLLING":return{...e,isUserScrolling:t.payload};case"SET_SHOW_LYRICS_IN_HEADER":return{...e,showLyricsInHeader:t.payload};case"SET_CURRENT_INDEX_LINE":return{...e,currentIndexLine:t.payload};case"SET_CURRENT_LINE_REF":return{...e,currentLineRef:t.payload};default:return e}},{isUserScrolling:!1,showLyricsInHeader:!1,currentIndexLine:0,currentLineRef:i.createRef()}),o=e=>{s({type:"SET_IS_USER_SCROLLING",payload:e})},l=e=>{s({type:"SET_SHOW_LYRICS_IN_HEADER",payload:e})},c=e=>{s({type:"SET_CURRENT_INDEX_LINE",payload:e})},d=e=>{s({type:"SET_CURRENT_LINE_REF",payload:e})},[u,p]=(0,i.useState)(Fl.showTranslation),m=()=>{p(!u)},h=(0,i.useRef)(!0),g=Nl(t),{loading:y,data:A,error:E}=(0,Ue.Ypw)({variables:{trackId:t},onCompleted:e=>{var t,n;g(e?{action:{type:h.current?Ml.DISPLAY:Ml.DISPLAY_NEXT},type:null!==(t=e.track)&&void 0!==t&&null!==(t=t.lyrics)&&void 0!==t&&t.synchronizedLines||null!==(n=e.track)&&void 0!==n&&null!==(n=n.lyrics)&&void 0!==n&&n.synchronizedWordByWordLines?Ol.SYNCHRO:Ol.FULL_TEXT}:{action:{type:h.current?Ml.DISPLAY:Ml.DISPLAY_NEXT,context:zl.NO_LYRICS}}),h.current=!1},onError:()=>{g({action:{type:h.current?Ml.DISPLAY:Ml.DISPLAY_NEXT,context:zl.ERROR}}),h.current=!1}}),_=(0,i.useMemo)(()=>{var e,i,s,p,h,g,_,f,b;const v=(null==A||null===(e=A.track)||void 0===e||null===(e=e.lyrics)||void 0===e?void 0:e.synchronizedWordByWordLines)||void 0,k=(null==A||null===(i=A.track)||void 0===i||null===(i=i.lyrics)||void 0===i?void 0:i.synchronizedLines)||void 0,T=(null==A||null===(s=A.track)||void 0===s||null===(s=s.lyrics)||void 0===s?void 0:s.text.split(/(?:\r?\n)+/))||void 0,C=(null==A||null===(p=A.track)||void 0===p||null===(p=p.lyrics)||void 0===p||null===(p=p.synchronizedLines)||void 0===p?void 0:p.map(e=>e.lineTranslated))||void 0;return{...r,trackId:t,lyricsWordByWord:v,lyricsLineByLine:k,lyricsUnsynchronized:T,lyricsTranslated:C,backgroundColor:n,isLightMode:a,isLoading:y,hasError:!!E,timeToFirstLyric:null!==(h=null==A||null===(g=A.track)||void 0===g||null===(g=g.lyrics)||void 0===g||null===(g=g.synchronizedLines)||void 0===g?void 0:g[0].milliseconds)&&void 0!==h?h:0,licence:(null==A||null===(_=A.track)||void 0===_||null===(_=_.lyrics)||void 0===_?void 0:_.licence)||"",copyright:(null==A||null===(f=A.track)||void 0===f||null===(f=f.lyrics)||void 0===f?void 0:f.copyright)||"",writers:(null==A||null===(b=A.track)||void 0===b||null===(b=b.lyrics)||void 0===b?void 0:b.writers)||"",hasLyrics:!!k||!!v||!!T,hasSync:!!k||!!v,hasTranslation:!(null==C||!C.filter(e=>!!e).length),showTranslation:u,toggleTranslation:m,setIsUserScrolling:o,setShowLyricsInHeader:l,setCurrentIndexLine:c,setCurrentLineRef:d}},[t,n,a,A,y,u,r]);return i.createElement(Bl.Provider,{value:_},e)};var Hl=n("9yOc");const Vl_Header=({children:e,...t})=>i.createElement(de.a,(0,a.A)({gridArea:"header",paddingTop:"spacing.2xl",px:"spacing.2xl",width:"100%",zIndex:2,sx:{"-webkit-app-region":Hl.A.is("windows")?"no-drag":"drag"}},t),e),Vl_Body=({children:e,...t})=>i.createElement(de.a,(0,a.A)({gridArea:"body",overflow:"auto",p:{base:"spacing.l",sm:"spacing.2xl"}},t),e),Vl_Main=({children:e,...t})=>i.createElement(de.a,(0,a.A)({display:"grid",height:"100vh",gridTemplateColumns:"1fr",gridTemplateRows:"auto 1fr auto",gridTemplateAreas:"'header' 'body' 'footer'",position:"relative",overflow:"hidden"},t),e);var Yl=n("SLMx");const Ql=new class{constructor(e){this._logCenter=void 0,this._logCenter=e}logReportClick(e,t,n){this.log({trackId:e,isSynchro:t,container:Dl.PANEL,action:{type:Ml.CLICK_REPORT_PROBLEM},country:n})}logProblem(e,t,n,a){this.log({trackId:e,isSynchro:t,container:Dl.PANEL,action:{type:Ml.CLICK_CONFIRM_PROBLEM,context:n},country:a})}log({trackId:e,isSynchro:t,container:n,action:a,country:i}){this._logCenter.log((0,P.L)("lyrics.lyrics_action","1.0.0",{sng:Number(e),lyrics_type:t?Ol.SYNCHRO:Ol.FULL_TEXT,container:n,action:a,client_ip:Yl.A.get(),country:i}))}}(I.A);var Wl,Kl,jl=n("VF6J"),$l=n("nHPd"),Xl=n("eOc8"),Jl=n("5u5g");const Zl=()=>{const{isOpen:e,onOpen:t,onClose:n}=(0,jl.j)(),[a,r]=(0,i.useState)(),{country:s,trackId:o,isAppInDarkMode:l}=(0,Pe.G)(e=>({country:e.user.COUNTRY,trackId:e.player.music.id,isAppInDarkMode:(0,S.NF)(e.user)})),{hasSync:c,hasTranslation:d}=ql(),u=(0,i.useMemo)(()=>[c&&{value:Ul.PROBLEM_SYNCHRONIZATION,label:(0,oe.AP)("lyricstranslation_text_errorinlyricssyncronization_web")},{value:Ul.PROBLEM_TYPO,label:(0,oe.AP)("lyricstranslation_text_typoinlyrics_web")},{value:Ul.PROBLEM_MATCHING,label:(0,oe.AP)("lyricstranslation_text_lyricsdonotmatchtrack_web")},{value:Ul.PROBLEM_LANGUAGE,label:(0,oe.AP)("lyricstranslation_text_languageisincorrect_web")},d&&{value:Ul.PROBLEM_TRANSLATION,label:(0,oe.AP)("lyricstranslation_text_translationisincorrect_web")}].filter(Boolean),[c,d]),p=(0,i.useCallback)(({children:e})=>l?i.createElement(ca.QQ,null,e):i.createElement(ca.K2,null,e),[l]);return i.createElement(i.Fragment,null,i.createElement(Te.K0,{onClick:()=>{Ql.logReportClick(o,c,s),t()},"aria-label":(0,oe.AP)("lyricstranslation_title_reportaproblem_web"),icon:Wl||(Wl=i.createElement(Jl.Z,null)),variant:"ghost",sx:{"-webkit-app-region":"no-drag"}}),i.createElement(p,null,i.createElement(G.aF,{isOpen:e,onClose:n,isCentered:!0},Kl||(Kl=i.createElement(H.m,null)),i.createElement(V.$,null,i.createElement($l.r,{textAlign:"center"},(0,oe.AP)("lyricstranslation_title_reportaproblem_web")),i.createElement(Y.c,null,i.createElement(ta.z,{onChange:e=>{r(e)},value:a},i.createElement(Xl.B,{direction:"column",spacing:4,textAlign:"left"},u.map(({value:e,label:t})=>i.createElement(aa.s,{key:e,value:e,spacing:{base:6,sm:8,md:4}},t))))),i.createElement(G.jl,null,i.createElement(Te.$n,{variant:"outline",onClick:n},(0,oe.AP)("generic_action_cancel_web")),i.createElement(Te.$n,{onClick:()=>{a&&(Ql.logProblem(o,c,a,s),r(void 0),n())},disabled:!a},(0,oe.AP)("Valider")))))))};var ec,tc;const nc=()=>{const{trackId:e,hasError:t,hasLyrics:n,hasSync:a,lyricsLineByLine:s,lyricsWordByWord:o,showLyricsInHeader:l,currentIndexLine:c,currentLineRef:d}=ql(),{playerQueuelist:u,playerType:p}=(0,Pe.G)(e=>({playerQueuelist:e.player.config.playerQueuelist,playerType:e.player.config.playerType})),m=(0,r.wA)(),h=Nl(e),g=()=>{m(u?(0,Gs.IG)(!1):(0,Gs.no)(!1)),h(!n||t?{action:{type:Ml.CLICK_CLOSE,context:n?zl.ERROR:zl.NO_LYRICS}}:{action:{type:Ml.CLICK_CLOSE},type:a?Ol.SYNCHRO:Ol.FULL_TEXT})};return(0,i.useEffect)(()=>{p===je.Cc.ADS&&g()},[p]),i.createElement(Ne.s,{alignItems:"center",height:"100%",justifyContent:"space-between",py:"spacing.xs"},i.createElement(Te.K0,{onClick:g,"aria-label":(0,oe.AP)("generic_action_closepanel_web"),icon:ec||(ec=i.createElement(Se.w,null)),variant:"ghost",sx:{"-webkit-app-region":"no-drag"}}),i.createElement(Ne.s,{alignItems:"center",justifyContent:"flex-end",flex:{base:1,md:.6},gap:"spacing.m"},l&&i.createElement(de.a,{borderRadius:"lg",bg:"rgba(255, 255, 255, 0.2)",transition:"background-color 0.15s",padding:"spacing.s",cursor:"pointer",_hover:{backgroundColor:"rgba(255, 255, 255, 0.4)"},onClick:()=>{var e;null===(e=d.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"center"})},w:"100%",sx:{"-webkit-app-region":"no-drag"}},i.createElement(Ke.E,{textAlign:"center",noOfLines:1,fontWeight:"bold",color:"text.neutral.primary.default"},o?o[c].words.reduce((e,t)=>`${e} ${t.word}`,""):s?s[c].line:void 0)),_.A.isAllowed("lyrics_report_problem")&&n&&(tc||(tc=i.createElement(Zl,null)))))};var ac=n("SsV2"),ic=n("hn+P");const rc={trackId:"",isPlaying:!1,isPaused:!1,timeToFirstLyric:0,position:0,play:()=>{},pause:()=>{},seek:()=>{}},sc=(0,i.createContext)(rc),oc=()=>(0,i.useContext)(sc),lc=({children:e})=>{const[t,n]=(0,i.useState)(0),{trackId:a,isPlaying:r,isPaused:s,trackDuration:o}=(0,Pe.G)(e=>({trackId:e.player.music.id,isPlaying:e.player.control.playing,isPaused:e.player.control.paused,trackDuration:e.player.music.trackDuration})),l={...rc,trackId:a,isPlaying:r,isPaused:s,position:t,play:$e.Ay.control.play,pause:$e.Ay.control.pause,seek:e=>{$e.Ay.control.seek(e/1e3/o)}};return(0,i.useEffect)(()=>{const e=(e,t)=>{n(Math.floor(1e3*t))};return E.A.subscribe(E.A.player.position,e),()=>{E.A.unsubscribe(E.A.player.position,e)}},[]),i.createElement(sc.Provider,{value:l},e)};var cc;const dc=()=>{const{timeToFirstLyric:e}=ql(),{position:t}=oc();return i.createElement(de.a,{height:"100px",width:"100px"},i.createElement(ac.P,{color:"text.neutral.primary.default",max:e,min:0,size:"100%",thickness:"4px",trackColor:"background.accent.onContent.disabled",value:t},cc||(cc=i.createElement(ic.n,{width:"fit-content"},i.createElement(Ws.c,{size:"medium",color:"text.neutral.primary.default"})))))},uc=()=>{const{copyright:e,writers:t,licence:n}=ql();return i.createElement(de.a,{role:"complementary",color:"text.neutral.primary.default",fontSize:"12px",textAlign:"center"},n&&n.length?i.createElement(Ke.E,{variant:"body.xs.default"},i.createElement("span",null,n)):null,i.createElement(Ke.E,{variant:"body.xs.default",itemType:"https://schema.org/Organization",itemProp:"copyrightHolder",itemScope:!0},"© ",i.createElement("span",{itemProp:"legalName"},e)),i.createElement(Ke.E,{itemType:"https://schema.org/Person",itemProp:"lyricist",itemScope:!0},i.createElement("span",{itemProp:"name"},t)))};var pc=n("pkJ8");const mc=[{opacity:0,percentage:0},{opacity:1,percentage:18}],hc=[{opacity:1,percentage:75},{opacity:0,percentage:88}],gc=(0,pc.A)(e=>{const t=e.getClientHeight(),n=e.getScrollHeight(),a=e.getScrollTop(),i=a+t,r=a-20,s=t/5;let o=mc.map(e=>({...e,percentage:0}));r>0&&(o=r<=s?mc.map(e=>({...e,percentage:Math.ceil(r/s*e.percentage)})):mc);let l=hc;return i>n-s&&(l=hc.map(e=>({...e,percentage:Math.round(100-(n-i)/s*(100-e.percentage))}))),[...o,...l]},100),yc=i.forwardRef(({children:e},t)=>{const[n,a]=(0,i.useState)([...mc,...hc]);(0,i.useImperativeHandle)(t,()=>({setMaskGradient:e=>{const t=gc(e);t&&n.some((e,n)=>e.percentage!==t[n].percentage)&&a(t)}}));const r=n.map(e=>`rgb(0 0 0 / ${100*e.opacity}%) ${e.percentage}%`).join(",");return i.createElement(de.a,{height:"100%",width:"100%",sx:{maskImage:`linear-gradient(to bottom, ${r})`,WebkitMaskImage:`linear-gradient(to bottom, ${r})`}},e)});yc.displayName="LyricsMask";const Ac=yc;var Ec,_c;const fc=({children:e})=>{const{hasSync:t,setIsUserScrolling:n,isUserScrolling:a}=ql(),r=(0,i.useRef)(null),s=(0,i.useCallback)(()=>{a||n(!0),r.current&&clearTimeout(r.current),r.current=setTimeout(()=>{n(!1)},5e3)},[a,n,n]);return i.createElement(Ac,null,i.createElement(de.a,{onWheel:t?s:void 0,height:"full",overflowY:"scroll",sx:{"::-webkit-scrollbar":{display:"none"},"-ms-overflow-style":"none","scrollbar-width":"none"}},i.createElement(Ne.s,{flexDirection:"column",alignItems:"center",paddingTop:"size.3xl",paddingBottom:"size.3xl",paddingStart:{base:"size.m",md:"size.2xl"},paddingEnd:{base:"size.m",md:"size.2xl"}},t&&(Ec||(Ec=i.createElement(de.a,{marginTop:"size.m",marginBottom:"size.l",marginX:"auto"},i.createElement(dc,null)))),i.createElement(Ne.s,{flexDirection:"column",alignItems:"center",textAlign:"center",gap:"spacing.3xl",marginBottom:"spacing.3xl"},e),_c||(_c=i.createElement(de.a,{marginTop:"spacing.3xl",marginBottom:"spacing.xl"},i.createElement(uc,null))))))},bc_Wrapper=({isActive:e,children:t})=>i.createElement(de.a,{paddingY:"spacing.s",lineHeight:"48px",role:"group",_hover:{cursor:"pointer",opacity:1},opacity:e?1:.5},t),bc_Default=({children:e})=>i.createElement(Ke.E,{variant:"body.2xl",color:"text.neutral.primary.default",fontSize:"40px"},e),bc_Translated=({isActive:e=!1,children:t})=>i.createElement(Ke.E,{paddingY:"spacing.s",variant:"body.xl.default",color:"text.neutral.primary.default",opacity:e?1:.5,_groupHover:{opacity:1},fontSize:"22px",fontStyle:"italic",fontWeight:400,lineHeight:"40px"},t),vc=()=>{var e,t;const{trackId:n}=(0,Pe.G)(e=>({trackId:e.player.music.id})),{loading:a,data:r}=(0,Ue.kqj)({variables:{trackId:n}});return a?null:i.createElement(de.a,{width:"28vw",minWidth:"300px",sx:{"@media screen and (min-aspect-ratio: 5/3)":{width:"46.7vh"}}},i.createElement(Xe.A,{src:(null==r||null===(e=r.track)||void 0===e||null===(e=e.album)||void 0===e||null===(e=e.cover)||void 0===e?void 0:e.large[0])||"",isExplicitCover:null==r||null===(t=r.track)||void 0===t||null===(t=t.album)||void 0===t||null===(t=t.cover)||void 0===t?void 0:t.explicitStatus,borderRadius:"l",border:"none",style:{boxShadow:"0px 30px 80px 0px rgba(0 0 0 / 40%)"}}))},kc=({line:e,lineTranslated:t,milliseconds:n,duration:a,index:r})=>{const s=(0,i.useRef)(null),{position:o,seek:l}=oc(),{showTranslation:c,isUserScrolling:d,setShowLyricsInHeader:u,setCurrentIndexLine:p,setCurrentLineRef:m}=ql(),h=null!=n?n:0,g=o>h-200,y=o>h-200&&null!==a&&o<h+a;return(0,i.useEffect)(()=>{const e=s.current;g&&e&&!d&&e.scrollIntoView({behavior:"smooth",block:"center"})},[g,d]),(0,i.useEffect)(()=>{const e=s.current;if(e&&y){const t=new IntersectionObserver(([t])=>{u(!t.isIntersecting),p(r),m({current:e})});return t.observe(e),()=>{e&&t.unobserve(e)}}},[y,u,p]),i.createElement(de.a,{onClick:()=>l(h),ref:s},i.createElement(bc_Wrapper,{isActive:g},i.createElement(bc_Default,null,e),c&&t&&i.createElement(bc_Translated,null,t)))},Tc=({start:e,word:t})=>{const{position:n}=oc(),a=n>e-200;return i.createElement(Ke.E,{as:"span",color:"'text.neutral.primary.default'",opacity:a?1:.5,transition:"color 0.2s ease",_groupHover:{opacity:1}},t," ")},Cc=({start:e,end:t,words:n,index:r})=>{const s=(0,i.useRef)(null),{position:o,seek:l}=oc(),{lyricsTranslated:c,showTranslation:d,setCurrentIndexLine:u,setCurrentLineRef:p,setShowLyricsInHeader:m,isUserScrolling:h}=ql(),g=o>e-200,y=o<t,A=g&&y;return(0,i.useEffect)(()=>{const e=s.current;g&&y&&e&&!h&&e.scrollIntoView({behavior:"smooth",block:"center"})},[g,y,d,h]),(0,i.useEffect)(()=>{const e=s.current;if(e&&A){const t=new IntersectionObserver(([t])=>{m(!t.isIntersecting),u(r),p({current:e})});return t.observe(e),()=>{e&&t.unobserve(e)}}},[A,m]),i.createElement(de.a,{onClick:()=>l(e),ref:s},i.createElement(bc_Wrapper,{isActive:g},i.createElement(bc_Default,null,n.map((e,t)=>i.createElement(Tc,(0,a.A)({key:t},e)))),d&&(null==c?void 0:c[r])&&i.createElement(bc_Translated,null,c[r])))};var wc,Sc;const xc=()=>{const{trackId:e,hasLyrics:t,hasSync:n,hasTranslation:r,lyricsWordByWord:s,lyricsLineByLine:o,lyricsUnsynchronized:l,backgroundColor:c,isLightMode:d,showTranslation:u,toggleTranslation:p}=ql(),m=Nl(e),h=(0,i.useMemo)(()=>{const e=({children:e})=>d?i.createElement(ca.K2,null,e):i.createElement(ca.QQ,null,e);return e.displayName="ColorMode",e},[d]);return i.createElement(h,null,i.createElement(Vl_Main,{height:"full",backgroundColor:c},wc||(wc=i.createElement(Vl_Header,null,i.createElement(nc,null))),i.createElement(Vl_Body,null,i.createElement(Ne.s,{height:"full",flexDirection:"row",alignItems:"center"},i.createElement(Ne.s,{alignItems:"center",justifyContent:"center",flex:t?.4:1,height:"full",display:{base:"none",md:"flex"}},Sc||(Sc=i.createElement(vc,null))),t&&i.createElement(Ne.s,{flex:{base:1,md:.6},height:"full",position:"relative"},i.createElement(lc,null,i.createElement(fc,null,s?s.map((e,t)=>i.createElement(Cc,(0,a.A)({key:t,index:t},e))):o?o.map((e,t)=>i.createElement(kc,(0,a.A)({key:t,index:t},e))):l?i.createElement(i.Fragment,null,i.createElement(Ke.E,{color:"text.neutral.primary.default",variant:"body.xs.default",padding:"18px 0"},(0,oe.AP)("sharelyricserrormessage_text_lyricsnotsyncedwithtrackyet_web")),l.map((e,t)=>i.createElement(bc_Default,{key:t},e))):void 0)),r&&i.createElement(de.a,{position:"absolute",bottom:"spacing.xl",left:0,right:0,textAlign:"center"},i.createElement(Te.$n,{onClick:()=>{m({action:{type:u?Ml.CLICK_UNTRANSLATE:Ml.CLICK_TRANSLATE},type:n?Ol.SYNCHRO:Ol.FULL_TEXT}),p()},"aria-label":u?(0,oe.AP)("lyrics_action_withouttranslation_web"):(0,oe.AP)("lyrics_action_withtranslation_web"),variant:"onContent",borderColor:"transparent",_hover:{borderColor:"transparent"}},u?(0,oe.AP)("lyrics_action_withouttranslation_web"):(0,oe.AP)("lyrics_action_withtranslation_web"))))))))};var Ic;const Pc=()=>Ic||(Ic=i.createElement(Gl,null,i.createElement(xc,null)));var Rc,Lc;class Nc extends i.Component{constructor(e){super(e),this._onClose=this._onClose.bind(this),this._onBackToQueuelist=this._onBackToQueuelist.bind(this),this._onKeyUp=this._onKeyUp.bind(this)}componentDidMount(){window.addEventListener("keyup",this._onKeyUp)}componentDidUpdate(e){this.props.location!==e.location&&this._onClose()}componentWillUnmount(){window.removeEventListener("keyup",this._onKeyUp)}render(){const{playerFull:e,playerQueuelist:t,playerLyrics:n}=this.props;return t||n?i.createElement(ie.N,null,e&&i.createElement(re.P.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{ease:"easeInOut",duration:.4},onAnimationStart:({y:e})=>{"100%"===e&&Vs(!0)},onAnimationComplete:({y:e})=>{0===e?Vs(!1):(this.props.setPlayerQueuelist(!1),this.props.setPlayerLyrics(!1))},className:(0,s.A)("player-lyrics-full",{"player-full":t})},t&&!n&&(Rc||(Rc=i.createElement(Rl,null))),n&&(Lc||(Lc=i.createElement(Pc,null))))):null}_onBackToQueuelist(){this.props.setPlayerLyrics(!1)}_onClose(){this.props.setPlayerFull(!1)}_onKeyUp(e){"Escape"===e.key&&(this.props.playerLyrics&&this.props.playerQueuelist?this.props.setPlayerLyrics(!1):this.props.setPlayerFull(!1))}}const Oc=(0,be.y)((0,r.Ng)(({player:e})=>({playerFull:e.config.playerFull,playerQueuelist:e.config.playerQueuelist,playerLyrics:e.config.playerLyrics}),{setPlayerFull:Gs.no,setPlayerQueuelist:Gs.PV,setPlayerLyrics:Gs.IG})(Nc));var Dc,Mc=n("9MQu"),Uc=n("hL1g");const zc=()=>{const e=(0,r.d4)(e=>e.player.music.trackDuration);return i.createElement(Te.K0,{variant:"ghost","aria-label":(0,oe.AP)("Retour rapide de 30 secondes"),onClick:()=>{const t=($e.Ay.getPosition()-30)/e;$e.Ay.control.seek(t)},icon:Dc||(Dc=i.createElement(Uc.I,null)),size:"small","data-testid":"backward_30"})};var Fc,Bc=n("ckPn");const qc=()=>{const e=(0,r.d4)(e=>e.player.music.trackDuration);return i.createElement(Te.K0,{variant:"ghost","aria-label":(0,oe.AP)("Avance rapide de 30 secondes"),"data-testid":"forward_30",onClick:()=>{const t=($e.Ay.getPosition()+30)/e;t>=1?$e.Ay.control.nextSong():$e.Ay.control.seek(t)},icon:Fc||(Fc=i.createElement(Bc.Y,null)),size:"small"})};var Gc=n("dFIf");const Hc=({trackId:e})=>(0,Pe.G)(Zs.Cu).like?i.createElement("div",{className:"preview-action"},i.createElement("ul",{className:"svg-icon-group"},i.createElement("li",{className:"svg-icon-group-item"},i.createElement($s.A,{className:"svg-icon-group-btn",context:{ID:e,TYPE:"player"},id:e,tooltip:!0,type:Be.Ay.Song})))):null,Vc=e=>e.player.music.mediaType,Yc=({track:e})=>{const t=(0,Pe.G)(Vc);return i.createElement("div",{className:"preview-thumbnail","data-testid":"content_preview_item_cover"},i.createElement(Mt.A,{type:t===je.zu.EPISODE?Be.Ay.Episode:Be.Ay.Album,height:40,width:40,data:e,coverLink:!1}))},Qc=({track:e,trackArtists:t,trackTitle:n})=>{const a=(0,Pe.G)(Zs.Cu),r=El({playerUI:a,track:e});return i.createElement("div",{className:"preview-heading","data-testid":"content_preview_item_title"},i.createElement(et.A,null,r?i.createElement(Ze.A,{className:"preview-link",to:r},n):n," · ",t.map((e,t)=>{const n=_l({playerUI:a},e);return[t>0?", ":"",null===n?e.ART_NAME:i.createElement(Ze.A,{className:"preview-link",key:e.ART_ID,to:n},e.ART_NAME)]})))},Wc=({type:e})=>{const t=(0,Pe.G)(t=>"prev"===e?(e=>e.player.music.trackPrev)(t):(e=>e.player.music.trackNext)(t)),n=(0,Pe.G)(t=>"prev"===e?(0,yl.hN)(t):(0,yl.VX)(t)),a=(0,Pe.G)(t=>"prev"===e?(0,yl.$7)(t):(0,yl.b3)(t)),r=String(t.SNG_ID_ORIGIN||t[$e.Ay.getMediaId(t)]);return i.createElement("div",{className:"player-overlay-preview","data-testid":"content_preview_tooltip"},i.createElement(Yc,{track:t}),i.createElement(Qc,{track:t,trackArtists:n,trackTitle:a}),i.createElement(Hc,{trackId:r}))};var Kc,jc,$c=n("BcXB");const Xc=()=>{const e=(0,r.d4)($c.m5),t=(0,r.d4)($c.kQ),n=(0,r.d4)(e=>(0,Zs.Cu)(e)),a=$e.Ay.getPrevSong()&&!$e.Ay.isRadio()&&t!==je.EV.SINGLE,s=i.createElement(Te.K0,{icon:Kc||(Kc=i.createElement(Gc.U,null)),isDisabled:!e||!n.prev,onClick:()=>{$e.Ay.control.prevSong()},variant:"ghost","aria-label":(0,oe.AP)("Précédent"),size:"small","data-testid":"previous_track_button"});return a?i.createElement("div",null,i.createElement(Ba.A,{openDelay:500,trigger:"hover",isLazy:!0},i.createElement(qa.W,null,s),jc||(jc=i.createElement(Ga.h,{w:"auto"},i.createElement(Ha.R,null),i.createElement(Va.e,{p:0},i.createElement(Wc,{type:"prev"})))))):s};var Jc,Zc,ed,td,nd=n("slbf"),ad=n("1m5e"),id=n("X/L1"),rd=n("U47Q");const sd=({isPaused:e})=>{const{playerUI:t,loading:n,isChromecastCasting:a}=(0,r.d4)(e=>({playerUI:(0,Zs.Cu)(e),loading:e.player.control.loading,isChromecastCasting:e.player.chromecast.casting}));return a&&n?Jc||(Jc=i.createElement(nd.A,{className:"animate-spin",size:"auto"})):e?Zc||(Zc=i.createElement(ad.S,null)):t.stop?ed||(ed=i.createElement(id.w,null)):td||(td=i.createElement(rd.I,null))};var od=n("Vynx"),ld=n("bDF2");const cd=()=>{const{paused:e,playing:t,playerUI:n,loading:a,isConnected:s,canPlay:l,canPause:c}=(0,r.d4)(e=>({paused:e.player.control.paused,playing:e.player.control.playing,loading:e.player.control.loading,playerUI:(0,Zs.Cu)(e),isChromecastCasting:e.player.chromecast.casting,isConnected:(0,S.UJ)(e.user),canPlay:(0,$c.v_)(e),canPause:(0,$c.J2)(e)})),{trackEvent:d}=(0,o.z1)(),u=e&&!t||!e&&!t,p=n.stop?(0,oe.AP)("Stop"):(0,oe.AP)("Pause"),m=u?(0,oe.AP)("Play"):p;return i.createElement(Te.K0,{icon:i.createElement(sd,{isPaused:u}),onClick:()=>{if(u?$e.Ay.control.play():n.pause?$e.Ay.control.pause():$e.Ay.control.stop(),od.A.intent(u?od.A.TIME_TO_PLAY:od.A.TIME_TO_PAUSE),!s&&u){const e=(0,ld.bg)();d({eventaction:`click-play-${e}_${$e.Ay.getMediaType()}`,event:"click",eventcategory:e,eventlabel:"deezer-player"})}},disabled:!c||!l||a,"aria-label":m,size:"small","data-testid":"play_button_"+(u?"play":n.stop?"stop":"pause")})};var dd,ud,pd=n("pj9K");const md=()=>{const e=(0,r.d4)($c.m$),t=(0,r.d4)($c.kQ),n=(0,r.d4)(e=>(0,Zs.Cu)(e)),a=$e.Ay.getNextSong()&&!$e.Ay.isRadio()&&t!==je.EV.SINGLE,s=i.createElement(Te.K0,{icon:dd||(dd=i.createElement(pd.K,null)),isDisabled:!e||!n.next,onClick:()=>{$e.Ay.control.nextSong()},variant:"ghost","aria-label":(0,oe.AP)("Suivant"),size:"small","data-testid":"next_track_button"});return a?i.createElement("div",null,i.createElement(Ba.A,{openDelay:500,trigger:"hover",isLazy:!0},i.createElement(qa.W,null,s),ud||(ud=i.createElement(Ga.h,{w:"auto"},i.createElement(Ha.R,null),i.createElement(Va.e,{p:0},i.createElement(Wc,{type:"next"})))))):s},hd=()=>{const{playerUI:e,shuffle:t}=(0,r.d4)(e=>({playerUI:(0,Zs.Cu)(e),shuffle:e.player.control.shuffle}));let n="";e.shuffle&&(n=t?(0,oe.AP)("Désactiver le mode aléatoire"):(0,oe.AP)("Activer le mode aléatoire"));const a=e.chromecastActive||!e.shuffle,s=t&&e.shuffle?"icon.accent.primary.default":"icon.neutral.primary.default",o=i.createElement(Te.K0,{disabled:a,"aria-label":n,onClick:()=>{$e.Ay.control.setShuffle(!t)},icon:i.createElement(Wo.R,{color:s}),variant:"ghost",size:"small","data-testid":"shuffle_play_button_"+(t?"on":"off")});return a?o:i.createElement(Ts.m,{label:n},o)};var gd=n("cx5i"),yd=n("AfR/");const Ad=()=>{const{playerUI:e,repeat:t}=(0,r.d4)(e=>({playerUI:(0,Zs.Cu)(e),repeat:e.player.control.repeat}));let n="";if(e.repeat)switch(n=(0,oe.AP)("Répéter"),t){case je.EV.OFF:n=(0,oe.AP)("Réécouter tous les titres");break;case je.EV.ALL:n=(0,oe.AP)("Réécouter ce titre");break;case je.EV.SINGLE:n=(0,oe.AP)("Désactiver la fonction Répéter")}const a=!e.repeat,s=t>0&&e.repeat?"icon.accent.primary.default":"icon.neutral.primary.default",o=i.createElement(Te.K0,{isDisabled:a,"aria-label":n,onClick:()=>{$e.Ay.control.setRepeat(t===je.EV.SINGLE?je.EV.OFF:t+1)},variant:"ghost",size:"small",icon:t===je.EV.SINGLE?i.createElement(gd.Z,{color:s}):i.createElement(yd.H,{color:s}),"data-testid":"repeat_button_"+(t===je.EV.OFF?"off":t===je.EV.ALL?"all":"single")});return a?o:i.createElement(Ts.m,{label:n},o)},Ed=e=>i.cloneElement(e.children,{className:(0,s.A)(e.children.props.className,"mousetrap")});Ed.propType={children:rs().element.isRequired};const _d=Ed;var fd;class bd extends i.Component{constructor(e){super(e),this._onKeyUp=this._onKeyUp.bind(this),this._onMouseDown=this._onMouseDown.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onChange=this._onChange.bind(this),this._showTooltip=this._showTooltip.bind(this),this._hideTooltip=this._hideTooltip.bind(this),this.isDragging=!1,this.state={position:!1,isActive:!1,tooltipOffset:null,tooltipValue:0},this._sliderTrackRef=i.createRef()}shouldComponentUpdate(e,t){return e.value!==this.props.value||!1!==t.position||t.isActive!==this.state.isActive||t.tooltipOffset!==this.state.tooltipOffset||t.tooltipValue!==this.state.tooltipValue}render(){const{max:e,min:t,value:n,step:r,disabled:o,tooltip:l,autoHide:c,testId:d,counter:u}=this.props,{position:p,isActive:m}=this.state,h=Number(this.isDragging&&!1!==p?p:n),g=100*(h-t)/(e-t)||0,y={className:(0,s.A)("slider",{"slider-autohide":c,"is-active":m,"has-counter":u}),onMouseEnter:c?()=>this._setActive(!0):null,onMouseLeave:c?()=>this._setActive(!1):null,onFocus:c?()=>this._setActive(!0):null,onBlur:c?()=>this._setActive(!1):null},A=this._getSliderTrackStyle(g);return i.createElement(de.a,(0,a.A)({},y,{py:"spacing.2xs",height:"auto"}),this._renderCurrentValue(h),i.createElement("div",{className:"slider-track",ref:this._sliderTrackRef},fd||(fd=i.createElement("div",{className:"slider-track-default"})),i.createElement("div",{className:"slider-track-active",style:A}),i.createElement(_d,null,i.createElement("input",{className:"slider-track-input",type:"range",step:r,min:t,max:e,value:h,disabled:o,"aria-valuemin":t,"aria-valuemax":e,"aria-valuenow":h,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onKeyUp:this._onKeyUp,onChange:this._onChange,onMouseMove:l?this._showTooltip:null,onMouseOut:l?this._hideTooltip:null,"data-testid":d})),this._renderTooltip()),this._renderMaxValue())}_renderCurrentValue(e){const{counter:t}=this.props;if(!1===t)return null;const n=this._formatValue(e);return i.createElement(de.a,{pr:"spacing.l"},i.createElement(Ke.E,{variant:"body.2xs.default",color:"text.neutral.primary.default","data-testid":"elapsed_time"},n))}_renderMaxValue(){const{counter:e,max:t}=this.props;if(!1===e)return null;const n=this._formatValue(t);return i.createElement(de.a,{pl:"spacing.l",position:"absolute",right:"0"},i.createElement(Ke.E,{variant:"body.2xs.default",color:"text.neutral.primary.default","data-testid":"remaining_time"},n))}_renderTooltip(){const{tooltipOffset:e,tooltipValue:t}=this.state;if(null===e)return null;const n=this._formatValue(t),a=this._getTooltipStyle(e);return i.createElement("div",{className:"slider-tooltip",style:a},i.createElement(Ke.E,{variant:"body.2xs.default"},n))}_onMouseDown(){this.isDragging=!0}_onMouseUp(e){this.props.onChange(e.target.value);const t={position:!1};if(this.props.tooltip){const n=e.target.getBoundingClientRect(),a=Math.floor(n.left),i=Math.floor(n.width);(e.clientX<a||e.clientX>a+i)&&(t.tooltipOffset=null)}this.setState(t,()=>{this.isDragging=!1})}_onKeyUp(e){-1!==[33,34,35,36,37,38,39,40].indexOf(e.keyCode)&&(this.props.onChange(e.target.value),this.setState({position:!1}))}_onChange({target:{value:e}}){this.props.onProgress(e),(this.isDragging||Number(e)!==this.props.min&&Number(e)!==this.props.max)&&this.setState({position:e})}_showTooltip(e){const t=this._sliderTrackRef.current.getBoundingClientRect(),n=Math.floor(t.left),a=Math.floor(t.width);let i=e.clientX-n;i<0&&(i=0),i>a&&(i=a);const r=this._getValueByCursorPosition(e.clientX);null!==this.state.tooltipOffset&&r===this.state.tooltipValue||this.setState({tooltipOffset:i,tooltipValue:r})}_hideTooltip(){this.setState({tooltipOffset:null})}_formatValue(e){const{counter:t}=this.props;return"function"==typeof t?t(e):e}_setActive(e){this.setState({isActive:e})}_getSliderTrackStyle(e){return{width:`${e}%`,willChange:"width"}}_getTooltipStyle(e){return{transform:`translate3d(${e}px, 0px, 0px)`,WebkitTransform:`translate3d(${e}px, 0px, 0px)`,willChange:"transform"}}_getValueByCursorPosition(e){const{min:t,max:n,step:a}=this.props,i=this._sliderTrackRef.current.getBoundingClientRect(),r=Math.floor(i.left),s=Math.floor(i.width);let o=e-r;o<0&&(o=0),o>s&&(o=s);const l=o/s*100/100,c=Math.round(l*(n*a/a)+t-l*t);return a>1&&c%a!=0?c-c%a:c}}bd.defaultProps={min:0,max:100,value:0,step:1,disabled:!1,counter:!0,tooltip:!1,autoHide:!1,onChange:()=>{},onProgress:()=>{},testId:null};const vd=bd;var kd=n("s026");class Td extends i.Component{constructor(...e){super(...e),this.state={position:0},this._onPositionChanged=(e,t)=>{this.setState({position:t})},this._onSeek=e=>{const{duration:t}=this.props;e>=t?$e.Ay.control.nextSong():$e.Ay.isPlaying()||$e.Ay.isPaused()?$e.Ay.control.seek(e/t):($e.Ay.getTrackList()[0].OFFSET=e/t*t,$e.Ay.control.play())}}componentDidMount(){E.A.subscribe(E.A.player.position,this._onPositionChanged)}componentWillUnmount(){E.A.unsubscribe(E.A.player.position,this._onPositionChanged)}render(){const{position:e}=this.state,{playerUI:t,duration:n,seekAllowed:a}=this.props;return t.seek?i.createElement(vd,{max:n,value:e,counter:kd.A,onChange:this._onSeek,disabled:!a,tooltip:!0,autoHide:!0,testId:"progress_bar"}):null}}const Cd=(0,r.Ng)(e=>({duration:e.player.music.trackDuration,playerUI:(0,Zs.Cu)(e),seekAllowed:(0,$c.rt)(e)}))(Td);var wd=n("g1Fm");const Sd=()=>{const{uiType:e,isUpnext:t,isFlow:n}=(0,r.d4)(e=>({uiType:(0,Zs.ip)(e),isUpnext:e.player.config.isUpnext,isFlow:e.player.config.isFlow}));let a=(0,oe.AP)("MIX");return e===Js.U.AD||e===Js.U.TRITON_AD?null:(e===Js.U.LIVESTREAM?a=(0,oe.AP)("EN DIRECT"):t?a=(0,oe.AP)("RECOMMANDÉ"):n&&(a=(0,oe.AP)("FLOW")),i.createElement(un.J,{size:"small","data-testid":"listening_context_label"},(0,wd.A)(a,!0)))};var xd,Id,Pd,Rd,Ld,Nd,Od,Dd,Md;const Ud=()=>{const e=(0,r.d4)(e=>(0,Zs.Cu)(e));return i.createElement(Ne.s,{width:"33%",px:"spacing.l",direction:"column",gap:"spacing.xs",dir:"ltr"},i.createElement(Ne.s,{justifyContent:"center",alignItems:"center",position:"relative"},e.label&&i.createElement(de.a,{left:"0",top:"50%",transform:"translateY(-50%)",position:"absolute",opacity:{md:"100%",base:"0%"}},xd||(xd=i.createElement(Sd,null))),i.createElement(Mc.e,{size:"small",gap:"spacing.s",spacing:0},e.skipBackwards?Id||(Id=i.createElement(zc,null)):Pd||(Pd=i.createElement(hd,null)),Rd||(Rd=i.createElement(Xc,null)),Ld||(Ld=i.createElement(cd,null)),Nd||(Nd=i.createElement(md,null)),e.skipForwards?Od||(Od=i.createElement(qc,null)):Dd||(Dd=i.createElement(Ad,null)))),Md||(Md=i.createElement(Cd,null)))};var zd,Fd=n("Al8Q"),Bd=n("RGaU");const qd=(0,Fd.A)(Ze.A,{target:"ely5kss1"})({name:"tadcwa",styles:"&:hover{text-decoration:underline;}"}),Gd=(0,Fd.A)("a",{target:"ely5kss0"})({name:"tadcwa",styles:"&:hover{text-decoration:underline;}"}),Hd=()=>{const{playerUI:e,trackTitle:t,uiType:n,track:a}=(0,r.d4)(e=>({playerUI:(0,Zs.Cu)(e),trackTitle:e.player.music.trackTitle,uiType:(0,Zs.ip)(e),track:e.player.music.track}));if(n===Js.U.AD){const e=window.sasAudioConfig||{},t=e.text,n=decodeURIComponent(e.url),a=e=>{e.preventDefault(),e.stopPropagation(),/^http/.test(n)&&open(n)};return t?/^http/.test(n)?i.createElement(Gd,{href:n,onClick:a},t):i.createElement(qd,{to:n,onClick:a},t):null}if(n===Js.U.TRITON_AD)return i.createElement(i.Fragment,null,zd||(zd=i.createElement(Bd.k,{as:"span",size:20,thickness:2,marginRight:1,verticalAlign:"text-bottom"})),(0,oe.AP)("Chargement en cours"));const s=El({playerUI:e,track:a});return s?i.createElement(qd,{to:s},t):t},Vd=(0,Fd.A)(Ze.A,{target:"erlh4i50"})({name:"tadcwa",styles:"&:hover{text-decoration:underline;}"}),Yd=()=>{const{trackArtists:e,playerUI:t}=(0,r.d4)(e=>({trackArtists:e.player.music.trackArtists,playerUI:(0,Zs.Cu)(e)}));return e.map((e,n)=>{const a=_l({playerUI:t},e);return[n>0?", ":"",a?i.createElement(Vd,{className:"track-link",key:e.ART_ID,to:a},e.ART_NAME):e.ART_NAME]})};var Qd;const Wd=()=>{const{playerUI:e,track:t,id:n,mediaType:a,userId:s,context:o,trackArtists:l}=(0,r.d4)(e=>({playerUI:(0,Zs.Cu)(e),id:e.player.music.id,track:e.player.music.track,mediaType:e.player.music.mediaType,userId:e.user.id,context:e.player.music.context,trackArtists:e.player.music.trackArtists}));if(a===je.zu.LIVE_STREAM&&t.EXTERNAL)return null;const c={anchor:e=>i.createElement(Te.K0,{"aria-label":"Open context menu",variant:"ghost",isActive:e,_active:{color:"icon.accent.primary.default",bg:"transparent"},icon:Qd||(Qd=i.createElement(_i.c,null)),size:"small"}),context:{ID:s,TYPE:"player"},data:{SONG:t,PLAYLIST_ID:o.ID},forceShowPlaylists:!0,id:n,placement:"top"},d=String(t.SNG_ID_ORIGIN||n);return i.createElement(Mc.e,{size:"small",spacing:"spacing.xs",alignItems:"center"},e.like&&i.createElement($s.A,{type:Be.Ay.Song,context:{ID:d,TYPE:"player",CONTEXT_ID:t.SPONSORED?"sponsored=true":void 0},tooltip:!0,id:d}),i.createElement(ml,{placement:"top",artistId:l.length>0?l[0].ART_ID:"0",trackId:String(t.SNG_ID_ORIGIN||n)}),e.contextMenu&&i.createElement("div",{"data-testid":"add_to_playlist_button"},i.createElement(Xs.A,c)))};var Kd,jd,$d,Xd;const Jd=()=>{const{playerUI:e,mediaType:t,isExplicit:n,uiType:a,currentTrack:s,isExplicitCover:o}=(0,r.d4)(e=>({playerUI:(0,Zs.Cu)(e),mediaType:e.player.music.mediaType,isExplicit:e.player.music.isExplicit,isExplicitCover:(0,gl.cV)(e.player.music.track),uiType:(0,Zs.ip)(e),currentTrack:e.player.music}));return i.createElement(Ne.s,{width:"33%",alignItems:"center"},e.cover&&i.createElement(de.a,{boxSize:"size.xl","data-testid":"item_cover",minWidth:"size.xl"},i.createElement(Xe.A,{src:s.cover,alt:s.trackTitle,isExplicitCover:o})),i.createElement(Ne.s,{alignItems:"flex-start",minWidth:0},i.createElement(Ne.s,{direction:"column",ms:"spacing.s",minWidth:0},e.title&&i.createElement(Ne.s,{alignItems:"center",gap:"spacing.xs"},Kd||(Kd=i.createElement(et.A,null,i.createElement(Ke.E,{variant:"body.l.default",color:"text.neutral.primary.default","data-testid":"item_title"},i.createElement(Hd,null)))),n&&a!==Js.U.AD&&a!==Js.U.TRITON_AD&&(jd||(jd=i.createElement(js.A,{size:"small"})))),e.subTitle&&($d||($d=i.createElement(et.A,null,i.createElement(Ke.E,{variant:"body.s.default",color:"text.neutral.secondary.default","data-testid":"item_subtitle"},i.createElement(Yd,null))))))),t&&(Xd||(Xd=i.createElement(Ne.s,{ms:"spacing.l"},i.createElement(Wd,null)))))};var Zd,eu,tu,nu,au=n("AeFk"),iu=n("oxTq"),ru=n("Dmvo");class su extends i.Component{constructor(e){super(e),this._onAudioQualityUpdate=this._onAudioQualityUpdate.bind(this),this._onTriforceUpdate=this._onTriforceUpdate.bind(this),this._onDiscoverClick=this._onDiscoverClick.bind(this)}render(){return i.createElement(de.a,{className:"player-overlay-settings",fontSize:"sm","data-testid":"audio_settings_menu"},this._renderAudioQuality(),i.createElement("ul",{className:"setting-menu"},this._renderNormalized(),this._renderTriforce()))}_renderAudioQuality(){const e=!0===this.props.isCasting?(0,oe.AP)("hificast_title_audioqualityondevices_web"):(0,oe.AP)("Qualité Audio"),t=this._getCurrentAudioQuality();return i.createElement(ta.z,{onChange:this._onAudioQualityUpdate,value:t},i.createElement("ul",{className:"setting-menu"},i.createElement("li",{className:"setting-item"},i.createElement("div",{className:"setting-label-text","data-testid":"audio_setting_title"},e)),this._renderAudioQualityStandard(),this._renderAudioQualityHigh(),this._renderAudioQualityLossless()))}_renderAudioQualityStandard(){const{hasHqAudioRight:e,hasLosslessAudioRight:t}=this.props,n=!t&&!e,a=this._getCurrentAudioQuality()===Al.en.STANDARD;return i.createElement("li",{className:"setting-item"},i.createElement("label",{className:"setting-label","data-testid":"quality_standard_title"},i.createElement("div",{className:"setting-label-text"},(0,oe.AP)("Standard")),!n&&(Zd||(Zd=i.createElement("div",{className:"setting-label-info"},"128kb/s"))),i.createElement("div",{className:"setting-label-control"},i.createElement(aa.s,{as:"span",value:Al.en.STANDARD,"data-testid":"quality_standard_button_"+(a?"on":"off")}))))}_renderAudioQualityHigh(){const{hasHqAudioRight:e,conversionEntrypoints:t}=this.props;if(!e&&!t.AUDIO_SETTING_PREMIUM)return null;const n=this._getCurrentAudioQuality()===Al.en.HIGH;return e?i.createElement("li",{className:"setting-item"},i.createElement("label",{className:"setting-label","data-testid":"quality_hq_title"},i.createElement("div",{className:"setting-label-text"},(0,oe.AP)("Supérieure")),eu||(eu=i.createElement("div",{className:"setting-label-info"},"320kb/s")),i.createElement("div",{className:"setting-label-control"},i.createElement(aa.s,{as:"span",value:Al.en.HIGH,"data-testid":"quality_hq_button_"+(n?"on":"off")})))):i.createElement("li",{className:"setting-item"},i.createElement(ln.A,null,i.createElement(Ze.A,{target:"_blank",to:(0,da.hY)(t.AUDIO_SETTING_PREMIUM.action),className:"setting-label"},i.createElement("div",{className:"setting-label-text"},(0,oe.AP)("audioquality_title_highfidelity_web")),i.createElement("div",{className:"setting-label-control"},i.createElement("span",{className:"setting-discover-link"},t.AUDIO_SETTING_PREMIUM.label,tu||(tu=i.createElement(cn.A,{size:"14"})))))))}_renderAudioQualityLossless(){const{conversionEntrypoints:e,hasLosslessAudioRight:t,hasHqAudioRight:n}=this.props;if(!t&&!e.AUDIO_SETTING_HIFI||!n)return null;if(!$e.Ay.html5.flac)return i.createElement("li",{className:"setting-item disabled"},i.createElement("div",{className:"setting-label-text"},(0,oe.AP)("audioquality_title_highfidelity_web")),i.createElement("div",{className:"setting-notice"},(0,oe.AP)("infomessage_text_notsupportedbybrowserusechromefirefoxedge_web")));const a=this._getCurrentAudioQuality()===Al.en.LOSSLESS;return i.createElement("li",{className:"setting-item"},i.createElement("label",{className:"setting-label","data-testid":"quality_loseless_title"},i.createElement("div",{className:"setting-label-text"},(0,oe.AP)("audioquality_title_highfidelity_web")),i.createElement("div",{className:"setting-label-control"},t?i.createElement(aa.s,{as:"span",value:Al.en.LOSSLESS,"data-testid":"quality_loseless_button_"+(a?"on":"off")}):i.createElement(ln.A,null,i.createElement(Ze.A,{className:"setting-discover-link",to:(0,da.hY)(e.AUDIO_SETTING_HIFI.action),target:"_blank"},e.AUDIO_SETTING_HIFI.label,nu||(nu=i.createElement(cn.A,null)))))),i.createElement("div",{className:"setting-notice"},(0,oe.AP)("audiosettings_text_highfidelitydescription_web")))}_renderNormalized(){return _.A.isAllowed("volume_normalization")?i.createElement("li",{className:"setting-item"},i.createElement("label",{className:"setting-label"},i.createElement("div",{className:"setting-label-text","data-testid":"normalize_title"},(0,oe.AP)("audiosettings_title_normalizeaudio_web")),i.createElement("div",{className:"setting-label-control"},i.createElement(pn.d,{as:"span","data-testid":"normalize_button_"+(this.props.isNormalized?"on":"off"),isChecked:this.props.isNormalized,onChange:this._onNormalizedUpdate}))),i.createElement("div",{className:"setting-notice","data-testid":"normalize_subtitle"},(0,oe.AP)("audiosettings_text_normalizeaudiodescription_web"))):null}_renderTriforce(){return _.A.isAllowed("triforce_queuelist_ui")&&this.props.isPremium?i.createElement("li",{className:"setting-item"},i.createElement("label",{className:"setting-label"},i.createElement("div",{className:"setting-label-text","data-testid":"synchronised_title"},(0,oe.AP)("Synchronisation de la file d'attente")),i.createElement("div",{className:"setting-label-control"},i.createElement(pn.d,{as:"span",isChecked:this.props.isTriforceEnabled,"data-testid":"synchronised_button_"+(this.props.isTriforceEnabled?"on":"off"),onChange:this._onTriforceUpdate}))),i.createElement("div",{className:"setting-notice","data-testid":"synchronised_subtitle"},(0,oe.AP)("Le contenu de votre file d'attente reste le même sur tous les appareils où vous utilisez Deezer."))):null}_onAudioQualityUpdate(e){const t={site:{player_hq:e===Al.en.HIGH||e===Al.en.LOSSLESS}};!0===this.props.isCasting?t.site.cast_audio_quality=e:t.site.player_audio_quality=e,this.props.updateSettings(t),$e.Ay.control.setAudioQuality(e)}_onNormalizedUpdate(e){if(!e.isTrusted)return void e.preventDefault();const t=e.target.checked;$e.Ay.control.setNormalized(t),sn.A.set({site:{player_normalize:t}}),Rt.A.call({method:"log_central.log",data:{BATCH:[{channel:"feature_activation",params:{ts:Math.floor(Date.now()/1e3),state:t?"on":"off",feature:"normalization",os_based:!1}}]}})}_onTriforceUpdate(e){if(!e.isTrusted)return void e.preventDefault();const t=e.target.checked;this.props.updateSettings({site:{triforce:t}})}_onDiscoverClick(e){e.preventDefault(),(0,hl.A)(e.target.href)}_getCurrentAudioQuality(){return this.props.isCasting?this.props.currentCastAudioQuality:this.props.currentAudioQuality}}const ou={updateSettings:D.Xx},lu=(0,r.Ng)(({user:e,player:t})=>({conversionEntrypoints:e.USER.ENTRYPOINTS,currentAudioQuality:e.currentAudioQuality,currentCastAudioQuality:e.currentCastAudioQuality,hasHqAudioRight:e.hasHqAudioRight,hasLosslessAudioRight:e.hasLosslessAudioRight,isPremium:(0,S.ki)(e),isTriforceEnabled:(0,S.Qi)(e),isCasting:t.chromecast.casting,isNormalized:(0,$c.mQ)({player:t})}),ou)(su);var cu,du,uu=n("5CMV");const pu=()=>{const[e,t]=(0,i.useState)(!1);return(0,i.useEffect)(()=>(E.A.subscribe(E.A.player.openAudioSettings,open),()=>E.A.unsubscribe(E.A.player.openAudioSettings,open)),[]),i.createElement(Ba.A,{placement:"top",isLazy:!0,onOpen:()=>t(!0),onClose:()=>t(!1)},i.createElement(qa.W,null,i.createElement(Te.K0,{"aria-label":(0,oe.AP)("Audio"),size:"small",variant:"ghost",isActive:e,_active:{color:"icon.accent.primary.default",bg:"transparent"},icon:cu||(cu=i.createElement(uu.Q,null)),"data-testid":"audio_settings_button"})),du||(du=i.createElement(Ga.h,{w:"auto"},i.createElement(Ha.R,null),i.createElement(Va.e,{p:0},i.createElement(lu,null)))))};var mu=n("ITz4"),hu=n("mIO1");const gu=()=>{const e=(0,r.d4)($c.yk),t=(0,r.d4)($c.bE),n=(0,i.useCallback)(e=>{$e.Ay.control.setVolume(Number(e/100),!0)},[]);return i.createElement(vd,{min:0,max:100,step:1,value:e?0:Math.round(100*t),counter:!1,onProgress:n,testId:"volume_menu_bar"})};var yu,Au,Eu;const _u=()=>{const e=(0,r.d4)($c.yk),t=(0,r.d4)(Zs.Cu),n=(0,i.useCallback)(()=>{$e.Ay.control.mute(!e)},[e]);return i.createElement(Ba.A,{placement:"top",trigger:"hover",isLazy:!0},i.createElement(qa.W,null,i.createElement(Te.K0,{"aria-label":"volume button",disabled:!t.volume,onClick:n,"data-testid":"volume_button_"+(e?"mute":"default"),icon:e?yu||(yu=i.createElement(mu.V,null)):Au||(Au=i.createElement(hu.s,null)),variant:"ghost",isActive:e,_active:{color:"icon.accent.primary.default",bg:"transparent"},size:"small"})),Eu||(Eu=i.createElement(Ga.h,{w:"240px","data-testid":"volume_menu"},i.createElement(Ha.R,null),i.createElement(Va.e,null,i.createElement(gu,null)))))};var fu,bu,vu,ku;au.i7`
	0% {opacity: 1}
	50% {opacity: 0.2}
	100% {opacity: 1}
`;const Tu=()=>{var e;const t=(0,r.wA)(),{playerUI:n,hasLyrics:a,playerLyrics:s,isFlow:o,isOnline:l,list:c,playerQueuelist:d,playerFull:u,playerContext:p,casting:m,connecting:h,active:g,userId:y}=(0,r.d4)(e=>({playerUI:(0,Zs.Cu)(e),hasLyrics:(0,yl.jk)(e),playerLyrics:e.player.config.playerLyrics,isFlow:e.player.config.isFlow,isOnline:e.app.online,list:e.player.music.list,playerQueuelist:e.player.config.playerQueuelist,playerFull:e.player.config.playerFull,playerContext:e.player.music.context,connecting:e.player.chromecast.connecting,casting:e.player.chromecast.casting,active:e.player.chromecast.active,userId:e.user.id})),{data:A}=(0,Ue.aD2)({variables:{flowConfigId:String(p.ID)===String(y)?"default":p.ID},skip:!_.A.isAllowed("feature_2025_flow_custo")||!o}),E=()=>{t((0,F.qf)({name:"FLOW_CUSTO",props:{flowId:"dynamic_page_user_radio"===p.TYPE||String(p.ID)===String(y)?"default":null==p?void 0:p.ID},background:"background.neutral.primary.default"}))};(0,ru.A)({shouldSkip:!1===_.A.isAllowed("feature_2025_flow_custo")||!o||"true"===localStorage.getItem(ru.q),playerContext:p,openModalFlowTuner:E});const f=n.lyrics&&a&&l,b=null==A||null===(e=A.flowConfig)||void 0===e?void 0:e.hasCustomizableClusterConfigurations;return i.createElement(Mc.e,{size:"small",alignItems:"center",width:"33%",justifyContent:"flex-end",spacing:"spacing.xs"},b&&i.createElement(Te.$n,{"data-testid":"tune_flow_button",variant:"outline",onClick:E},(0,oe.AP)("flowtuner_action_tunethisflow_web")),f&&i.createElement(Ts.m,{label:s?(0,oe.AP)("lyrics_action_hidelyrics_web"):(0,oe.AP)("Afficher les paroles")},i.createElement(Te.K0,{"data-testid":"lyrics_button",icon:fu||(fu=i.createElement(Ws.c,null)),variant:"ghost",isActive:s,_active:{color:"icon.accent.primary.default",bg:"transparent"},onClick:()=>{t(s?(0,Gs.no)(!1):(0,Gs.IG)(!0)),$e.Ay.isPaused()||$e.Ay.isPlaying()||$e.Ay.control.play()},"aria-label":s?(0,oe.AP)("lyrics_action_hidelyrics_web"):(0,oe.AP)("Afficher les paroles")})),n.queuelist&&i.createElement(Te.K0,{"data-testid":"queue_list_button","aria-label":"open queuelist",variant:"ghost",isActive:d,_active:{color:"icon.accent.primary.default",bg:"transparent"},isDisabled:!c.length,onClick:()=>{t(d?(0,Gs.no)(!u):(0,Gs.PV)(!0))},icon:bu||(bu=i.createElement(iu.j,null))}),((()=>{try{var e;const t=null===(e=navigator.userAgentData)||void 0===e?void 0:e.brands;return t?t.some(e=>"Google Chrome"===e.brand):/Chrome/.test(navigator.userAgent)}catch{return/Chrome/.test(navigator.userAgent)}})(),null),vu||(vu=i.createElement(_u,null)),ku||(ku=i.createElement(pu,null)))};var Cu=n("p2PB");var Su=n("qBrz"),xu=n("FvhZ"),Iu=n("DFyM"),Pu=n("JPje");const Ru={buffer:0,volume:0,repeat:0,shuffle:!1,mute:!1,playing:!1,paused:!1,loading:!1,hasPrev:!1,hasNext:!1,hasRepeat:!1,hasShuffle:!1,normalized:!0};var Lu=n("PIVb");const Nu={available:!1,connecting:!1,casting:!1,loading:!1,active:!1,chunksInfo:{},skipLimited:!1};var Ou=n("5LFp");const Du={isRadio:!1,isUpnext:!1,isFlow:!1,isMyFlow:!1,isBlindTestMode:!1,playerType:"",playerFull:!1,playerQueuelist:!1,playerLyrics:!1};var Mu=n("FMs+");let Uu=function(e){return e.SET_TONE="components/Player/ui/SET_TONE",e.SET_COLOR="components/Player/ui/SET_COLOR",e}({});const zu={tone:(0,Mu.Q5)(),backgroundColor:(0,Mu.D8)()[0],isLightMode:(0,Mu.D8)()[1]};let Bu={statusExclamationMark:80,object:null,type:"no_restriction",init:function(){try{if(x.A.getState().user.id<=0||(0,S.jQ)(x.A.getState().user))return!1;if(x.A.getState().user.USER.OPTIONS.web_streaming&&0===x.A.getState().user.USER.OPTIONS.web_streaming_duration)return!1;Rt.A.call({method:"restriction.get",data:{},success:function(e){e&&(Bu.object=e,Math.round((new Date).getTime()/1e3)<Bu.object.date_end_discover?Bu.type="discovery_unlimited":(Bu.type="discovery",E.A.subscribe(E.A.player.updateRestrictTime,Bu.updateRestrictTime)))}})}catch(e){b.A.error(e)}return!0},updateRestrictTime:function(e,t){return Bu.object.time_left-=t,Bu.object.time_used+=t,Bu.object.percent=100*Bu.object.time_used/(Bu.object.time_used+Bu.object.time_left),Bu.object.percent=Math.min(Bu.object.percent,100),!0}};const qu=Bu;var Gu=n("AY3M");const Hu=(0,ze.Us)(Be.Ay.Album),Vu=(0,ze.Pe)(Be.Ay.Artist,Gu.sI),Yu=(0,ze.Pe)(Be.Ay.Playlist,Gu.lh),Qu=(0,ze.Us)(Be.Ay.Episode),Wu=(0,ze.Pe)(Be.Ay.User,Gu.N_),Ku=(0,ze.Pe)(Be.Ay.Album,Gu.LF),ju=(0,ze.Pe)(Be.Ay.Artist,Gu.LF),$u=(0,ze.Pe)(Be.Ay.Playlist,Gu.LF),Xu=(0,ze.Pe)(Be.Ay.Radio,Gu.LF),Ju=(0,ze.Pe)(Be.Ay.Track,Gu.LF),Zu=(0,ze.Us)(Be.Ay.Livestream),ep=(0,ze.Us)(Be.Ay.Playlist),tp=(0,ze.Pe)(Be.Ay.User,Gu.N_),np=(0,ze.Us)(Be.Ay.Radio),ap=(0,ze.Pe)(Be.Ay.Artist,Gu.Gv),ip=(0,ze.Us)(Be.Ay.Show),rp=(0,ze.Us)(Be.Ay.Smarttracklist),sp=(0,ze.Us)(Be.Ay.Track),op={album:Hu,artist:Vu,episode:Qu,flow:Wu,landingalbum:Ku,landingartist:ju,landingplaylist:$u,landingradio:Xu,landingtrack:Ju,livestream:Zu,playlist:ep,profile:tp,mix:np,mixes:ap,show:ip,smarttracklist:rp,track:sp},lp=/.*\/([0-9]+).*/,cp=/.*\/smarttracklist\/([0-9a-z-]+).*/;var dp=n("DNpT"),up=n("w2Jm"),pp=n("IZwO"),mp=n("RuKb"),hp=n("2dhM");let gp=!1;const yp=({getState:e,dispatch:t},n)=>{const a=n?n.offset:Math.floor($e.Ay.getPosition()),i=n?n.id:$e.Ay.getSongId(),r=n?n.type:$e.Ay.getMediaType(),s=n?n.duration:$e.Ay.getDuration();if(!i||!r||!s)return;const o=(0,up.qx)(String(r));if(null===o)return;const l=(0,mp.v6)(e().bookmarks,o,String(i));(l?(0,dp.Ki)(l,a,s):(0,dp.Ht)(o,String(i),a,s)).then(e=>{t((0,pp.S8)(e))})};var Ep=n("dn5u"),_p=n.n(Ep);const fp=_p()(),bp="LIMITATION";function vp(e,[t]){var n;t&&t.VALUE&&!Number(t.VALUE.USER_ID)||fp!==(null==t||null===(n=t.VALUE)||void 0===n?void 0:n.UNIQID)&&E.A.trigger(E.A.live.simultaneousAccess)}n("hB5o"),n("LvTk");var kp=n("YNBm");class Tp{constructor(){(0,kp.A)(this).list=[]}add(e){const t=(0,kp.A)(this);return t.list=t.list.filter(t=>t.name!==e.name),t.list.push(e),this}clear(){return(0,kp.A)(this).list.length=0,this}has(e={}){return Boolean((0,kp.A)(this).list.filter(t=>Object.keys(e).reduce((n,a)=>n&&t[a]===e[a],!0)).length)}pause(){return(0,kp.A)(this).paused=!0,this}prioritize(e={}){const t=(0,kp.A)(this),n=t.list.filter(t=>Object.keys(e).reduce((n,a)=>n&&t[a]===e[a],!0));if(n.length){const e=n[n.length-1];return t.list=t.list.filter(e=>n.indexOf(e)<0),t.list.unshift(e),!0}return!1}resume(){return(0,kp.A)(this).paused=!1,this.run(),this}run(){const e=(0,kp.A)(this);if(e.paused||e.running)return this;const t=e.list[0];if(t){const a=Date.now();if(t.timeout&&self.clearTimeout(t.timeout),t.timestamp>a)return t.timeout=self.setTimeout(()=>this.run(),t.timestamp-a),this;e.list.shift(),e.running=!0;const i=t.fn();(n=i,!Boolean(n)||"object"!=typeof n&&"function"!=typeof n||"function"!=typeof n.then?Promise.resolve():i).catch(e=>b.A.error(e)).then(()=>{e.running=!1,this.run()})}var n;return this}}var Cp=n("8VJL"),wp=n("eC9Z"),Sp=n("pUfN"),xp=n("LURY");const Ip={};let Pp;function Rp(e){const t={from:e.getAttribute("from"),to:e.getAttribute("to")},n=e.getElementsByTagName("items")[0];t.node=n?n.getAttribute("node"):void 0;const a=e.getElementsByTagName("payload")[0]||e.getElementsByTagName("item")[0];t.payload=a.childNodes.length?a.childNodes[0].textContent:void 0;try{t.payload=JSON.parse(t.payload)}catch(e){}return t}function Lp(e){const t=Rp(e);return((0,kp.A)(this).listeners.message||[]).filter(e=>Object.keys(e.options||{}).reduce((n,a)=>n&&(Array.isArray(e.options[a])?e.options[a]:[e.options[a]]).indexOf(t[a])>-1,!0)).forEach(e=>{try{e.fn(t)}catch(e){this.emit("error",e)}}),!0}function Np(e){const t={client:e.getAttribute("from"),type:e.getAttribute("type")};return t.client!==this.socket.jid&&this.emit("presence",t),!0}xp.aC.Builder.prototype.cdata||(xp.aC.Builder.prototype.cdata=function(e){return this.node.appendChild(xp.aC.xmlGenerator().createCDATASection(e)),this});class AuthenticationError extends Cp.A{}class ConnectionError extends Cp.A{}class Op{static get singleton(){const e=(0,wp.WV)({itemType:Sp.Wi.CONFIG,itemName:"messaging"})||_r.default.get("host_messaging");return Pp||(Pp=new Op({endpoint:`wss://${e}/websocket`,jid:`${x.A.getState().user.id}@${e}`,password:x.A.getState().user.USER_TOKEN}))}constructor({endpoint:e="",id:t=_p()(),jid:n,password:a}={}){this.id=t,Object.defineProperty(this,"endpoint",{value:e}),Object.defineProperty(this,"jid",{value:n}),Object.defineProperty(this,"password",{value:a}),Object.defineProperty(this,"socket",{value:new xp.aC.Connection(e)});const i=(0,kp.A)(this);i.listeners={},i.retries=0}connect(){const e=(0,kp.A)(this);if(e.connecting)return e.connecting;if(this.socket.connected)return Promise.resolve();const t=e.connecting=new Promise((t,n)=>{e.connected=(e,a)=>e?n(e):t(a)});return this.socket.connect(this.jid,this.password,function t(n,a){switch(n){case xp.aC.Status.ERROR:this.emit("error",new Error(a));break;case xp.aC.Status.CONNFAIL:case xp.aC.Status.CONNTIMEOUT:this.emit("error",new ConnectionError(a||"Timeout"));break;case xp.aC.Status.AUTHFAIL:a=new AuthenticationError,this.emit("error",a),e.connected(a),e.retries=0,delete e.connecting,delete e.connected;break;case xp.aC.Status.CONNECTED:this.socket.addHandler(Lp.bind(this),null,"message"),this.socket.addHandler(Np.bind(this),null,"presence"),this.emit("connect"),e.connected(),e.retries=0,delete e.connecting,delete e.connected;break;case xp.aC.Status.DISCONNECTED:this.emit("disconnect"),e.disconnecting?(e.disconnected(),delete e.disconnecting,delete e.disconnected,delete this.socket.connect_callback):self.setTimeout(()=>e.connecting?this.socket.connect(this.jid,this.password,t.bind(this)):this.connect(),1e3*(Math.random()*(Math.pow(2,++e.retries)-Math.pow(2,e.retries-1))+Math.pow(2,e.retries-1)));case xp.aC.Status.CONNECTING:case xp.aC.Status.AUTHENTICATING:case xp.aC.Status.DISCONNECTING:case xp.aC.Status.ATTACHED:case xp.aC.Status.REDIRECT:}}.bind(this)),t}disconnect(){const e=(0,kp.A)(this);if(this===Pp)return Promise.reject(new Error("Cannot disconnect the singleton since the socket might be used somewhere else."));if(e.disconnecting)return e.disconnecting;if(!this.socket.connected)return Promise.resolve();const t=e.disconnecting=new Promise((t,n)=>{e.disconnected=(e,a)=>e?n(e):t(a)});return this.socket.disconnect(),t}emit(e,...t){((0,kp.A)(this).listeners[e]||[]).forEach(e=>{try{e.fn(...t)}catch(e){this.emit("error",e)}})}get(e,t={}){const n=new xp.aC.Builder("iq",{from:this.jid,type:"get"}).c("pubsub",{xmlns:"http://jabber.org/protocol/pubsub"}).c("items",{node:e});return this.connect().then(()=>new Promise((e,a)=>this.socket.sendIQ(n,t=>e(Rp(t)),a,t.timeout)))}off(e,t){const n=(0,kp.A)(this),a=n.listeners[e]||[];let i=a.length;for(;i--;)t&&a[i]!==t||a.splice(i,1);a.length||delete n.listeners[e]}on(e,t,n){const a=(0,kp.A)(this);a.listeners[e]=a.listeners[e]||[],a.listeners[e].push({fn:t,options:n})}post(e,t,n={}){const a=new xp.aC.Builder("iq",{from:this.jid,type:"set"}).c("pubsub",{xmlns:"http://jabber.org/protocol/pubsub"}).c("publish",{node:e}).c("item").cdata("string"==typeof t?t:JSON.stringify(t));return this.connect().then(()=>new Promise(function e(t){const n=Math.floor(Date.now()/1e3);return Object.keys(Ip).filter(e=>e<n).forEach(e=>delete Ip[e]),Ip[n]>=10?self.setTimeout(()=>e(t),1e3):(Ip[n]=(Ip[n]||0)+1,t())})).then(()=>new Promise((e,t)=>this.socket.sendIQ(a,e,t,n.timeout)))}presence(e,t={}){return this.connect().then(()=>new Promise((n,a)=>this.socket.sendPresence(new xp.aC.Builder("presence",e),n,a,t.timeout)))}}Op.AuthenticationError=AuthenticationError,Op.ConnectionError=ConnectionError;const Dp=Op;var Mp=n("wlv8"),Up=n.n(Mp),zp=n("nLzw"),Fp=n("77Ru"),Bp=n.n(Fp);const qp=new Map([[je.EV.ALL,Bp().com.deezer.kmp.player.models.RepeatMode.All],[je.EV.OFF,null],[je.EV.SINGLE,Bp().com.deezer.kmp.player.models.RepeatMode.One]]),Gp={[je.Cc.ADS]:null,[je.Cc.CHROMECAST]:null,[je.Cc.JINGLE]:null,[je.Cc.LIVESTREAM]:null,[je.Cc.MOD]:Bp().com.deezer.kmp.player.models.ListenType.MOD,[je.Cc.RADIO]:Bp().com.deezer.kmp.player.models.ListenType.SMART_RADIO,[je.Cc.TRITON_AD]:null},Hp={[je.zu.SONG]:Bp().com.deezer.kmp.player.models.PlayableType.TRACK,[je.zu.LIVE_STREAM]:Bp().com.deezer.kmp.player.models.PlayableType.LIVESTREAM,[je.zu.EPISODE]:Bp().com.deezer.kmp.player.models.PlayableType.PODCAST_EPISODE};var Vp=(0,C.A)("log"),Yp=(0,C.A)("dzPlayer"),Qp=(0,C.A)("playerStateEmitter"),Wp=(0,C.A)("syncPlayerState"),Kp=(0,C.A)("getUnshuffledTrackOrder"),jp=(0,C.A)("emitPlayerState"),$p=(0,C.A)("setIsActive"),Xp=(0,C.A)("tranformCBQLTracklistToDzPlayerTracklist"),Jp=(0,C.A)("transformDzPlayerTracklistToCBQLTracklist");class Zp{constructor(e,t,n){Object.defineProperty(this,Jp,{value:im}),Object.defineProperty(this,Xp,{value:am}),Object.defineProperty(this,$p,{value:nm}),Object.defineProperty(this,jp,{value:tm}),Object.defineProperty(this,Kp,{value:em}),Object.defineProperty(this,Vp,{writable:!0,value:void 0}),Object.defineProperty(this,Yp,{writable:!0,value:void 0}),Object.defineProperty(this,Qp,{writable:!0,value:void 0}),this.playerState=void 0,this._hydrateDzPlayerTracks=void 0,Object.defineProperty(this,Wp,{writable:!0,value:void 0}),(0,T.A)(this,Vp)[Vp]=n,(0,T.A)(this,Yp)[Yp]=e,this._hydrateDzPlayerTracks=t;const a=(0,T.A)(this,Yp)[Yp].getRepeat();(0,T.A)(this,Qp)[Qp]=new(Bp().com.deezer.kmp.mp.async.MPStateFlowEmitter)(new(Bp().com.deezer.kmp.queuesync.api.DzAppPlayerState)(new(Bp().com.deezer.kmp.queuesync.models.DzAppQueueState)(Bp().com.deezer.kmp.queuesync.models.DzAppQueueType.BasicQueueList,qp.get(a),(0,T.A)(this,Yp)[Yp].getTrackListIndex(),(0,T.A)(this,Jp)[Jp]([]),(0,T.A)(this,Yp)[Yp].isShuffle()?Bp().com.deezer.kmp.mp.copyToMPList((0,T.A)(this,Kp)[Kp]()):null),(0,T.A)(this,Yp)[Yp].isPlaying(),!1)),this.playerState=(0,T.A)(this,Qp)[Qp].flow(),(0,T.A)(this,Wp)[Wp]=this.playerState.value.copy(),E.A.subscribe(E.A.player.play,()=>(0,T.A)(this,$p)[$p](!0)),E.A.subscribe(E.A.player.playing,(e,t)=>(0,T.A)(this,$p)[$p](t)),E.A.subscribe(E.A.player.paused,(t,n)=>(0,T.A)(this,$p)[$p](!!e.isPlaying()&&!n))}dispatch(e){if(e instanceof Bp().com.deezer.kmp.queuesync.api.DzAppPlayerAction.SetQueue){const t=this.playerState.value.queueState.copy();(0,T.A)(this,Vp)[Vp]("Receving new state from CBQL",e.queueState),(0,T.A)(this,jp)[jp]((0,T.A)(this,Wp)[Wp].copy(e.queueState)),(0,T.A)(this,Xp)[Xp](e.queueState.queueTrackList).then(n=>{if(!n)return;const a=n.filter(({context:{TYPE:e}})=>"up_next_artist"===e),i=a.length?n.slice(0,n.indexOf(a[0])):n;if(t.copy(t.queueType,t.repeatMode,e.queueState.queuePosition).equals(e.queueState))return void(0,T.A)(this,Yp)[Yp].setTriforceIndex(e.queueState.queuePosition);var r;if(t.copy(t.queueType,e.queueState.repeatMode).equals(e.queueState))return void(0,T.A)(this,Yp)[Yp].control.setRepeat(null===(r=qp.entries().find(([,t])=>t===e.queueState.repeatMode))||void 0===r?void 0:r[0],{sync:!1});const s=e.queueState.queueType instanceof Bp().com.deezer.kmp.queuesync.models.DzAppQueueType.InfiniteQueueList?e.queueState.queueType.context.listenType===Bp().com.deezer.kmp.player.models.ListenType.SMART_RADIO:e.queueState.queueTrackList.get(e.queueState.queuePosition).itemContext.listenType===Bp().com.deezer.kmp.player.models.ListenType.SMART_RADIO,o={original:i,tracks:e.queueState.queuePlayingOrder?Bp().com.deezer.kmp.mp.copyToJsArray(e.queueState.queuePlayingOrder).map(e=>i[e]):i,recommended:a,shuffled:null!==e.queueState.queuePlayingOrder,index:e.queueState.queuePosition,radio:s};(0,T.A)(this,Vp)[Vp]("Sending queuelist to dzPlayer",o),(0,T.A)(this,Yp)[Yp].setTriforceState(o)})}}setRepeat(e){(0,T.A)(this,jp)[jp]((0,T.A)(this,Wp)[Wp].copy(this.playerState.value.queueState.copy(this.playerState.value.queueState.queueType,qp.get(e)))),(0,T.A)(this,Vp)[Vp]("Sending new state to CBQL for repeatMode",this.playerState.value)}setTracklist(e,t=0){(0,T.A)(this,jp)[jp]((0,T.A)(this,Wp)[Wp].copy(this.playerState.value.queueState.copy(Bp().com.deezer.kmp.queuesync.models.DzAppQueueType.BasicQueueList,this.playerState.value.queueState.repeatMode,t,(0,T.A)(this,Jp)[Jp](e.tracks),e.shuffled?Bp().com.deezer.kmp.mp.copyToMPList(e.tracks_order):null))),(0,T.A)(this,Vp)[Vp]("Sending new state to CBQL for a tracklist ",this.playerState.value)}setTracklistIndex(e){(0,T.A)(this,jp)[jp]((0,T.A)(this,Wp)[Wp].copy(this.playerState.value.queueState.copy(this.playerState.value.queueState.queueType,this.playerState.value.queueState.repeatMode,e))),(0,T.A)(this,Vp)[Vp]("Sending new state to CBQL for the tracklist index",this.playerState.value)}}function em(){const e=(0,T.A)(this,Yp)[Yp].getTrackList(!0,!1);return(0,T.A)(this,Yp)[Yp].getTrackList(!0,!0).map(t=>e.findIndex(e=>e===t))}function tm(e){(0,T.A)(this,Wp)[Wp]=e,(0,T.A)(this,Qp)[Qp].emit((0,T.A)(this,Wp)[Wp])}function nm(e){(0,T.A)(this,jp)[jp]((0,T.A)(this,Wp)[Wp].copy(this.playerState.value.queueState.copy(),e)),(0,T.A)(this,Vp)[Vp]("Setting isActive locally - aka is playing",this.playerState.value)}async function am(e){if(!e.size)return;let t=!1;const n=Bp().com.deezer.kmp.mp.copyToJsArray(e),a=await Promise.all([this._hydrateDzPlayerTracks("songs",n.filter(e=>e.identifier.type===Bp().com.deezer.kmp.player.models.PlayableType.TRACK).map(e=>e.identifier.playableId)),this._hydrateDzPlayerTracks("episodes",n.filter(e=>e.identifier.type===Bp().com.deezer.kmp.player.models.PlayableType.PODCAST_EPISODE).map(e=>e.identifier.playableId)),this._hydrateDzPlayerTracks("lives",n.filter(e=>e.identifier.type===Bp().com.deezer.kmp.player.models.PlayableType.LIVESTREAM).map(e=>e.identifier.playableId))]).then(([e,a,i])=>{const r=[];return n.map(n=>{const{itemContext:{contextContainer:s,contextId:o,contextType:l}}=n,c={CONTEXT_ID:s||void 0,ID:o,TYPE:l};let d=r.findIndex(e=>(0,zp.A)(e,c));switch(d<0&&(d=r.push(c)-1),n.identifier.type){case Bp().com.deezer.kmp.player.models.PlayableType.TRACK:return{data:e.find(({SNG_ID:e})=>e.toString()===n.identifier.playableId),context:r[d]};case Bp().com.deezer.kmp.player.models.PlayableType.PODCAST_EPISODE:return{data:a.find(({EPISODE_ID:e})=>e.toString()===n.identifier.playableId),context:r[d]};case Bp().com.deezer.kmp.player.models.PlayableType.LIVESTREAM:return{data:i.find(({LIVESTREAM_ID:e})=>e.toString()===n.identifier.playableId),context:r[d]};default:t=!0}})});return t?a.filter(Boolean):a}function im(e){return Bp().com.deezer.kmp.mp.copyToMPList(e.map(e=>Bp().com.deezer.kmp.queuesync.models.DzAppQueueItem.withDefaults(new(Bp().com.deezer.kmp.player.models.PlayableIdentifier)(e.type in Hp?Hp[e.type]:Hp[je.zu.SONG],e.id),new(Bp().com.deezer.kmp.queuesync.models.DzAppStreamContext)(e.context.ID.toString(),e.context.TYPE,e.context.CONTEXT_ID||null,Gp[(0,T.A)(this,Yp)[Yp].getPlayerType()]||Bp().com.deezer.kmp.player.models.ListenType.MOD))))}var rm=(0,C.A)("topic"),sm=(0,C.A)("realtimeStateEmitter"),om=(0,C.A)("messageReceivedEmitter"),lm=(0,C.A)("onCBQLMessage");class cm{constructor(e){Object.defineProperty(this,rm,{writable:!0,value:void 0}),Object.defineProperty(this,sm,{writable:!0,value:new(Bp().com.deezer.kmp.mp.async.MPStateFlowEmitter)(Bp().com.deezer.kmp.queuesync.api.realtime.QueueSyncRealtimeClientState.Stopped)}),this.realtimeState=(0,T.A)(this,sm)[sm].flow(),Object.defineProperty(this,om,{writable:!0,value:new(Bp().com.deezer.kmp.mp.async.MPStateFlowEmitter)("")}),this.jsonMessageReceived=(0,T.A)(this,om)[om].flow(),Object.defineProperty(this,lm,{writable:!0,value:(e,[t])=>{(0,T.A)(this,om)[om].emit(JSON.stringify(t))}}),(0,T.A)(this,rm)[rm]=`${e}_${e}_${Bp().com.deezer.kmp.queuesync.api.realtime.QUEUESYNC_RELIVE_CHANNEL_NAME}`,f.A.addChannel((0,T.A)(this,rm)[rm]),f.A.connected?(0,T.A)(this,sm)[sm].emit(Bp().com.deezer.kmp.queuesync.api.realtime.QueueSyncRealtimeClientState.Connected):((0,T.A)(this,sm)[sm].emit(Bp().com.deezer.kmp.queuesync.api.realtime.QueueSyncRealtimeClientState.Connecting),E.A.subscribe(E.A.live.connected,()=>{(0,T.A)(this,sm)[sm].emit(Bp().com.deezer.kmp.queuesync.api.realtime.QueueSyncRealtimeClientState.Connected)})),E.A.subscribe(E.A.live.cbql,(0,T.A)(this,lm)[lm])}dispatchRealtimeAction(e){if(e===Bp().com.deezer.kmp.queuesync.api.realtime.QueueSyncRealtimeAction.Stop)return f.A.deleteChannel((0,T.A)(this,rm)[rm]),void(0,T.A)(this,sm)[sm].emit(Bp().com.deezer.kmp.queuesync.api.realtime.QueueSyncRealtimeClientState.Stopped);e===Bp().com.deezer.kmp.queuesync.api.realtime.QueueSyncRealtimeAction.Start&&(f.A.addChannel((0,T.A)(this,rm)[rm]),(0,T.A)(this,sm)[sm].emit(Bp().com.deezer.kmp.queuesync.api.realtime.QueueSyncRealtimeClientState.Connected)),e instanceof Bp().com.deezer.kmp.queuesync.api.realtime.QueueSyncRealtimeAction.SendMessage&&f.A.publish((0,T.A)(this,rm)[rm],JSON.parse(e.jsonPayload))}}var dm=n("WHSZ"),um=n("63mb"),pm=n("bmsN");const mm=Bp().com.deezer.kmp.time.api.sharedServerTimeProvider({get currentTimeMillis(){return Bp().com.deezer.kmp.mp.toMPLong(pm.P6.now())}});var hm=n("h4AR");const gm=(0,P.L)("","",{}),ym=(new(Bp().com.deezer.kmp.recserializer.RecSerializerFactory)).create(new class{dispatchPayload(e){I.A.log(JSON.parse(e))}provideClientData(){return new(Bp().com.deezer.kmp.recserializer.model.common.ClientData)(new(Bp().com.deezer.kmp.recserializer.model.common.Platform)(new(Bp().com.deezer.kmp.recserializer.model.common.PlatformApp)(gm.platform.app.name.toLowerCase(),gm.platform.app.version,gm.platform.app.stack===hm.T.Web?Bp().com.deezer.kmp.recserializer.model.common.PlatformApp.Stack.WEB:Bp().com.deezer.kmp.recserializer.model.common.PlatformApp.Stack.ELECTRON,gm.platform.app.family===hm.S.Desktop?Bp().com.deezer.kmp.recserializer.model.common.PlatformApp.Family.DESKTOP:gm.platform.app.family===hm.S.Mobile?Bp().com.deezer.kmp.recserializer.model.common.PlatformApp.Family.MOBILE:Bp().com.deezer.kmp.recserializer.model.common.PlatformApp.Family.TABLET,null,null,null),null,new(Bp().com.deezer.kmp.recserializer.model.common.PlatformOs)(gm.platform.os.name,gm.platform.os.version),new(Bp().com.deezer.kmp.recserializer.model.common.PlatformBrowser)(gm.platform.browser.name,gm.platform.browser.version)),new(Bp().com.deezer.kmp.recserializer.model.common.RecNetwork)(Bp().com.deezer.kmp.recserializer.model.common.RecNetwork.NetworkType.LAN,Bp().com.deezer.kmp.recserializer.model.common.RecNetwork.NetworkSubType.ETHERNET),pm.It.get().user_id,pm.It.get().offer_id,Yl.A.get(),null)}},mm,gm["correlation-id"]);var Am=(0,C.A)("userID"),Em=(0,C.A)("queueSynchronizer");class _m{constructor(e,t,n,a=!1){Object.defineProperty(this,Am,{writable:!0,value:void 0}),Object.defineProperty(this,Em,{writable:!0,value:void 0}),(0,T.A)(this,Am)[Am]=n,(0,T.A)(this,Em)[Em]=(new(Bp().com.deezer.kmp.queuesync.DzQueueSynchronizerFactory)).create(um.F,mm,Bp().com.deezer.kmp.queuesync.api.sharedDzAppPlayer(e),Bp().com.deezer.kmp.queuesync.api.realtime.sharedQueueSyncRealtimeClient(t),dm.x,ym),a&&Bp().com.deezer.kmp.helper.Logger_setLogWriter(Bp().com.deezer.kmp.helper.sharedLogWriter(console))}set enable(e){e?(0,T.A)(this,Em)[Em].dispatchAction(new(Bp().com.deezer.kmp.queuesync.api.QueueSyncAction.Start)((0,T.A)(this,Am)[Am])):(0,T.A)(this,Em)[Em].dispatchAction(Bp().com.deezer.kmp.queuesync.api.QueueSyncAction.Stop)}}var fm=n("c33K");let bm=function(e){return e[e.DEFAULT=0]="DEFAULT",e[e.ALBUM=1]="ALBUM",e[e.ARTIST=2]="ARTIST",e[e.CHARTS=3]="CHARTS",e[e.FAMILY=4]="FAMILY",e[e.GENRE=5]="GENRE",e[e.HISTORY=6]="HISTORY",e[e.PLAYLIST=7]="PLAYLIST",e[e.SEARCH=8]="SEARCH",e[e.SONG=9]="SONG",e[e.USER=10]="USER",e[e.OFFLINE=11]="OFFLINE",e}({}),vm=function(e){return e[e.DEFAULT=0]="DEFAULT",e[e.ARTIST=1]="ARTIST",e}({}),km=function(e){return e[e.DEFAULT=0]="DEFAULT",e[e.ALBUM=1]="ALBUM",e[e.LIVE=3]="LIVE",e[e.MIX=4]="MIX",e[e.PERSONAL=5]="PERSONAL",e[e.PLAYLIST=6]="PLAYLIST",e[e.PODCAST=7]="PODCAST",e[e.RECOMMENDED=8]="RECOMMENDED",e[e.SHUFFLE_MY_MUSIC=9]="SHUFFLE_MY_MUSIC",e[e.SMART_TRACKLIST=10]="SMART_TRACKLIST",e[e.TOP_TRACKS=11]="TOP_TRACKS",e}({}),Tm=function(e){return e[e.SONG=0]="SONG",e[e.EPISODE=2]="EPISODE",e[e.LIVE=3]="LIVE",e}({}),Cm=function(e){return e[e.NONE=0]="NONE",e[e.ALL=1]="ALL",e[e.ONE=2]="ONE",e}({});class wm extends fm.G{constructor(){super("IndexChanged",[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"index",kind:"scalar",T:13},{no:3,name:"timestamp",kind:"scalar",T:4,L:2}])}}const Sm=new wm;class xm extends fm.G{constructor(){super("ListChanged",[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"contexts",kind:"message",repeat:2,T:()=>Rm},{no:3,name:"tracks",kind:"message",repeat:2,T:()=>qm},{no:4,name:"tracks_order",kind:"scalar",localName:"tracks_order",repeat:1,T:13},{no:5,name:"shuffled",kind:"scalar",T:8},{no:6,name:"timestamp",kind:"scalar",T:4,L:2}])}}const Im=new xm;class Pm extends fm.G{constructor(){super("ListChanged.Context",[{no:1,name:"container",kind:"message",T:()=>Nm},{no:2,name:"log",kind:"message",T:()=>Fm}])}}const Rm=new Pm;class Lm extends fm.G{constructor(){super("ListChanged.Context.Container",[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:()=>["ListChanged.Context.Container.ContainerType",km]},{no:3,name:"mix",kind:"message",oneof:"extra",T:()=>Dm},{no:4,name:"smart_tracklist_method",kind:"scalar",localName:"smart_tracklist_method",oneof:"extra",T:9},{no:5,name:"topTracks",kind:"message",oneof:"extra",T:()=>Um}])}}const Nm=new Lm;class Om extends fm.G{constructor(){super("ListChanged.Context.Container.Mix",[{no:1,name:"type",kind:"enum",T:()=>["ListChanged.Context.Container.Mix.MixType",bm]}])}}const Dm=new Om;class Mm extends fm.G{constructor(){super("ListChanged.Context.Container.TopTracks",[{no:1,name:"type",kind:"enum",T:()=>["ListChanged.Context.Container.TopTracks.TopTracksType",vm]}])}}const Um=new Mm;class zm extends fm.G{constructor(){super("ListChanged.Context.Log",[{no:1,name:"context_id",kind:"scalar",localName:"context_id",T:9},{no:2,name:"listening_context",kind:"scalar",localName:"listening_context",T:9}])}}const Fm=new zm;class Bm extends fm.G{constructor(){super("ListChanged.Track",[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"context",kind:"scalar",T:13},{no:3,name:"type",kind:"enum",T:()=>["ListChanged.Track.TrackType",Tm]}])}}const qm=new Bm;class Gm extends fm.G{constructor(){super("RepeatChanged",[{no:1,name:"repeat",kind:"enum",T:()=>["RepeatChanged.RepeatMode",Cm]}])}}const Hm=new Gm;var Vm=n("oEcL"),Ym=n("ij5m"),Qm=n("zCrf"),Wm=n("ISNy");let Km;const jm=[Im],$m=new Tp,Xm=new Tp,Jm={paused:!0},Zm={stack:[]};function eh(...e){Zm.console&&window.console.log("[TRIFORCE]",...e),Zm.enabled&&Zm.stack.push(e)}const th={songs:Qm.d0,episodes:Vm.l$,lives:Ym.qS},nh={songs:Wm.KW,episodes:Vm.KN,lives:Ym.b2};function ah(e){const t=[],n=e.music.unshuffledList.map((e,n)=>{const a=$e.Ay.getContextByIndexFromOriginal(n),i={container:{id:a.ID,extra:{}},log:{context_id:a.CONTEXT_ID||"",listening_context:a.TYPE}};let r,s=t.findIndex(e=>(0,zp.A)(e,i));switch(s<0&&(s=t.push(i)-1),$e.Ay.getMediaType(e)){case je.zu.EPISODE:r=Tm.EPISODE;break;case je.zu.LIVE_STREAM:r=Tm.LIVE;break;default:r=Tm.SONG}return{context:s,id:String(e[$e.Ay.getMediaId(e)]),type:r}}),a=[],i=e.music.list.map((t,n)=>{let i=0;const r=$e.Ay.getContextByIndex(n),s=t[$e.Ay.getMediaId(t)],o=e.music.unshuffledList.filter(e=>e[$e.Ay.getMediaId(e)]===t[$e.Ay.getMediaId(t)]).filter(t=>(0,zp.A)(r,$e.Ay.getContextByIndexFromOriginal(e.music.unshuffledList.indexOf(t))));return o.length>1&&(i=a.filter(e=>s===e).length,a.push(s)),e.music.unshuffledList.indexOf(o[i])});t.forEach(({container:e,log:{listening_context:t,context_id:n=""}})=>{if(/album(?!_similar)|artist_discography/i.test(t))e.type=km.ALBUM;else if(/livestream/.test(t))e.type=km.LIVE;else if(/personal/.test(t))e.type=km.PERSONAL;else if(/playlist(?!_radio)/.test(t))e.type=km.PLAYLIST;else if(/show/.test(t))e.type=km.PODCAST;else if("up_next_artist"===t)e.type=km.RECOMMENDED;else if(/^shuffled/.test(t))e.type=km.SHUFFLE_MY_MUSIC;else if(/smarttracklist/.test(t)){const t=n.split(",").filter(e=>e.startsWith("card_name")).map(e=>e.split("=")[1]).shift()||"";e.type=km.SMART_TRACKLIST,e.extra={oneofKind:"smart_tracklist_method",smart_tracklist_method:t}}else/artist|smartradio/.test(t)?(e.type=km.MIX,e.extra={oneofKind:"mix",mix:{type:bm.ARTIST}}):"history_radio"===t||"playlist_radio"===t?(e.type=km.MIX,e.extra={oneofKind:"mix",mix:{type:bm.HISTORY}}):"search_radio"===t?(e.type=km.MIX,e.extra={oneofKind:"mix",mix:{type:bm.SEARCH}}):/user|flow/.test(t)?(e.type=km.MIX,e.extra={oneofKind:"mix",mix:{type:bm.USER}}):/radio/i.test(t)?(e.type=km.MIX,e.mix={type:bm.DEFAULT}):e.type=km.DEFAULT});const r=!i.reduce((e,t,n)=>e&&t===n,!0);return{contexts:t,id:Jm.id||_p()(),shuffled:r,timestamp:Jm.now(),tracks:n,tracks_order:r?i:[]}}function ih(e,t){const n=atob(e),a=Array.from(n).map(e=>e.charCodeAt(0)),i=a.length&&jm.includes(t)?Up().inflate(new Uint8Array(a)):a;return t.fromBinary(new Uint8Array(i))}function rh(e,t,n={}){const a={PlaybackCurrentIndex:Sm,PlaybackQueueList:Im,PlaybackRepeatMode:Hm};let i;eh(`Enqueueing a task to update ${e} with:`,t),n.defer&&(Jm.retries=(Jm.retries||0)+1,i=Date.now()+Math.round(Math.random()*(Math.pow(2,Jm.retries)-Math.pow(2,Jm.retries-1))*1e3)),Jm.retries>5?eh(`Exceeded 5 retries (${e}), task won't be scheduled`):Xm.add({name:e,timestamp:i,fn:()=>(eh(`Sending to node ${e}:`,t),Dp.singleton.post(e,function(e,t){const n=t.toBinary(e),a=n.length&&jm.includes(t)?Up().deflate(n,7):n;return btoa(String.fromCharCode(...a))}(t,a[e])||null))}).run()}function sh(e){const t=e/($e.Ay.getDuration()||0);return Number.isFinite(t)?t:0}function oh(e){$e.Ay.isPlaying()||$e.Ay.control.play();const t=$e.Ay.getPosition()/($e.Ay.getDuration()||0)+e;t>0&&t<1&&$e.Ay.control.seek(t)}let lh=!1;function ch(e,t){try{var n;navigator.mediaSession.setPositionState({duration:Math.max(null!==(n=$e.Ay.getDuration())&&void 0!==n?n:1/0,0),position:t})}catch(e){}}var uh=n("Z64h");function ph(e,t,n={}){e.dispatch((0,z.S7)(t,n))}const mh=({backgroundColor:e,isLightMode:t})=>({type:Uu.SET_COLOR,backgroundColor:e,isLightMode:t});var hh=n("nMcH");const gh=new Image;let yh,Ah=28;(0,hh.A)()&&(Ah*=2),(0,xu.I7)(()=>e=>t=>{const n=e(t);return t.type===Iu.xo&&function(){E.A.subscribeOnce(E.A.player.tracklist_changed,()=>E.A.resolve(E.A.player.playerReady)),E.A.subscribeOnce(E.A.player.playerLoaded,()=>{$e.Ay.restoreSetting(x.A.getState().user.USER.SETTING)}),qu.init(),$e.Ay.html5.init();const t=op[x.A.getState().app.currentPage]||Yu,n=["flow","landing"].includes(x.A.getState().app.currentPage),a=d.A.location&&d.A.location.query&&("true"===d.A.location.query.autoplay||"1"===d.A.location.query.autoplay);let i=x.A.getState().user.PLAYLIST_WELCOME_ID;t===tp?i=x.A.getState().user.USER.USER_ID:t===rp&&cp.test(d.A.location.pathname)?i=d.A.location.pathname.replace(cp,"$1"):t!==Yu&&lp.test(d.A.location.pathname)&&(i=d.A.location.pathname.replace(lp,"$1"));let r=_r.default.get("log_contexts")[t];switch(t){case Vu:r="topArtistFull";break;case Ku:case ju:case $u:case Xu:case Ju:r=_r.default.get("log_contexts")[x.A.getState().app.currentPage]}$e.Ay.play({autoplay:n||a,context:{ID:i,TYPE:t},id:i,initializing:!0,sync:!1,type:r,radio:[np,ap,tp].includes(t),callbackTrack(e){if(e.length)return;const t=x.A.getState().user.PLAYLIST_WELCOME_ID,n=Yu;$e.Ay.play({autoplay:!1,context:{ID:t,TYPE:n},id:t,initializing:!0,sync:!1,type:_r.default.get("log_contexts")[n]})}})}(),n},e=>t=>n=>{const a=e.getState().player.control.playing,i=t(n),r=e.getState().player.control.playing,s=e.getState().user.isAuth,o=e.getState().user.id;if(!s)return i;switch(n.type){case Iu.xo:!function(e){const t=`${e}_${e}_STREAM`;f.A.addChannel(t),E.A.subscribe(E.A.live[bp.toLocaleLowerCase()],vp)}(o);break;case Pu.EC:!r||a||$e.Ay.chromecast.isCasting()||function(e){const t=`${e}_${e}_STREAM`,n=String($e.Ay.getCurrentSong($e.Ay.getMediaId())),a={ACTION:"PLAY",APP:bp,VALUE:{USER_ID:String(e),UNIQID:fp,SNG_ID:n}};f.A.publish(t,a)}(o)}return i},e=>t=>n=>{const a=e.getState(),i=t(n),r=e.getState(),s=_.A.isAllowed("kmp_queue_synchronizer"),o=_.A.isAllowed("queue_synchronizer");if(a===r)return i;if(!_.A.isAllowed("triforce_queuelist_messages")&&!o)return i;if(!(0,S.ki)(r.user))return i;if(Jm.now||(Jm.now=s?()=>(0,S.Wk)(r.user):()=>(0,S.mI)(r.user)),Jm.enabled!==(0,S.Qi)(r.user)){const l=void 0===Jm.enabled;if(Jm.enabled=(0,S.Qi)(r.user),!l)if(s)Jm.KMPSynchronizer.enable=Jm.enabled;else if(Jm.enabled){const c=e=>Km[e.node](e);Promise.resolve().then(()=>Dp.singleton.get("PlaybackQueueList").then(c)).then(()=>Dp.singleton.get("PlaybackCurrentIndex").then(c)).then(()=>Dp.singleton.get("PlaybackRepeatMode").then(c))}else $m.clear(),Xm.clear(),delete Jm.id}if("enabled"in Zm||(Zm.enabled=/triforce/i.test(window.location.search),Zm.console=Zm.enabled,Zm.enabled&&(window.triforce={get console(){return Zm.console},set console(e){Zm.console=Boolean(e)},copy:()=>window.copy(Zm.stack),dump:()=>Zm.stack.forEach(e=>window.console.log("[TRIFORCE]",...e))})),n.type===Iu.xo){if(s){if(o){function d(t,n){if(!th[t]||!nh[t])return Promise.resolve();const a=nh[t];return(0,th[t])({ids:n})(e.dispatch,e.getState).then(()=>a(e.getState().entities,n))}const u=(0,S.F6)(r.user);Jm.DzAppPlayerApi=new Zp($e.Ay,d,eh),Jm.KMPSynchronizer=new _m(Jm.DzAppPlayerApi,new cm(u),u),eh("Initializing CBQL"),Jm.KMPSynchronizer.enable=Jm.enabled}return}E.A.subscribe(E.A.player.play,()=>Jm.paused=!1),E.A.subscribe(E.A.player.playing,(e,t)=>Jm.paused=!t),E.A.subscribe(E.A.player.paused,(e,t)=>Jm.paused=!$e.Ay.isPlaying()||Boolean(t)),Km={PlaybackCurrentIndex(t){const n=ih(t.payload,Sm);n&&(eh("Received from PlaybackCurrentIndex node:",n),$m.add({id:n.id,name:"PlaybackCurrentIndex",fn(){if(!$m.prioritize({name:"PlaybackQueueList"})&&!$m.prioritize({id:Jm.id,name:"PlaybackCurrentIndex"})&&!Xm.has({name:"PlaybackQueueList"})){if(!Jm.paused||n.timestamp&&n.timestamp<Jm.timestamp){if(n.id!==Jm.id){eh("Payload id isn't matching with the current one, sending the current state");const t=ah(e.getState().player);return rh("PlaybackQueueList",t,{defer:!0}),void rh("PlaybackCurrentIndex",{id:t.id,index:$e.Ay.getIndexSong(),timestamp:Jm.now()})}return n.index!==$e.Ay.getIndexSong()?(eh("Currently playing, sending the current index"),void rh("PlaybackCurrentIndex",{id:Jm.id,index:$e.Ay.getIndexSong(),timestamp:Jm.now()},{defer:!0})):void eh("Asked to change for the same id, so this is a no-op")}(_.A.isAllowed("triforce_queuelist_ui")||"B"===(r.user.USER.ABTEST.triforce_queuelist_ui||{}).option)&&(delete Jm.retries,eh("Updating the index with:",n.index),$e.Ay.setTriforceIndex(n.index))}}}).run())},PlaybackQueueList(t){const n=ih(t.payload,Im);if(!n)return;if(eh("Received from PlaybackQueueList node:",{...n,tracks:n.tracks.map(e=>({...e}))}),n.id===Jm.id)return void eh("Payload id is matching with the current one, stopping here.");if(!n.tracks.length)return void eh("No tracks found in the payload, stopping here.");const a=n.contexts.map(({container:{id:e},log:{context_id:t,listening_context:n}})=>({CONTEXT_ID:t,ID:e,TYPE:n}));function i(t){if(!th[t]||!nh[t])return Promise.resolve();const i=th[t],r=nh[t],s=Tm[t.substring(0,t.length-1).toUpperCase()]||Tm.SONG,o=n.tracks.filter(e=>e.type===s),l=o.map(e=>e.id);return i({ids:l})(e.dispatch,e.getState).then(()=>{const t=r(e.getState().entities,l);o.forEach((e,i)=>{const r=e.context;Object.keys(e).forEach(t=>delete e[t]),e.context=a[r],e.data={...t[i]},"up_next_artist"===e.context.TYPE&&n.recommended.push(e)})})}n.recommended=[],$m.add({name:"PlaybackQueueList",fn(){if(!$m.prioritize({name:"PlaybackQueueList"}))return Promise.all([i("songs"),i("episodes"),i("lives")]).then(()=>{if($m.prioritize({name:"PlaybackQueueList"}))return;n.tracks=n.tracks.filter(e=>n.recommended.indexOf(e)<0),n.original=[...n.tracks],n.tracks=n.tracks_order.length?n.tracks_order.map(e=>n.tracks[e]):n.tracks;const t={[bm.ARTIST]:"artist",[bm.USER]:"user"};if(n.recommended.length)n.radio="up_next_artist";else{const{container:e}=n.contexts[0];e.type===km.LIVE?n.radio="livestream":e.type===km.MIX&&(n.radio=t[e.extra.mix.type])}if(delete n.contexts,delete n.tracks_order,eh("Hydrated the payload:",n),!Jm.paused||n.timestamp&&n.timestamp<Jm.timestamp){const{CONTEXT_ID:t,ID:a,TYPE:i}=$e.Ay.getContext(),r={CONTEXT_ID:t,ID:String(a),TYPE:i},s=$e.Ay.getMediaId(),o=$e.Ay.getCurrentSong(s),l=n.tracks.filter(e=>(0,zp.A)(e.context,r)).filter(e=>e.data[s]===o);if(eh("Currently playing, searching for the current track"),!l.length){eh("Current track not found, sending the current state");const t=ah(e.getState().player);return rh("PlaybackQueueList",t,{defer:!0}),void rh("PlaybackCurrentIndex",{id:t.id,index:$e.Ay.getIndexSong(),timestamp:Jm.now()})}n.index=n.tracks.indexOf(l[0]),eh("Current track found, sending the index in case of de-sync"),rh("PlaybackCurrentIndex",{id:n.id,index:n.index,timestamp:Jm.now()})}(_.A.isAllowed("triforce_queuelist_ui")||"B"===(r.user.USER.ABTEST.triforce_queuelist_ui||{}).option)&&(delete Jm.retries,Jm.id=n.id,eh("Updating the queuelist"),$e.Ay.setTriforceState(n))})}}).run()},PlaybackRepeatMode(e){const t=null===e.payload?{repeat:0}:ih(e.payload,Hm);eh("Received from PlaybackRepeatMode node:",t),(_.A.isAllowed("triforce_queuelist_ui")||"B"===(r.user.USER.ABTEST.triforce_queuelist_ui||{}).option)&&$e.Ay.control.setRepeat(t?t.repeat:0,{sync:!1})}},Dp.singleton.on("connect",()=>{eh("Socket connected, sending a presence signal"),Xm.clear().resume(),Dp.singleton.presence()}),Dp.singleton.on("disconnect",()=>{eh("Socket disconnected, pausing the outgoing queue"),Xm.pause()}),Dp.singleton.on("message",e=>Jm.enabled&&Km[e.node](e),{node:Object.keys(Km)}),Dp.singleton.connect()}if(!1===n.sync||!Jm.enabled)return i;switch(n.type){case Pu.yd:Jm.timestamp=Jm.now();break;case Pu.f6:a.player.control.repeat!==r.player.control.repeat&&(s?Jm.DzAppPlayerApi.setRepeat(r.player.control.repeat):(delete Jm.retries,rh("PlaybackRepeatMode",{repeat:r.player.control.repeat})));break;case Iu.Qx:if(!(0,zp.A)(a.player.music.list,r.player.music.list)){if(s){const p=function(e){const t=e.music.unshuffledList.map((e,t)=>({context:$e.Ay.getContextByIndexFromOriginal(t),id:String(e[$e.Ay.getMediaId(e)]),type:$e.Ay.getMediaType(e)})),n=[],a=e.music.list.map((t,a)=>{let i=0;const r=$e.Ay.getContextByIndex(a),s=t[$e.Ay.getMediaId(t)],o=e.music.unshuffledList.filter(e=>e[$e.Ay.getMediaId(e)]===t[$e.Ay.getMediaId(t)]).filter(t=>(0,zp.A)(r,$e.Ay.getContextByIndexFromOriginal(e.music.unshuffledList.indexOf(t))));return o.length>1&&(i=n.filter(e=>s===e).length,n.push(s)),e.music.unshuffledList.indexOf(o[i])}),i=!a.reduce((e,t,n)=>e&&t===n,!0);return{shuffled:i,tracks:t,tracks_order:i?a:[]}}(r.player);Jm.DzAppPlayerApi.setTracklist(p,r.player.music.index,r.player.music.context);break}{const m=ah(r.player);delete Jm.retries,Jm.id=m.id=_p()(),rh("PlaybackQueueList",m),rh("PlaybackCurrentIndex",{id:Jm.id,index:r.player.music.index,timestamp:Jm.now()})}}case Iu.gz:if(!(0,zp.A)(a.player.music.track,r.player.music.track)||!(0,zp.A)(a.player.music.context,r.player.music.context))if(s)Jm.DzAppPlayerApi.setTracklistIndex(r.player.music.index);else{if(!Jm.id){const h=ah(r.player);Jm.id=h.id,rh("PlaybackQueueList",h)}rh("PlaybackCurrentIndex",{id:Jm.id,index:r.player.music.index,timestamp:Jm.now()})}}return i},e=>t=>n=>{const a=t(n),i=e.getState();if(n.type===Iu.gz||n.type===Iu.GD){const e=(0,yl.tc)(i),t=(0,yl.KX)(i).map(({ART_NAME:e})=>e).filter(Boolean).join(", "),n=(0,yl.ZQ)(i),a=(0,yl.uY)(i);if(document.title=`${a} - ${t} - Deezer`,"mediaSession"in navigator){const r=(0,gl.vp)(i.user,i.player.music.track);!lh&&navigator.mediaSession.setPositionState&&(E.A.subscribe(E.A.player.position,ch),lh=!0),navigator.mediaSession.metadata=new MediaMetadata({title:a,artist:t,album:e,artwork:r?[]:[{src:n,sizes:"250x250",type:"image/jpeg"}]})}}if("mediaSession"in navigator&&(n.type===Pu.Qx||n.type===Pu.aw)){navigator.mediaSession.setActionHandler("nexttrack",(0,$c.oy)(i)?$e.Ay.control.nextSong:null),navigator.mediaSession.setActionHandler("pause",(0,$c.J2)(i)?$e.Ay.control.pause:null),navigator.mediaSession.setActionHandler("play",(0,$c.v_)(i)?$e.Ay.control.play:null),navigator.mediaSession.setActionHandler("previoustrack",(0,$c.eX)(i)?$e.Ay.control.prevSong:null),navigator.mediaSession.setActionHandler("seekbackward",(0,$c.rt)(i)?({seekOffset:e})=>oh(e?sh(e):-.05):null),navigator.mediaSession.setActionHandler("seekforward",(0,$c.rt)(i)?({seekOffset:e})=>oh(e?sh(e):.05):null);try{navigator.mediaSession.setActionHandler("seekto",(0,$c.rt)(i)?({seekTime:e})=>{const t=e/$e.Ay.getDuration();t>0&&t<1&&$e.Ay.control.seek(t)}:null)}catch(e){}}return a},e=>t=>n=>{const a=t(n),i=e.getState().user;if(n.type===Iu.xo&&(0,S.UJ)(i)&&!(0,S.jQ)(i)&&!(0,S.Dx)(i)&&"US"===(0,S.JJ)(i))return ph(e,ce.cn),a;if(n.type!==Iu.xo||uh.$.HTML5Renderer||ph(e,ce.Iv),n.type!==Pu.EC)return a;if(n.playing){if((0,S.UJ)(i)||$e.Ay.getMediaType()!==je.zu.SONG){if((0,S.UJ)(i)&&!(0,S.jQ)(i)&&e.getState().player.config.playerType===je.Cc.MOD)if((0,S.fn)(i)){if(!(0,S.Dx)(i)){const t=(0,S.ai)(i);"US"===(0,S.JJ)(i)?ph(e,ce.cn):t>0?ph(e,ce.aC,{streamingDuration:t}):ph(e,ce.h5)}}else ph(e,ce.v4)}else e.dispatch((0,F.qf)({name:he.b.AUTH_MODAL,size:"large",props:{context:"catalog-preview"}}));return a}return a},e=>t=>n=>{const a=t(n);if(n.type!==Iu.LK)return a;let i=n.cover;if(i===yh)return a;yh=i;const r=(0,Mu.D8)();return e.dispatch(mh({backgroundColor:r[0],isLightMode:r[1]})),gh.onload=()=>{try{var{color:t}=(0,Mu.xH)(gh);const a=(0,Mu.nr)(t);(0,yl.Cv)(e.getState())===n.cover&&e.dispatch(mh({backgroundColor:a.color[0],isLightMode:a.color[1]}))}catch(e){}},gh.crossOrigin="",gh.src=n.cover.replace("250x250",`${Ah}x${Ah}-000000-80-0-0`),a},e=>t=>n=>{n.type===Iu.xo&&(e=>{gp||(E.A.subscribe(E.A.player.seekCompleted,()=>{yp(e)},"bookmarking_middleware"),E.A.subscribe(E.A.player.paused,(t,n)=>{!0===n&&yp(e)},"bookmarking_middleware"),E.A.subscribe(E.A.player.trackChange,(t,n)=>{yp(e,{id:n.previousTrack.id,type:n.previousTrack.type,offset:n.previousTrack.offset,duration:n.previousTrack.duration})},"bookmarking_middleware"),gp=!0)})(e);const a=t(n);if(n.type!==hp.S.MARK_AS_PLAYED&&n.type!==hp.S.MARK_AS_NOT_PLAYED)return a;const i=$e.Ay.getSongId(),r=$e.Ay.getMediaType();if(!i||!r||!function(e){return{}.hasOwnProperty.call(e,"bookmark")}(n))return a;const s=(0,up.qx)(String(r)),o=n.bookmark;return null===s||o.type===s&&o.id===i&&$e.Ay.control.stop(),a});const Eh=(0,Su.combineReducers)({config:function(e=Du,t={}){let n;switch(t.type){case Iu.xo:case Iu.Qx:case Iu.gz:return{...e,isRadio:$e.Ay.isRadio(),isUpnext:"up_next_artist"===$e.Ay.getContext("TYPE"),isFlow:$e.Ay.helper.isPlayingFlow(),isMyFlow:$e.Ay.helper.isPlayingUserFlow(),playerType:$e.Ay.getPlayerType()};case Ou.MC:return Boolean(t.active)!==e.isBlindTestMode?{...e,isBlindTestMode:Boolean(t.active)}:e;case Ou.Dp:return n=$e.Ay.getPlayerType(),n!==e.playerType?{...e,playerType:n}:e;case Ou.HO:return e.playerFull!==t.active?{...e,playerFull:t.active}:e;case Ou.J:return e.playerQueuelist!==t.active?{...e,playerFull:t.active||e.playerFull,playerQueuelist:t.active,playerLyrics:!t.active&&e.playerFull}:e;case Ou.Kf:return e.playerLyrics!==t.active?{...e,playerFull:t.active||e.playerFull,playerLyrics:t.active}:e;default:return e}},control:function(e=Ru,t={}){switch(t.type){case Iu.xo:case Iu.Qx:case Iu.gz:return{...e,volume:$e.Ay.getVolume(),hasShuffle:(0,$e.S1)(),shuffle:$e.Ay.isShuffle(),hasRepeat:(0,$e.k2)(),repeat:$e.Ay.getRepeat(),mute:$e.Ay.isMuted()};case Pu.Qx:return{...e,hasNext:t.hasNext};case Pu.aw:return{...e,hasPrev:t.hasPrev};case Pu.EC:return t.playing!==e.playing?{...e,playing:t.playing,loading:!1}:e;case Pu.oB:return t.loading!==e.loading?{...e,loading:t.loading}:e;case Pu.yd:return t.paused!==e.paused?{...e,paused:t.paused}:e;case Pu.Iq:return t.volume!==e.volume?{...e,volume:t.volume}:e;case Pu.tU:return{...e,mute:t.mute};case Pu.f6:return{...e,repeat:t.repeat};case Pu.RA:return{...e,shuffle:t.shuffle};case Pu.Ym:return t.buffer!==e.buffer?{...e,buffer:t.buffer}:e;case Pu.vg:return{...e,playing:!1,paused:!1,loading:!1};case Pu.pU:return{...e,normalized:t.normalized};default:return e}},music:yl.Ay,chromecast:function(e=Nu,t={}){switch(t.type){case Iu.xo:return{...Nu,loading:$e.Ay.chromecast.isLoading(),active:$e.Ay.chromecast.isActive(),chunksInfo:$e.Ay.chromecast.getChunksInfo()};case Lu.Kx:return{...e,available:t.status,connecting:!1,active:t.active,chunksInfo:t.chunksInfo};case Lu.tM:return{...e,available:!0,connecting:t.status,casting:!1,chunksInfo:t.chunksInfo};case Lu.qC:return{...e,available:!0,connecting:!1,active:t.active,casting:t.status,chunksInfo:t.chunksInfo};case Lu.iY:return{...e,loading:t.loading,active:t.active,chunksInfo:t.chunksInfo};case Lu.Y0:return{...e,skipLimited:t.skipLimited};default:return e}},ui:(e=zu,t)=>{switch(t.type){case Uu.SET_TONE:return{...e,tone:t.tone};case Uu.SET_COLOR:return{...e,backgroundColor:t.backgroundColor,isLightMode:t.isLightMode};default:return e}}});var bh,vh,kh,Th,Ch,_h=n("3mue"),fh=n("pJNj");const wh=i.lazy(()=>n.e(8314).then(n.bind(n,"OER3")));class Sh extends i.Component{constructor(e){super(e),this.state={fading:!1},this._onFading=this._onFading.bind(this),this._onFinish=this._onFinish.bind(this),this._onTrackChange=this._onTrackChange.bind(this),this._onTrackRecognized=this._onTrackRecognized.bind(this),this._onChangePlayerType=this._onChangePlayerType.bind(this),this._onTracklistChange=this._onTracklistChange.bind(this),this._onToggleFavorite=this._onToggleFavorite.bind(this),this._onPlayingChange=this._onPlayingChange.bind(this),this._onPauseChange=this._onPauseChange.bind(this),this._onTracklistFinish=this._onTracklistFinish.bind(this),this._onLoaded=this._onLoaded.bind(this),this._onTrackDurationChange=this._onTrackDurationChange.bind(this),this._onVolumeChange=this._onVolumeChange.bind(this),this._onToggleMute=this._onToggleMute.bind(this),this._onRepeatChange=this._onRepeatChange.bind(this),this._onSimultaneousAccess=this._onSimultaneousAccess.bind(this),this._onShuffleChange=this._onShuffleChange.bind(this),this._onQualityChange=this._onQualityChange.bind(this),this._onNormalizedChange=this._onNormalizedChange.bind(this),this._setAvailableStatus=this._setAvailableStatus.bind(this),this._setConnectingStatus=this._setConnectingStatus.bind(this),this._setCastingStatus=this._setCastingStatus.bind(this),this._setChromecastActiveState=this._setChromecastActiveState.bind(this)}componentDidMount(){!function(){let e,t=[];const{offer_id:n,user_id:a}=pm.It.get();E.A.subscribe(E.A.player.licenseChanged,(i,{license_country:r})=>{if(e&&e!==r){const i=(0,P.L)("playback.media_request_errors","2.0.0",{error:{type:"OtherError",subtype:"CountryMismatch"},media:{id:"id-of-the-track",type:"song"},apiCalls:t,license:{new:r,old:e},client_ip:Yl.A.get(),offer_id:n,user_id:a});I.A.log(i)}e=r,t=[]}),Rt.A.addEventListener(Rt.Q.CALL_STARTED,({detail:e})=>{t.push({method:new URL(e.url).searchParams.get("method"),params:e.data})})}(),this.props.initPlayer(),E.A.ready(E.A.user.userReady,this._onToggleFavorite),E.A.subscribe(E.A.player.displayCurrentSong,this._onTrackChange,"player"),E.A.subscribe(E.A.player.displayRecognizedTrack,this._onTrackRecognized,"player"),E.A.subscribe(E.A.player.changePlayerType,this._onChangePlayerType,"player"),E.A.subscribe(E.A.player.tracklist_changed,this._onTracklistChange,"player"),E.A.subscribe(E.A.user.addFavorite,this._onToggleFavorite,"player"),E.A.subscribe(E.A.user.deleteFavorite,this._onToggleFavorite,"player"),E.A.subscribe(E.A.player.playing,this._onPlayingChange,"player"),E.A.subscribe(E.A.player.paused,this._onPauseChange,"player"),E.A.subscribe(E.A.player.finishTrackList,this._onTracklistFinish,"player"),E.A.subscribe(E.A.player.pourcentLoaded,this._onLoaded,"player"),E.A.subscribe(E.A.player.duration,this._onTrackDurationChange,"player"),E.A.subscribe(E.A.player.volume_changed,this._onVolumeChange,"player"),E.A.subscribe(E.A.player.mute_changed,this._onToggleMute,"player"),E.A.subscribe(E.A.player.repeat_changed,this._onRepeatChange,"player"),E.A.subscribe(E.A.player.shuffle_changed,this._onShuffleChange,"player"),E.A.subscribeOnce(E.A.player.playerLoaded,()=>{$e.Ay.restoreSetting(this.props.userSetting)}),E.A.subscribe(E.A.player.fading,this._onFading,"player"),E.A.subscribe(E.A.player.finish,this._onFinish,"player"),E.A.subscribe(E.A.live.simultaneousAccess,this._onSimultaneousAccess,"player"),E.A.subscribe(E.A.player.qualityChanged,this._onQualityChange,"player"),E.A.subscribe(E.A.player.normalizedChanged,this._onNormalizedChange,"player"),E.A.subscribe(E.A.player.trackAddNext,this._onTrackAddNext,"player"),E.A.subscribe(E.A.player.trackAddToQueue,this._onTrackAddToQueue,"player"),E.A.subscribe(E.A.chromecast.available,this._setAvailableStatus,"player"),E.A.subscribe(E.A.chromecast.connecting,this._setConnectingStatus,"player"),E.A.subscribe(E.A.chromecast.casting,this._setCastingStatus,"player"),E.A.subscribe(E.A.chromecast.loading,this._setChromecastActiveState,"player")}componentDidUpdate(e){this.props.id!==e.id&&this.props.dispatchHidePopper()}componentWillUnmount(){E.A.unsubscribeAll("player")}render(){const{hasDesktopNotifications:e}=this.props;return i.createElement(de.a,{className:"page-player",id:"page_player","data-testid":"miniplayer_container"},e?bh||(bh=i.createElement(wh,null)):null,i.createElement(Ne.s,{minWidth:"768px",alignItems:"center",backgroundColor:"background.neutral.secondary.default",bottom:"0",borderTopWidth:"1px",borderTopStyle:"solid",borderTopColor:"border.neutral.primary.default",justifyContent:"space-between",height:"var(--layout-player-height)",left:"0",px:"spacing.l",position:"fixed",right:"0",zIndex:"300"},vh||(vh=i.createElement(Jd,null)),kh||(kh=i.createElement(Ud,null)),Th||(Th=i.createElement(Tu,null))),Ch||(Ch=i.createElement(Oc,null)))}_onFading(){this.props.hasAudioAds&&null!==$e.Ay.getAudioAds()||(this.setState({fading:!0}),$e.Ay.control.nextSong(!0))}_onFinish(){this.state.fading||$e.Ay.control.nextSong(!0),this.setState({fading:!1}),this.props.isLogged||this.props.showAlert(ce.mu)}_onTrackChange(e,t,n){this.props.updateTrack(n)}_onTrackRecognized(e,t){t?this.props.updateRecognizedTrack({track:t}):this._onTrackChange()}_onChangePlayerType(){this.props.updatePlayerType()}_onTracklistChange(e,t){this.props.updateTracklist(t),E.A.trigger(E.A.list.deselectAll)}_onToggleFavorite(e,t){(!t||"song"===t.type&&String(t.id)===this.props.id)&&this.props.updateFavorite()}_onPlayingChange(e,t){this.props.setPlaying({playing:t})}_onPauseChange(e,t,n){this.props.setPaused({paused:t,...n})}_onTracklistFinish(){this.props.setTracklistFinished()}_onLoaded(e,t){this.props.setBuffer({buffer:t})}_onTrackDurationChange(e,t){this.props.setTrackDuration({trackDuration:t})}_onVolumeChange(e,t){this.props.setVolume({volume:t/100})}_onToggleMute(e,t){this.props.setMute({mute:t})}_onRepeatChange(e,t,n){this.props.setRepeat({repeat:t,...n})}_onSimultaneousAccess(){const{playing:e,playerType:t,hasEventSimultaneousListening:n,triggerAppCustoEvent:a}=this.props;if(e&&!(0,$e._k)(t)&&!$e.Ay.chromecast.isActive()){if($e.Ay.control.pause(),n&&a(Cu.Sc.SIMULTANEOUS_LISTENING))return;this.props.openModal({name:"PLAYER_LIMITATION"})}}_onShuffleChange(e,t){this.props.setShuffle({shuffle:t}),E.A.trigger(E.A.list.deselectAll)}_onQualityChange(e,t){this.props.setQuality(t)}_onNormalizedChange(e,t){this.props.setNormalized(t)}_onTrackAddNext(e,{notify:t,count:n}){!0===t&&(0,qr.A)({body:(0,oe.WI)("Le titre a bien été ajouté à la file d'attente.","Les titres ont bien été ajoutés à la file d'attente.",{count:n}),status:"success"})}_onTrackAddToQueue(e,{count:t}){(0,qr.A)({body:(0,oe.WI)("Le titre a bien été ajouté à la file d'attente.","Les titres ont bien été ajoutés à la file d'attente.",{count:t}),status:"success"})}_setChromecastActiveState(e,t){this.props.setLoading({loading:t}),this.props.setChromecastActiveState({loading:t,active:$e.Ay.chromecast.isActive(),chunksInfo:$e.Ay.chromecast.getChunksInfo()})}_setAvailableStatus(e,t){this.props.setChromecastAvailableStatus({status:t,active:$e.Ay.chromecast.isActive(),chunksInfo:$e.Ay.chromecast.getChunksInfo()})}_setConnectingStatus(e,t){this.props.setChromecastConnectingStatus({status:t,chunksInfo:$e.Ay.chromecast.getChunksInfo()})}_setCastingStatus(e,t){this.props.setChromecastCastingStatus({status:t,active:$e.Ay.chromecast.isActive(),chunksInfo:$e.Ay.chromecast.getChunksInfo()})}_seek(e,t){e&&(e.preventDefault(),e.stopPropagation()),this.props.canSeek&&(void 0===t&&(t=e.pageX/e.currentTarget.parentNode.offsetWidth),$e.Ay.control.seek(t))}}x.A.addReducers({player:Eh});const xh=(0,r.Ng)(e=>({isLogged:(0,S.UJ)(e.user),id:e.player.music.id,track:e.player.music.track,playing:e.player.control.playing,playerType:e.player.config.playerType,userSetting:e.user.USER.SETTING,hasAudioAds:e.user.USER.OPTIONS.ads_audio,hasEventSimultaneousListening:(0,qs.lm)(e,Cu.Sc.SIMULTANEOUS_LISTENING),hasDesktopNotifications:(0,S.AU)(e.user),canSeek:(0,$c.rt)(e)}),{dispatchHidePopper:$.Lm,initPlayer:yl.kI,setPlaying:_h.Li,setPaused:_h.XP,setLoading:_h.r1,setTracklistFinished:_h.qq,setBuffer:_h.V6,setTrackDuration:yl.WN,setVolume:_h.ls,setRepeat:_h.oD,setShuffle:_h.UD,setMute:_h.YI,setQuality:yl.Up,setNormalized:_h.ej,showAlert:z.S7,updateFavorite:yl.O,updateTrack:yl.FZ,updateRecognizedTrack:yl.NL,updatePlayerType:Gs.pE,updateTracklist:yl.Fh,triggerAppCustoEvent:Bs.sS,openModal:F.qf,setChromecastActiveState:fh.uP,setChromecastAvailableStatus:fh.E9,setChromecastConnectingStatus:fh.F$,setChromecastCastingStatus:fh.ix})(Sh);var Ih=n("WeLa");class Ph extends i.Component{shouldComponentUpdate(e){return!!e.current&&(!this.props.current||Boolean(this.props.current&&e.current.name!==this.props.current.name))}render(){const{current:e}=this.props;return e&&e.value?(e.type===Cu.DP.CUSTO&&(this._custoModal(),(0,Ih.s6)(e.onTriggered||[])),null):null}_custoModal(){const{current:e}=this.props;e&&e.value&&e.type===Cu.DP.CUSTO&&this.props.openModal({name:"CUSTO",props:{custo:e.value,closeModal:()=>{this.props.removeCurrent(),this.props.closeModal()}},size:"medium",addRadius:!0,disableClosingAction:!(0,qs.db)(e)})}}Ph.displayName="AppCusto";const Rh=(0,r.Ng)(({appCusto:{current:e}})=>({current:e}),{openModal:F.qf,closeModal:F.Oo,removeCurrent:Bs.in})(Ph);var Lh=n("9odk");const Nh=({openScreen:e,isOnboardingOpen:t,toRenderWhenNoOnboarding:n,toRenderWhenOnboarding:a})=>{const r=(0,Lh.AP)();return i.useEffect(()=>{null!=r&&r.shouldBeOnboarded&&!t&&e({name:X.F.ONBOARDING,data:{showGenreFilter:!0}})},[t,r,e]),r&&!1===r.shouldBeOnboarded?n:a};Nh.defaultProps={toRenderWhenNoOnboarding:null,toRenderWhenOnboarding:null};const Oh=(0,r.Ng)(({user:{id:e},fullscreen:{name:t}})=>({currentUserId:e,isOnboardingOpen:t===X.F.ONBOARDING}),{openScreen:U.J2,closeScreen:U.Fn})(Nh);class Dh extends i.Component{render(){const{darkModeOn:e}=this.props;return e===(0,on.iE)()||(e?(0,on.S8)():(0,on.qv)()),null}}const Mh=(0,r.Ng)(e=>({darkModeOn:(0,S.NF)(e.user)}))(Dh);var Uh=n("imBb"),zh=n.n(Uh);const Bh="igbv2",Yh="qQd6L",Qh="X8ULE",Kh=({label:e,displaySize:t,shortcut:n})=>{if(!e)return null;const a="wide"!==t?null==n?void 0:n.split(","):[n],r=(0,s.A)("cZzQk",{[Qh]:"wide"===t,[Yh]:"wide"!==t&&1===(null==a?void 0:a.length)});return i.createElement("div",{className:"pr654"},null==a?void 0:a.map((e,t)=>{if(!e)return null;const n=t;return i.createElement("div",{className:r,key:"shortcut"+n},e)}),i.createElement("div",{className:"zt_Lq"},e))};var jh=n("TYt9"),$h=n("fJgm");const Xh=e=>{e>0&&e<1&&$e.Ay.control.seek(e)},Jh=()=>{Xh(1e-4)},Zh=e=>{e.preventDefault(),$e.Ay.isPlaying()||$e.Ay.control.play();const t=($e.Ay.getPosition()/($e.Ay.getDuration()||1)-.05).toFixed(3);Xh(Number(t))},eg=e=>{e.preventDefault(),$e.Ay.isPlaying()||$e.Ay.control.play();const t=($e.Ay.getPosition()/($e.Ay.getDuration()||1)+.05).toFixed(3);Xh(Number(t))},tg=(e,t)=>{let n=parseFloat(t||"0")/10;return 0===n&&(n=1e-5),Xh(n)},ng=()=>{let e=Number(($e.Ay.getVolume()-.1).toFixed(2));e=Math.max(0,e),0!==e||$e.Ay.isMuted()||$e.Ay.control.mute(),$e.Ay.control.setVolume(e)},ag=()=>{let e=Number(($e.Ay.getVolume()+.1).toFixed(2));e=Math.min(1,e),$e.Ay.control.setVolume(e)},ig=()=>{$e.Ay.control.mute(!$e.Ay.isMuted())},rg=(0,fe.A)(()=>{$e.Ay.control.nextSong()},100),sg=(0,fe.A)(()=>{$e.Ay.control.prevSong()},100),og=e=>{"preventDefault"in e&&e.preventDefault(),od.A.intent("play"),E.A.trigger("EVENT.TRACKLIST.togglePlayAll")},lg=e=>{"preventDefault"in e&&e.preventDefault(),$e.Ay.getPlayerType()!==je.Cc.ADS&&$e.Ay.getPlayerType()!==je.Cc.TRITON_AD&&(od.A.intent((0,jh.G)($e.Ay)),$e.Ay.control.togglePause())},cg=()=>{const e=Number($e.Ay.getRepeat());$e.Ay.control.setRepeat(2===e?0:e+1)},dg=()=>{E.A.ready(E.A.user.initialized,()=>{if(-1!==[je.Cc.ADS,je.Cc.LIVESTREAM].indexOf($e.Ay.getPlayerType()))return;if($e.Ay.getMediaType()!==je.zu.SONG)return;const e=$e.Ay.getCurrentSong("SNG_ID"),t=$h.A.isFavorite(Be.Ay.Song,e)?"remove":"add",n=$e.Ay.getContext();$h.A[t]({type:Be.Ay.Song,id:e,context:n})})},ug=e=>{var t;"preventDefault"in e&&e.preventDefault(),null===(t=document.getElementById("topbar-search"))||void 0===t||t.focus()},pg=Hl.A.is("macos")?"alt":"ctrl",mg=()=>{const[e,t]=(0,i.useState)(!1),n=(0,i.useCallback)(()=>{t(!e)},[e]),r=()=>{document.body.classList&&(document.body.classList.add("konami"),setTimeout(()=>{document.body.classList.remove("konami")},1e4))},o=(0,i.useMemo)(()=>[{keys:["0","1","2","3","4","5","6","7","8","9"],callback:tg,options:{label:(0,oe.AP)("Aller à la position"),shortcut:"0...9",displaySize:"wide"}},{keys:"space",callback:lg,options:{label:(0,oe.AP)("Lecture/Pause"),shortcut:(0,oe.AP)("Espace"),displaySize:"wide"}},{keys:"shift+enter",callback:og,options:{label:(0,oe.AP)("Lire les titres présents sur la page"),shortcut:"⇧ ⏎",displaySize:"wide"}},{keys:["s","shift+s"],callback:ug,options:{label:(0,oe.AP)("Rechercher"),shortcut:"S"}},{keys:[`${pg}+left`,"left"],callback:Zh,options:{label:(0,oe.AP)("Reculer"),shortcut:`${pg},←`}},{keys:[`${pg}+right`,"right"],callback:eg,options:{label:(0,oe.AP)("Avancer"),shortcut:`${pg},→`}},{keys:"r",callback:Jh,options:{label:(0,oe.AP)("Rejouer le titre"),shortcut:"R"}},{keys:"shift+left",callback:sg,options:{label:(0,oe.AP)("Lire le titre précédent"),shortcut:"⇧,←",event:"keyup"}},{keys:"shift+right",callback:rg,options:{label:(0,oe.AP)("Lire le titre suivant"),shortcut:"⇧,→",event:"keyup"}},{keys:["m","shift+m"],callback:ig,options:{label:(0,oe.AP)("Silence"),shortcut:"M"}},{keys:"shift+up",callback:ag,options:{label:(0,oe.AP)("Augmenter le volume"),shortcut:"⇧,↑"}},{keys:"shift+down",callback:ng,options:{label:(0,oe.AP)("Baisser le volume"),shortcut:"⇧,↓"}},{keys:["l","shift+l"],callback:dg,options:{label:(0,oe.AP)("Ajouter le titre aux Coups de cœur"),shortcut:"L"}},{keys:"shift+r",callback:cg,options:{label:(0,oe.AP)("Mode de répétition"),shortcut:"⇧,R"}},{keys:["h","shift+h","?"],callback:n,options:{label:(0,oe.AP)("Afficher les raccourcis clavier"),shortcut:"H / ?",displaySize:"wide",event:"keypress"}},{keys:"up up down down left right left right b a enter",callback:r}],[n]);(0,i.useEffect)(()=>(o.forEach(e=>(({keys:e,callback:t,options:n})=>{const a=(null==n?void 0:n.event)||"keydown";zh().bind(e,t,a)})(e)),()=>{o.forEach(e=>zh().unbind(e.keys))}),[o]);const l=(0,s.A)("h3wew",{[Bh]:e});return i.createElement("div",{className:l,"aria-hidden":!e,"data-testid":"hotkey-panel"},i.createElement("div",{className:"KGl0e"}),i.createElement("div",{className:"vBn6X"},o.map(e=>i.createElement(Kh,(0,a.A)({key:e.keys.toString()},e.options)))))};n("Dk60");class hg{constructor(e,t,n,a=void 0){this.userId=void 0,this.name=void 0,this.to=void 0,this.event=void 0,this.channel=void 0,this.eventHandler=void 0,this.listeners=void 0,this._connected=!1,this.event=e,this.userId=t,this.name=n,this.to=a,this.channel=[this.userId,this.userId,this.event.toUpperCase()].join("_"),this.listeners=[]}connect(){if(!0!==this._connected){if(this.event in E.A.live==0)throw new Error(`Unknown event ${this.event}: you should specify an event from Events.live`);f.A.addChannel(this.channel),this.eventHandler=this.onMessage.bind(this),E.A.subscribe(E.A.live[this.event],this.eventHandler),this._connected=!0}}disconnect(){!1!==this._connected&&(f.A.deleteChannel(this.channel),E.A.unsubscribe(E.A.live[this.event],this.eventHandler),this._connected=!1,this.listeners=[])}get connected(){return this._connected}onMessage(e,t){if(!1===this._connected)return;const{body:n,headers:a}=t[0];if("string"!=typeof n)throw new Error("No string body property on message");if("object"!=typeof a)throw new Error("No headers on message");const{destination:i,from:r}=a;if(void 0===r)throw new Error("No sender defined");r!==this.name&&(i&&i!==this.name||this.to&&r!==this.to||this.listeners.forEach(e=>e(n)))}publish(e,t){if(!this._connected)return Promise.reject(new Error("Not connected"));if(void 0!==this.to&&void 0!==t&&t!==this.to)return Promise.reject(new Error("Cannot publish to another peer that the one we connected to"));const n={from:this.name};void 0!==this.to&&(n.destination=this.to),void 0!==t&&(n.destination=t);const a={APP:this.event.toUpperCase(),headers:n,body:e};return f.A.publish(this.channel,a),Promise.resolve()}addListener(e){this.listeners.push(e)}removeListener(e){this.listeners=this.listeners.filter(t=>t!==e)}}var gg=n("8cVe");function yg(e,t){const n=JSON.parse(e);if("string"!=typeof n.messageType)throw new Error('No string property "messageType" on message');if("string"!=typeof n.messageId||""===n.messageId)throw new Error('No string property "messageId" on message');if("string"!=typeof n.payload)throw new Error('No string property "payload" on message');if("string"!=typeof n.protocolVersion)throw new Error('No string property "protocolVersion" on message');const a=t[n.messageType];if(void 0===a)throw new Error(`Unknow message type ${n.messageType}`);return a(n)}function Ag(e){return({messageId:t,payload:n})=>{const a=""===n?{}:JSON.parse((0,gg.D4)(n));return new e({messageId:t,...a})}}function Eg(e){return JSON.stringify({messageId:e.messageId,messageType:e.messageType,protocolVersion:e.protocolVersion,clock:e.clock,payload:e.payloadString()})}class _g{constructor({messageType:e,messageId:t=_p()(),clock:n={}}){this.messageId=void 0,this.messageType=void 0,this.protocolVersion="com.deezer.remote.discovery.proto1",this.clock={},this.messageId=t,this.messageType=e,this.clock=n}payloadString(){const e=this.payloadJSON();return 0===Object.getOwnPropertyNames(e).length?"":(0,gg.lF)(JSON.stringify(e))}}class fg extends _g{constructor({from:e,params:t,messageId:n}){if(super({messageType:"connectionOffer",messageId:n}),this.from=void 0,this.params=void 0,"string"!=typeof e)throw new Error('"from" should be a string');this.from=e,this.params=t}payloadJSON(){return{from:this.from,params:this.params}}}class bg extends _g{constructor({from:e,params:t,messageId:n}){if(super({messageType:"connect",messageId:n}),this.from=void 0,this.params=void 0,"string"!=typeof e)throw new Error('"from" should be a string');this.from=e,this.params=t}payloadJSON(){return{from:this.from,params:this.params}}}class vg extends _g{constructor({from:e,params:t,messageId:n}){if(super({messageId:n,messageType:"discoveryRequest"}),this.from=void 0,this.params=void 0,"string"!=typeof e)throw new Error('"from" should be a string');this.from=e,this.params=t}payloadJSON(){return{from:this.from,params:this.params}}}var kg=n("xNxK"),Tg=n("mEUi");class Cg extends Tg.Ay{}class wg extends Error{constructor(e){super(e),this.name="Stopped"}}class Sg{constructor(){this.internalCache=new Map,this.waiting=new Map}clear(){this.waiting.forEach(({reject:e})=>{e(new u.MU)}),this.waiting.clear(),this.internalCache.clear()}cache(e){this.internalCache.set(e.id,e);const t=this.waiting.get(e.id);if(void 0===t)return;const{resolve:n}=t;this.waiting.delete(e.id),n(e)}get(e,t){return(0,kg.h)(new Promise((t,n)=>{const a=this.internalCache.get(e);void 0===a?this.waiting.set(e,{resolve:t,reject:n}):t(a)}),t).finally(()=>this.waiting.delete(e))}}class xg{constructor({messageType:e,messageId:t=_p()(),clock:n={}}){this.messageId=void 0,this.messageType=void 0,this.protocolVersion="com.deezer.remote.queue.proto1",this.clock={},this.messageId=t,this.messageType=e,this.clock=n}}class Ig extends xg{constructor({queue:e,messageId:t}){super({messageType:"publishQueue",messageId:t}),this.queue=void 0,this.queue=e}payloadString(){return function(e){const t=Im.toBinary(e),n=t.length>0?Up().deflate(t,7):t;return btoa(String.fromCharCode(...n))}(this.queue)}}function Pg({messageId:e,payload:t}){const n=function(e){if("string"!=typeof e)return;const t=atob(e),n=Array.from(t).map(e=>e.charCodeAt(0)),a=Up().inflate(new Uint8Array(n));return Im.fromBinary(new Uint8Array(a))}(t);if(!n)throw new Error("Could not decode received queue");return new Ig({messageId:e,queue:n})}class Rg extends xg{constructor({messageId:e}){super({messageType:"refreshQueue",messageId:e})}payloadString(){return""}}class Lg extends Cg{constructor(e,t,n){super(),this.conn=void 0,this.cache=new Sg,this.closed=!1,this.onQueueNeedsRefresh=void 0,this.conn=new hg("remotequeue",e,t,n),this.conn.addListener(e=>this.didReceiveMessage(e))}connect(){this.conn.connect()}disconnect(){this.conn.disconnect()}queueWithId(e,t){return!0===this.closed?Promise.reject(new wg):this.cache.get(e,t)}publishQueue(e){var t;const n=Eg(new Ig({queue:e}));return this.dispatchEvent(new CustomEvent("sendqueue",{detail:{content:n,containerType:(null===(t=e.contexts[0])||void 0===t||null===(t=t.container)||void 0===t?void 0:t.type)||0}})),this.conn.publish(n)}stop(){this.disconnect(),this.cache.clear(),this.onQueueNeedsRefresh=void 0,this.closed=!0}didReceiveMessage(e){const t=yg(e,{refreshQueue:Ag(Rg),publishQueue:Pg});switch(t.messageType){case"publishQueue":return this.cache.cache(t.queue);case"refreshQueue":return this.onQueueNeedsRefresh&&this.onQueueNeedsRefresh();default:throw new Error("Unknow message type "+t.messageType)}}}class Ng extends Tg.Ay{}class Og extends Error{constructor(e,t){super(t),this.code=void 0,this.code=e}}class Dg{constructor({messageType:e,messageId:t=_p()(),clock:n={}}){this.messageId=void 0,this.messageType=void 0,this.protocolVersion="com.deezer.remote.command.proto1",this.clock={},this.messageId=t,this.messageType=e,this.clock=n}payloadString(){const e=this.payloadJSON();return 0===Object.getOwnPropertyNames(e).length?"":(0,gg.lF)(JSON.stringify(e))}}class Mg extends Dg{constructor({acknowledgementId:e,messageId:t}){if(super({messageType:"ack",messageId:t}),this.acknowledgementId=void 0,"string"!=typeof e)throw new TypeError("Parse Error, no acknowledgementId");this.acknowledgementId=e}payloadJSON(){return{acknowledgementId:this.acknowledgementId}}}class Ug extends Dg{constructor({messageId:e}={}){super({messageType:"ready",messageId:e})}payloadJSON(){return{}}}class zg extends Dg{constructor({queueId:e,elementId:t,progress:n,buffered:a,duration:i,quality:r,isPlaying:s,isShuffle:o,repeatMode:l,volume:c,messageId:d}){super({messageType:"playbackProgress",messageId:d}),this.queueId=void 0,this.elementId=void 0,this.progress=void 0,this.buffered=void 0,this.duration=void 0,this.quality=void 0,this.volume=void 0,this.isPlaying=void 0,this.isShuffle=void 0,this.repeatMode=void 0,this.queueId=e,this.elementId=t,this.progress=n,this.buffered=a,this.duration=i,this.quality=r,this.isPlaying=s,this.isShuffle=o,this.repeatMode=l,this.volume=c}payloadJSON(){return{queueId:this.queueId,elementId:this.elementId,progress:this.progress,buffered:this.buffered,duration:this.duration,quality:this.quality,volume:this.volume,isPlaying:this.isPlaying,isShuffle:this.isShuffle,repeatMode:this.repeatMode}}}class Fg extends Dg{constructor({queueId:e,elementId:t,progress:n,shouldPlay:a,setShuffle:i,setRepeatMode:r,setVolume:s,messageId:o}){super({messageType:"skip",messageId:o}),this.queueId=void 0,this.elementId=void 0,this.progress=void 0,this.shouldPlay=void 0,this.setShuffle=void 0,this.setRepeatMode=void 0,this.setVolume=void 0,this.queueId=e,this.elementId=t,this.progress=n,this.shouldPlay=a,this.setRepeatMode=r,this.setShuffle=i,this.setVolume=s}payloadJSON(){return{queueId:this.queueId,elementId:this.elementId,progress:this.progress,shouldPlay:this.shouldPlay,setShuffle:this.setShuffle,setRepeatMode:this.setRepeatMode,setVolume:this.setVolume}}}class Bg extends Dg{constructor({messageId:e}){super({messageType:"ping",messageId:e})}payloadJSON(){return{}}}class qg extends Dg{constructor({messageId:e}){super({messageType:"close",messageId:e})}payloadJSON(){return{}}}class Gg extends Dg{constructor({messageId:e}){super({messageType:"stop",messageId:e})}payloadJSON(){return{}}}class Hg extends Dg{constructor({commandId:e,status:t,messageId:n}){if(super({messageType:"status",messageId:n}),this.commandId=void 0,this.status=void 0,"string"!=typeof e)throw new TypeError("Parse Error, no commandId");if("number"!=typeof t&&void 0!==t)throw new TypeError("Parse Error, no status");this.commandId=e,this.status=t}payloadJSON(){return{commandId:this.commandId,status:this.status}}}class Vg extends Ng{constructor(e,t,n){super(),this.conn=void 0,this.remotePromises=void 0,this.commandHandler=void 0,this.stopWatchDog=()=>{},this.conn=new hg("remotecommand",e,t,n),this.remotePromises=new Map}connect(e,t){this.stopWatchDog=function(e,t,n){let a,i=!1;function r(){clearTimeout(a)}function s(e=!1){i||(a=window.setTimeout(()=>{if(!e)return n.onInactive(),void s(!0);n.onLost()},Math.floor(5e3+1e3*Math.random())))}function o(){r(),s()}return s(),e.addListener(o),()=>{i=!0,e.removeListener(o),r()}}(this.conn,0,{onInactive:()=>this.publish(new Bg({})),onLost:t||(()=>{})}),this.commandHandler=e,this.conn.addListener(e=>this.onMessage(e)),this.conn.connect()}async disconnect(e){!e&&this.conn.connected&&await this.publish(new qg({})),this.commandHandler=void 0,this.conn.disconnect(),this.stopWatchDog(),this.remotePromises=new Map}onCommandStatus(e){const t=this.remotePromises.get(e.commandId);t&&(e.status>0?t.reject(e.status):t.resolve())}onMessage(e){const t=(e=>yg(e,{ack:Ag(Mg),ready:Ag(Ug),playbackProgress:Ag(zg),skip:Ag(Fg),ping:Ag(Bg),close:Ag(qg),stop:Ag(Gg),status:Ag(Hg)}))(e);if(t instanceof Mg){const e=new CustomEvent("msgack",{detail:{id:t.acknowledgementId}});return void this.dispatchEvent(e)}if(t instanceof Hg)return void this.onCommandStatus(t);const n=new Mg({acknowledgementId:t.messageId});if(this.publish(n),!(t instanceof Bg)&&void 0!==this.commandHandler){const e={commandId:t.messageId,status:0};this.commandHandler(t).then(()=>e).catch(n=>(b.A.error(`command ${t.messageType} errored`,n),{...e,status:n instanceof Og?n.code:1})).then(e=>{this.publish(new Hg(e))})}}publish(e,t){const n=Eg(e),a=()=>{const t=new CustomEvent("msgsent",{detail:{id:e.messageId,type:e.messageType}});return this.dispatchEvent(t),this.conn.publish(n)};return void 0===t?a().catch(()=>{}):(0,kg.h)(new Promise((t,n)=>{this.remotePromises.set(e.messageId,{resolve:t,reject:n}),a()}),t).catch(t=>{const n=t instanceof u.MU?"timeout":"error",a={status:n,id:e.messageId,type:e.messageType,code:"error"===n?t:void 0},i=new CustomEvent("msgstatus",{detail:a});this.dispatchEvent(i);const r=`${a.type} failed (reason: ${n}, code: ${a.code})`;throw"timeout"===n?new u.MU(r):Error(r)}).then(()=>{const t=new CustomEvent("msgstatus",{detail:{status:"ok",id:e.messageId,type:e.messageType}});this.dispatchEvent(t)}).finally(()=>{this.remotePromises.delete(e.messageId)})}}class Yg{constructor(e,t){this.userId=void 0,this.conn=void 0,this.discoveryRequestHandler=void 0,this.pendingOffers=new Map,this.seen=new Set,this.userId=e,this.conn=new hg("remotediscover",e,t),this.conn.addListener(e=>this.handleMessage(e))}listen(e){this.discoveryRequestHandler=e,this.conn.connect()}stop(){this.pendingOffers.forEach(({reject:e})=>e(new u.MU)),this.pendingOffers=new Map,this.conn.disconnect()}handleMessage(e){const t=yg(e,{discoveryRequest:Ag(vg),connectionOffer:Ag(fg),connect:Ag(bg)});switch(t.messageType){case"discoveryRequest":this.handleDiscoveryRequest(t);break;case"connect":this.handleConnect(t)}}handleDiscoveryRequest({from:e,params:t}){const{discovery_session:n}=t,a=e+n;if(!0!==this.seen.has(a)&&(this.seen.add(a),this.discoveryRequestHandler)){const n={from:e,params:t,accept:(t={},n=3e4)=>{const a=new fg({from:this.conn.name,params:t}),i=Eg(a);return this.conn.publish(i,e).then(()=>(0,kg.h)(new Promise((e,t)=>{this.pendingOffers.set(a.messageId,{resolve:e,reject:t})}),n).finally(()=>{this.pendingOffers.delete(a.messageId)}))}};this.discoveryRequestHandler(n)}}handleConnect({from:e,params:t}){var n;const a=t.offer_id;if(void 0===a)return;const{resolve:i,reject:r}=null!==(n=this.pendingOffers.get(a))&&void 0!==n?n:{};void 0!==i&&void 0!==r&&i({command:new Vg(this.userId,this.conn.name,e),queue:new Lg(this.userId,this.conn.name,e)})}}function Qg(e,t){if(t)return[e,t.id,t.index].join("-")}var Kg=n("sEfC"),jg=n.n(Kg),$g=n("D/zM");n("W8Tb");class Xg{constructor(e){this._less_eq=void 0,this._count=void 0,this._less_eq=e,this._count=0}get less_eq(){return this._less_eq===1/0?"+Inf":this._less_eq.toString()}add(e){if(!this.test(e))throw new Error(`${e} is out of bound`);this._count++}test(e){return e<=this._less_eq}serialize(){return{count:this._count,less_eq:this.less_eq}}reset(){this._count=0}}const Jg=class{constructor({id:e,buckets:t,tags:n}){if(this._tags=void 0,this._buckets=void 0,this._id=void 0,this._count=void 0,this._sum=void 0,!t.length)throw new Error("Buckets values are mandatory");this._id=e,this._count=0,this._sum=0,this._buckets=[...new Set(t)].sort((e,t)=>e-t).map(e=>new Xg(e)),n&&Object.keys(n).length&&(this._tags=n)}get id(){return this._id}get buckets(){return this._buckets}get count(){return this._count}get sum(){return this._sum}add(e){const t=this._buckets.filter(t=>t.test(e));if(!t.length)throw new Error(`${e} is out of bound`);t.forEach(t=>t.add(e)),this._count++,this._sum+=e}send(){const e={metric:{id:this._id},histogram:{buckets:this._buckets.map(e=>e.serialize()),count:this._count,sum:this._sum}};this._tags&&(e.metric.tags=this._tags),I.A.log((0,P.L)("metrics.histogram","1.0.0",e)),this.reset()}reset(){this._buckets.forEach(e=>e.reset()),this._count=0,this._sum=0}};var Zg=n("+pY+");const ey=e=>{const t={},n=({detail:e})=>{const n=`${e.type}${e.status}${e.code||""}`;t[n]=t[n]||new $g.A({id:Zg.Ps.REMOTE_COMMAND_STATUS,tags:{command_type:e.type,status:e.status,errorCode:e.code}}),t[n].increment(1)};return e.addEventListener("msgstatus",n),{stop:()=>e.removeEventListener("msgstatus",n),flush:()=>{Object.values(t).filter(e=>e.value>0).forEach(e=>e.send())}}},ty=e=>{const t={},n=({detail:e})=>{t[e.type]=t[e.type]||new $g.A({id:Zg.Ps.REMOTE_COMMAND_TYPE,tags:{command_type:e.type}}),t[e.type].increment(1)};return e.addEventListener("msgsent",n),{stop:()=>e.removeEventListener("msgsent",n),flush:()=>{Object.values(t).filter(e=>e.value>0).forEach(e=>e.send())}}},ny=(e,t)=>{const n={},a=new Jg({id:Zg.xK.REMOTE_BUS_LATENCY,buckets:[100,500,1e3,3e3,1/0],tags:{country_code:t}}),i=({detail:e})=>{"ack"!==e.type&&(n[e.id]=Date.now())},r=e=>{const{id:t}=e.detail;if(t in n){const e=Date.now()-n[t];a.add(e),delete n[t]}};return e.addEventListener("msgsent",i),e.addEventListener("msgack",r),{stop:()=>{e.removeEventListener("msgsent",i),e.removeEventListener("msgack",r)},flush:()=>a.send()}},ay=(e,t)=>{const n=[ey,ty,ny].map(n=>n(e,t)),a=setInterval(()=>{n.forEach(e=>e.flush())},3e4);return{stop:()=>{n.forEach(e=>e.stop()),clearInterval(a)},flush:j.A}},iy=new Map([[0,"DEFAULT"],[1,"ALBUM"],[3,"LIVE"],[4,"MIX"],[5,"PERSONAL"],[6,"PLAYLIST"],[7,"PODCAST"],[8,"RECOMMENDED"],[9,"SHUFFLE_MY_MUSIC"],[10,"SMART_TRACKLIST"],[11,"TOP_TRACKS"],[-1,"UNRECOGNIZED"]]);function ry(e){const t=({detail:e})=>{((e,t)=>{const n=new Jg({id:Zg.xK.REMOTE_QUEUE_SIZE,buckets:[1e3,1e5,5e5,1e6,1/0],tags:{queue_type:null!=t?t:"UNRECOGNIZED"}});n.add(e),n.send()})(new Blob([e.content]).size,iy.get(e.containerType))};return e.addEventListener("sendqueue",t),{stop:()=>{e.removeEventListener("sendqueue",t)}}}class sy{constructor(e,t,n,a,i){this.commandConnection=void 0,this.queueConnection=void 0,this.eventGroup=void 0,this.player=void 0,this.countryCode=void 0,this.trackers=[],this.playRequestHandler=void 0,this.playerEventsBound=!1,this.enableTracking=void 0,this.player=e,this.queueConnection=n,this.commandConnection=t,this.eventGroup=_p()(),this.countryCode=a,this.enableTracking=i}set onPlayRequested(e){this.playRequestHandler=e}connect(e){this.trackers=this.enableTracking?[ry(this.queueConnection),ay(this.commandConnection,this.countryCode)]:[],this.queueConnection.connect(),this.commandConnection.connect(this.onCommand.bind(this),e),this.queueConnection.onQueueNeedsRefresh=()=>{this.publishQueue(this.player.getQueue()||this.player.generateQueue())};let t=0;const n=()=>{this.commandConnection.publish(new Ug,3e3).then(()=>this.bindPlayerListeners()).catch(()=>{!this.playerEventsBound&&t<3&&(t++,n())})};n()}disconnect(e){return this.trackers.forEach(e=>e.stop()),this.trackers=[],E.A.unsubscribeAll(this.eventGroup),this.playerEventsBound=!1,this.queueConnection.stop(),this.commandConnection.disconnect(e)}publishQueue(e){this.queueConnection.publishQueue(e).catch(e=>b.A.error(e))}publishState(){const e=this.player.getState();this.commandConnection.publish(new zg({...e,elementId:Qg(e.queueId,e.track)}),1e3).catch(()=>{})}bindPlayerListeners(){if(this.playerEventsBound)return;this.playerEventsBound=!0;const e=jg()(this.publishState.bind(this),30);E.A.subscribe(E.A.player.position,(0,pc.A)(()=>this.publishState(),3e3,{leading:!0}),this.eventGroup),E.A.subscribe(E.A.player.tracklist_changed,()=>{this.onTracklistChange()},this.eventGroup),E.A.subscribe(E.A.player.volume_changed,jg()(e,300),this.eventGroup),E.A.subscribe(E.A.player.paused,e,this.eventGroup),E.A.subscribe(E.A.player.mute_changed,e,this.eventGroup),E.A.subscribe(E.A.player.repeat_changed,e,this.eventGroup)}onTracklistChange(){this.publishQueue(this.player.generateQueue()),this.publishState()}onCommand(e){switch(this.playerEventsBound||this.bindPlayerListeners(),e.messageType){case"skip":return this.onSkip(e);case"stop":return Promise.resolve(this.stop());case"close":return this.stop(),this.disconnect("remote");default:return Promise.reject(new Og(0))}}stop(){this.player.stop()}async onSkip(e){const{queueId:t,elementId:n,progress:a,shouldPlay:i,setShuffle:r,setRepeatMode:s,setVolume:o}=e,l=t!==this.player.getQueueId();if(l){const e=await this.queueConnection.queueWithId(t,12e4);await this.player.replaceQueue(e)}if(void 0!==n){const{score:e,index:t}=function(e,t,n){var a;const i=function(e){const t=e.match(/^((?:[0-9A-Fa-f]+-?)+[0-9A-Fa-f]+)-([-]?[0-9]+)-([0-9]+)$/);if(!t)return;const[,n,a,i]=t;return{queue:n,id:a,index:Number(i)}}(n);if(!i)return{score:0,index:-1};const{queue:r,id:s,index:o}=i;return r===e&&(null===(a=t[o])||void 0===a?void 0:a.SNG_ID)===s?{score:1,index:o}:t.reduce((t,n,a)=>{let i=e===r?.25:0;return n.SNG_ID===s&&(i+=.5),a===o&&(i+=.25),t.score<i?{score:i,index:a}:t},{score:0,index:-1})}(this.player.getQueueId(),this.player.getTrackList(),n);if(e<.5)throw new Og(0);(l||t!==this.player.getTrackListIndex())&&this.player.playTrackAtIndex(t,!0)}void 0!==r&&this.player.setShuffle(r),void 0!==s&&this.player.setRepeatMode(s),void 0!==o&&(0===o&&this.player.isMuted()||this.player.setVolume(o)),void 0!==a&&a>0&&this.player.seek(a),i&&this.playRequestHandler&&await this.playRequestHandler(),void 0!==i&&i!==this.player.isPlaying()&&(i?this.player.play():this.player.pause())}}const oy={[bm.ARTIST]:"artist",[bm.USER]:"user"};const cy={[Al.en.LOW]:0,[Al.en.STANDARD]:1,[Al.en.HIGH]:2,[Al.en.LOSSLESS]:3,[Al.en.UNKNOWN]:-1};function dy(e,t){const n={queue:void 0,quality:void 0};return E.A.subscribe(E.A.player.qualityChanged,(e,t)=>{n.quality=t}),{play:()=>e.control.play(),pause:()=>e.control.pause(),stop:()=>[je.zu.LIVE_STREAM,je.zu.EPISODE].includes(e.getMediaType())?e.control.stop():e.control.pause(),seek:t=>e.control.seek(t),setShuffle:t=>e.control.setShuffle(t),setRepeatMode:t=>e.control.setRepeat(t),setDeviceID:t=>{e.setLinkedDevice(t?{device_type:"remote_control",name:t,type:"in"}:void 0)},isPlaying:()=>e.isPlaying(),getPosition:()=>e.getPosition(),getDuration:()=>e.getDuration(),setVolume:(0,fe.A)(t=>e.control.setVolume(t),100),isMuted:()=>e.isMuted(),playTrackAtIndex:(t,n=!1)=>e.playTrackAtIndex(t,n),getSongId:()=>e.getSongId(),getTrackListIndex:()=>e.getTrackListIndex(),getTrackList:()=>e.getTrackList(!0).map(e=>e.data),getQueueId:()=>{var e;return(null===(e=n.queue)||void 0===e?void 0:e.id)||""},getQueue:()=>n.queue,generateQueue:()=>{const t=function(e){const t=e.getTrackList(!0,!0),n=[],a=t.map(({context:t,data:a})=>{const i=function(e){const t={id:e.ID.toString(),extra:{oneofKind:void 0}};if(/album(?!_similar)|artist_discography/i.test(e.TYPE))t.type=km.ALBUM;else if(/livestream/.test(e.TYPE))t.type=km.LIVE;else if(/personal/.test(e.TYPE))t.type=km.PERSONAL;else if(/artist_top/.test(e.TYPE))t.type=km.TOP_TRACKS,t.extra={oneofKind:"topTracks",topTracks:{type:vm.ARTIST}};else if(/playlist(?!_radio)/.test(e.TYPE)||/history_page/.test(e.TYPE)||/profile_top/.test(e.TYPE))t.type=km.PLAYLIST;else if(/show/.test(e.TYPE))t.type=km.PODCAST;else if("up_next_artist"===e.TYPE)t.type=km.RECOMMENDED;else if(/^shuffled/.test(e.TYPE))t.type=km.SHUFFLE_MY_MUSIC;else if(/smarttracklist/.test(e.TYPE)){const n=(e.CONTEXT_ID||"").split(",").filter(e=>e.startsWith("card_name")).map(e=>e.split("=")[1]).shift()||"";t.type=km.SMART_TRACKLIST,t.extra={oneofKind:"smart_tracklist_method",smart_tracklist_method:n}}else/artist|smartradio/.test(e.TYPE)?(t.type=km.MIX,t.extra={oneofKind:"mix",mix:{type:bm.ARTIST}}):"history_radio"===e.TYPE||"playlist_radio"===e.TYPE?(t.type=km.MIX,t.extra={oneofKind:"mix",mix:{type:bm.HISTORY}}):"search_radio"===e.TYPE?(t.type=km.MIX,t.extra={oneofKind:"mix",mix:{type:bm.SEARCH}}):/user|flow/.test(e.TYPE)?(t.type=km.MIX,t.extra={oneofKind:"mix",mix:{type:bm.USER}}):"mix_bottom_sheet_layer"===e.TYPE?(t.type=km.MIX,t.extra={oneofKind:"mix",mix:{type:bm.GENRE}}):/radio|mix/i.test(e.TYPE)?(t.type=km.MIX,t.extra={oneofKind:"mix",mix:{type:bm.DEFAULT}}):t.type=km.DEFAULT;return{container:t,log:{context_id:e.CONTEXT_ID||"",listening_context:e.TYPE||""}}}(t);let r,s=n.findIndex(e=>(0,zp.A)(e,i));switch(s<0&&(s=n.push(i)-1),e.getMediaType(a)){case je.zu.EPISODE:r=Tm.EPISODE;break;case je.zu.LIVE_STREAM:r=Tm.LIVE;break;default:r=Tm.SONG}return{context:s,id:String(a[e.getMediaId(a)]),type:r}}),i=[],r=e.getTrackList(!0,!1).map(({context:n,data:a})=>{let r=0;const s=a[e.getMediaId(a)],o=t.filter(({context:t,data:i})=>i[e.getMediaId(i)]===a[e.getMediaId(a)]&&(0,zp.A)(n,t));return o.length>1&&(r=i.filter(e=>s===e).length,i.push(s)),t.indexOf(o[r])}),s={contexts:n,id:_p()(),tracks:a,tracks_order:[],shuffled:!1,timestamp:0};return r.reduce((e,t,n)=>e&&t===n,!0)||(s.tracks_order=r,s.shuffled=!0),s}(e);return n.queue=t,t},replaceQueue:a=>async function(e,t){if(!0===e.hydrated)return Promise.resolve(e);const n=e.contexts.map(({container:e,log:t})=>({CONTEXT_ID:null==t?void 0:t.context_id,ID:(null==e?void 0:e.id)||"",TYPE:(null==t?void 0:t.listening_context)||""})),a=e=>({type:t})=>t===e,i=e=>e.id,{tracks:r}=e,s=r.filter(a(Tm.SONG)).map(i),o=r.filter(a(Tm.EPISODE)).map(i),l=r.filter(a(Tm.LIVE)).map(i),c=[...s.length?await t(s,"song"):[],...o.length?await t(o,"episode"):[],...l.length?await t(l,"live"):[]],{originals:d,recommended:u}=r.reduce((e,t,a)=>{if(!c[a])return e;const i=t.context,r={context:n[i],data:c[a]};return"up_next_artist"===r.context.TYPE?e.recommended.push(r):e.originals.push(r),e},{originals:[],recommended:[]}),p={hydrated:!0,contexts:e.contexts,tracks_order:e.tracks_order,timestamp:e.timestamp,id:e.id,shuffled:e.shuffled,original:d,recommended:u,tracks:(Array.isArray(e.tracks_order)&&e.tracks_order.length?e.tracks_order.map(e=>d[e]):d).map(e=>e.data)};if(u.length)p.radio="up_next_artist";else{const{container:t}=e.contexts[0];if(t&&t.type===km.LIVE)p.radio="livestream";else if(t&&t.type===km.MIX){var m;p.radio=oy["mix"===(null==t||null===(m=t.extra)||void 0===m?void 0:m.oneofKind)&&t.extra.mix.type||0]||""}}return p}(a,t).then(t=>{n.queue=a,e.setTriforceState(t)}),getState(){var t;const a=n.quality||e.control.getAudioQuality()||"standard",i=this.getQueueId();let r,s,o;if(e.getMediaType()===je.zu.LIVE_STREAM)o=0,r=e.getPosition(),s=e.getPosition()/2;else{var l;const t=null!==(l=e.getDuration())&&void 0!==l?l:180;r=Number(t),o=r,s=e.getPosition()/r}const c=null===(t=e.getSongId())||void 0===t?void 0:t.toString();return{queueId:i,track:c?{id:c,index:e.getTrackListIndex()}:void 0,buffered:o,volume:Number(e.isMuted()?0:e.getVolume()),progress:s,duration:r,quality:cy[a],isPlaying:e.isPlaying(),isShuffle:e.isShuffle(),repeatMode:e.getRepeat()}}}}class uy{constructor(e,t,n,a,i,r){this.discovery=void 0,this.currentReceiverConnection=void 0,this.player=void 0,this.playRequestHandler=void 0,this.deviceName=void 0,this.countryCode=void 0,this.enableTracking=void 0,this.player=dy(e,a),this.discovery=new Yg(t,_p()()),this.deviceName=n,this.countryCode=i,this.enableTracking=r}set onPlayRequested(e){this.playRequestHandler=e}listenForRemotes(){this.discovery.listen(this.handleConnectionOffer.bind(this))}isConnectedToRemote(){return void 0!==this.currentReceiverConnection}disconnect(){return this.discovery.stop(),this.disconnectFromCurrentSender()}async disconnectFromCurrentSender(e){this.currentReceiverConnection&&(await this.currentReceiverConnection.disconnect(e),this.player.setDeviceID(void 0),this.currentReceiverConnection=void 0)}async handleConnectionOffer(e){const{command:t,queue:n}=await e.accept({device_name:this.deviceName,device_type:"web",supported_control_versions:["1.0.0-beta2"]});await this.disconnectFromCurrentSender("remote"),this.currentReceiverConnection=new sy(this.player,t,n,this.countryCode,this.enableTracking),this.player.setDeviceID(e.from),this.currentReceiverConnection.onPlayRequested=()=>this.playRequestHandler?this.playRequestHandler():Promise.resolve(),this.currentReceiverConnection.connect(this.disconnectFromCurrentSender.bind(this,"timeout"))}}var py=n("+Hyk"),my=function(e){return e.UPDATE_STATE="updateState",e.JOIN="join",e.LEAVE="leave",e.PING="ping",e}(my||{});function hy(e,t){return e>=([...t].sort((e,t)=>e-t)[t.length-1]||0)}const gy=async(e,t)=>{switch(t){case"song":return await x.A.dispatch((0,Qm.d0)({ids:e})),(0,Wm.KW)(x.A.getState().entities,e);case"episode":return await x.A.dispatch((0,Vm.l$)({ids:e})),(0,Vm.KN)(x.A.getState().entities,e);case"live":return await x.A.dispatch((0,Ym.qS)({ids:e})),(0,Ym.b2)(x.A.getState().entities,e);default:throw new Error("Unhandled track type")}},yy=({onAutoplayBlocked:e})=>((0,i.useEffect)(()=>{let t;const n=(0,S.F6)(x.A.getState().user),a=function(e,t=""){if(!("BroadcastChannel"in window))return e(),()=>{};const n=new BroadcastChannel((t?t+"-":"")+"single-active-tab"),a=Date.now();let i=0,r={leadTab:void 0,tabs:[a]},s=()=>{r.leadTab=a,n.postMessage({type:my.UPDATE_STATE,state:r}),e(),s=()=>{}};const o=()=>a===r.leadTab,l=setTimeout(s,500),c=setInterval(()=>{o()?n.postMessage({type:my.PING}):Date.now()-i>6e4&&hy(a,r.tabs)&&s()},5e3);return n.onmessage=e=>{const t=e.data;switch(t.type){case my.JOIN:o()&&(r.tabs.push(t.id),n.postMessage({type:my.UPDATE_STATE,state:r}));break;case my.LEAVE:r.tabs=r.tabs.filter(e=>e!==t.id),t.id===r.leadTab&&(r.leadTab=void 0,hy(a,r.tabs)&&s());break;case my.PING:clearTimeout(l),i=Date.now();break;case my.UPDATE_STATE:clearTimeout(l),i=Date.now(),r={...t.state}}},n.postMessage({type:my.JOIN,id:a}),()=>{n.postMessage({type:my.LEAVE,id:a}),n.close(),clearInterval(c)}}(()=>{let i=!1;const r=rn.Ay?null===rn.Ay||void 0===rn.Ay?void 0:rn.Ay.getHostname():Hl.A.getBrowserName();t=new uy($e.Ay,n,r,gy,(0,S.JJ)(x.A.getState().user),_.A.isAllowed("metric.remote_control")),t.onPlayRequested=()=>i?Promise.resolve():py.A.audio({timeout:1e3}).then(({result:t})=>(i=t,t?Promise.resolve():e())),t.listenForRemotes(),window.addEventListener("beforeunload",()=>{t.disconnect(),a()})},n);return()=>{a(),t&&t.disconnect()}},[]),null);var Ay=n("YIja"),Ey=n("DVo4"),_y=n("oN5d"),fy=n("jUB+");const by=au.i7`
	from {
		opacity: 0;
		transform: translateY(15px);
	}
	to {
		opacity: 1;
		transform: translateY(0);
	}
`,vy=()=>{const[e,t]=i.useState({body:"",status:void 0,timerId:0});if(i.useEffect(()=>{const n=n=>{clearTimeout(e.timerId);const a=window.setTimeout(()=>t({timerId:0}),n.detail.duration||fy.j);t({timerId:a,...n.detail})};return _y.Ay.addEventListener(_y.v9.OPEN,n),()=>{_y.Ay.removeEventListener(_y.v9.OPEN,n)}},[e.timerId]),!e.body)return null;let n=null,a=null;e.title?(n=e.title,a=e.body):(n=e.body,a=null);const r=()=>{clearTimeout(e.timerId),t({timerId:0})};return i.createElement(de.a,{animation:`${by} 400ms ease-out both`,as:"aside",bottom:"calc(var(--layout-player-height) + 15px)",left:"0",maxWidth:"560px",mx:"auto",position:"fixed",right:"0",width:"max-content",zIndex:"9000"},i.createElement(Ay.N,{action:i.createElement(i.Fragment,null,"function"==typeof e.action?e.action(r):e.action,e.isClosable&&i.createElement(Ey.J,{size:"small",onClick:r})),"data-testid":e.testId||"toast_message",icon:void 0===e.icon||e.icon,status:e.status,title:n},a))};var ky;function Ty(){return i.createElement(ca.K2,null,i.createElement(Ne.s,{alignItems:"center",background:"#EAD1FF",bottom:"var(--layout-player-height)",gap:"spacing.l",left:"0",p:"spacing.l",position:"fixed",w:"100%",zIndex:"2"},ky||(ky=i.createElement(Ne.s,{alignItems:"center",background:"#A238FF3D",borderRadius:"2xs",flexShrink:0,height:"48px",justifyContent:"center",width:"48px"},i.createElement(In.h,{size:"medium",color:"icon.accent.primary.default"}))),i.createElement(Ne.s,{alignItems:"start",flexDirection:"column",flexGrow:1},i.createElement(Oe.D,{color:"text.neutral.primary.default",variant:"heading.s"},(0,oe.AP)("unloggedhomepagevitrine_title_stickybanner_web")),i.createElement(Ke.E,{display:{base:"none",md:"block"},color:"text.neutral.primary.default",variant:"body.l.default"},(0,oe.AP)("unloggedhomepagevitrine_text_stickybanner_web"))),i.createElement(Te.$n,{flexShrink:0,as:"a",onClick:function(){var e;(0,ld.R2)({eventcategory:null!==(e=(0,ld.bg)())&&void 0!==e?e:"",eventaction:"signup-sticky"})},href:(0,_s.t)({route:"register",comeback:!0})},(0,oe.AP)("unloggedhomepage_action_signupforfree_web"))))}var Cy=n("FuY1");let wy,Sy,xy;n("noe2");class Iy extends i.Component{constructor(){super(),this._onPageChanged=this._onPageChanged.bind(this),this._onPageDisplayed=this._onPageDisplayed.bind(this),this._updateWidth=this._updateWidth.bind(this),this._onTransitionEnd=this._onTransitionEnd.bind(this),this.state={isLoading:!1,width:0},this.contentRef=i.createRef()}componentDidMount(){E.A.subscribe(E.A.navigation.page_changed,this._onPageChanged),E.A.subscribe(E.A.navigation.page_displayed,this._onPageDisplayed)}componentWillUnmount(){clearTimeout(wy),clearTimeout(xy),clearInterval(Sy),E.A.unsubscribe(E.A.navigation.page_changed,this._onPageChanged),E.A.unsubscribe(E.A.navigation.page_displayed,this._onPageDisplayed)}render(){const e=(0,s.A)({"page-loader":!0,opened:this.state.isLoading}),t=(0,s.A)({"page-loader-bar":!0,"has-transition":this.state.hasTransition});return i.createElement("div",{className:e,id:"page_loader",ref:this.contentRef},i.createElement("div",{className:t,style:{width:`${this.state.width}%`}}))}_onPageChanged(){this.state.isLoading||(this.setState({isLoading:!0,hasTransition:!0,width:20+55*Math.random()}),wy=setTimeout(()=>{this._updateWidth(),Sy=setInterval(this._updateWidth,1e3)},1e3))}_onPageDisplayed(){setImmediate(()=>{this.state.isLoading&&(clearTimeout(wy),clearInterval(Sy),this.setState({hasTransition:!1,width:100}),xy=setTimeout(()=>{this.contentRef.current&&this.contentRef.current.addEventListener("transitionend",this._onTransitionEnd,!1),this.setState({isLoading:!1})},500))})}_onTransitionEnd(){this.setState({width:0}),this.contentRef.current&&this.contentRef.current.removeEventListener("transitionend",this._onTransitionEnd)}_updateWidth(){this.state.width>=90&&clearInterval(Sy),this.setState({width:this.state.width+5})}}var Py,Ry,Ly=n("hYAH");function Ny(){return i.createElement("div",{className:"modal",id:"modal",role:"dialog","aria-hidden":"true",style:{display:"none"}},Py||(Py=i.createElement("div",{className:"modal-backdrop"})),Ry||(Ry=i.createElement("div",{className:"modal-wrapper"})))}var Oy=n("ACKC"),Dy=n("G/O0"),My=n("V9V8"),Uy=n("Au7y"),zy=n("LOxp");const Fy=({id:e,onClose:t,onError:n,userId:a,placeholders:s})=>{const[o,l]=(0,i.useState)(!1),[c,d]=(0,i.useState)(!1),u=(0,r.wA)(),p=(0,Uy.oc)(),m=(0,r.d4)(({user:e})=>(0,S.Pe)(e)),h=(0,r.d4)(({user:e})=>(0,S.G8)(e)),g=(0,r.d4)(({user:e})=>(0,S.zJ)(e)),y=(0,r.d4)(({user:e})=>(0,S.Mn)(e)),A=(0,i.useMemo)(()=>new My.A,[]),E=(0,i.useMemo)(()=>new Oy.Ay((0,wp.WV)({itemType:Sp.Wi.CONFIG,itemName:"media-service"})||g,m,{timeService:A,trackTokenProvider:async function e(t,{fetchPolicy:n="cache-first"}={}){if(!p)return;const{data:a}=await p.query({fetchPolicy:n,query:Uy.J1`
								query TrackMediaToken($trackId: String!) {
									track(trackId: $trackId) {
										media {
											token {
												payload
												expiresAt
											}
										}
									}
								}
							`,variables:{trackId:t.id}}),{track:{media:{token:{payload:i="",expiresAt:r=Date.now()}={}}={}}={}}=a,s=new Oy.X8(i,{expire:new Date(r).getTime()});return s.isExpired(A.now())&&n.startsWith("cache")?e(t,{fetchPolicy:"network-only"}):s}}),[p,m,g,A]);return(0,i.useEffect)(()=>{var e;window.IASReady={_e:[()=>l(!0)]};const t=document.createElement("script");return t.async=!0,t.id="ias-wjs",t.src="https://sdk.inappstory.com/v2.4.3/dist/js/IAS.js",null===(e=document.getElementsByTagName("script")[0])||void 0===e||e.insertAdjacentElement("beforebegin",t),()=>{delete window.IASReady,t.remove()}},[]),(0,i.useEffect)(()=>{if(!o)return;const{IAS:i}=window,r=(new i.AppearanceManager).setStoryReaderOptions({sharePanel:{targets:[]}}),l={};null==s||s.forEach(({key:e,value:t})=>{l[e]=t});const c={apiKey:_r.default.get("inappstory_api_key"),userId:a,tags:[],placeholders:{blogname:y||"",...l},lang:"en"},p=new Dy.A,m=new i.StoryManager({...c},{storyLinkClickHandler:e=>{const{data:t}=e,{url:n}=t;(0,zy.$)(n,{dispatch:u,lovedTracksId:h,userId:a})?m.closeStoryReader():window.open(n)}}),g=({payload:e})=>function(e,{mediaProvider:t,previewer:n,placeholders:a}){if(!e)return;let i;try{i=JSON.parse(e)}catch(e){return}switch(i.action){case"muteAudio":"boolean"==typeof i.data.isMuted&&(n.muted=i.data.isMuted);break;case"playAudio":{const{data:e}=i;let{content:r}=e;const{type:s}=e,o=null==a?void 0:a.find(e=>(null==e?void 0:e.key)===r);if(o&&(r=o.value),!r)break;"external"===s&&(n.load(r),n.volume=$e.Ay.getVolume()),"internal"===s&&t.getMedia({id:r},{type:Oy.Sq.PREVIEW}).then(e=>{const t=e.sources[0];t&&(n.load(t.url),n.volume=$e.Ay.getVolume())}).catch(()=>{});break}case"stopAudio":n.stop()}}(e,{mediaProvider:E,previewer:p,placeholders:s});return m.on("closeStory",t),m.on("showSlide",g),m.showStory(e,r).then(d).catch(n),()=>{p.stop(),m.closeStoryReader(),m.off("closeStory",t),m.off("showSlide",g)}},[s,u,e,h,E,t,n,o,y,a]),(0,i.useEffect)(()=>{if(!c)return;const e=$e.Ay.isPlaying();return $e.Ay.control.pause(),()=>{e&&$e.Ay.control.play()}},[c]),null};var By=n("pIhH");const qy=({story:e})=>e.id;var Gy,Hy;function Vy(){const e=(0,be.W6)(),t=(0,r.wA)(),n=(0,r.d4)(({user:e})=>(0,S.F6)(e)),a=(0,r.d4)(qy),{data:s,loading:o}=(0,Ue.ZO1)({variables:{storyId:a||""},skip:!a});(0,i.useEffect)(()=>{const n=e=>{const n=new URL(e).searchParams.get("stories");n&&t((0,Ly.o)({id:n}))};n(window.location.href);const a=e.listen(()=>{n(window.location.href)});return()=>{a()}},[]);const l=(0,i.useCallback)(()=>{window.location.href.includes("stories")&&e.replace(window.location.pathname),t((0,Ly.E)())},[]),c=(0,i.useMemo)(()=>{var e;return(null==s||null===(e=s.me)||void 0===e||null===(e=e.simpleStory)||void 0===e?void 0:e.placeholders)||[]},[s]);return i.createElement("div",{className:"page-shadow"},Gy||(Gy=i.createElement(Ny,null)),a&&n&&!o?i.createElement(Fy,{id:a,onClose:l,onError:l,userId:n,placeholders:c}):null,_.A.isAllowed("reactivation_desktop_notification")&&(Hy||(Hy=i.createElement(By.Ay,null))))}var Yy=n("r2ys"),Qy=n("ebSJ"),Wy=n("uHHB");let Ky;var $y,Xy,Jy,Zy,eA,tA,nA,aA,iA,rA,sA,oA,lA,cA,dA,uA,pA,mA,hA,gA;class yA extends i.Component{constructor(e){super(e),e.updateCurrentPage(e.location.pathname),this._onLiveFeed=this._onLiveFeed.bind(this),this.state={error:null}}componentDidMount(){(()=>{if(void 0!==Ky)return Ky;if("undefined"!=typeof document){const e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.position="absolute",e.style.top="-9999px",e.style.overflow="scroll",document.body.appendChild(e),Ky=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}else Ky=0;return Ky})()>0&&document.body.classList.add("force-scrollbar"),f.A.addInternalChannel("-1_"+this.props.userID+"_USERFEED_"+this.props.userID),f.A.init(),O.init(),E.A.subscribe(E.A.live.feed,this._onLiveFeed),E.A.trigger(E.A.navigation.page_displayed,{path:this.props.location.pathname}),E.A.resolve(E.A.navigation.page_initialized),this.props.hasMultiAccountEnabled&&this.props.fetchChildAccount();const e=this._getSelectedAccount();!1!==e?this.props.selectChildAccount(e):this.props.isSubAccount?this.props.selectChildAccount(this.props.userID):this.props.hasNoChildAccountSelected&&!e&&this.props.openScreen({name:X.F.SELECT_PROFILE,data:{hasPreselectedMember:!1,allowScreenClose:!1}}),!_.A.isAllowed("public_api_onboarding")&&this.props.hasOnBoarding&&this.props.openScreen({name:X.F.ONBOARDING_LEGACY,data:{showGenreFilter:!0}}),this.props.location.query&&this.props.location.query.modal&&(0,B.C)(this.props.location.query.modal)&&this.props.openModal({name:this.props.location.query.modal}),(0,Qy.A)("hideBannerElectronUI")&&(0,Wy.A)("hideBannerElectronUI",!1,-1),this._displayProfileSelection(),this._displayAlerts()}shouldComponentUpdate(e,t){return this.props.location.pathname!==e.location.pathname||this.props.location.state!==e.location.state||this.props.hasNoChildAccountSelected!==e.hasNoChildAccountSelected||this.props.userID!==e.userID||!this.state.error&&t.error}componentDidUpdate(){window.scrollTo(0,0),E.A.trigger(E.A.navigation.page_changed,{path:this.props.location.pathname}),this.props.updateCurrentPage(this.props.location.pathname),E.A.trigger(E.A.navigation.page_displayed,{path:this.props.location.pathname}),this._hideAlerts(),!_.A.isAllowed("public_api_onboarding")&&this.props.hasOnBoarding&&this.props.openScreen({name:X.F.ONBOARDING_LEGACY,data:{showGenreFilter:!0}}),this.state.error&&this.setState({error:null})}componentDidCatch(e,t){this.setState({error:e.constructor.name}),e instanceof u.Dr||b.A.error(e,t)}componentWillUnmount(){E.A.unsubscribe(E.A.live.feed,this._onLiveFeed)}render(){if(this.props.hasNoChildAccountSelected)return $y||($y=i.createElement("div",{className:"naboo"},i.createElement(Mh,null),i.createElement(ae,null),i.createElement(Vy,null),i.createElement(q.A,null)));const e=["/login","/register"].includes(this.props.location.pathname),t=(0,s.A)("naboo",{"with-banner":!this.props.isConnected});return i.createElement("div",(0,a.A)({className:t},{}),Xy||(Xy=i.createElement(Mh,null)),_.A.isAllowed("public_api_onboarding")?Jy||(Jy=i.createElement(Oh,{toRenderWhenNoOnboarding:i.createElement(Rh,null)})):!this.props.hasOnBoarding&&(Zy||(Zy=i.createElement(Rh,null))),eA||(eA=i.createElement(ae,{withTransition:!0})),tA||(tA=i.createElement(pe,null)),nA||(nA=i.createElement(vy,null)),aA||(aA=i.createElement(Iy,null)),e?null:iA||(iA=i.createElement(Os,null)),e?null:rA||(rA=i.createElement(Fs,null)),this._renderMain(e),e||this.props.isConnected?null:sA||(sA=i.createElement(Ty,null)),e?null:oA||(oA=i.createElement(xh,null)),e?null:lA||(lA=i.createElement(Ee.A,null)),cA||(cA=i.createElement(Vy,null)),dA||(dA=i.createElement(mg,null)),_.A.isAllowed("remote_control")?i.createElement(yy,{onAutoplayBlocked:()=>new Promise(e=>{this.props.openModal({name:"REMOTE_CANNOT_AUTOPLAY",props:{onClose:e}})})}):null,uA||(uA=i.createElement(q.A,null)),pA||(pA=i.createElement(ye,null)))}_renderMain(e){const t=(0,s.A)({"page-main":!0,"electron-auth":e});if(this.state.error)return i.createElement("div",{className:t,id:"page_content",role:"main"},mA||(mA=i.createElement(Cy.A,null)));const n=this.props.location.pathname.replace(/^\/|\/$/g,"")===this.props.userLanguage;return i.createElement("div",{className:t,id:"page_content",role:"main"},i.createElement(Ae.A,{displayContentCard:n}),hA||(hA=i.createElement(_e.s,null)),gA||(gA=i.createElement(Yy.A,null)),i.createElement(i.Suspense,{fallback:null},this.props.children))}_onLiveFeed(e,t){if(!t.length)return;const n=t[0];switch(n.ACTION){case"FRIEND_FOLLOW":case"PLAYLIST_COMMENT":case"SHARE":v.A.addNotification(n);break;default:v.A.addTicker(n,!0)}}_displayProfileSelection(){const{hasMultiAccountEnabled:e,hasParent:t,isSubAccount:n,isSubProfile:a}=this.props,{redirect:i}=c().parse(window.location.search,{ignoreQueryPrefix:!0});e&&"profiles"===i&&(!t||a&&!n)&&(this.props.openScreen({name:X.F.SELECT_PROFILE,data:{hasPreselectedMember:!1,allowScreenClose:!0}}),d.A.push((0,k.jd)("/")))}_displayAlerts(){const{isConnected:e,userOfferId:t,isHardbounce:n}=this.props;e&&!A.isDismissed(ce.jE)&&this.props.dispatchShowAlert(ce.jE,{userOfferId:t,onClose:()=>{A.markAsDismissed(ce.jE)}}),n&&this.props.dispatchShowAlert(ce.IV)}_hideAlerts(){const{alerts:e,dispatchHideAlert:t}=this.props;if(!e.length)return;const n=[ce.jE];e.filter(e=>n.includes(e.id)).forEach(e=>{t(e.id),A.markAsDismissed(e.id)})}_getSelectedAccount(){return m.default.get("selectedChildAccount",!1,!0)}}yA.defaultProps={userAge:"",userGender:"",hasNoChildAccountSelected:!1};const AA=(0,r.Ng)(({user:e,alerts:t})=>({userID:e.USER.USER_ID,isConnected:(0,S.UJ)(e),hasOnBoarding:e.USER.ONBOARDING_MODAL,userAge:(0,S.QO)(e),userGender:(0,S.o_)(e),userLanguage:(0,S.Z0)(e),userOfferId:(0,S.id)(e),hasNoChildAccountSelected:(0,S.In)(e),alerts:t,isSubProfile:(0,S.W$)(e),isHardbounce:e.USER.HARDBOUNCED_EMAIL,hasParent:(0,S.p7)(e),hasMultiAccountEnabled:(0,S.mE)(e),isSubAccount:(0,S.m0)(e),displayCommunicationPreferencesUpdateBanner:!0===e.__DZR_GATEKEEPS__.display_communication_preferences_update_banner}),{selectChildAccount:D.me,updateCurrentPage:M.yf,openScreen:U.J2,openModal:F.qf,dispatchShowAlert:z.S7,dispatchHideAlert:z.Hd,fetchChildAccount:D.C9}),EA=AA((0,o.Ay)(e=>({virtualpageurl:e.location.pathname,language:e.userLanguage,uilogged:e.isConnected}),{process:e=>e.pagename?e:null,dispatch:e=>{if(void 0!==window.dataLayer){const t=Object.assign({},e);e.pagecategory===Ot.CONTEXT_PAGE_SEARCH&&(t.pagename=Ot.CONTEXT_PAGE_SEARCH),window.dataLayer.push(t)}(0,p.TD)(e)}})(yA))},gLR9:(e,t,n)=>{n.d(t,{C:()=>p});var a=n("MVPB"),i=n("4OMY"),r=n("77Ru"),s=n.n(r),o=n("bmsN"),l=n("fd4+"),c=(0,i.A)("listeners"),d=(0,i.A)("setSessionState");function u(e){this.sessionState="0"===e?s().com.deezer.kmp.usersession.api.UserSessionState.LoggedOut:new(s().com.deezer.kmp.usersession.api.UserSessionState.LoggedIn)(e)}const p=new class{constructor(){Object.defineProperty(this,d,{value:u}),this.sessionState=s().com.deezer.kmp.usersession.api.UserSessionState.LoggedOut,Object.defineProperty(this,c,{writable:!0,value:new Map}),(0,a.A)(this,d)[d](o.It.get().user_id),o.It.addEventListener(l.O8,e=>{const{userContext:{user_id:t}}=e.detail;(0,a.A)(this,d)[d](t),(0,a.A)(this,c)[c].forEach(e=>{e.onUserChanged(this.sessionState)})})}addOnUserSessionChangedListener(e){return(0,a.A)(this,c)[c].set(e,e),new(s().com.deezer.kmp.helper.ObserverSubscriptionOnce)(()=>{(0,a.A)(this,c)[c].delete(e)})}}},guCc:(e,t,n)=>{n.d(t,{U:()=>a,m:()=>i});let a=function(e){return e.AGE_INVALID="FORM_ERROR_AGE_INVALID",e.BLOGNAME_HAS_SPECIAL_CHARS="FORM_ERROR_BLOGNAME_HAS_SPECIAL_CHARS",e.BLOGNAME_TOO_LONG="FORM_ERROR_BLOGNAME_TOO_LONG",e.BLOGNAME_TOO_SHORT="FORM_ERROR_BLOGNAME_TOO_SHORT",e.EMAIL_ALREADY_USED="FORM_ERROR_EMAIL_ALREADY_USED",e.EMAIL_DOMAIN_NOT_VALID="FORM_ERROR_EMAIL_DOMAIN_NOT_VALID",e.EMAIL_NOT_VALID="FORM_ERROR_EMAIL_NOT_VALID",e.FORM_ERROR="FORM_ERROR",e.MIN_LEGAL_AGE="FORM_ERROR_MIN_LEGAL_AGE",e.PASSWORD_HAS_TRAILLING_WHITESPACE="FORM_ERROR_PASSWORD_HAS_TRAILLING_WHITESPACE",e.PASSWORD_TOO_LONG="FORM_ERROR_PASSWORD_TOO_LONG",e.PASSWORD_TOO_SHORT="FORM_ERROR_PASSWORD_TOO_SHORT",e}({}),i=function(e){return e[e.TOO_WEAK=0]="TOO_WEAK",e[e.WEAK=1]="WEAK",e[e.MEDIUM=2]="MEDIUM",e[e.STRONG=3]="STRONG",e}({})},h65K:(e,t,n)=>{n.d(t,{m:()=>a});const a=(0,n("IRKz").B)("div",{baseStyle:{m:"auto",w:"80",textAlign:"start"}})},hIIJ:(e,t,n)=>{n.d(t,{A:()=>u});var a=n("+9dH"),i=n("q1tI"),r=n("55Ip"),s=n("Wp0Y"),o=n("HmE0"),l=n("TDRX"),c=n("y7xR"),d=n("pVdW");const u=({children:e,href:t,className:n,title:u,subtitle:p,onClick:m,ctaLabel:h=(0,s.AP)("Voir tout"),isExternalLink:g=!1,...y})=>i.createElement(l.a,(0,a.A)({flex:1,className:n},y),i.createElement(c.D,{variant:"heading.m","data-testid":"section_title"},u,t?g?i.createElement(o.$n,{as:"a",href:t,target:"_blank",variant:"outline",size:"small",ms:"spacing.s","data-testid":"section_title_cta"},h):i.createElement(r.N_,{to:t,onClick:()=>null==m?void 0:m()},i.createElement(o.$n,{variant:"outline",size:"small",ms:"spacing.s","data-testid":"section_title_cta"},h)):null,e),p?i.createElement(d.E,{variant:"body.s.default",mt:"spacing.xs",color:"text.neutral.secondary.default","data-testid":"section-title-subtitle"},p):null)},hYAH:(e,t,n)=>{n.d(t,{E:()=>i,o:()=>r});var a=n("6wwM");const i=()=>({type:a.R.CLOSE_STORY}),r=({id:e})=>({id:e,type:a.R.OPEN_STORY})},i6DM:(e,t,n)=>{n.d(t,{KI:()=>u,Kl:()=>o,rS:()=>d}),n("/eM8"),n("EV0h"),n("gS5K");var a=n("nrKQ"),i=n("Wp0Y"),r=n("fkXJ");const s=new(n("ZOeD").V),o=async(e,t,n=!1)=>{const i=await a.A.callAsync({method:"libraryimport.getTMMAccessToken",data:{}}).catch(e=>{throw e});s.setToken(i);const r=await s.getLibraryTransferUrl(e,t,n);try{const e=new URL(r.migration_url);return e.searchParams.append("mode","deezer"),e.href}catch(e){throw new Error("TMM: migration url not valid")}},l={apple:"apple-music",youtubemusic:"youtube-music"},c={ww:"/en",ar:"/ar",cs:"/cs",es:"/es",mx:"/es",fr:"/fr",da:"/da",de:"/de",nl:"/nl",hu:"/hu",ja:"/jp",it:"/it",pl:"/pl",pt:"/pt",br:"/pt",ro:"/ro",sv:"/sv",tr:"/tr"},d=(e,t)=>{var n,a;const i=null!==(n=c[t])&&void 0!==n?n:c.ww,r=new URL(`https://www.tunemymusic.com${i}/export?mode=shaker`);return r.searchParams.set("fdest",null!==(a=l[e.toLowerCase()])&&void 0!==a?a:e.toLowerCase()),r},u=()=>{(0,r.A)({body:(0,i.AP)("libraryimporterdismiss_text_transferstillavailableinsettings_web")}),a.A.callAsync({method:"libraryimport.flagTMMAsDismissed"}).catch(e=>{throw e})}},kDgj:(e,t,n)=>{n.d(t,{E:()=>i,w:()=>a});const a="allow-explicit-content",i="block-explicit-content"},nQur:(e,t,n)=>{n.d(t,{A:()=>g});var a=n("Au7y"),i=n("Sb6s"),r=n("TRpf"),s=n("Fzox"),o=n("X6oL"),l=n("Nz/Y"),c=n("34sk"),d=n("yJX9"),u=n("vXsw"),p=n("xobL"),m=n("A2sV");const h=a.J1`
	fragment isAlbumFavorite on Album {
		isFavorite
	}
`,g=e=>{const t={albumId:e},n=(0,r.wA)(),a=(0,s.G)(({user:e})=>(0,p.UJ)(e)),g=(0,l.A)(),y=(0,o.z1)(),{data:A}=(0,i.I)({fragment:h,from:{__typename:"Album",id:e},optimistic:!0}),[E]=(0,m._At)({variables:t,optimisticResponse:{__typename:"Mutation",addAlbumToFavorite:{album:{id:e,isFavorite:!0,__typename:"Album"},__typename:"AlbumMutationFavoriteAddOut"}},onCompleted:()=>{n((0,c.TD)(d.Z.favorites,{id:e,timestamp:Date.now()},"album"));const t=y.getTrackingData(),{pagecategory:a,pagename:i,index:r}=t,s=a||i,o="album";s&&y.trackEvent({eventaction:`click-favorite-${s}_${o}`,event:"click",eventcategory:s,eventlabel:`favorite-${s}_${o}`,item:{id:e,type:o,rank:r||0}})}}),[_]=(0,m.I7O)({variables:t,onCompleted:()=>{n((0,c.E$)(d.Z.favorites,e,"album"))},optimisticResponse:{__typename:"Mutation",removeAlbumFromFavorite:{album:{id:e,isFavorite:!1,__typename:"Album"},__typename:"AlbumMutationFavoriteRemoveOut"}}}),f=(0,s.G)(t=>t.feedbacks.favorites.album.feedbacks[e]),b=Boolean(f||(null==A?void 0:A.isFavorite));return{isFavorite:b,toggleFavorite:()=>{a?b?_():(g(),E()):u.g.goToConnection()}}}},"oRM/":(e,t,n)=>{n.d(t,{Dy:()=>p,eQ:()=>u});var a=n("q1tI"),i=n("LOQS"),r=n("HQK9"),s=n("tZCQ"),o=n("TRpf");let l=function(e){return e.CALL="call",e.PRINT="print",e.CLICK="click",e.VIEW="view",e.DISCARD="discard",e}({}),c=function(e){return e.OK="ok",e.NO_ADS="no_ads",e.ERROR="error",e.PENDING="pending",e.TIMEOUT="timeout",e}({}),d=function(e){return e.GAM="gam",e.SERVER="server",e}({}),u=function(e){return e.NATIVE="native",e.BANNER="banner",e.AUDIO="audio",e.PREROLL="preroll",e.PLAYLIST="playlist",e}({});const p=e=>{const t=(0,o.d4)(e=>{var t;return null==e||null===(t=e.user)||void 0===t?void 0:t.COUNTRY}),n=(0,a.useCallback)((n,a,o,l={})=>{var c;if(!s.A.isAllowed("metric.ads.monitoring"))return;const p=o===u.AUDIO?d.SERVER:d.GAM;return i.A.log((0,r.L)("ads.monitoring","3.0.0",{country:t,content:{user_profile:(null===(c=e.profile)||void 0===c?void 0:c.name)||"regular",ad_count:l.adCount||1,event:{type:n,status:a,...l.error&&{error:l.error}},ad:{source:p,type:o,...l.campaignId&&{campaign_id:l.campaignId},...l.loadingDuration&&{loading_duration:l.loadingDuration}},...void 0!==l.adblock&&{adblock:l.adblock}}}))},[e]);return{logBannerAdDisplay:(0,a.useCallback)((e,t={})=>{n(l.PRINT,c.OK,e,{...t})},[n]),logBannerAdDisplayError:(0,a.useCallback)((e,t,a={})=>{n(l.PRINT,c.ERROR,e,{error:t,...a})},[n]),logAdView:(0,a.useCallback)((e,t={})=>{n(l.VIEW,c.OK,e,{...t})},[n]),logAdViewError:(0,a.useCallback)((e,t={})=>{var a;n(l.VIEW,c.ERROR,e,{error:t.error,adblock:null===(a=t.error)||void 0===a?void 0:a.includes("adblock")})},[n]),logAdClick:(0,a.useCallback)((e,t={})=>{n(l.CLICK,c.OK,e,{...t})},[n]),logNoAds:(0,a.useCallback)((e,t={})=>{n(l.CALL,c.NO_ADS,e,{...t})},[n]),logAdTimeout:(0,a.useCallback)((e,t={})=>{n(l.CALL,c.TIMEOUT,e,{...t})},[n]),logBannerAdDiscard:(0,a.useCallback)((e,t={})=>{n(l.DISCARD,c.OK,e,{...t})},[n]),logAdCall:(0,a.useCallback)((e,t={})=>{n(l.CALL,c.OK,e,{...t})},[n]),logAdCallError:(0,a.useCallback)((e,t)=>{n(l.CALL,c.ERROR,e,{error:t})},[n])}}},pIhH:(e,t,n)=>{n.d(t,{Ay:()=>p,y5:()=>d});var a=n("q1tI"),i=n("TRpf"),r=n("H/eQ"),s=n("WBQ7"),o=n("xobL");const l="wakeUpNotification-time",c="wakeUpNotification-cap";let d=function(e){return e.LTR="ltr",e.RTL="rtl",e}({});class u extends a.Component{constructor(...e){super(...e),this.createGenericNotification=e=>new Notification("Deezer",{body:"Why not listen again to some music?",dir:e,silent:!0}),this.createTrackNotification=(e,t,n)=>new Notification("Deezer",{body:`You last listened to ${e} by ${t.map(e=>e.ART_NAME).join(", ")}. What will you listen to next?`,dir:n,silent:!0}),this.shouldLaunchTimer=()=>{if(!this.props.isPaused)return!1;const e=Number(s.default.get(l,"0")),t=(new Date).setDate((new Date).getDate()-1),n=Number(s.default.get(c,"0"));return e<t&&n<5},this._onBlur=()=>{this.shouldLaunchTimer()&&(this._timer=window.setTimeout(this._notify,this.props.delay))},this._onFocus=()=>{clearTimeout(this._timer)},this._onNotificationShown=()=>{s.default.set(l,Date.now())},this._notify=()=>{const{trackTitle:e,trackArtists:t,langDirection:n}=this.props;if(e&&t)return this._notification=this.createTrackNotification(e,t,n),void this._setNewCap();this._notification=this.createGenericNotification(n),this._setNewCap()},this._setNewCap=()=>{s.default.set(l,Date.now()),s.default.set(c,Number(s.default.get(c,0)+1))},this._notification=void 0,this._timer=void 0}componentDidMount(){window.addEventListener(r.A.ads.blur,this._onBlur),window.addEventListener(r.A.ads.focus,this._onFocus)}componentWillUnmount(){window.removeEventListener(r.A.ads.blur,this._onBlur),window.removeEventListener(r.A.ads.focus,this._onFocus)}render(){return null}}u.defaultProps={delay:72e5,trackTitle:void 0,trackArtists:[]};const p=(0,i.Ng)(e=>({langDirection:(0,o.iJ)(e.user),isPaused:!e.player.control.playing,trackTitle:e.player.music.trackTitle,trackArtists:e.player.music.trackArtists}))(u)},r2ys:(e,t,n)=>{n.d(t,{A:()=>s});var a=n("q1tI"),i=n("uHHB"),r=n("vGT4");const s=()=>{const{state:e}=(0,r.b)(),t=(e=>null==e?void 0:e.settings)(e);return(0,a.useEffect)(()=>{const{consentString:e,statistics:n=0,targetedAdvertising:a=0}=t||{};window.sas&&window.sas.cmd.push(()=>{window.sas.setGdprConsentData(e)}),(0,i.A)("consentStatistics",n.toString(),100),(0,i.A)("consentMarketing",a.toString(),100)},[t]),null}},"rYh+":(e,t,n)=>{n.d(t,{A:()=>c});var a=n("q1tI"),i=n("juqV"),r=n("TRpf"),s=n("RSbz"),o=n("6vqc");class l extends a.Component{render(){const{className:e,langDirection:t,size:n}=this.props,r="rtl"===t?s.Y:o.v,l=(0,i.A)(e,"animate-wobble-target");return a.createElement(r,{className:l,boxSize:`${n}px`})}}l.defaultProps={size:"16",langDirection:"ltr"};const c=(0,r.Ng)(({user:e})=>({langDirection:e.DIRECTION}))(l)},vHlZ:(e,t,n)=>{n.d(t,{A:()=>p});var a,i=n("+9dH"),r=n("q1tI"),s=n("HmE0"),o=n("YIja"),l=n("Votb"),c=n("7bxg"),d=n("mUtM"),u=n("TRpf");const p=({id:e,onClose:t,message:n,action:p,...m})=>{const h=(0,u.wA)(),g=r.createElement(l.z,{spacing:"spacing.s"},p,r.createElement(s.K0,{"aria-label":"close","data-testid":"alert-close-btn",icon:a||(a=r.createElement(c.w,null)),key:"close",onClick:n=>{h((0,d.Hd)(e)),t&&t(n)},type:"button",size:"small",variant:"outline"}));return r.createElement(o.N,(0,i.A)({borderRadius:"0","data-testid":`alert-${e}`,action:g},m),n)}},"x4+n":(e,t,n)=>{n.d(t,{E:()=>s});var a=n("Wp0Y"),i=n("3nMj"),r=n("iiSH");const s=(e,t)=>{if(Number.isNaN(e))return r.fs;const n=new Date(1e3*t),s=n.getDate(),o=new Date(1e3*t-864e5).getDate(),l=n.getMonth(),c=n.getFullYear(),d=new Date(e),u=d.getDate(),p=d.getMonth(),m=d.getFullYear();return s===u&&l===p&&c===m?(0,a.AP)("masthead_title_today_web"):o===u&&l===p&&c===m?(0,a.AP)("generic_title_yesterday_web"):(0,i.A)(e)}},xvdY:(e,t,n)=>{n.d(t,{A:()=>A});var a,i,r=n("q1tI"),s=n("TRpf"),o=n("fJgm"),l=n("OPhi"),c=n("GkgI"),d=n("5G9X"),u=n("NgX8"),p=n("HmE0"),m=n("AlG7"),h=n("DcKU"),g=n("P4bz");class y extends r.Component{constructor(e){super(e),this._handleToggle=this._handleToggle.bind(this),this._handleDoubleClick=this._handleDoubleClick.bind(this)}shouldComponentUpdate(e){return this.props.isFavorite!==e.isFavorite||this.props.id!==e.id}render(){const{className:e,isFavorite:t,type:n,tooltip:s,tooltipPosition:o,isDisabled:l}=this.props,c=this._getTooltip(),y=r.createElement(p.K0,{"data-testid":n!==d.Ay.User?"add_to_favorite_button_"+(t?"on":"off"):void 0,variant:"ghost",size:"small",isDisabled:l,onClick:this._handleToggle,onDoubleClick:this._handleDoubleClick,"aria-label":c,icon:r.createElement(r.Fragment,null,n===d.Ay.User&&r.createElement(g.H,{color:t&&"icon.accent.primary.default"}),n!==d.Ay.User&&t&&(a||(a=r.createElement(m.C,{color:"icon.accent.primary.default"}))),n!==d.Ay.User&&!t&&(i||(i=r.createElement(h.M,null)))),className:e});return s&&!l?r.createElement(u.m,{label:c,placement:o},y):y}_handleDoubleClick(e){e.stopPropagation()}_handleToggle(e){e.stopPropagation();const{isFavorite:t,type:n,id:a,context:i,onAdd:r,onRemove:s}=this.props,l={type:n,id:a,context:i};if(t){if(s)return void s(o.A,l);o.A.remove(l)}else{if(r)return void r(o.A,l);o.A.add(l)}}_getTooltip(){const{isFavorite:e,type:t}=this.props;return"song"===t?(0,c.b)({type:t,action:"favorite"},e?"hover":"add","full"):""}}y.defaultProps={type:d.Ay.Album,tooltip:!1,tooltipPosition:"top",isDisabled:!1};const A=(0,s.Ng)(({feedbacks:e},t)=>({isFavorite:(0,l.BA)(e,t.id,t.type)}))(y)},zerP:(e,t,n)=>{n.d(t,{$O:()=>g,A$:()=>d,BE:()=>m,Hx:()=>y,PJ:()=>u,iE:()=>h,sR:()=>p}),n("WpbS"),n("/eM8");var a=n("nrKQ"),i=n("1EyH"),r=n("kSUS"),s=n("guCc"),o=n("H9G8"),l=n("5U+Y"),c=n("EYlq");const d=async(e,t=!1)=>{if(e=e.trim(),!(0,i.UC)(e))throw new o.Hf;const n=await a.A.callAsync({method:"deezer.emailCheck",data:{EMAIL:e}});if(!n.domain_validity)throw new o.SY(n.domain);if(n.availability)return t&&n.suggestion?{success:!0,suggestion:n.suggestion}:{success:!0};throw new o.qb},u=(0,r.A)((e,t,n,a)=>d(e,t).then(n).catch(a),400),p=e=>{const t=[/.*[A-Z]+.*/,/.*[a-z]+.*/,/.*[0-9]+.*/,/.*[^A-Za-z0-9]+.*/];if([/.*[0-9]+.*/,/.*[a-zA-Z]+.*/,/^.{8,}$/].reduce((t,n)=>t&&n.test(e),!0)){const n=t.reduce((t,n)=>t+(n.test(e)?1:0),0);return n>3?s.m.STRONG:n>2?s.m.MEDIUM:n>1?s.m.WEAK:s.m.TOO_WEAK}return s.m.TOO_WEAK},m=e=>{if(e!==e.trim())throw new o.RQ;if(e.length>l.K9)throw new o.Ee;if(e.length<l.wz)throw new o.CZ;return!0},h=e=>{if((e=e.trim()).length<l.D6)throw new o.U9;if(e.length>l.d0)throw new o.aS;if((0,i.Sx)(e)||(0,i.BB)(e))throw new o.In;return!0},g=e=>{if("string"==typeof e){if(!/^\d+$/.test(e.toString()))throw new o.vM;e=parseInt(e,10)}if(e<l.fB)throw new o.r_(l.fB);if(e>l.D3)throw new o.vM;return!0},y=e=>{if(0===e.length)throw new o.jQ((0,c.u)("invalid_code"));if(e.length<6)throw new o.jQ((0,c.u)("code_too_short"));if(e.length>6)throw new o.jQ((0,c.u)("code_too_long"));return!0}}}]);